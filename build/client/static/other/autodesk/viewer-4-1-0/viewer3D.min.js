// LMV v4.1.0
//
// Copyright 2018 Autodesk, Inc.
// All rights reserved.
// 
// This computer source code and related instructions and comments are the
// unpublished confidential and proprietary information of Autodesk, Inc.
// and are protected under Federal copyright and state trade secret law.
// They may not be disclosed to, copied or used by any third party without
// the prior written consent of Autodesk, Inc.
// 
// Autodesk Forge Viewer Usage Limitations:
// 
// The Autodesk Forge viewer can only be used to view files generated by
// Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
// delivered from an Autodesk hosted URL.
function getGlobal(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:global}function trace(a){"\n"==a[a.length-1]&&(a=a.substring(0,a.length-1)),console.log((performance.now()/1e3).toFixed(3)+": "+a)}function init_TransformGizmos(){"use strict";var a=function(a){THREE.MeshBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.side=THREE.FrontSide,this.transparent=!0,this.setValues(a),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(a){a?(this.color.setRGB(1,230/255,3/255),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};a.prototype=Object.create(THREE.MeshBasicMaterial.prototype);var b=function(a){THREE.LineBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.transparent=!0,this.linewidth=1,this.setValues(a),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(a){a?(this.color.setRGB(1,230/255,3/255),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};b.prototype=Object.create(THREE.LineBasicMaterial.prototype),void 0===THREE.PolyhedronGeometry&&(THREE.PolyhedronGeometry=function(a,b,c,d){function e(a){var b=a.normalize().clone();b.index=j.vertices.push(b)-1;var c=g(a)/2/Math.PI+.5,d=h(a)/Math.PI+.5;return b.uv=new THREE.Vector2(c,1-d),b}function f(a,b,c){var d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]);j.faces.push(d),s.copy(a).add(b).add(c).divideScalar(3);var e=g(s);j.faceVertexUvs[0].push([i(a.uv,a,e),i(b.uv,b,e),i(c.uv,c,e)])}function g(a){return Math.atan2(a.z,-a.x)}function h(a){return Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))}function i(a,b,c){return c<0&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y)),0===b.x&&0===b.z&&(a=new THREE.Vector2(c/2/Math.PI+.5,a.y)),a.clone()}THREE.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:a,indices:b,radius:c,detail:d},c=c||1,d=d||0;for(var j=this,k=0,l=a.length;k<l;k+=3)e(new THREE.Vector3(a[k],a[k+1],a[k+2]));for(var m=this.vertices,n=[],k=0,o=0,l=b.length;k<l;k+=3,o++){var p=m[b[k]],q=m[b[k+1]],r=m[b[k+2]];n[o]=new THREE.Face3(p.index,q.index,r.index,[p.clone(),q.clone(),r.clone()])}for(var s=new THREE.Vector3,k=0,l=n.length;k<l;k++)!function(a,b){for(var c=Math.pow(2,b),d=(Math.pow(4,b),e(j.vertices[a.a])),g=e(j.vertices[a.b]),h=e(j.vertices[a.c]),i=[],k=0;k<=c;k++){i[k]=[];for(var l=e(d.clone().lerp(h,k/c)),m=e(g.clone().lerp(h,k/c)),n=c-k,o=0;o<=n;o++)i[k][o]=0==o&&k==c?l:e(l.clone().lerp(m,o/n))}for(var k=0;k<c;k++)for(var o=0;o<2*(c-k)-1;o++){var p=Math.floor(o/2);o%2==0?f(i[k][p+1],i[k+1][p],i[k][p]):f(i[k][p+1],i[k+1][p+1],i[k+1][p])}}(n[k],d);for(var k=0,l=this.faceVertexUvs[0].length;k<l;k++){var t=this.faceVertexUvs[0][k],u=t[0].x,v=t[1].x,w=t[2].x,x=Math.max(u,Math.max(v,w)),y=Math.min(u,Math.min(v,w));x>.9&&y<.1&&(u<.2&&(t[0].x+=1),v<.2&&(t[1].x+=1),w<.2&&(t[2].x+=1))}for(var k=0,l=this.vertices.length;k<l;k++)this.vertices[k].multiplyScalar(c);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype)),void 0===THREE.OctahedronGeometry&&(THREE.OctahedronGeometry=function(a,b){this.parameters={radius:a,detail:b};var c=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],d=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];THREE.PolyhedronGeometry.call(this,c,d,a,b),this.type="OctahedronGeometry",this.parameters={radius:a,detail:b}},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype)),void 0===THREE.TorusGeometry&&(THREE.TorusGeometry=function(a,b,c,d,e){THREE.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e},a=a||100,b=b||40,c=c||8,d=d||6,e=e||2*Math.PI;for(var f=new THREE.Vector3,g=[],h=[],i=0;i<=c;i++)for(var j=0;j<=d;j++){var k=j/d*e,l=i/c*Math.PI*2;f.x=a*Math.cos(k),f.y=a*Math.sin(k);var m=new THREE.Vector3;m.x=(a+b*Math.cos(l))*Math.cos(k),m.y=(a+b*Math.cos(l))*Math.sin(k),m.z=b*Math.sin(l),this.vertices.push(m),g.push(new THREE.Vector2(j/d,i/c)),h.push(m.clone().sub(f).normalize())}for(var i=1;i<=c;i++)for(var j=1;j<=d;j++){var n=(d+1)*i+j-1,o=(d+1)*(i-1)+j-1,p=(d+1)*(i-1)+j,q=(d+1)*i+j,r=new THREE.Face3(n,o,q,[h[n].clone(),h[o].clone(),h[q].clone()]);this.faces.push(r),this.faceVertexUvs[0].push([g[n].clone(),g[o].clone(),g[q].clone()]),r=new THREE.Face3(o,p,q,[h[o].clone(),h[p].clone(),h[q].clone()]),this.faces.push(r),this.faceVertexUvs[0].push([g[o].clone(),g[p].clone(),g[q].clone()])}this.computeFaceNormals()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype));var c=function(a,b,c){var d=new THREE.Geometry;c=c||1;for(var e=0;e<=64*c;++e)"x"==b&&d.vertices.push(new THREE.Vector3(0,Math.cos(e/32*Math.PI),Math.sin(e/32*Math.PI)).multiplyScalar(a)),"y"==b&&d.vertices.push(new THREE.Vector3(Math.cos(e/32*Math.PI),0,Math.sin(e/32*Math.PI)).multiplyScalar(a)),"z"==b&&d.vertices.push(new THREE.Vector3(Math.sin(e/32*Math.PI),Math.cos(e/32*Math.PI),0).multiplyScalar(a));return d},d=function(a,b,c,d,e,f){var g=new THREE.Geometry,h=new THREE.Mesh(new THREE.CylinderGeometry(a,b,c,d,e,f));return h.position.y=.5,h.updateMatrix(),g.merge(h.geometry,h.matrix),g},e=function(a){var b=new THREE.Geometry;return"X"===a?b.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(1,0,0)):"Y"===a?b.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0)):"Z"===a&&b.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1)),b};THREE.TransformGizmo=function(){var a=this;this.init=function(){THREE.Object3D.call(this),this.handles=new THREE.Object3D,this.pickers=new THREE.Object3D,this.planes=new THREE.Object3D,this.highlights=new THREE.Object3D,this.hemiPicker=new THREE.Object3D,this.subPickers=new THREE.Object3D,this.add(this.handles),this.add(this.pickers),this.add(this.planes),this.add(this.highlights),this.add(this.hemiPicker),this.add(this.subPickers);var a=new THREE.PlaneBufferGeometry(50,50,2,2),b=new THREE.MeshBasicMaterial({wireframe:!0});b.side=THREE.DoubleSide;var c={XY:new THREE.Mesh(a,b),YZ:new THREE.Mesh(a,b),XZ:new THREE.Mesh(a,b),XYZE:new THREE.Mesh(a,b)};this.activePlane=c.XYZE,c.YZ.rotation.set(0,Math.PI/2,0),c.XZ.rotation.set(-Math.PI/2,0,0);for(var d in c)c[d].name=d,this.planes.add(c[d]),this.planes[d]=c[d],c[d].visible=!1;this.setupGizmos(),this.activeMode="",this.traverse(function(a){if(a instanceof THREE.Mesh){a.updateMatrix();var b=new THREE.Geometry;a.geometry instanceof THREE.BufferGeometry&&(a.geometry=(new THREE.Geometry).fromBufferGeometry(a.geometry)),b.merge(a.geometry,a.matrix),a.geometry=b,a.position.set(0,0,0),a.rotation.set(0,0,0),a.scale.set(1,1,1)}})},this.hide=function(){this.traverse(function(a){a.visible=!1})},this.show=function(){this.traverse(function(b){b.visible=!0,b.parent!=a.pickers&&b.parent!=a.hemiPicker||(b.visible=!1),b.parent==a.planes&&(b.visible=!1)}),this.activePlane.visible=!1},this.highlight=function(a){this.traverse(function(b){b.material&&b.material.highlight&&(b.name==a?b.material.highlight(!0):b.material.highlight(!1))})},this.setupGizmos=function(){var a=function(a,b){for(var c in a)for(var d=a[c].length;d--;){var e=a[c][d][0],f=a[c][d][1],g=a[c][d][2],h=a[c][d][3];e.name=c,f&&e.position.set(f[0],f[1],f[2]),g&&e.rotation.set(g[0],g[1],g[2]),h&&(e.visble=h),b.add(e)}};this.setHandlePickerGizmos(),a(this.handleGizmos,this.handles),a(this.pickerGizmos,this.pickers),a(this.highlightGizmos,this.highlights),a(this.hemiPickerGizmos,this.hemiPicker),a(this.subPickerGizmos,this.subPickers),this.hide(),this.show()}},THREE.TransformGizmo.prototype=Object.create(THREE.Object3D.prototype),THREE.TransformGizmo.prototype.update=function(a,b){var c=new THREE.Vector3(0,0,0),d=new THREE.Vector3(0,1,0),e=new THREE.Matrix4;this.traverse(function(f){f.name&&(-1!=f.name.search("E")?f.quaternion.setFromRotationMatrix(e.lookAt(b,c,d)):-1==f.name.search("X")&&-1==f.name.search("Y")&&-1==f.name.search("Z")||f.quaternion.setFromEuler(a))})},THREE.TransformGizmoTranslate=function(){THREE.TransformGizmo.call(this),this.setHandlePickerGizmos=function(){var c=d(0,.05,.2,12,1,!1),f=e("X"),g=e("Y"),h=e("Z");this.handleGizmos={X:[[new THREE.Mesh(c,new a({color:15805484})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(f,new b({color:15805484}))]],Y:[[new THREE.Mesh(c,new a({color:768011})),[0,.5,0]],[new THREE.Line(g,new b({color:768011}))]],Z:[[new THREE.Mesh(c,new a({color:2895089})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(h,new b({color:2895089}))]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new a({color:16777215,opacity:.25})),[0,0,0],[0,0,0]]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new a({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new a({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new a({color:16711935,opacity:.25})),[.15,0,.15],[-Math.PI/2,0,0]]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:16711680,opacity:.25})),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:65280,opacity:.25})),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:255,opacity:.25})),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.2,0),new a({color:16777215,opacity:.25}))]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new a({color:16776960,opacity:.25})),[.2,.2,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new a({color:65535,opacity:.25})),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new a({color:16711935,opacity:.25})),[.2,0,.2],[-Math.PI/2,0,0]]]},this.hemiPickerGizmos={XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(1.2,1.2,1.2),new a({color:255})),[.5,.5,.5],null,!1]]}},this.setActivePlane=function(a,b){var c=new THREE.Matrix4;b.applyMatrix4(c.getInverse(c.extractRotation(this.planes.XY.matrixWorld))),"X"==a&&(this.activePlane=this.planes.XY,Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ)),"Y"==a&&(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ)),"Z"==a&&(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=this.planes.YZ)),"XYZ"==a&&(this.activePlane=this.planes.XYZE),"XY"==a&&(this.activePlane=this.planes.XY),"YZ"==a&&(this.activePlane=this.planes.YZ),"XZ"==a&&(this.activePlane=this.planes.XZ),this.hide(),this.show()},this.init()},THREE.TransformGizmoTranslate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoRotate=function(){THREE.TransformGizmo.call(this),this.setHandlePickerGizmos=function(){this.handleGizmos={RX:[[new THREE.Line(c(1,"x",.5),new b({color:16711680}))]],RY:[[new THREE.Line(c(1,"y",.5),new b({color:65280}))]],RZ:[[new THREE.Line(c(1,"z",.5),new b({color:255}))]],RE:[[new THREE.Line(c(1.25,"z",1),new b({color:65535}))]],RXYZE:[[new THREE.Line(c(1,"z",1),new b({color:16711935}))]]},this.pickerGizmos={RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new a({color:16711680,opacity:.25})),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new a({color:65280,opacity:.25})),[0,0,0],[Math.PI/2,0,0]]],RZ:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new a({color:255,opacity:.25})),[0,0,0],[0,0,-Math.PI/2]]],RE:[[new THREE.Mesh(new THREE.TorusGeometry(1.25,.12,2,24),new a({color:65535,opacity:.25}))]],RXYZE:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,2,24),new a({color:16711935,opacity:.25}))]]}},this.setActivePlane=function(a){"RE"==a&&(this.activePlane=this.planes.XYZE),"RX"==a&&(this.activePlane=this.planes.YZ),"RY"==a&&(this.activePlane=this.planes.XZ),"RZ"==a&&(this.activePlane=this.planes.XY),this.hide(),this.show()},this.update=function(a,b){THREE.TransformGizmo.prototype.update.apply(this,arguments);var c=new THREE.Matrix4,d=new THREE.Euler(0,0,1),e=new THREE.Quaternion,f=new THREE.Vector3(1,0,0),g=new THREE.Vector3(0,1,0),h=new THREE.Vector3(0,0,1),i=new THREE.Quaternion,j=new THREE.Quaternion,k=new THREE.Quaternion,l=b.clone();d.copy(this.planes.XY.rotation),e.setFromEuler(d),c.makeRotationFromQuaternion(e).getInverse(c),l.applyMatrix4(c),this.traverse(function(a){e.setFromEuler(d),"RX"==a.name&&(i.setFromAxisAngle(f,Math.atan2(-l.y,l.z)),e.multiplyQuaternions(e,i),a.quaternion.copy(e)),"RY"==a.name&&(j.setFromAxisAngle(g,Math.atan2(l.x,l.z)),e.multiplyQuaternions(e,j),a.quaternion.copy(e)),"RZ"==a.name&&(k.setFromAxisAngle(h,Math.atan2(l.y,l.x)),e.multiplyQuaternions(e,k),a.quaternion.copy(e))})},this.init()},THREE.TransformGizmoRotate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoTranslateRotate=function(){THREE.TransformGizmo.call(this);var b=this;this.setHandlePickerGizmos=function(){var b=d(0,.05,.2,12,1,!1);(new THREE.Geometry).vertices.push(new THREE.Vector3(0,0,-.1),new THREE.Vector3(0,0,.1),new THREE.Vector3(-.1,0,0),new THREE.Vector3(.1,0,0));this.handleGizmos={Z:[[new THREE.Mesh(b,new a({color:16777215})),[0,0,.25],[Math.PI/2,0,0]],[new THREE.Mesh(new THREE.CylinderGeometry(.015,.015,.6,4,1,!1),new a({color:16777215})),[0,0,.5],[Math.PI/2,0,0]]],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.015,12,60,.3*Math.PI),new a({color:16711680})),[0,0,0],[.15*Math.PI,-Math.PI/2,0]],[new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,.015,60,1,!1),new a({color:16711680})),[0,0,1],[Math.PI/2,0,0]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.015,12,60,.3*Math.PI),new a({color:255})),[0,0,0],[Math.PI/2,0,.35*Math.PI]],[new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,.01,60,1,!1),new a({color:255})),[0,0,1]]]},this.pickerGizmos={Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.12,.12,.65,4,1,!1),new a({color:255,opacity:.25})),[0,0,.5],[Math.PI/2,0,0]]],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,.3*Math.PI),new a({color:16711680,opacity:.25})),[0,0,0],[.15*Math.PI,-Math.PI/2,0]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,.3*Math.PI),new a({color:255,opacity:.25})),[0,0,0],[Math.PI/2,0,.35*Math.PI]]]},this.subPickerGizmos={Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.12,.12,.65,4,1,!1),new a({color:255,opacity:.25})),[0,0,.5],[Math.PI/2,0,0]]]},this.highlightGizmos={Z:[],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.02,12,60,2*Math.PI),new a({color:16711680,opacity:1})),[0,0,0],[0,-Math.PI/2,-Math.PI/2],!1]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.02,12,60,2*Math.PI),new a({color:255,opacity:1})),[0,0,0],[Math.PI/2,0,0],!1]]},this.hemiPickerGizmos={XYZ:[[new THREE.Mesh(new THREE.SphereGeometry(1.2,8,8,0,Math.PI),new a({color:255})),null,null,!1]]}},this.setActivePlane=function(a,b){if("translate"==this.activeMode){var c=new THREE.Matrix4;b.applyMatrix4(c.getInverse(c.extractRotation(this.planes.XY.matrixWorld))),"X"==a&&(this.activePlane=this.planes.XY,Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ)),"Y"==a&&(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ)),"Z"==a&&(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=this.planes.YZ))}else"rotate"==this.activeMode&&("RX"==a&&(this.activePlane=this.planes.YZ),"RY"==a&&(this.activePlane=this.planes.XZ),"RZ"==a&&(this.activePlane=this.planes.XY));this.hide(),this.show()},this.update=function(a,b){if("translate"==this.activeMode)THREE.TransformGizmo.prototype.update.apply(this,arguments);else if("rotate"==this.activeMode){THREE.TransformGizmo.prototype.update.apply(this,arguments);var c=new THREE.Matrix4,d=new THREE.Euler(0,0,1),e=new THREE.Quaternion,f=new THREE.Vector3(1,0,0),g=new THREE.Vector3(0,1,0),h=new THREE.Vector3(0,0,1),i=new THREE.Quaternion,j=new THREE.Quaternion,k=new THREE.Quaternion,l=b.clone();d.copy(this.planes.XY.rotation),e.setFromEuler(d),c.makeRotationFromQuaternion(e).getInverse(c),l.applyMatrix4(c),this.traverse(function(a){e.setFromEuler(d),"RX"==a.name&&(i.setFromAxisAngle(f,Math.atan2(-l.y,l.z)),e.multiplyQuaternions(e,i),a.quaternion.copy(e)),"RY"==a.name&&(j.setFromAxisAngle(g,Math.atan2(l.x,l.z)),e.multiplyQuaternions(e,j),a.quaternion.copy(e)),"RZ"==a.name&&(k.setFromAxisAngle(h,Math.atan2(l.y,l.x)),e.multiplyQuaternions(e,k),a.quaternion.copy(e))})}},this.show=function(){this.traverse(function(a){(null==b.parent||b.parent.useAllPickers||a.parent!=b.handles)&&(a.visible=!0),a.material&&(a.material.opacity=a.material.oldOpacity),a.parent!=b.pickers&&a.parent!=b.hemiPicker&&a.parent!=b.subPickers||(a.visible=!1),a.parent!=b.planes&&a.parent!=b.highlights||(a.visible=!1)}),this.activePlane.visible=!1},this.highlight=function(a){this.traverse(function(c){c.material&&c.material.highlight&&(c.name==a?(c.parent!=b.highlights&&c.parent!=b.handles||(c.visible=!0),c.material.highlight(!0)):(c.material.highlight(!1),c.material.opacity=.1))})},this.init()},THREE.TransformGizmoTranslateRotate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoScale=function(){THREE.TransformGizmo.call(this),this.setHandlePickerGizmos=function(){var c=d(.125,.125,.125),f=e("X"),g=e("Y"),h=e("Z");this.handleGizmos={X:[[new THREE.Mesh(c,new a({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(f,new b({color:16711680}))]],Y:[[new THREE.Mesh(c,new a({color:65280})),[0,.5,0]],[new THREE.Line(g,new b({color:65280}))]],Z:[[new THREE.Mesh(c,new a({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(h,new b({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.125,.125,.125),new a({color:16777215,opacity:.25}))]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:16711680,opacity:.25})),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:65280,opacity:.25})),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:255,opacity:.25})),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.4,.4,.4),new a({color:16777215,opacity:.25}))]]}},this.setActivePlane=function(a,b){var c=new THREE.Matrix4;b.applyMatrix4(c.getInverse(c.extractRotation(this.planes.XY.matrixWorld))),"X"==a&&(this.activePlane=this.planes.XY,Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ)),"Y"==a&&(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ)),"Z"==a&&(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=this.planes.YZ)),"XYZ"==a&&(this.activePlane=this.planes.XYZE),this.hide(),this.show()},this.init()},THREE.TransformGizmoScale.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformControls=function(a,b,c){function d(c,d){var e=b.getBoundingClientRect(),f=(c.clientX-e.left)/e.width*2-1,g=-(c.clientY-e.top)/e.height*2+1;a.isPerspective?(r.set(f,g,.5),r.unproject(a),q.set(a.position,r.sub(a.position).normalize())):(r.set(f,g,-1),r.unproject(a),s.set(0,0,-1),q.set(r,s.transformDirection(a.matrixWorld)));var h=q.intersectObjects(d,!0);return!!h[0]&&h[0]}switch(THREE.Object3D.call(this),b=void 0!==b?b:document,this.gizmo={},c){case"translate":this.gizmo[c]=new THREE.TransformGizmoTranslate;break;case"rotate":this.gizmo[c]=new THREE.TransformGizmoRotate;break;case"transrotate":this.gizmo[c]=new THREE.TransformGizmoTranslateRotate;break;case"scale":this.gizmo[c]=new THREE.TransformGizmoScale}if(this.add(this.gizmo[c]),this.gizmo[c].hide(),this.object=void 0,this.snap=null,this.snapDelta=0,this.space="world",this.size=1,this.axis=null,this.useAllPickers=!0,this.unitX=new THREE.Vector3(1,0,0),this.unitY=new THREE.Vector3(0,1,0),this.unitZ=new THREE.Vector3(0,0,1),this.normal=new THREE.Vector3(0,0,1),"transrotate"===c){var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1));var f=new THREE.LineBasicMaterial({color:0,linewidth:2,depthTest:!1});this.startLine=new THREE.Line(e,f);var e=new THREE.Geometry,f=new THREE.LineBasicMaterial({color:16770563,linewidth:2,depthTest:!1});e.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1)),this.endLine=new THREE.Line(e,f);var e=new THREE.Geometry,f=new THREE.LineDashedMaterial({color:0,linewidth:1,depthTest:!1});e.vertices.push(new THREE.Vector3(0,-1,0),new THREE.Vector3(0,1,0)),this.centerLine=new THREE.Line(e,f);var g=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/textures/centerMarker_X.png"));g.magFilter=g.minFilter=THREE.NearestFilter;var e=new THREE.CircleGeometry(.1,32),f=new THREE.MeshBasicMaterial({opacity:1,side:THREE.DoubleSide,transparent:!0,map:g});this.centerMark=new THREE.Mesh(e,f),this.centerMark.rotation.set(Math.PI/2,0,0),this.ticks={};var g=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/textures/cardinalPoint.png"));g.magFilter=g.minFilter=THREE.NearestFilter;var f=new THREE.MeshBasicMaterial({depthTest:!1,opacity:1,transparent:!0,side:THREE.DoubleSide,map:g}),h=.25;this.ticks.RX=new THREE.Object3D;var e=new THREE.PlaneBufferGeometry(.12,h),i=new THREE.Mesh(e,f);i.position.set(0,0,-1.275),i.rotation.set(Math.PI/2,Math.PI/2,0),this.ticks.RX.add(i),i=i.clone(),i.position.set(0,1.275,0),i.rotation.set(0,Math.PI/2,0),this.ticks.RX.add(i),i=i.clone(),i.position.set(0,0,1.275),i.rotation.set(0,Math.PI/2,Math.PI/2),this.ticks.RX.add(i),i=i.clone(),i.position.set(0,-1.275,0),i.rotation.set(0,Math.PI/2,0),this.ticks.RX.add(i),this.ticks.RY=new THREE.Object3D,i=i.clone(),i.position.set(0,0,-1.275),i.rotation.set(Math.PI/2,0,0),this.ticks.RY.add(i),i=i.clone(),i.position.set(-1.275,0,0),i.rotation.set(Math.PI/2,0,Math.PI/2),this.ticks.RY.add(i),i=i.clone(),i.position.set(0,0,1.275),i.rotation.set(Math.PI/2,0,0),this.ticks.RY.add(i),i=i.clone(),i.position.set(1.275,0,0),i.rotation.set(Math.PI/2,0,Math.PI/2),this.ticks.RY.add(i)}var j=this,k=!1,l=c,m={type:"change"},n={type:"mouseDown"},o={type:"mouseUp",mode:l},p={type:"objectChange"},q=new THREE.Raycaster,r=new THREE.Vector3,s=new THREE.Vector3,t=new THREE.Vector3,u=new THREE.Vector3,v=new THREE.Vector3,w=new THREE.Vector3,x=1,y=new THREE.Matrix4,z=new THREE.Vector3,A=new THREE.Matrix4,B=new THREE.Vector3,C=new THREE.Quaternion,D=new THREE.Vector3,E=new THREE.Vector3,F=new THREE.Vector3,G=new THREE.Quaternion,H=new THREE.Quaternion,I=new THREE.Quaternion,J=new THREE.Quaternion,K=new THREE.Quaternion,L=new THREE.Vector3,M=new THREE.Vector3,N=new THREE.Matrix4,O=new THREE.Matrix4,P=new THREE.Vector3,Q=new THREE.Vector3,R=new THREE.Euler,S=new THREE.Matrix4,T=new THREE.Vector3;new THREE.Euler;this.attach=function(a){j.object=a,this.gizmo[l].show(),j.update(),j.updateUnitVectors()},this.detach=function(a){j.object=void 0,this.axis=null,this.gizmo[l].hide()},this.setMode=function(a){l=a||l,"scale"==l&&(j.space="local"),this.gizmo[l].show(),this.update(),j.dispatchEvent(m)},this.getPicker=function(){return j.gizmo[l].hemiPicker.children},this.setPosition=function(a){this.object.position.copy(a),this.update()},this.setNormal=function(a){C.setFromUnitVectors(this.normal,a),this.unitX.applyQuaternion(C),this.unitY.applyQuaternion(C),this.unitZ.applyQuaternion(C),this.normal.copy(a),this.object&&this.object.quaternion.multiply(C),this.update()},this.setSnap=function(a,b){j.snap=a,j.snapDelta=b},this.setSize=function(a){j.size=a,this.update(),j.dispatchEvent(m)},this.setSpace=function(a){j.space=a,this.update(),j.dispatchEvent(m)},this.update=function(c){if(void 0!==j.object){j.object.updateMatrixWorld(),Q.setFromMatrixPosition(j.object.matrixWorld),R.setFromRotationMatrix(A.extractRotation(j.object.matrixWorld)),a.updateMatrixWorld(),T.setFromMatrixPosition(a.matrixWorld),this.position.copy(Q),this.quaternion.setFromEuler(R),this.normal.set(0,0,1),this.normal.applyEuler(R);var d;if(a.isPerspective){var e=Q.distanceTo(T);d=2*Math.tan(a.fov*Math.PI/360)*e}else d=a.top-a.bottom;var f=b.getBoundingClientRect();x=100*d/f.height,this.scale.set(x,x,x),c&&this.gizmo[l].highlight(j.axis)}},this.updateUnitVectors=function(){this.unitX.set(1,0,0),this.unitY.set(0,1,0),this.unitZ.set(0,0,1),this.unitX.applyEuler(R),this.unitY.applyEuler(R),this.unitZ.applyEuler(R)},this.showRotationGizmos=function(a){for(var b=this.gizmo[l].handles.children,c=0;c<b.length;c++){var d=b[c];d.visible=!0,-1!==d.name.search("R")&&(d.visible=a)}this.useAllPickers=a},this.highlight=function(){this.gizmo[l].highlight(this.axis||"Z")},this.onPointerHover=function(a){if(void 0===j.object||!0===k)return!1;var b=a.pointers?a.pointers[0]:a,c=d(b,j.useAllPickers?j.gizmo[l].pickers.children:j.gizmo[l].subPickers.children),e=null,f="";return c&&(e=c.object.name,f=-1!=e.search("R")?"rotate":"translate"),j.axis!==e&&(j.axis=e,j.gizmo[l].activeMode=f,j.update(!0),j.dispatchEvent(m)),null===j.axis&&j.gizmo[l].show(),!!c},this.onPointerDown=function(b){if(void 0===j.object||!0===k)return!1;var c=b.pointers?b.pointers[0]:b;if("touch"===b.pointerType){var e=d(c,j.useAllPickers?j.gizmo[l].pickers.children:j.gizmo[l].subPickers.children),f=null,g="";e&&(f=e.object.name,g=-1!=f.search("R")?"rotate":"translate"),j.axis!==f&&(j.axis=f,j.gizmo[l].activeMode=g)}var e=null;if((0===c.button||-1===c.button||void 0===c.button)&&(e=d(c,j.useAllPickers?j.gizmo[l].pickers.children:j.gizmo[l].subPickers.children))){j.dispatchEvent(n),j.axis=e.object.name,j.update(),z.copy(a.position).sub(Q).normalize(),j.gizmo[l].setActivePlane(j.axis,z);var h=d(c,[j.gizmo[l].activePlane]);if(h&&u.copy(h.point),L.copy(j.object.position),M.copy(j.object.scale),N.extractRotation(j.object.matrix),S.extractRotation(j.object.matrixWorld),j.object.parent?(O.extractRotation(j.object.parent.matrixWorld),P.setFromMatrixScale(A.getInverse(j.object.parent.matrixWorld))):(O.extractRotation(j.object.matrixWorld),P.setFromMatrixScale(A.getInverse(j.object.matrixWorld))),"transrotate"===l&&"rotate"===j.gizmo[l].activeMode){j.startLine.geometry.vertices[0].set(0,0,0).applyMatrix4(j.matrixWorld),j.startLine.geometry.vertices[1].set(0,0,1).applyMatrix4(j.matrixWorld),j.startLine.geometry.verticesNeedUpdate=!0,j.parent.add(j.startLine);var i=j.object.geometry.getAttribute("position"),m=(new THREE.Vector3).fromAttribute(i,0).applyMatrix4(j.object.matrixWorld),o=(new THREE.Vector3).fromAttribute(i,1).applyMatrix4(j.object.matrixWorld),p=(new THREE.Vector3).fromAttribute(i,2).applyMatrix4(j.object.matrixWorld),q=(new THREE.Vector3).fromAttribute(i,3).applyMatrix4(j.object.matrixWorld);if("RX"===j.axis){m.lerp(p,.5),o.lerp(q,.5);var r=m.distanceTo(o);j.centerLine.material.dashSize=r/15,j.centerLine.material.gapSize=r/30,j.centerLine.geometry.vertices[0].copy(m),j.centerLine.geometry.vertices[1].copy(o)}else{m.lerp(o,.5),p.lerp(q,.5);var r=m.distanceTo(p);j.centerLine.material.dashSize=r/15,j.centerLine.material.gapSize=r/30,j.centerLine.geometry.vertices[0].copy(m),j.centerLine.geometry.vertices[1].copy(p)}j.centerLine.geometry.computeLineDistances(),j.centerLine.geometry.verticesNeedUpdate=!0,j.parent.add(j.centerLine),j.ticks[j.axis].position.copy(j.position),j.ticks[j.axis].quaternion.copy(j.quaternion),j.ticks[j.axis].scale.copy(j.scale),j.parent.add(j.ticks[j.axis])}}return k=!0,!!e},this.onPointerMove=function(a){if(void 0===j.object||null===j.axis||!1===k)return!1;var b=a.pointers?a.pointers[0]:a,c=d(b,[j.gizmo[l].activePlane]);c&&t.copy(c.point);var e=j.gizmo[l].activeMode;if("translate"==e)t.sub(u),t.multiply(P),"local"==j.space&&(t.applyMatrix4(A.getInverse(S)),D.copy(this.unitX),E.copy(this.unitY),F.copy(this.unitZ),B.set(0,0,0),-1!=j.axis.search("X")&&(D.multiplyScalar(t.dot(this.unitX)),B.add(D)),-1!=j.axis.search("Y")&&(E.multiplyScalar(t.dot(this.unitY)),B.add(E)),-1!=j.axis.search("Z")&&(F.multiplyScalar(t.dot(this.unitZ)),B.add(F)),t.copy(B),t.applyMatrix4(N),j.object.position.copy(L),j.object.position.add(t)),"world"!=j.space&&-1==j.axis.search("XYZ")||(D.copy(this.unitX),E.copy(this.unitY),F.copy(this.unitZ),B.set(0,0,0),-1!=j.axis.search("X")&&(D.multiplyScalar(t.dot(this.unitX)),B.add(D)),-1!=j.axis.search("Y")&&(E.multiplyScalar(t.dot(this.unitY)),B.add(E)),-1!=j.axis.search("Z")&&(F.multiplyScalar(t.dot(this.unitZ)),B.add(F)),t.copy(B),t.applyMatrix4(A.getInverse(O)),j.object.position.copy(L),j.object.position.add(t));else if("scale"==e)t.sub(u),t.multiply(P),"local"==j.space&&("XYZ"==j.axis?(x=1+t.y/50,j.object.scale.x=M.x*x,j.object.scale.y=M.y*x,j.object.scale.z=M.z*x):(t.applyMatrix4(A.getInverse(S)),"X"==j.axis&&(j.object.scale.x=M.x*(1+t.x/50)),"Y"==j.axis&&(j.object.scale.y=M.y*(1+t.y/50)),"Z"==j.axis&&(j.object.scale.z=M.z*(1+t.z/50))));else if("rotate"==e){if(t.sub(Q),t.multiply(P),B.copy(u).sub(Q),B.multiply(P),"RE"==j.axis){t.applyMatrix4(A.getInverse(y)),B.applyMatrix4(A.getInverse(y)),v.set(Math.atan2(t.z,t.y),Math.atan2(t.x,t.z),Math.atan2(t.y,t.x)),w.set(Math.atan2(B.z,B.y),Math.atan2(B.x,B.z),Math.atan2(B.y,B.x)),C.setFromRotationMatrix(A.getInverse(O));var f=v.z-w.z;if(null!==j.snap){var g=Math.round(f/j.snap)*j.snap;Math.abs(g-f)<j.snapDelta&&(f=g)}K.setFromAxisAngle(z,f),G.setFromRotationMatrix(S),C.multiplyQuaternions(C,K),C.multiplyQuaternions(C,G),j.object.quaternion.copy(C)}else if("RXYZE"==j.axis){var h=t.clone().cross(B).normalize();C.setFromRotationMatrix(A.getInverse(O));var i=-t.clone().angleTo(B);if(null!==j.snap){var g=Math.round(i/j.snap)*j.snap;Math.abs(g-i)<j.snapDelta&&(i=g)}H.setFromAxisAngle(h,i),G.setFromRotationMatrix(S),C.multiplyQuaternions(C,H),C.multiplyQuaternions(C,G),j.object.quaternion.copy(C)}else if("local"==j.space){t.applyMatrix4(A.getInverse(S)),B.applyMatrix4(A.getInverse(S));var n=t.dot(this.unitX),o=t.dot(this.unitY),q=t.dot(this.unitZ),r=B.dot(this.unitX),s=B.dot(this.unitY),R=B.dot(this.unitZ);v.set(Math.atan2(q,o),Math.atan2(n,q),Math.atan2(o,n)),w.set(Math.atan2(R,s),Math.atan2(r,R),Math.atan2(s,r));var T=v.x-w.x,U=v.y-w.y,f=v.z-w.z;if(null!==j.snap){if(-1!=j.axis.search("X")){var g=Math.round(T/j.snap)*j.snap;Math.abs(g-T)<j.snapDelta&&(T=g)}if(-1!=j.axis.search("Y")){var g=Math.round(U/j.snap)*j.snap;Math.abs(g-U)<j.snapDelta&&(U=g)}if(-1!=j.axis.search("Z")){var g=Math.round(f/j.snap)*j.snap;Math.abs(g-f)<j.snapDelta&&(f=g)}}H.setFromAxisAngle(this.unitX,T),I.setFromAxisAngle(this.unitY,U),J.setFromAxisAngle(this.unitZ,f),G.setFromRotationMatrix(N),"RX"==j.axis&&G.multiplyQuaternions(G,H),"RY"==j.axis&&G.multiplyQuaternions(G,I),"RZ"==j.axis&&G.multiplyQuaternions(G,J),j.object.quaternion.copy(G)}else if("world"==j.space){var n=t.dot(this.unitX),o=t.dot(this.unitY),q=t.dot(this.unitZ),r=B.dot(this.unitX),s=B.dot(this.unitY),R=B.dot(this.unitZ);v.set(Math.atan2(q,o),Math.atan2(n,q),Math.atan2(o,n)),w.set(Math.atan2(R,s),Math.atan2(r,R),Math.atan2(s,r)),C.setFromRotationMatrix(A.getInverse(O));var T=v.x-w.x,U=v.y-w.y,f=v.z-w.z;if(null!==j.snap){if(-1!=j.axis.search("X")){var g=Math.round(T/j.snap)*j.snap;Math.abs(g-T)<j.snapDelta&&(T=g)}if(-1!=j.axis.search("Y")){var g=Math.round(U/j.snap)*j.snap;Math.abs(g-U)<j.snapDelta&&(U=g)}if(-1!=j.axis.search("Z")){var g=Math.round(f/j.snap)*j.snap;Math.abs(g-f)<j.snapDelta&&(f=g)}}H.setFromAxisAngle(this.unitX,T),I.setFromAxisAngle(this.unitY,U),J.setFromAxisAngle(this.unitZ,f),G.setFromRotationMatrix(S),"RX"==j.axis&&C.multiplyQuaternions(C,H),"RY"==j.axis&&C.multiplyQuaternions(C,I),"RZ"==j.axis&&C.multiplyQuaternions(C,J),C.multiplyQuaternions(C,G),j.object.quaternion.copy(C)}"transrotate"===l&&(j.add(j.endLine),j.add(j.centerMark))}return j.object.matrixAutoUpdate=!0,j.update(!0),j.dispatchEvent(m),j.dispatchEvent(p),!!c},this.onPointerUp=function(a){return k&&null!==j.axis&&(o.mode=l,j.dispatchEvent(o)),k=!1,this.gizmo[l].show(),this.updateUnitVectors(),"transrotate"===l&&"rotate"===this.gizmo[l].activeMode&&(this.remove(this.endLine),this.remove(this.centerMark),this.parent.remove(this.centerLine),this.parent.remove(this.startLine),this.parent.remove(this.ticks[this.axis])),!1}},
THREE.TransformControls.prototype=Object.create(THREE.Object3D.prototype)}!function(){function a(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:global}function b(b){for(var c=a(),d=b.split("."),e=0;e<d.length;++e)c[d[e]]=c[d[e]]||{},c=c[d[e]];return c}b("Autodesk.Viewing.Private"),b("Autodesk.Viewing.Extensions"),b("Autodesk.Viewing.Shaders"),b("Autodesk.Viewing.UI"),b("Autodesk.LMVTK"),Autodesk.Viewing.getGlobal=a,Autodesk.Viewing.AutodeskNamespace=b,a().AutodeskNamespace=b}(),Autodesk.Viewing.Private.initializeLegacyNamespaces=function(a){var b=Autodesk.Viewing,c=b.Shaders,d=b.Private;b.LMVTK;b.ErrorCodes=WGS.ErrorCodes,b.errorCodeString=WGS.errorCodeString,b.getErrorCode=WGS.getErrorCode,d.InstanceTreeStorage=WGS.InstanceTreeStorage,d.InstanceTreeAccess=WGS.InstanceTreeAccess,d.BVHBuilder=WGS.BVHBuilder,d.NodeArray=WGS.NodeArray,d.ViewingService=WGS.ViewingService,WGS.ViewingService.setEndpoint(b.endpoint),d.logger&&WGS.setLogger(d.logger),a||(b.FileLoaderManager.registerFileLoader("svf",["svf","gltf","glb"],WGS.SvfLoader),b.FileLoaderManager.registerFileLoader("json",["json"],WGS.OtgLoader),b.LOAD_MISSING_GEOMETRY=WGS.LOAD_MISSING_GEOMETRY,b.MODEL_ROOT_LOADED_EVENT=WGS.MODEL_ROOT_LOADED_EVENT,b.FRAGMENTS_LOADED_EVENT=WGS.FRAGMENTS_LOADED_EVENT,b.OBJECT_TREE_CREATED_EVENT=WGS.OBJECT_TREE_CREATED_EVENT,b.MODEL_UNLOADED_EVENT=WGS.MODEL_UNLOADED_EVENT,b.OBJECT_TREE_UNAVAILABLE_EVENT=WGS.OBJECT_TREE_UNAVAILABLE_EVENT,b.TEXTURES_LOADED_EVENT=WGS.TEXTURES_LOADED_EVENT,c.PackDepthShaderChunk=WGS.PackDepthShaderChunk,c.TonemapShaderChunk=WGS.TonemapShaderChunk,c.OrderedDitheringShaderChunk=WGS.OrderedDitheringShaderChunk,c.CutPlanesUniforms=WGS.CutPlanesUniforms,c.CutPlanesShaderChunk=WGS.CutPlanesShaderChunk,c.PackNormalsShaderChunk=WGS.PackNormalsShaderChunk,c.HatchPatternShaderChunk=WGS.HatchPatternShaderChunk,c.EnvSamplingShaderChunk=WGS.EnvSamplingShaderChunk,c.IdUniforms=WGS.IdUniforms,c.IdFragmentDeclaration=WGS.IdFragmentDeclaration,c.IdOutputShaderChunk=WGS.IdOutputShaderChunk,c.FinalOutputShaderChunk=WGS.FinalOutputShaderChunk,c.ThemingUniform=WGS.ThemingUniform,c.ThemingFragmentDeclaration=WGS.ThemingFragmentDeclaration,c.ThemingFragmentShaderChunk=WGS.ThemingFragmentShaderChunk,c.BackgroundShader=WGS.BackgroundShader,c.BlendShader=WGS.BlendShader,c.CelShader=WGS.CelShader,c.CopyShader=WGS.CopyShader,c.ClearShader=WGS.ClearShader,c.HighlightShader=WGS.HighlightShader,c.FXAAShader=WGS.FXAAShader,c.SAOBlurShader=WGS.SAOBlurShader,c.SAOMinifyFirstShader=WGS.SAOMinifyFirstShader,c.SAOMinifyShader=WGS.SAOMinifyShader,c.SAOShader=WGS.SAOShader,c.NormalsShader=WGS.NormalsShader,c.EdgeShader=WGS.EdgeShader,c.LineShader=WGS.LineShader,d.LineStyleDefs=WGS.LineStyleDefs,d.CreateLinePatternTexture=WGS.CreateLinePatternTexture,d.CreateCubeMapFromColors=WGS.CreateCubeMapFromColors,d.FloatToHalf=WGS.FloatToHalf,d.HalfToFloat=WGS.HalfToFloat,d.IntToHalf=WGS.IntToHalf,d.HalfToInt=WGS.HalfToInt,d.HalfTest=WGS.HalfTest,c.createShaderMaterial=WGS.createShaderMaterial,c.setMacro=WGS.setMacro,c.removeMacro=WGS.removeMacro,c.LmvShaderPass=WGS.ShaderPass,c.GaussianPass=WGS.GaussianPass,c.GroundShadow=WGS.GroundShadow,c.createGroundShape=WGS.createGroundShape,c.setGroundShapeTransform=WGS.setGroundShapeTransform,c.GroundReflection=WGS.GroundReflection,d.FireflyWebGLShader=WGS.WebGLShader,d.PrismMaps=WGS.PrismMaps,d.GetPrismMapChunk=WGS.GetPrismMapChunk,d.FireflyWebGLProgram=WGS.WebGLProgram,c.ShadowMapCommonUniforms=WGS.ShadowMapCommonUniforms,c.ShadowMapUniforms=WGS.ShadowMapUniforms,c.ShadowMapDeclareCommonUniforms=WGS.ShadowMapDeclareCommonUniforms,c.ShadowMapVertexDeclaration=WGS.ShadowMapVertexDeclaration,c.ShadowMapVertexShaderChunk=WGS.ShadowMapVertexShaderChunk,c.ShadowMapFragmentDeclaration=WGS.ShadowMapFragmentDeclaration,c.FireflyPhongShader=WGS.PhongShader,c.PrismShader=WGS.PrismShader,c.GetPrismMapUniforms=WGS.GetPrismMapUniforms,c.GetPrismMapSampleChunk=WGS.GetPrismMapSampleChunk,c.GetPrismMapUniformChunk=WGS.GetPrismMapUniformChunk,c.AverageOfFloat3=WGS.AverageOfFloat3,d.createPrismMaterial=WGS.createPrismMaterial,d.clonePrismMaterial=WGS.clonePrismMaterial,d.ShadowMapShader=WGS.ShadowMapShader,d.GroundShadowShader=WGS.GroundShadowShader,d.ShadowMapOverrideMaterials=WGS.ShadowMapOverrideMaterials,d.SHADOWMAP_NEEDS_UPDATE=WGS.SHADOWMAP_NEEDS_UPDATE,d.SHADOWMAP_INCOMPLETE=WGS.SHADOWMAP_INCOMPLETE,d.SHADOWMAP_VALID=WGS.SHADOWMAP_VALID,d.ShadowConfig=WGS.ShadowConfig,d.ShadowRender=WGS.ShadowRender,d.ShadowMaps=WGS.ShadowMaps,d.FrustumIntersector=WGS.FrustumIntersector,d.OUTSIDE=WGS.OUTSIDE,d.INTERSECTS=WGS.INTERSECTS,d.CONTAINS=WGS.CONTAINS,d.VBIntersector=WGS.VBIntersector,d.VertexEnumerator=WGS.VertexEnumerator,d.GPU_MEMORY_LIMIT=WGS.GPU_MEMORY_LIMIT,d.GPU_OBJECT_LIMIT=WGS.GPU_OBJECT_LIMIT,d.PAGEOUT_SUCCESS=WGS.PAGEOUT_SUCCESS,d.PAGEOUT_FAIL=WGS.PAGEOUT_FAIL,d.PAGEOUT_NONE=WGS.PAGEOUT_NONE,d.GeometryList=WGS.GeometryList,d.MESH_VISIBLE=WGS.MESH_VISIBLE,d.MESH_HIGHLIGHTED=WGS.MESH_HIGHLIGHTED,d.MESH_HIDE=WGS.MESH_HIDE,d.MESH_ISLINE=WGS.MESH_ISLINE,d.MESH_ISWIDELINE=WGS.MESH_ISWIDELINE,d.MESH_ISPOINT=WGS.MESH_ISPOINT,d.MESH_MOVED=WGS.MESH_MOVED,d.MESH_TRAVERSED=WGS.MESH_TRAVERSED,d.MESH_DRAWN=WGS.MESH_DRAWN,d.MESH_RENDERFLAG=WGS.MESH_RENDERFLAG,d.FragmentPointer=WGS.FragmentPointer,d.FragmentList=WGS.FragmentList,d.RENDER_NORMAL=WGS.RENDER_NORMAL,d.RENDER_HIGHLIGHTED1=WGS.RENDER_HIGHLIGHTED1,d.RENDER_HIGHLIGHTED2=WGS.RENDER_HIGHLIGHTED2,d.RENDER_HIDDEN=WGS.RENDER_HIDDEN,d.RENDER_SHADOWMAP=WGS.RENDER_SHADOWMAP,d.RENDER_FINISHED=WGS.RENDER_FINISHED,d.GROUND_UNFINISHED=WGS.GROUND_UNFINISHED,d.GROUND_FINISHED=WGS.GROUND_FINISHED,d.GROUND_RENDERED=WGS.GROUND_RENDERED,d.RenderBatch=WGS.RenderBatch,b.rescueFromPolymer=WGS.rescueFromPolymer,d.FireflyWebGLRenderer=WGS.WebGLRenderer,d.ModelIteratorLinear=WGS.ModelIteratorLinear,d.ModelIteratorBVH=WGS.ModelIteratorBVH,d.BufferGeometryUtils=WGS.BufferGeometryUtils,d.RenderScene=WGS.RenderScene,d.SortedList=WGS.SortedList,d.ModelIteratorTexQuad=WGS.ModelIteratorTexQuad,d.TexQuadConfig=WGS.TexQuadConfig,d.LeafletDiffIterator=WGS.LeafletDiffIterator,d.LeafletDiffModes=WGS.LeafletDiffModes,d.InstanceTree=WGS.InstanceTree,b.SelectionMode=WGS.SelectionMode,d.MaterialConverter=WGS.MaterialConverter)};var av=Autodesk.Viewing,avp=av.Private;av.getGlobal=getGlobal;var isBrowser=av.isBrowser="undefined"!=typeof navigator,isIE11=av.isIE11=isBrowser&&!!navigator.userAgent.match(/Edge|Trident\/7\./);"undefined"!=typeof window&&isIE11&&function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.CustomEvent.prototype,window.CustomEvent=a}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){if(!b||b>this.byteLength?b=this.byteLength:b<0&&(b=this.byteLength+b)<0&&(b=0),a<0&&(a=this.byteLength+a)<0&&(a=0),b<=a)return new ArrayBuffer;for(var c=b-a,d=new Uint8Array(this,a,c),e=new Uint8Array(c),f=0;f<c;f++)e[f]=d[f];return e.buffer}),function(){Math.log2=Math.log2||function(a){return Math.log(a)/Math.LN2}}(),"undefined"!=typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);var launchFullscreen=av.launchFullscreen=function(a,b){a.requestFullscreen?a.requestFullscreen(b):a.mozRequestFullScreen?a.mozRequestFullScreen(b):a.webkitRequestFullscreen?a.webkitRequestFullscreen(b):a.msRequestFullscreen&&a.msRequestFullscreen(b)},exitFullscreen=av.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},inFullscreen=av.inFullscreen=function(){return"webkitIsFullScreen"in document?!!document.webkitIsFullScreen:"fullscreenElement"in document?!!document.fullscreenElement:"mozFullScreenElement"in document?!!document.mozFullScreenElement:"msFullscreenElement"in document?!!document.msFullscreenElement:!!document.querySelector(".viewer-fill-browser")},fullscreenElement=av.fullscreenElement=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},isFullscreenAvailable=av.isFullscreenAvailable=function(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen},getAndroidVersion=av.getAndroidVersion=function(a){a=a||navigator.userAgent;var b=a.match(/Android\s([0-9\.]*)/);return!!b&&b[1]},isTouchDevice=av.isTouchDevice=function(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)};av.isIOSDevice=function(){return!!isBrowser&&/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())},av.isAndroidDevice=function(){return!!isBrowser&&-1!==navigator.userAgent.toLowerCase().indexOf("android")},av.isMobileDevice=function(){return!!isBrowser&&(av.isIOSDevice()||av.isAndroidDevice())},av.isSafari=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("safari")&&-1===a.indexOf("chrome")},av.isFirefox=function(){return!!isBrowser&&-1!==navigator.userAgent.toLowerCase().indexOf("firefox")},av.isChrome=function(){return!!isBrowser&&-1!==navigator.userAgent.toLowerCase().indexOf("chrome")},av.isMac=function(){return!!isBrowser&&-1!==navigator.userAgent.toLowerCase().indexOf("mac os")},av.isWindows=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("win32")||-1!==a.indexOf("windows")},av.ObjectAssign=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},avp.disableTouchSafari=function(a){var b=window.hasOwnProperty("pageXOffset")?window.pageXOffset:document.documentElement.scrollLeft,c=window.hasOwnProperty("pageYOffset")?window.pageYOffset:document.documentElement.scrollTop,d=document.elementFromPoint(a.pageX-b,a.pageY-c);return!d||"CANVAS"!==d.nodeName||(!!d.getAttribute(!0)||(a.preventDefault(),!1))},avp.disableDocumentTouchSafari=function(){av.isMobileDevice()&&av.isSafari()&&(document.documentElement.addEventListener("touchstart",avp.disableTouchSafari,!0),document.documentElement.addEventListener("touchmove",avp.disableTouchSafari,!0),document.documentElement.addEventListener("touchcanceled",avp.disableTouchSafari,!0),document.documentElement.addEventListener("touchend",avp.disableTouchSafari,!0))},avp.enableDocumentTouchSafari=function(){av.isMobileDevice()&&av.isSafari()&&(document.documentElement.removeEventListener("touchstart",avp.disableTouchSafari,!0),document.documentElement.removeEventListener("touchmove",avp.disableTouchSafari,!0),document.documentElement.removeEventListener("touchcanceled",avp.disableTouchSafari,!0),document.documentElement.removeEventListener("touchend",avp.disableTouchSafari,!0))};var detectWebGL=av.detectWebGL=function(){if(window.WebGLRenderingContext){for(var a=document.createElement("canvas"),b=["webgl","experimental-webgl","moz-webgl","webkit-3d"],c=!1,d=0;d<4;d++)try{if(c=a.getContext(b[d]),(c=av.rescueFromPolymer(c))&&"function"==typeof c.getParameter)return 1}catch(a){}return 0}return-1},touchStartToClick=av.touchStartToClick=function(a){a.target.className.indexOf("fullscreen")>-1||a.target.className.indexOf("webvr")>-1||(a.preventDefault(),a.stopPropagation(),a.target.click())};!function(){var a=getGlobal();a.performance||(a.performance=Date)}(),Number.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},String.prototype.repeat=String.prototype.repeat||function(a){if(a<1)return"";for(var b="",c=this.valueOf();a>1;)1&a&&(b+=c),a>>=1,c+=c;return b+c},Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{enumerable:!1,value:function(a,b,c){b=void 0===b?0:b,c=void 0===c?this.length:c;for(var d=b;d<c;++d)this[d]=a}}),Int32Array.prototype.lastIndexOf=Int32Array.prototype.lastIndexOf||function(a,b){return Array.prototype.lastIndexOf.call(this,a,b)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{enumerable:!1,value:function(a,b){for(var c=this.length,d=0;d<c;++d){var e=this[d];if(a.call(b,e,d,this))return e}}});var av=Autodesk.Viewing,avp=Autodesk.Viewing.Private;if(avp.BUILD_LMV_WORKER_URL="lmvworker.min.js",avp.LMV_WORKER_URL=avp.BUILD_LMV_WORKER_URL,avp.ENABLE_DEBUG=avp.ENABLE_DEBUG||!1,avp.ENABLE_INLINE_WORKER=!0,function(){"use strict";function a(){this.adp=null,this.runtimeStats={},this.level=-1,this.setLevel(d.LogLevels.ERROR)}function b(){return"undefined"!=typeof window?encodeURI(window.location.href):""}var c=Autodesk.Viewing,d=Autodesk.Viewing.Private;d.LogLevels={DEBUG:5,LOG:4,INFO:3,WARNING:2,ERROR:1,NONE:0},a.prototype.initialize=function(a){if(a.eventCallback&&(this.callback=a.eventCallback),this.sessionId=a.sessionId,!this.sessionId){var e=Date.now()+"";this.sessionId=parseFloat((1e4*Math.random()|0)+""+e.substring(4))}var f=a.logLevel||a.loglevel;"number"==typeof f&&this.level!==f&&this.setLevel(f),this.environmentInfo={touch:c.isTouchDevice(),env:d.env,referer:b(),version:LMV_VIEWER_VERSION,patch:LMV_VIEWER_PATCH,build_type:LMV_BUILD_TYPE};var g={category:"viewer_start",touch:this.environmentInfo.touch,env:this.environmentInfo.env,referer:this.environmentInfo.referer,version:this.environmentInfo.version,patch:this.environmentInfo.patch,build_type:this.environmentInfo.build_type};this.track(g);var h=this;this.interval=setInterval(function(){h.reportRuntimeStats()},6e4)},a.prototype.shutdown=function(){clearInterval(this.interval),this.interval=void 0},a.prototype.track=function(a){if(this.updateRuntimeStats(a),!d.offline&&this.sessionId){a.timestamp=Date.now(),a.sessionId=this.sessionId;var b=this.logToADP(a);this.callback&&this.callback(a,{adp:b})}},a.prototype.logToADP=function(a){if(!this.adp)return!1;var c="",d="";switch(a.category){case"tool_changed":case"pref_changed":c="CLICK_OPERATION",d=a.category+"/"+a.name;break;case"screen_mode":c="CLICK_OPERATION",d="pref_changed/"+a.category;break;case"metadata_load_stats":c="DOCUMENT_START",d="stats",a.full_url=b();break;case"model_load_stats":c="DOCUMENT_FULL",d="stats";break;case"tool_used":c="BACKGROUND_CALL",d=a.category+"/"+a.name;break;case"settingOptionsStatus":c="BACKGROUND_CALL",d=a.category+"/"+a.list;break;case"node_selected":case"search_node":c="CLICK_OPERATION",d=a.category+"/"+a.name;break;case"loaded_extensions":c="BACKGROUND_CALL",d=a.category;case"error":c="BACKGROUND_CALL",d="error"}return!!c&&(this.adp.trackEvent(c,{operation:{id:a.sessionId,type:d,stage:"",status:"C",meta:a}}),!0)},a.prototype.updateRuntimeStats=function(a){if(a.hasOwnProperty("aggregate"))switch(a.aggregate){case"count":this.runtimeStats[a.name]>0?this.runtimeStats[a.name]++:this.runtimeStats[a.name]=1,this.runtimeStats._nonempty=!0;break;case"last":this.runtimeStats[a.name]=a.value,this.runtimeStats._nonempty=!0;break;default:this.warn("unknown log aggregate type")}},a.prototype.reportRuntimeStats=function(){this.runtimeStats._nonempty&&(delete this.runtimeStats._nonempty,this.adp&&this.adp.trackEvent("BACKGROUND_CALL",{operation:{id:this.sessionId,type:"stats",stage:"",status:"C",meta:this.runtimeStats}}),this.runtimeStats.category="misc_stats",this.track(this.runtimeStats),this.runtimeStats={})},a.prototype.setLevel=function(a){if(this.level!==a){this.level=a;var b=function(){},c=d.LogLevels,e=this,f=function(){if(e.callback){var a=Array.prototype.slice.call(arguments).join(" ");e.callback({category:"error",message:a},{adp:!1})}console.error.apply(console,arguments)};this.debug=a>=c.DEBUG?console.log.bind(console):b,this.log=a>=c.LOG?console.log.bind(console):b,this.info=a>=c.INFO?console.info.bind(console):b,this.warn=a>=c.WARNING?console.warn.bind(console):b,this.error=a>=c.ERROR?f:b}},Autodesk.Viewing.Private.logger=new a}(),function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(j(a,c),b)}function f(a,b,c){return!!Array.isArray(a)&&(g(a,c[b],c),!0)}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(b,c,d){var e="DEPRECATED METHOD: "+c+"\n"+d+" AT \n";return function(){var c=new Error("get-stack-trace"),d=c&&c.stack?c.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",f=a.console&&(a.console.warn||a.console.log);return f&&f.call(a.console,e,d),b.apply(this,arguments)}}function i(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&qa(d,c)}function j(a,b){return function(){return a.apply(b,arguments)}}function k(a,b){return typeof a==ma?a.apply(b?b[0]||d:d,b):a}function l(a,b){return a===d?b:a}function m(a,b,c){g(q(b),function(b){a.addEventListener(b,c,!1)})}function n(a,b,c){g(q(b),function(b){a.removeEventListener(b,c,!1)})}function o(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function p(a,b){return a.indexOf(b)>-1}function q(a){return a.trim().split(/\s+/g)}function r(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];r(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function u(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ka.length;){if(c=ka[g],(e=c?c+f:b)in a)return e;g++}return d}function v(){return ta++}function w(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}function x(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){k(a.options.enable,[a])&&c.handler(b)},this.init()}function y(a){var b=a.options.inputClass;return new(b||(wa?M:xa?P:va?R:L))(a,z)}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&za&&d-e==0,g=b&(Ba|Ca)&&d-e==0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,A(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function A(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),e>1&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=pa(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),B(c,b),b.offsetDirection=G(b.deltaX,b.deltaY);var j=F(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=j.x,b.overallVelocityY=j.y,b.overallVelocity=oa(j.x)>oa(j.y)?j.x:j.y,b.scale=g?K(g.pointers,d):1,b.rotation=g?J(g.pointers,d):0,b.maxPointers=c.prevInput?b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers:b.pointers.length,C(c,b);var k=a.element;o(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}function B(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};b.eventType!==za&&f.eventType!==Ba||(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ca&&(i>ya||h.velocity===d)){var j=b.deltaX-h.deltaX,k=b.deltaY-h.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=oa(l.x)>oa(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function D(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:na(a.pointers[c].clientX),clientY:na(a.pointers[c].clientY)},c++;return{timeStamp:pa(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var b=a.length;if(1===b)return{x:na(a[0].clientX),y:na(a[0].clientY)};for(var c=0,d=0,e=0;e<b;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:na(c/b),y:na(d/b)}}function F(a,b,c){return{x:b/a||0,y:c/a||0}}function G(a,b){return a===b?Da:oa(a)>=oa(b)?a<0?Ea:Fa:b<0?Ga:Ha}function H(a,b,c){c||(c=La);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function I(a,b,c){c||(c=La);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function J(a,b){return I(b[1],b[0],Ma)-I(a[1],a[0],Ma)}function K(a,b){return H(b[0],b[1],Ma)/H(a[0],a[1],Ma)}function L(){this.evEl=Oa,this.evWin=Pa,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Sa,this.evWin=Ta,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=Va,this.evWin=Wa,this.started=!1,x.apply(this,arguments)}function O(a,b){var c=s(a.touches),d=s(a.changedTouches);return b&(Ba|Ca)&&(c=t(c.concat(d),"identifier",!0)),[c,d]}function P(){this.evTarget=Ya,this.targetIds={},x.apply(this,arguments)}function Q(a,b){var c=s(a.touches),d=this.targetIds;if(b&(za|Aa)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=s(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return o(a.target,i)}),b===za)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ba|Ca)&&delete d[g[e].identifier],e++;return h.length?[t(f.concat(h),"identifier",!0),h]:void 0}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function S(a,b){a&za?(this.primaryTouch=b.changedPointers[0].identifier,T.call(this,b)):a&(Ba|Ca)&&T.call(this,b)}function T(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches,e=function(){var a=d.indexOf(c);a>-1&&d.splice(a,1)};setTimeout(e,Za)}}function U(a){for(var b=a.srcEvent.clientX,c=a.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d],f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(f<=$a&&g<=$a)return!0}return!1}function V(a,b){this.manager=a,this.set(b)}function W(a){if(p(a,db))return db;var b=p(a,eb),c=p(a,fb);return b&&c?db:b||c?b?eb:fb:p(a,cb)?cb:bb}function X(a){this.options=qa({},this.defaults,a||{}),this.id=v(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=hb,this.simultaneous={},this.requireFail=[]}function Y(a){return a&mb?"cancel":a&kb?"end":a&jb?"move":a&ib?"start":""}function Z(a){return a==Ha?"down":a==Ga?"up":a==Ea?"left":a==Fa?"right":""}function $(a,b){var c=b.manager;return c?c.get(a):a}function _(){X.apply(this,arguments)}function aa(){_.apply(this,arguments),this.pX=null,this.pY=null}function ba(){_.apply(this,arguments)}function ca(){X.apply(this,arguments),this._timer=null,this._input=null}function da(){_.apply(this,arguments)}function ea(){_.apply(this,arguments)}function fa(){X.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ga(a,b){return b=b||{},b.recognizers=l(b.recognizers,ga.defaults.preset),new ha(a,b)}function ha(a,b){this.options=qa({},ga.defaults,b||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=y(this),this.touchAction=new V(this,this.options.touchAction),ia(this,!0),g(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ia(a,b){var c=a.element;if(c.style){var d;g(a.options.cssProps,function(e,f){d=u(c.style,f),b?(a.oldCssProps[d]=c.style[d],c.style[d]=e):c.style[d]=a.oldCssProps[d]||""}),b||(a.oldCssProps={})}}function ja(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ka=["","webkit","Moz","MS","ms","o"],la=b.createElement("div"),ma="function",na=Math.round,oa=Math.abs,pa=Date.now,qa=function(a){if(a===d||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var e=arguments[c];if(e!==d&&null!==e)for(var f in e)e.hasOwnProperty(f)&&(b[f]=Array.isArray(e[f])?e[f].slice(0):e[f])}return b},ra=h(function(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a},"extend","Use `assign`."),sa=h(function(a,b){return ra(a,b,!0)},"merge","Use `assign`."),ta=1,ua=/mobile|tablet|ip(ad|hone|od)|android/i,va="ontouchstart"in a,wa=u(a,"PointerEvent")!==d,xa=va&&ua.test(navigator.userAgent),ya=25,za=1,Aa=2,Ba=4,Ca=8,Da=1,Ea=2,Fa=4,Ga=8,Ha=16,Ia=Ea|Fa,Ja=Ga|Ha,Ka=Ia|Ja,La=["x","y"],Ma=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var Na={mousedown:za,mousemove:Aa,mouseup:Ba},Oa="mousedown",Pa="mousemove mouseup";i(L,x,{handler:function(a){var b=Na[a.type];b&za&&0===a.button&&(this.pressed=!0),b&Aa&&1!==a.which&&(b=Ba),this.pressed&&(b&Ba&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:"mouse",srcEvent:a}))}});var Qa={pointerdown:za,pointermove:Aa,pointerup:Ba,pointercancel:Ca,pointerout:Ca},Ra={2:"touch",3:"pen",4:"mouse",5:"kinect"},Sa="pointerdown",Ta="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Sa="MSPointerDown",Ta="MSPointerMove MSPointerUp MSPointerCancel"),i(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Qa[d],f=Ra[a.pointerType]||a.pointerType,g="touch"===f,h="mouse"===f,i=r(b,a.pointerId,"pointerId");e&za&&(0===a.button||g)?i<0&&(b.push(a),i=b.length-1):e&(Ba|Ca)&&(c=!0),i<0||(b[i]=a,h||this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(i,1))}});var Ua={touchstart:za,touchmove:Aa,touchend:Ba,touchcancel:Ca},Va="touchstart",Wa="touchstart touchmove touchend touchcancel";i(N,x,{handler:function(a){var b=Ua[a.type];if(b===za&&(this.started=!0),this.started){var c=O.call(this,a,b);b&(Ba|Ca)&&c[0].length-c[1].length==0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}}});var Xa={touchstart:za,touchmove:Aa,touchend:Ba,touchcancel:Ca},Ya="touchstart touchmove touchend touchcancel";i(P,x,{handler:function(a){var b=Xa[a.type],c=Q.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}});var Za=2500,$a=25;i(R,x,{handler:function(a,b,c){var d="touch"==c.pointerType,e="mouse"==c.pointerType;if(!(e&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(d)S.call(this,b,c);else if(e&&U.call(this,c))return;this.callback(a,b,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _a=u(la.style,"touchAction"),ab=_a!==d,bb="auto",cb="manipulation",db="none",eb="pan-x",fb="pan-y",gb=function(){if(!ab)return!1;var b={},c=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(d){b[d]=!c||a.CSS.supports("touch-action",d)}),b}();V.prototype={set:function(a){"compute"==a&&(a=this.compute()),ab&&this.manager.element.style&&gb[a]&&(this.manager.element.style[_a]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){k(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),W(a.join(" "))},preventDefaults:function(a){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=p(d,db)&&!gb[db],f=p(d,fb)&&!gb[fb],g=p(d,eb)&&!gb[eb];if(e){var h=1===a.pointers.length,i=a.distance<2,j=a.deltaTime<250;if(h&&i&&j)return}return g&&f?void 0:e||f&&c&Ia||g&&c&Ja?this.preventSrc(b):void 0},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var hb=1,ib=2,jb=4,kb=8,lb=kb,mb=16;X.prototype={defaults:{},set:function(a){return qa(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=$(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=$(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=$(a,this),-1===r(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=$(a,this);var b=r(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(b,a)}var c=this,d=this.state;d<kb&&b(c.options.event+Y(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),d>=kb&&b(c.options.event+Y(d))},tryEmit:function(a){if(this.canEmit())return this.emit(a);this.state=32},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(32|hb)))return!1;a++}return!0},recognize:function(a){var b=qa({},a);if(!k(this.options.enable,[this,b]))return this.reset(),void(this.state=32);this.state&(lb|mb|32)&&(this.state=hb),this.state=this.process(b),this.state&(ib|jb|kb|mb)&&this.tryEmit(b)},process:function(a){},getTouchAction:function(){},reset:function(){}},i(_,X,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(ib|jb),e=this.attrTest(a);return d&&(c&Ca||!e)?b|mb:d||e?c&Ba?b|kb:b&ib?b|jb:ib:32}}),i(aa,_,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ka},getTouchAction:function(){var a=this.options.direction,b=[];return a&Ia&&b.push(fb),a&Ja&&b.push(eb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Ia?(e=0===f?Da:f<0?Ea:Fa,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Da:g<0?Ga:Ha,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return _.prototype.attrTest.call(this,a)&&(this.state&ib||!(this.state&ib)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=Z(a.direction);b&&(a.additionalEvent=this.options.event+b),this._super.emit.call(this,a)}}),i(ba,_,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[db]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&ib)},emit:function(a){if(1!==a.scale){var b=a.scale<1?"in":"out";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}}),i(ca,X,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[bb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ba|Ca)&&!f)this.reset();else if(a.eventType&za)this.reset(),this._timer=e(function(){this.state=lb,this.tryEmit()},b.time,this);else if(a.eventType&Ba)return lb;return 32},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===lb&&(a&&a.eventType&Ba?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=pa(),this.manager.emit(this.options.event,this._input)))}}),i(da,_,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[db]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&ib)}}),i(ea,_,{defaults:{event:"swipe",threshold:10,velocity:.3,
direction:Ia|Ja,pointers:1},getTouchAction:function(){return aa.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Ia|Ja)?b=a.overallVelocity:c&Ia?b=a.overallVelocityX:c&Ja&&(b=a.overallVelocityY),this._super.attrTest.call(this,a)&&c&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&oa(b)>this.options.velocity&&a.eventType&Ba},emit:function(a){var b=Z(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),i(fa,X,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[cb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&za&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ba)return this.failTimeout();var g=!this.pTime||a.timeStamp-this.pTime<b.interval,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;if(0===this.count%b.taps)return this.hasRequireFailures()?(this._timer=e(function(){this.state=lb,this.tryEmit()},b.interval,this),ib):lb}return 32},failTimeout:function(){return this._timer=e(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==lb&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ga.VERSION="2.0.8",ga.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[da,{enable:!1}],[ba,{enable:!1},["rotate"]],[ea,{direction:Ia}],[aa,{direction:Ia},["swipe"]],[fa],[fa,{event:"doubletap",taps:2},["tap"]],[ca]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ha.prototype={set:function(a){return qa(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?2:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&lb)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],2===b.stopped||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(ib|jb|kb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof X)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;if(a=this.get(a)){var b=this.recognizers,c=r(b,a);-1!==c&&(b.splice(c,1),this.touchAction.update())}return this},on:function(a,b){if(a!==d&&b!==d){var c=this.handlers;return g(q(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this}},off:function(a,b){if(a!==d){var c=this.handlers;return g(q(a),function(a){b?c[a]&&c[a].splice(r(c[a],b),1):delete c[a]}),this}},emit:function(a,b){this.options.domEvents&&ja(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()},b.stopPropagation=function(){b.srcEvent.stopPropagation()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ia(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},qa(ga,{INPUT_START:za,INPUT_MOVE:Aa,INPUT_END:Ba,INPUT_CANCEL:Ca,STATE_POSSIBLE:hb,STATE_BEGAN:ib,STATE_CHANGED:jb,STATE_ENDED:kb,STATE_RECOGNIZED:lb,STATE_CANCELLED:mb,STATE_FAILED:32,DIRECTION_NONE:Da,DIRECTION_LEFT:Ea,DIRECTION_RIGHT:Fa,DIRECTION_UP:Ga,DIRECTION_DOWN:Ha,DIRECTION_HORIZONTAL:Ia,DIRECTION_VERTICAL:Ja,DIRECTION_ALL:Ka,Manager:ha,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:X,AttrRecognizer:_,Tap:fa,Pan:aa,Swipe:ea,Pinch:ba,Rotate:da,Press:ca,on:m,off:n,each:g,merge:sa,extend:ra,assign:qa,inherit:i,bindFn:j,prefixed:u}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=ga,"function"==typeof define&&define.amd?define(function(){return ga}):"undefined"!=typeof module&&module.exports?module.exports=ga:a.Hammer=ga}(window,document),function(){"use strict";var a=Autodesk.Viewing;a.EventDispatcher=function(){},a.EventDispatcher.prototype={constructor:a.EventDispatcher,apply:function(b){b.addEventListener=a.EventDispatcher.prototype.addEventListener,b.hasEventListener=a.EventDispatcher.prototype.hasEventListener,b.removeEventListener=a.EventDispatcher.prototype.removeEventListener,b.clearListeners=a.EventDispatcher.prototype.clearListeners,b.fireEvent=a.EventDispatcher.prototype.fireEvent,b.dispatchEvent=a.EventDispatcher.prototype.fireEvent,b.debugEvents=a.EventDispatcher.prototype.debugEvents},addEventListener:function(a,b,c){a&&(void 0===this.listeners&&(this.listeners={}),void 0===this.listeners[a]&&(this.listeners[a]=[]),this.listeners[a].push({callbackFn:b,once:!!c&&!!c.once}))},hasEventListener:function(a,b){if(!a)return!1;if(void 0===this.listeners)return!1;var c=this.listeners[a];if(!c||0===c.length)return!1;for(var d=0,e=c.length;d<e;++d)if(c[d].callbackFn===b)return!0;return!1},removeEventListener:function(a,b){if(a){if(void 0===this.listeners)return void(this.listeners={});var c=this.listeners[a];if(c)for(var d=0,e=c.length;d<e;++d)if(c[d].callbackFn===b){c.splice(d,1);break}}},clearListeners:function(){this.listeners=null},dispatchEvent:function(a){if(void 0===this.listeners)return void(this.listeners={});if("string"==typeof a&&(a={type:a}),!a.target)try{a.target=this}catch(a){}if(!a.type)throw new Error("event type unknown.");if(this._doDebug&&console.log("Event: "+a.type),Array.isArray(this.listeners[a.type])){for(var b=this.listeners[a.type].slice(),c=[],d=0,e=b.length;d<e;++d)b[d].callbackFn.call(this,a),b[d].once&&c.push(b[d].callbackFn);for(var f=0;f<c.length;++f)this.removeEventListener(a.type,c[f])}},debugEvents:function(a){this._doDebug=a}},a.EventDispatcher.prototype.fireEvent=a.EventDispatcher.prototype.dispatchEvent}(),function(){"use strict";function a(){}var b=Autodesk.Viewing.Private,c=function(){if("undefined"==typeof window)return!1;try{var a="lmv_viewer_test_localStorage",b=window.localStorage;return!!b&&(b.setItem(a,"1"),b.removeItem(a),!0)}catch(a){return!1}}();a.prototype.getItem=function(a){return c?window.localStorage.getItem(a):null},a.prototype.setItem=function(a,d){if(c)try{window.localStorage.setItem(a,d)}catch(a){b.logger.debug("avp.LocalStorage: Failed to setItem()")}},a.prototype.removeItem=function(a){c&&window.localStorage.removeItem(a)},a.prototype.isSupported=function(){return c},Autodesk.Viewing.Private.LocalStorage=new a}(),Autodesk.Viewing.FileLoader=function(a){this.viewer=a},Autodesk.Viewing.FileLoader.prototype.constructor=Autodesk.Viewing.FileLoader,Autodesk.Viewing.FileLoader.prototype.loadFile=function(a,b,c,d){return!1},Autodesk.Viewing.FileLoader.prototype.is3d=function(){return!1},function(){"use strict";var a=function(){function a(a,b,c){return!e[a]&&(e[a]={loader:c,extensions:b},!0)}function b(a){return e[a]?e[a].loader:null}function c(a){return!!e[a]&&(delete e[a],!0)}function d(a){a=a?a.toLowerCase():"";for(var b in e){var c=e[b];if(c)for(var d=0;d<c.extensions.length;d++)if(c.extensions[d].toLowerCase()===a)return c.loader}return null}var e={};return{registerFileLoader:a,getFileLoader:b,getFileLoaderForExtension:d,unregisterFileLoader:c}};Autodesk.Viewing.FileLoaderManager=new a}(),function(){"use strict";function a(a){for(var b=0;b<f.length;++b)document.addEventListener(f[b],a,!1)}function b(a){for(var b=0;b<f.length;++b)document.removeEventListener(f[b],a,!1)}function c(b){this.viewer=b,this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this),this.getMode()===d.ScreenMode.kFullScreen&&a(this.bindFullscreenEventListener)}var d=Autodesk.Viewing,e=d.Private,f=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"];d.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2},d.ScreenModeDelegate=c,c.prototype.uninitialize=function(){b(this.bindFullscreenEventListener),this.viewer=null},c.prototype.isModeSupported=function(a){return!0},c.prototype.setMode=function(a){var b=this.getMode();return!(a===b||!this.isModeSupported(a))&&(this.doScreenModeChange(b,a),this.onScreenModeChanged(b,a),!0)},c.prototype.getMode=function(){throw"Implement getMode() in derived class"},c.prototype.getNextMode=function(){var a,b=this.getMode(),c=d.ScreenMode;return b===c.kNormal&&this.isModeSupported(c.kFullBrowser)?a=c.kFullBrowser:b===c.kNormal&&this.isModeSupported(c.kFullScreen)?a=c.kFullScreen:b===c.kFullBrowser&&this.isModeSupported(c.kFullScreen)?a=c.kFullScreen:b===c.kFullBrowser&&this.isModeSupported(c.kNormal)?a=c.kNormal:b===c.kFullScreen&&this.isModeSupported(c.kNormal)?a=c.kNormal:b===c.kFullScreen&&this.isModeSupported(c.kFullBrowser)&&(a=c.kFullBrowser),a},c.prototype.getEscapeMode=function(){return this.getMode()!==d.ScreenMode.kNormal?d.ScreenMode.kNormal:void 0},c.prototype.fullscreenEventListener=function(){if(d.inFullscreen())this.viewer.resize();else{var a=d.ScreenMode;this.doScreenModeChange(a.kFullScreen,a.kNormal),this.onScreenModeChanged(a.kFullScreen,a.kNormal)}},c.prototype.doScreenModeChange=function(a,b){throw"Implement doScreenModeChange() in derived class"},c.prototype.onScreenModeChanged=function(c,e){c===d.ScreenMode.kFullScreen?b(this.bindFullscreenEventListener):e===d.ScreenMode.kFullScreen&&a(this.bindFullscreenEventListener),this.viewer.resize(),this.viewer.dispatchEvent({type:d.FULLSCREEN_MODE_EVENT,mode:e})},d.AppScreenModeDelegate=function(a){d.ScreenModeDelegate.call(this,a)},d.AppScreenModeDelegate.prototype=Object.create(d.ScreenModeDelegate.prototype),d.AppScreenModeDelegate.prototype.constructor=d.AppScreenModeDelegate,d.AppScreenModeDelegate.prototype.isModeSupported=function(a){return a!==d.ScreenMode.kFullBrowser},d.AppScreenModeDelegate.prototype.getMode=function(){return d.inFullscreen()?d.ScreenMode.kFullScreen:d.ScreenMode.kNormal},d.AppScreenModeDelegate.prototype.doScreenModeChange=function(a,b){var c=this.viewer.container;b===d.ScreenMode.kNormal?(c.classList.remove("viewer-fill-browser"),d.exitFullscreen()):b===d.ScreenMode.kFullScreen&&(c.classList.add("viewer-fill-browser"),d.launchFullscreen(c))},d.ApplicationScreenModeDelegate=d.AppScreenModeDelegate,d.NullScreenModeDelegate=function(a){d.ScreenModeDelegate.call(this,a)},d.NullScreenModeDelegate.prototype=Object.create(d.ScreenModeDelegate.prototype),d.NullScreenModeDelegate.prototype.constructor=d.ScreenModeDelegate,d.NullScreenModeDelegate.prototype.isModeSupported=function(a){return!1},d.NullScreenModeDelegate.prototype.getMode=function(){return d.ScreenMode.kNormal},d.ScreenModeMixin=function(){},d.ScreenModeMixin.prototype={setScreenModeDelegate:function(a){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this.screenModeDelegateClass=a||(null===a?d.NullScreenModeDelegate:d.AppScreenModeDelegate)},getScreenModeDelegate:function(){return this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this)),this.screenModeDelegate},isScreenModeSupported:function(a){return this.getScreenModeDelegate().isModeSupported(a)},canChangeScreenMode:function(){return this.isScreenModeSupported(Autodesk.Viewing.ScreenMode.kNormal)},setScreenMode:function(a){var b={category:"screen_mode",value:a};return e.logger.track(b),this.getScreenModeDelegate().setMode(a)},getScreenMode:function(){return this.getScreenModeDelegate().getMode()},nextScreenMode:function(){var a=this.getScreenModeDelegate().getNextMode();return void 0!==a&&this.setScreenMode(a)},escapeScreenMode:function(){var a=this.getScreenModeDelegate().getEscapeMode();return void 0!==a&&this.setScreenMode(a)},apply:function(a){var b=d.ScreenModeMixin.prototype;a.setScreenModeDelegate=b.setScreenModeDelegate,a.getScreenModeDelegate=b.getScreenModeDelegate,a.isScreenModeSupported=b.isScreenModeSupported,a.canChangeScreenMode=b.canChangeScreenMode,a.setScreenMode=b.setScreenMode,a.getScreenMode=b.getScreenMode,a.nextScreenMode=b.nextScreenMode,a.escapeScreenMode=b.escapeScreenMode}}}(),function(){"use strict";var a=Autodesk.Viewing,b=a.Private,c={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in"};a.ModelUnits=c;var d=function(a){WGS.RenderModel.call(this,a),this.topology=null,this.topologyPromise=null,this.svfUUID=null,this.defaultCameraHash=null;var c="Autodesk.Viewing.Private.HomeViewPFs.";this.is3d=function(){return!this.is2d()},this.getFastLoadList=function(){if(this.svfUUID||!b.LocalStorage.isSupported())return JSON.parse(b.LocalStorage.getItem(c+this.svfUUID))},this.setFastLoadList=function(a,d){if(b.LocalStorage.isSupported()&&!b.LocalStorage.getItem(c+this.svfUUID)){var e=this.getDefaultCamera();d.position.x+d.position.z==e.position.x+e.position.z&&b.LocalStorage.setItem(c+this.svfUUID,JSON.stringify(a))}}};a.EventDispatcher.prototype.apply(d.prototype),d.prototype.constructor=d,d.prototype.setUUID=function(a){this.svfUUID=btoa(WGS.pathToURL(a))},d.prototype.getDocumentNode=function(){var a=this.getData();return a.loadOptions?a.loadOptions.bubbleNode||null:null},d.prototype.getRoot=function(){var a=this.getData();return a&&a.instanceTree?a.instanceTree.root:null},d.prototype.getRootId=function(){var a=this.getData();if(a){if(a.instanceTree)return a.instanceTree.getRootId();if(a.fragmentMap)return a.fragmentMap.getRootId()}return 0},d.prototype.getUnitData=function(a){var b={unitString:null,unitScale:1};switch(a){case"meter":case"meters":case"m":return b.unitString=c.METER,b.unitScale=1,b;case"foot":case"feet":case"ft":return b.unitString=c.FOOT,b.unitScale=.3048,b;case"feet and inches":case"inch":case"inches":case"in":return b.unitString=c.INCH,b.unitScale=.0254,b;case"centimeter":case"centimeters":case"cm":return b.unitString=c.CENTIMETER,b.unitScale=.01,b;case"millimeter":case"millimeters":case"mm":return b.unitString=c.MILLIMETER,b.unitScale=.001,b;default:return b}},d.prototype.getUnitScale=function(){var a;if(this.is2d())a=this.getMetadata("page_dimensions","page_units",null);else{var b=this.getData();a=b&&b.overriddenUnits?b.overriddenUnits:b&&b.scalingUnit?b.scalingUnit:this.getMetadata("distance unit","value",null)}return a&&(a=a.toLowerCase()),this.getUnitData(a).unitScale},d.prototype.getUnitString=function(){var a;if(this.is2d())a=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var b=this.getData();a=b&&b.overriddenUnits?b.overriddenUnits:b&&b.scalingUnit?b.scalingUnit:this.getMetadata("distance unit","value",null)}return a&&(a=a.toLowerCase()),this.getUnitData(a).unitString},d.prototype.getDisplayUnit=function(){var a;if(this.is2d())a=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var b=this.getData();a=b&&b.scalingUnit?b.scalingUnit:this.getMetadata("distance unit","value",null)}return a&&(a=a.toLowerCase()),this.getUnitData(a).unitString},d.prototype.getMetadata=function(a,b,c){var d=this.getData();if(d){var e=d.metadata;if(e){var f=e[a];if(void 0!==f){if(!b)return f;var g=f[b];if(void 0!==g)return g}}}return c},d.prototype.getDefaultCamera=function(){var a=this.getData();if(!a)return null;var b=null,c=a.cameras?a.cameras.length:0;if(0<c){var d=this.getMetadata("default camera","index",null);if(null!==d&&a.cameras[d])b=a.cameras[d];else{for(var e=0;e<c;e++){var f=a.cameras[e];if(f.isPerspective){b=f;break}}b||(b=a.cameras[0])}}return b},d.prototype.isAEC=function(){return!!this.getData().loadOptions.isAEC},d.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)},d.prototype.geomPolyCount=function(){var a=this.getGeometryList();return a?a.geomPolyCount:null},d.prototype.instancePolyCount=function(){var a=this.getGeometryList();return a?a.instancePolyCount:null},d.prototype.isLoadDone=function(){var a=this.getData();return!(!a||!a.loadDone)},d.prototype.isObjectTreeCreated=function(){return!!this.getData().instanceTree},d.prototype.getPropertyDb=function(){var a=this.getData();return a&&a.propDbLoader},d.prototype.getProperties=function(a,b,c){var d=this.getPropertyDb();if(!d||a<=0)return void(c&&c());d.getProperties(a,b,c)},d.prototype.getBulkProperties=function(a,b,c,d){Array.isArray(b)&&(b={propFilter:b}),b=b||{};var e=b.propFilter||null,f=b.ignoreHidden||!1,g=this.getPropertyDb();if(!g)return void(d&&d());g.getBulkProperties(a,e,c,d,f)},d.prototype.getExternalIdMapping=function(a,b){var c=this.getPropertyDb();if(!c)return void(b&&b());c.getExternalIdMapping(a,b)},d.prototype.getLayerToNodeIdMapping=function(a,b){var c=this.getPropertyDb();if(!c)return void(b&&b());c.getLayerToNodeIdMapping(a,b)},d.prototype.getObjectTree=function(a,b){var c=this.getPropertyDb();if(!c)return void(b&&b());c.getObjectTree(a,b)},d.prototype.isObjectTreeLoaded=function(){var a=this.getPropertyDb();return!!a&&a.isObjectTreeLoaded()},d.prototype.search=function(a,b,c,d,e){var f=this.getPropertyDb();if(!f)return void(c&&c());f.searchProperties(a,d,b,c,e)},d.prototype.findProperty=function(a){var b=this.getPropertyDb();return b?b.findProperty(a):Promise.reject("Model doesn't have any properties.")};var e=function(a){var b=a;if(Math.abs(b[0])<.001)if(Math.abs(b[4])>.001)for(var c=0;c<4;c++){var d=b[c];b[c]=b[c+4],b[c+4]=d}else for(var c=0;c<4;c++){var d=b[c];b[c]=b[c+8],b[c+8]=d}if(Math.abs(b[5])<.001)for(var c=4;c<8;c++){var d=b[c];b[c]=b[c+4],b[c+4]=d}},f=function(a,b,c,d){var e,f,g,h,i,j,k=!1;g=d[c[c.length-1]].x,h=d[c[c.length-1]].y,e=h>=b;for(var l=0,m=c.length;l<m;++l)i=d[c[l]].x,j=d[c[l]].y,f=j>=b,e!=f&&(j-b)*(g-i)>=(i-a)*(h-j)==f&&(k=!k),e=f,g=i,h=j;return k};d.prototype.pointInPolygon=function(a,b,c,d){for(var e=!1,g=0;g<c.length;g++)f(a,b,c[g],d)&&(e=!e);return e},d.prototype.getPageToModelTransform=function(a){var b=this.getData();if(b.pageToModelTransform)return b.pageToModelTransform;var c=b,d=c.metadata,f=d.page_dimensions,g=c.viewports[a];if(!g)return new THREE.Matrix4;c.viewportTransforms||(c.viewportTransforms=new Array(c.viewports.length));var h=c.viewportTransforms[a];if(h)return h;var i=new WGS.LmvMatrix4(!0).set(f.logical_width/f.page_width,0,0,f.logical_offset_x,0,f.logical_height/f.page_height,0,f.logical_offset_y,0,0,1,0,0,0,0,1),j=g.transform.slice();e(j);var k=new WGS.LmvMatrix4(!0);k.elements.set(j);var l=new WGS.LmvMatrix4(!0);return l.getInverse(k),l.multiply(i),c.viewportTransforms[a]=l,l},d.prototype.pageToModel=function(a,b,c){function d(a){if(a){var b=(new THREE.Vector3).set(a.x,a.y,0).applyMatrix4(e);a.x=b.x,a.y=b.y}}var e=this.getPageToModelTransform(c);d(a),d(b)},d.prototype.pointInClip=function(a,b){for(var c=this.getData().clips,d=[],e=1;e<c.length;e++)if(e!==b){for(var f=[],g=[],h=c[e].contourCounts,i=c[e].points,j=0,k=[],l=0;l<h.length;l++){for(var m=0;m<h[l];m++)f.push(j),j++;g.push(f),f=[]}for(var l=0;l<i.length;l+=2){var n={x:i[l],y:i[l+1]};k.push(n)}var o=this.pointInPolygon(a.x,a.y,g,k);o&&d.push(e)}return d},d.prototype.getClip=function(a){for(var b=this.getData().clips,c=[],d=[],e=b[a].contourCounts,f=b[a].points,g=0,h=[],i=0;i<e.length;i++){for(var j=0;j<e[i];j++)c.push(g),g++;d.push(c),c=[]}for(var i=0;i<f.length;i+=2){var k={x:f[i],y:f[i+1]};h.push(k)}return{contours:d,points:h}},d.prototype.getTopoIndex=function(a){var b=this.getData();if(b&&b.fragments){var c=b.fragments.topoIndexes;if(c)return c[a]}},d.prototype.getTopology=function(a){return this.topology?this.topology[a]:null},d.prototype.hasTopology=function(){return!!this.topology},d.prototype.fetchTopology=function(b){if(this.topology)return Promise.resolve(this.topology);var c=this.getData();if(!c.topologyPath)return Promise.reject({error:"no-topology"});var d=b||(a.isMobileDevice()?20:100);if(c.topologySizeMB>d)return Promise.reject({error:"topology-too-big",limitMB:d,topologyMB:c.topologySizeMB});if(!this.topologyPromise){var e=this;this.topologyPromise=new Promise(function(a,b){e.loader.fetchTopologyFile(e.getData().topologyPath,function(c){c&&c.topology?(e.topology=c.topology,a(c.topology)):b(c)})})}return this.topologyPromise},d.prototype.hasGeometry=function(){var a=this.getData();return!!a&&(!!a.isLeaflet||a.fragments.length>0)},a.Model=d}(),function(){"use strict";function a(a){this.viewer=a,this.matman=a.matman(),this.model=null,this.root=null,this.initialized=!1,this.layerToIndex={},this.indexToLayer=[null],this.nodeToLayer=[]}function b(a){var b=a.getData(),c=j;return b&&b.layersRoot&&(c=b.layersRoot),Promise.resolve(c)}function c(a){var b=a.getPropertyDb();return b?b.findLayers():Promise.resolve(j)}function d(a,b){var c=a.model,d=a.indexToLayer;if(c.is2d()){var f=[];for(var g in a.layerToIndex)f.push(a.layerToIndex[g]);a.matman.setLayerVisible(f,b),a.viewer.invalidate(!0)}else{var h=[],j=b?a.viewer.visibilityManager.show:a.viewer.visibilityManager.hide;e(a,function(a,e){d[e].visible!==b&&(h.push(a),h.length===i&&(j(h,c),h.length=0))}),h.length>0&&j(h,c)}for(var k=d.length,l=1;l<k;++l){var m=d[l];m&&(m.visible=b)}}function e(a,b){var c=a.nodeToLayer,d=(c.length,a.model.getData().instanceTree.nodeAccess);for(var e in d.dbIdToIndex){var f=d.dbIdToIndex[e],g=c[f]||0;0!==g&&b(0|e,g)}}function f(a,b){return"number"==typeof b?b:a.layerToIndex[b.name||b]||0}var g=Autodesk.Viewing,h=g.Private,i=1024,j={name:"root",id:"root",isLayer:!1,children:[],childCount:0},k=a.prototype;k.addModel=function(a){var d=function(b){var c=this.model.getData(),d=c.instanceTree;b.children=b.children||[],b.childCount=b.children.length,this.indexToLayer=new Array(b.childCount+1),this.indexToLayer[0]=null;for(var e=0;e<b.childCount;++e){var f=b.children[e],g=f.name,i=f.id,j=f.index;this.indexToLayer[j]={name:g,id:i,index:j,visible:!0},this.layerToIndex[g]=j}if(!this.model.is2d()&&0!==b.childCount){this.nodeToLayer=b.childCount<=256?new Uint8Array(d.nodeAccess.getNumNodes()):new Uint16Array(d.nodeAccess.getNumNodes());var k=function(a){if(this.model){var b=this.model.getData(),c=b.instanceTree;for(var d in a)if(a.hasOwnProperty(d))for(var e=this.layerToIndex[d],f=a[d],g=0,h=f.length;g<h;++g){var i=c.nodeAccess.getIndex(f[g]);this.nodeToLayer[i]=e}}}.bind(this),l=function(){h.logger.warn("ModelLayers error: coudn't get layers from property database.")}.bind(this);a.getLayerToNodeIdMapping(k,l)}}.bind(this),e=function(b){this.root=b,this.initialized=!0,this.activateLayerState("Initial"),this.viewer.api.dispatchEvent({type:g.MODEL_LAYERS_LOADED_EVENT,model:a,root:b})}.bind(this);this.model=a,(a.is2d()?b(a):c(a)).then(function(a){d(a),e(a)}).catch(function(a){h.logger.warn(a),e(j)})},k.removeModel=function(a){this.model===a&&(this.model=null,this.root=null,this.initialized=!1,this.layerToIndex={},this.indexToLayer=[null],this.nodeToLayer=[])},k.getRoot=function(){return this.initialized||h.logger.warn("Autodesk.Viewing.ModelLayers.getRoot couldn't peform action, layers are still being loaded"),this.root},k.showAllLayers=function(){d(this,!0)},k.hideAllLayers=function(){d(this,!1)},k.isLayerVisible=function(a){return this.initialized?(a=f(this,a),this.indexToLayer[a]&&this.indexToLayer[a].visible):(h.logger.warn("Autodesk.Viewing.ModelLayers.isLayerVisible couldn't peform action, layers are still being loaded"),!1)},k.setLayerVisible=function(a,b){if(!this.initialized)return void h.logger.warn("Autodesk.Viewing.ModelLayers.setLayersVisible couldn't peform action, layers are still being loaded");var c=Array.isArray(a)?a:[a];c=a.map(function(a){return f(this,a)}.bind(this));var d=this.model,g=this.indexToLayer;if(d.is2d())this.matman.setLayerVisible(c,b),this.viewer.invalidate(!0);else{var j=g.map(function(a){return!(null!==a&&-1!==c.indexOf(a.index)&&a.visible!==b)}),k=[],l=b?this.viewer.visibilityManager.show:this.viewer.visibilityManager.hide;e(this,function(a,b){j[b]||(k.push(a),k.length===i&&(l(k,d),k.length=0))}),k.length>0&&l(k,d)}for(var m=c.length,n=0;n<m;++n){var o=this.indexToLayer[c[n]];o&&(o.visible=b)}},k.getVisibleLayerIndices=function(){if(!this.initialized)return h.logger.warn("Autodesk.Viewing.ModelLayers.getVisibleLayerIndices couldn't peform action, layers are still being loaded"),[];for(var a=(this.model,[]),b=this.indexToLayer,c=b.length,d=1;d<c;++d){var e=b[d];e&&e.visible&&a.push(e.index)}return a},k.activateLayerState=function(a){if(!this.initialized)return void h.logger.warn("Autodesk.Viewing.ModelLayers.activateLayerState couldn't peform action, layers are still being loaded");var b=this.model.getData().metadata,c=b?b.layer_states:null;if(!this.model.is3d()&&c&&a){var d;for(d=0;d<c.length&&c[d].name!==a;d++);if(d<c.length){var e=c[d],f=e.visible_layers,g={};if(f&&0<f.length)for(var i=0;i<f.length;i++)g[f[i]]=1;var j=[],k=[];for(var l in b.layers){var m=b.layers[l].name;l|=0,1===g[m]?j.push(l):k.push(l)}this.setLayerVisible(j,!0),this.setLayerVisible(k,!1)}}},k.getLayerStates=function(){if(!this.initialized)return h.logger.warn("Autodesk.Viewing.ModelLayers.getLayerStates couldn't peform action, layers are still being loaded"),null;var a=this.model,b=a?a.getData().metadata:null,c=b?b.layers:null,d=b?b.layer_states:null;if(this.model.is3d()||!c||!d)return null;var e,f={},g={};for(var i in c)if(c.hasOwnProperty(i)){var j=parseInt(i),k=c[i];e="string"==typeof k?k:k.name,f[e]=!0,this.isLayerVisible(j)&&(g[e]=!0)}for(var l=[],m=0;m<d.length;++m){var n=d[m],o=n.visible_layers,p={};if(!n.hidden){if(o&&0<o.length)for(var q=0;q<o.length;++q)e=o[q],f.hasOwnProperty(e)&&(p[e]=!0);l.push({name:n.name,description:n.description,active:function(a,b){var c=Object.getOwnPropertyNames(a),d=Object.getOwnPropertyNames(b);if(c.length!==d.length)return!1;for(var e=0;e<c.length;++e){var f=c[e];if(a[f]!==b[f])return!1}return!0}(g,p)})}}return 0<l.length?l:null},h.ModelLayers=a}(),"undefined"!=typeof window){var RTCPeerConnection=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null;if(navigator.mozGetUserMedia)webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]),RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,getUserMedia=navigator.mozGetUserMedia.bind(navigator),createIceServer=function(a,b,c){var d=null,e=a.split(":");if(0===e[0].indexOf("stun"))d={url:a};else if(0===e[0].indexOf("turn")&&(-1!==a.indexOf("transport=udp")||-1===a.indexOf("?transport"))){var f=a.split("?");d={url:f[0],credential:c,username:b}}return d},attachMediaStream=function(a,b){console.log("Attaching media stream"),a.mozSrcObject=b,a.play()},reattachMediaStream=function(a,b){console.log("Reattaching media stream"),a.mozSrcObject=b.mozSrcObject,a.play()},MediaStream.prototype.getVideoTracks=function(){return[]},MediaStream.prototype.getAudioTracks=function(){return[]};else if(navigator.webkitGetUserMedia){var match=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);webrtcDetectedBrowser="chrome",webrtcDetectedVersion=match?parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2]):40,createIceServer=function(a,b,c){var d=null,e=a.split(":");if(0===e[0].indexOf("stun"))d={url:a};else if(0===e[0].indexOf("turn"))if(webrtcDetectedVersion<28){var f=a.split("turn:");d={url:"turn:"+b+"@"+f[1],credential:c}}else d={url:a,credential:c,username:b};return d},RTCPeerConnection=webkitRTCPeerConnection,getUserMedia=navigator.webkitGetUserMedia.bind(navigator),attachMediaStream=function(a,b){void 0!==a.srcObject?a.srcObject=b:void 0!==a.mozSrcObject?a.mozSrcObject=b:void 0!==a.src?a.src=URL.createObjectURL(b):console.log("Error attaching stream to element.")},reattachMediaStream=function(a,b){a.src=b.src},webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks},webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks}),webkitRTCPeerConnection.prototype.getLocalStreams||(webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})}else console.log("Browser does not appear to be WebRTC-capable")}!function(){"use strict";function a(a,b){function e(){return c.config.userName&&c.config.userName.length?c.config.userName:p?p.slice(0,5):"Unknown"}function f(a){switch(a.type){case"txt":j(a);break;case"joinok":i(a);break;case"join_error":break;case"sessionId":c.logger.info("Connect successful, your id is: "+a.id),p=a.id;break;case"joined":a.userStatus="joined",g(a);break;case"left":a.userStatus="left",h(a);break;case"camera":case"pointer":break;default:c.logger.log(a)}var b=a.roomId,d={type:o[a.type],data:a,channelId:b};u.dispatchEvent(d)}function g(a){if(a.user.name&&a.user.name.length||(a.user.name=a.user.id.slice(0,5)),a.roomId){var b=t[a.roomId];b?(b.users.push(a.user),c.logger.info(a.user+" joined room "+a.roomId)):c.logger.warn("Channel "+a.roomId+" does not exist for socket "+p)}}function h(a){c.logger.info(a.user+" left room "+a.room);for(var b in t){for(var d=t[b].users,e=-1,f=0;f<d.length;f++)if(d[f].id==a.user){e=f;break}-1!=e&&d.splice(e,1),delete t[b].userSet[a.user]}}function i(a){var b=t[a.roomId];c.logger.info("joined channel "+a.roomId),a.users&&a.users.length?b.users=a.users:b.users=[];for(var d=0;d<b.users.length;d++)b.users[d].name&&b.users[d].name.length||(b.users[d].name=b.users[d].id.slice(0,5));var f=e(),g=Autodesk.Viewing.i18n.translate("you"),h={id:p,name:f+" ("+g+")",isSelf:!0,status:0};b.userSet[p]||(b.users.push(h),b.userSet[p]=h),0!=h.id.indexOf(f)&&u.sendChatMessage("/nick "+f,a.roomId)}function j(a){if(0==a.msg.indexOf("/nick ")){var b=u.getUserById(a.from,a.roomId),c=a.msg.slice(6);if(c.length&&(b.name=c,b.id==p)){var d=Autodesk.Viewing.i18n.translate("you");b.name+=" ("+d+")"}u.dispatchEvent({type:"userListChange",data:a,channelId:a.roomId})}}function k(a){r<q.length?(c.logger.info("Connect failed, trying another server..."),n.disconnect(),n=null,r++,u.connect(u.sessionID)):u.dispatchEvent({type:"socketError",data:a})}function l(a){u.dispatchEvent({type:"socketError",data:a})}function m(a){r=0;for(var b in s)u.join(b)}var n,o={camera:"cameraChange",pointer:"pointerMove",joystick:"joystick",state:"viewerState",txt:"chatReceived",joinok:"userListChange",sessionId:"connectSucceeded",joined:"userListChange",left:"userListChange",private:"privateMessage",join_error:"socketError"},p=null,q=Array.isArray(a)?a:[a],r=0,s={},t={},u=this;this.connect=function(a){if(!n)return void 0!==window.WebSocket&&(d||(d="undefined"!=typeof lmv_io?lmv_io:io),this.sessionID=a,n=d.connect(q[r]+"?sessionID="+a,{path:b,forceNew:!0}),n.on("connect",m),n.on("message",f),n.on("connect_error",k),n.on("error",l),!0)},this.join=function(a){if(!n||!n.connected)return void(s[a]=1);delete s[a],t[a]={id:a,users:[],userSet:{}},n.emit("join",{roomId:a,name:e()})},this.disconnect=function(){n&&(n.disconnect(),n=null,t={},p=null)},this.sendMessage=function(a,b,c){var d={type:a,from:p,msg:b,roomId:c};n.emit("message",d)},this.sendPrivateMessage=function(a,b){var c={type:"private",target:a,from:p,msg:b};n.emit("message",c)},this.sendChatMessage=function(a,b){var c={type:"txt",from:p,msg:a,roomId:b};n.emit("message",c),f(c)},this.getUserById=function(a,b){for(var c=t[b].users,d=0;d<c.length;d++)if(c[d].id==a)return c[d];return null},this.getLocalId=function(){return p},this.getChannelInfo=function(a){return t[a]},this.isConnected=function(){return n}}var b=Autodesk.Viewing,c=b.Private;c.config={userName:""},c.setUserName=function(a){c.config.userName=a};var d;a.prototype.constructor=a,
b.EventDispatcher.prototype.apply(a.prototype);var e={};a.GetInstance=function(a,b){a||(a=c.EnvironmentConfigurations[c.env].LMV.RTC),Array.isArray(a)||(a=[a]);var d=e[a[0]];return d||(d=new c.MessageClient(a,b),e[a[0]]=d,d)},Autodesk.Viewing.Private.MessageClient=a}(),AutodeskNamespace("Autodesk.Viewing.Private"),function(){var a=Autodesk.Viewing,b=a.Private;b.P2PClient=function(c){function d(c){try{l=new RTCPeerConnection(u),l.onicecandidate=function(a){a.candidate?r.sendPrivateMessage(m,{type:"candidate",label:a.candidate.sdpMLineIndex,id:a.candidate.sdpMid,candidate:a.candidate.candidate}):b.logger.log("End of candidates.")},l.ondatachannel=function(a){b.logger.log("Data channel added."),p=a.channel,p.onmessage=i,q.dispatchEvent({type:"dataChannelAdded",data:a.channel})},l.onaddstream=function(a){b.logger.log("Remote stream added."),o=a.stream,q.dispatchEvent({type:"remoteStreamAdded",data:a.stream})},l.onremovestream=function(a){b.logger.log("Remote stream removed. Event: ",a),o=null,q.dispatchEvent({type:"remoteStreamRemoved",data:a.stream})},c&&(p=l.createDataChannel("sendDataChannel",{reliable:!1,ordered:!1}),p.onmessage=i)}catch(c){return b.logger.error("Failed to create PeerConnection, exception: "+c.message,a.errorCodeString(a.ErrorCodes.NETWORK_FAILURE)),void alert("Cannot create RTCPeerConnection object.")}}function f(c){b.logger.error("createOffer() error: ",e,a.errorCodeString(a.ErrorCodes.UNKNOWN_FAILURE))}function g(a){if(l.setLocalDescription(a),r.sendPrivateMessage(m,a),t.length){for(var b=0;b<t.length;b++)l.addIceCandidate(t[b]);t=[]}}function h(a){for(var b=a.split("\n"),c=!1,d=!1,e=!1,f=0;f<b.length;f++)0==b[f].indexOf("a=mid:data")&&(c=!0),0==b[f].indexOf("a=mid:video")&&(e=!0),0==b[f].indexOf("a=mid:audio")&&(d=!0);return c&&!e&&!d}function i(a){var b=JSON.parse(a.data);switch(b.type){case"camera":q.dispatchEvent({type:"cameraChange",data:b});break;case"joystick":q.dispatchEvent({type:"joystick",data:b});break;case"state":q.dispatchEvent({type:"viewerState",data:b})}}function j(a){var c=a.data.msg;if(b.logger.debug("Client received message:"+JSON.stringify(c)),"offer"!=c.type||s)if("answer"===c.type&&s)l.setRemoteDescription(new RTCSessionDescription(c));else if("candidate"===c.type){var d=new RTCIceCandidate({sdpMLineIndex:c.label,candidate:c.candidate});s?l.addIceCandidate(d):t.push(d)}else"bye"===c&&s&&(q.dispatchEvent({type:"remoteHangup",data:null}),b.logger.info("Session terminated."),k());else b.logger.log("Received offer. Accepting."),q.receiveCall(a.data)}function k(){s=!1,l.close(),l=null,n=null,o=null,m=null}var l,m,n,o,p,q=this,r=c,s=!1,t=[],u={iceServers:[{url:"stun:stun.l.google.com:19302"}]},v={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},w={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};r.addEventListener("privateMessage",j),this.hangup=function(){b.logger.log("Hanging up."),s&&(r.sendPrivateMessage(m,"bye"),k())},this.initUserMedia=function(c){function d(a){b.logger.log("Adding local stream."),c&&c(a),q.dispatchEvent({type:"localStreamAdded",data:a})}function e(c){b.logger.error("getUserMedia error: ",c,a.errorCodeString(a.ErrorCodes.NETWORK_SERVER_ERROR))}var f={video:!0,audio:!0};window.getUserMedia(f,d,e),b.logger.log("Getting user media with constraints",f)},this.callUser=function(a,c){if(m)return void b.logger.warn("Already in a call. Ignoring call request.");m=a,b.logger.info("Calling user "+m),c?(d(!0),s=!0,b.logger.log("Sending data channel offer to peer"),l.createOffer(g,f)):this.initUserMedia(function(a){n=a,s||void 0===n||(d(!1),l.addStream(n),s=!0,b.logger.log("Sending audio/video offer to peer"),l.createOffer(g,f))})},this.receiveCall=function(a){(m=a.from)||(m=a.senderId),h(a.msg.sdp)?(d(!0),s=!0,l.setRemoteDescription(new RTCSessionDescription(a.msg)),b.logger.log("Sending data-only answer to peer."),l.createAnswer(g,null,w)):this.initUserMedia(function(c){n=c,s||void 0===n||(d(!1),l.addStream(n),s=!0),l.setRemoteDescription(new RTCSessionDescription(a.msg)),b.logger.log("Sending audio+video answer to peer."),l.createAnswer(g,null,v)})},this.getCurrentCallTarget=function(){return m},this.dataChannel=function(){return p}},b.P2PClient.prototype.constructor=b.P2PClient,Autodesk.Viewing.EventDispatcher.prototype.apply(b.P2PClient.prototype)}(),function(){var a=Autodesk.Viewing.Private;Autodesk.Viewing.Private.LiveReviewClient=function(a){this.viewer=a,this.messageClient=null,this.presenceChannelId=null,this.p2p=null,this.viewtx=null,this.interceptor=null},Autodesk.Viewing.Private.LiveReviewClient.prototype.destroy=function(){this.leaveLiveReviewSession()},Autodesk.Viewing.Private.LiveReviewClient.prototype.joinLiveReviewSession=function(b){this.messageClient||(this.messageClient=a.MessageClient.GetInstance()),this.presenceChannelId||(this.presenceChannelId=window.location.host),this.messageClient.isConnected()||this.messageClient.connect(b),this.viewtx||(this.viewtx=new a.ViewTransceiver(this.messageClient)),this.viewtx.channelId=b,this.viewtx.attach(this.viewer),this.p2p||(this.p2p=new a.P2PClient(this.messageClient)),this.messageClient.join(this.viewtx.channelId),this.interceptor||(this.interceptor=new a.InteractionInterceptor(this.viewtx)),this.viewer.toolController.registerTool(this.interceptor),this.viewer.toolController.activateTool(this.interceptor.getName())},Autodesk.Viewing.Private.LiveReviewClient.prototype.leaveLiveReviewSession=function(){this.p2p&&this.p2p.hangup(),this.viewtx&&this.viewtx.detach(this.viewer),this.messageClient&&this.messageClient.disconnect(),this.interceptor&&this.viewer.toolController.deactivateTool(this.interceptor.getName()),this.p2p=null,this.viewtx=null,this.messageClient=null,this.interceptor=null};var b=Autodesk.Viewing,a=b.Private;a.InteractionInterceptor=function(a){this.getNames=function(){return["intercept"]},this.getName=function(){return"intercept"},this.activate=function(a){},this.deactivate=function(a){},this.update=function(a){return!1},this.handleSingleClick=function(a,b){return!1},this.handleDoubleClick=function(a,b){return!1},this.handleSingleTap=function(a){return!1},this.handleDoubleTap=function(a,b){return!1},this.handleKeyDown=function(a,b){return!1},this.handleKeyUp=function(a,b){return!1},this.handleWheelInput=function(b){return a.takeControl(),!1},this.handleButtonDown=function(b,c){return a.takeControl(),!1},this.handleButtonUp=function(a,b){return!1},this.handleMouseMove=function(b){return a.updatePointer(b),!1},this.handleGesture=function(b){return a.takeControl(),!1},this.handleBlur=function(a){return!1},this.handleResize=function(){}},a.ViewTransceiver=function(c){function d(a){p=!0;var b=JSON.parse(a.data.msg);w.restoreState(b),o.impl.invalidate(!0,!1,!0),p=!1}function e(a){return Math.round(1e3*a)/1e3}function f(a){for(var b=0;b<a.length;b++)a[b]=e(a[b])}function g(a){var b=a.data.msg;!0===b[1]||r||(b[0]!=m&&(m=b[0],a.data.lastInControl=b[0],n.dispatchEvent({type:"controlChange",channelId:n.channelId,data:a.data})),q=!1,o.navigation.setView((new THREE.Vector3).set(b[2],b[3],b[4]),(new THREE.Vector3).set(b[5],b[6],b[7])),o.navigation.setCameraUpVector((new THREE.Vector3).set(b[8],b[9],b[10])))}function h(a){if(q||r){var b=a.camera,d=[b.position.x,b.position.y,b.position.z,b.target.x,b.target.y,b.target.z,b.up.x,b.up.y,b.up.z];f(d),d.unshift(r),d.unshift(c.getLocalId()),s.sendMessage("camera",d,n.channelId),m!=d[0]&&(m=d[0],n.dispatchEvent({type:"controlChange",channelId:n.channelId,data:{lastInControl:m}}))}}function i(a,b,c){a&&!u&&(u=document.createElement("div"),u.classList.add("collabPointer")),a&&!v?(o.container.appendChild(u),v=!0):!a&&v&&(o.container.removeChild(u),v=!1),a&&(u.style.left=b-6+"px",u.style.top=c-6+"px")}function j(a){if(!q&&!r){var b=a.data.msg;t.origin.set(b[1],b[2],b[3]),t.direction.set(b[4],b[5],b[6]);var c=t.at(o.getCamera().near);c.project(o.getCamera()),c=o.impl.viewportToClient(c.x,c.y),i(!0,c.x,c.y)}}function k(a){if(q){var b=o.impl.clientToViewport(a.canvasX,a.canvasY);o.impl.viewportToRay(b,t);var d=[t.origin.x,t.origin.y,t.origin.z,t.direction.x,t.direction.y,t.direction.z];f(d),d.unshift(c.getLocalId()),s.sendMessage("pointer",d,n.channelId)}}function l(a){if(!p){var b=w.getState(x);c.sendMessage("state",JSON.stringify(b),n.channelId)}}var m,n=this,o=this.viewer=null,p=!1,q=!1,r=!1,s=this.client=c,t=new THREE.Ray,u=null,v=!1;this.channelId=null;var w,x={seedURN:!1,objectSet:!0,viewport:!1,cutplanes:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}};this.takeControl=function(){q=!0,i(!1)},this.updatePointer=function(a){k(a)},this.connectCamera=function(a){r=!a},this.attach=function(c,e){o&&this.detach(),this.viewer=o=c,w=new a.ViewerState(o),s.addEventListener("cameraChange",g),s.addEventListener("pointerMove",j),o.hasEventListener(b.CAMERA_CHANGE_EVENT,h)||o.addEventListener(b.CAMERA_CHANGE_EVENT,h),e||(s.addEventListener("viewerState",d),o.hasEventListener(b.SELECTION_CHANGED_EVENT,l)||(o.addEventListener(b.SELECTION_CHANGED_EVENT,l),o.addEventListener(b.ISOLATE_EVENT,l),o.addEventListener(b.HIDE_EVENT,l),o.addEventListener(b.SHOW_EVENT,l),o.addEventListener(b.EXPLODE_CHANGE_EVENT,l),o.addEventListener(b.LAYER_VISIBILITY_CHANGED_EVENT,l),o.addEventListener(b.CUTPLANES_CHANGE_EVENT,l)))},this.detach=function(){i(!1),s&&(s.removeEventListener("cameraChange",g),s.removeEventListener("viewerState",d)),o&&(o.removeEventListener(b.CAMERA_CHANGE_EVENT,h),o.removeEventListener(b.SELECTION_CHANGED_EVENT,l),o.removeEventListener(b.ISOLATE_EVENT,l),o.removeEventListener(b.HIDE_EVENT,l),o.removeEventListener(b.SHOW_EVENT,l),o.removeEventListener(b.EXPLODE_CHANGE_EVENT,l),o.removeEventListener(b.LAYER_VISIBILITY_CHANGED_EVENT,l),o.removeEventListener(b.CUTPLANES_CHANGE_EVENT,l),this.viewer=o=null,w=null)}},a.ViewTransceiver.prototype.constructor=a.ViewTransceiver,Autodesk.Viewing.EventDispatcher.prototype.apply(a.ViewTransceiver.prototype)}();var avp=Autodesk.Viewing.Private;avp.Autocam=avp.Autocam||function(a,b,c){function d(b){u=!0,a.target.copy(r.center),a.pivot.copy(r.pivot),a.worldup?a.worldup.copy(r.sceneUpDirection):a.up.copy(r.sceneUpDirection),r.cameraChangedCallback(b),u=!1}function e(a,b){var c=a.clone();return Math.abs(c.clone().dot(b))<Number.MIN_VALUE?(c.normalize(),c):(c=f(a,b),c.length()<Number.MIN_VALUE&&(c=g(b)),c.normalize(),c)}function f(a,b){b.normalize();var c=a.clone().dot(b),d=b.clone().multiplyScalar(c);return d=a.clone().sub(d)}function g(a){for(var b=new THREE.Vector3(0,0,0),c=[new THREE.Vector3(0,1,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,1,1),new THREE.Vector3(1,0,1),new THREE.Vector3(1,1,0),new THREE.Vector3(1,1,1)],d=0;d<7;d++)if(Math.abs(c[d].dot(a))<Number.MIN_VALUE){b=c[d];break}return b}function h(a,b){var c=new THREE.Vector2(0,0);return c.x=a/window.innerWidth,c.y=b/window.innerHeight,c}function i(b){b.y=Math.abs(b.y-window.innerHeight);var c,d,e=a.position,f=r.center,g=f.clone().sub(e),h=a.up,i=g.clone().cross(h),j=g.clone().length(),k=j*Math.tan(THREE.Math.degToRad(a.leftFov)),l=j*Math.tan(THREE.Math.degToRad(a.rightFov)),m=j*Math.tan(THREE.Math.degToRad(a.topFov)),n=j*Math.tan(THREE.Math.degToRad(a.bottomFov)),o=k+l,p=m+n,q=b.x*o/window.innerWidth,s=q-k,t=b.y*p/window.innerHeight,u=t-n;return h=h.clone().normalize().clone().multiplyScalar(u),i=i.clone().normalize().clone().multiplyScalar(s),r.ortho?(c=e.clone().add(i).clone().add(h),d=g):(c=e,d=g.clone().add(h).clone().add(i)),{rayO:c,rayD:d}}function j(a,b,c){var d,e,f,g;d=e=f=g=0;var h=0,i=null,j=null,k=r.snapOrbitDeadZone,l=r.orbitMultiplier;return"h"==a?(d=r.snapOrbitThresholdH,e=r.snapOrbitAccelerationAX,f=r.snapOrbitAccelerationBX,g=1-r.snapOrbitAccelerationPointX,j=r.lockDeltaX,i=r.lockedX):(d=r.snapOrbitThresholdV,e=r.snapOrbitAccelerationAY,f=r.snapOrbitAccelerationBY,g=1-r.snapOrbitAccelerationPointY,j=r.lockDeltaY,i=r.lockedY),i?(j+=c,j<-k?(h=(j+k)*l*1/f,i=!1):j>k&&(h=(j-k)*l*1/f,i=!1)):(h=Math.abs(b)>d?c*l:Math.abs(b)>g*d?c*b>0?c*l*e:c*l*1/e:c*b>0?c*l*f:c*l*1/f)*b>0&&Math.abs(h)>Math.abs(b)&&(this.lockDeltaX=this.lockDeltaY=0,i=!0,h=b),h}function k(){return r.combined}function l(a,b){var c=!1,d=window.innerWidth,e=a.x%d,f=window.innerHeight,g=a.y%f,h=e>0?e-b.x:d+e-b.x,i=g>0?g-b.y:f+g-b.y;return Math.abs(h)<30&&Math.abs(i)<30&&(c=!0),c}function m(a,b,c){c.x=(a.x-b.x)/window.innerWidth,a.x=b.x+(a.x-b.x)%window.innerWidth,c.y=(a.y-b.y)/window.innerHeight,a.y=b.y+(a.y-b.y)%window.innerHeight}function n(a,b,c){if(!P||!a){if(a){var d=new THREE.Vector2,e=b.x,f=b.y;m(b,c,d),N=window.innerWidth*d.x,O=window.innerHeight*d.y,e<c.x?e-=60:e+=60,f<c.y?f-=60:f+=60}P=a}}function o(a,b,c){if(0===b)return 0;var d=a,e=r.saveEye.clone().sub(worldUp.clone().multiplyScalar(c+d)),f=r.saveEye.clone().sub(worldUp.clone().multiplyScalar(c)),g=0,h=(r.maxSceneBound-r.minSceneBound)/1e3;r.topLimit&&b>0?(g=r.maxSceneBound-h,r.topLimit=!1):r.bottomLimit&&b<0?(g=r.minSceneBound+h,r.bottomLimit=!1):g=e.dot(worldUp);var i=f.dot(worldUp);return g<r.minSceneBound?i<r.minSceneBound&&(r.bottomLimit=!0,d=0):g>r.maxSceneBound&&i>r.maxSceneBound&&(r.topLimit=!0,d=0),d}function p(a){var b=Math.pow(a,2);a<0&&(b=-b);var c=h(0,b),d=r.maxSceneBound-r.minSceneBound,e=.01*d;c.y*=e;var f=r.userHeightSpeed*c.y;return f=o(f,a,r.m_amount)}function q(a){var b=r.sceneFrontDirection.clone().cross(r.sceneUpDirection),c=Math.abs(Math.abs(a.dot(r.sceneUpDirection))-1),d=Math.abs(Math.abs(a.dot(r.sceneFrontDirection))-1),e=Math.abs(Math.abs(a.dot(b))-1);return c<1e-5||d<1e-5||e<1e-5}var r=this,s=null,t=null,u=!1;this.cube=null,this.camera=a,this.renderer="WEBGL",this.startState={},this.navApi=b,this.orthographicFaces=!1,this.canvas=c,this.cameraChangedCallback=function(){},this.pivotDisplayCallback=function(){},this.transitionCompletedCallback=function(){};var v,w=Date.now(),z=!1;this.dtor=function(){this.cube=null,this.cameraChangedCallback=null,this.pivotDisplayCallback=null,this.transitionCompletedCallback=null,this.canvas=null},this.registerCallbackCameraChanged=function(a){this.cameraChangedCallback=a},this.registerCallbackPivotDisplay=function(a){this.pivotDisplayCallback=a},this.registerCallbackTransitionCompleted=function(a){this.transitionCompletedCallback=a},this.showPivot=function(a){this.pivotDisplayCallback(a)},this.setWorldUpVector=function(a){u||a&&a.lengthSq()>0&&!a.normalize().equals(this.sceneUpDirection)&&(this.sceneUpDirection.copy(a),this.sceneFrontDirection.copy(this.getWorldFrontVector()),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.cube&&requestAnimationFrame(this.cube.render))},this.getWorldUpVector=function(){return this.sceneUpDirection.clone()},this.getWorldRightVector=function(){var a=this.sceneUpDirection.clone();return Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):a.z>=0?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x),a.normalize()},this.getWorldFrontVector=function(){return this.getWorldUpVector().cross(this.getWorldRightVector()).normalize()},this.goToView=function(a){if(this.navApi.isActionEnabled("gotoview")){var b={position:a.position.clone(),up:a.up.clone(),center:a.center.clone(),pivot:a.pivot.clone(),fov:a.fov,worldUp:a.worldUp.clone(),isOrtho:a.isOrtho};r.elapsedTime=0,this.animateTransition(b)}},this.getCurrentView=function(){return{position:a.position.clone(),up:a.up.clone(),center:this.center.clone(),pivot:this.pivot.clone(),fov:a.fov,worldUp:this.sceneUpDirection.clone(),isOrtho:!1===a.isPerspective}},this.setCurrentViewAsHome=function(a){a?(this.navApi.setRequestFitToView(!0),z=!0):this.homeVector=this.getCurrentView()},this.setHomeViewFrom=function(a){var b=a.pivot?a.pivot:this.center,c=a.target?a.target:this.pivot,d=a.worldup?a.worldup:this.sceneUpDirection;this.homeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone(),isOrtho:!1===a.isPerspective},this.originalHomeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone(),worldFront:this.sceneFrontDirection.clone(),isOrtho:!1===a.isPerspective}},this.toPerspective=function(){a.isPerspective||(a.toPerspective(),d(!1))},this.toOrthographic=function(){a.isPerspective&&(a.toOrthographic(),d(!1))},this.setOrthographicFaces=function(a){this.orthographicFaces=a},this.goHome=function(){this.navApi.isActionEnabled("gotoview")&&(this.navApi.setPivotSetFlag(!1),this.goToView(this.homeVector))},this.resetHome=function(){this.homeVector.position.copy(this.originalHomeVector.position),this.homeVector.up.copy(this.originalHomeVector.up),this.homeVector.center.copy(this.originalHomeVector.center),this.homeVector.pivot.copy(this.originalHomeVector.pivot),this.homeVector.fov=this.originalHomeVector.fov,this.homeVector.worldUp.copy(this.originalHomeVector.worldUp),this.homeVector.isOrtho=this.originalHomeVector.isOrtho,this.goHome()},this.getView=function(){return this.center.clone().sub(a.position)},this.setCameraUp=function(b){var c=this.dir.clone(),d=c.cross(b).normalize();0===d.lengthSq()&&(c.copy(this.dir),b.z>b.y?c.y+=1e-4:c.z+=1e-4,d=c.cross(b).normalize()),a.up.copy(d).cross(this.dir).normalize()},function a(){requestAnimationFrame(a);var b=Date.now();v=b-w,w=b}(),this.ortho=!1,this.center=a.target?a.target.clone():new THREE.Vector3(0,0,0),this.pivot=a.pivot?a.pivot.clone():this.center.clone(),this.sceneUpDirection=a.worldup?a.worldup.clone():a.up.clone(),this.sceneFrontDirection=this.getWorldFrontVector(),this.dir=this.getView(),this.setCameraUp(a.up),this.saveCenter=this.center.clone(),this.savePivot=this.pivot.clone(),this.saveEye=a.position.clone(),this.saveUp=a.up.clone();var A,B,C,D;this.cubeFront=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),this.setHomeViewFrom(a);var E,F,G=new THREE.Quaternion,H=new THREE.Quaternion,I=new THREE.Quaternion,J=new THREE.Quaternion;this.userPanSpeed=.5,this.userLookSpeed=2,this.userHeightSpeed=5,this.walkMultiplier=1,this.userZoomSpeed=1.015,this.orbitMultiplier=5,this.currentlyAnimating=!1,a.keepSceneUpright=!0,this.preserveOrbitUpDirection=!0,this.alignOrbitUpDirection=!0,this.constrainOrbitHorizontal=!1,this.constrainOrbitVertical=!1,this.doCustomOrbit=!1,this.snapOrbitDeadZone=.045,this.snapOrbitThresholdH=this.snapOrbitThresholdV=THREE.Math.degToRad(15),this.snapOrbitAccelerationAX=this.snapOrbitAccelerationAY=1.5,this.snapOrbitAccelerationBX=this.snapOrbitAccelerationBY=2,this.snapOrbitAccelerationPointX=this.snapOrbitAccelerationPointY=.5,this.alignDirTable=new Array(26),this.alignDirTable[0]=new THREE.Vector3(-1,0,0),this.alignDirTable[1]=new THREE.Vector3(1,0,0),this.alignDirTable[2]=new THREE.Vector3(0,-1,0),this.alignDirTable[3]=new THREE.Vector3(0,1,0),this.alignDirTable[4]=new THREE.Vector3(0,0,-1),this.alignDirTable[5]=new THREE.Vector3(0,0,1),this.alignDirTable[6]=new THREE.Vector3(-1,-1,0),this.alignDirTable[7]=new THREE.Vector3(-1,1,0),this.alignDirTable[8]=new THREE.Vector3(1,-1,0),this.alignDirTable[9]=new THREE.Vector3(1,1,0),this.alignDirTable[10]=new THREE.Vector3(0,-1,-1),this.alignDirTable[11]=new THREE.Vector3(0,-1,1),this.alignDirTable[12]=new THREE.Vector3(0,1,-1),this.alignDirTable[13]=new THREE.Vector3(0,1,1),this.alignDirTable[14]=new THREE.Vector3(-1,0,-1),this.alignDirTable[15]=new THREE.Vector3(1,0,-1),this.alignDirTable[16]=new THREE.Vector3(-1,0,1),this.alignDirTable[17]=new THREE.Vector3(1,0,1),this.alignDirTable[18]=new THREE.Vector3(-1,-1,-1),this.alignDirTable[19]=new THREE.Vector3(-1,-1,1),this.alignDirTable[20]=new THREE.Vector3(-1,1,-1),this.alignDirTable[21]=new THREE.Vector3(-1,1,1),this.alignDirTable[22]=new THREE.Vector3(1,-1,-1),this.alignDirTable[23]=new THREE.Vector3(1,-1,1),this.alignDirTable[24]=new THREE.Vector3(1,1,-1),this.alignDirTable[25]=new THREE.Vector3(1,1,1),this.combined=!1,this.useSnap=!1,this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new THREE.Vector3(0,0,0),this.topLimit=!1,this.bottomLimit=!1,this.minSceneBound=0,this.maxSceneBound=0;var K={destinationPercent:1,duration:1,zoomToFitScene:!0,useOffAxis:!1};this.shotParams=K;var L,M;this.zoomDelta=new THREE.Vector2;var N,O,P,Q=0,R=new THREE.Vector3,S=new THREE.Vector3;this.rewindParams={history:[],startTime:void 0,thumbnailSize:56,thumbnailGapSize:12,maxHistorySize:25,snappingEnabled:!0,timelineIndex:0,timelineIndexSlide:0,open:!1,openLocation:new THREE.Vector2(0,0),openBracket:new THREE.Vector2(0,0),openBracketA:new THREE.Vector2(0,0),openBracketB:new THREE.Vector2(0,0),openLocationOrigin:new THREE.Vector2(0,0),locationOffset:new THREE.Vector2(0,0),snapOffset:new THREE.Vector2(0,0),slideOffset:new THREE.Vector2(0,0),snapped:!0,resetWeights:!1,recordEnabled:!1,elementIsRecording:!1},this.viewCubeMenuOpen=!1,this.menuSize=new THREE.Vector2(0,0),this.menuOrigin=new THREE.Vector2(0,0),a.lookAt(this.center),this.setCube=function(a){this.cube=a},this.loadObject=function(a,b,c){loader=new THREE.JSONLoader,loader.load(a,function(a,d){var e=new THREE.MeshPhongMaterial(d);mesh=new THREE.Mesh(a,e),mesh.scale=b,mesh.position.copy(c),mesh.geometry.computeBoundingBox();var f=mesh.geometry.boundingBox.clone();S.set(f.max.x,f.max.y,f.max.z),R.set(f.min.x,f.min.y,f.min.z),S.multiply(b),R.multiply(b),scene.add(mesh),objects.push(mesh)})},this.sync=function(b){b.isPerspective!==a.isPerspective&&(b.isPerspective?a.toPerspective():(a.toOrthographic(),b.saveFov&&(a.saveFov=b.saveFov))),a.fov=b.fov,a.position.copy(b.position),b.target&&(this.center.copy(b.target),a.target.copy(b.target)),b.pivot&&(this.pivot.copy(b.pivot),a.pivot.copy(b.pivot)),this.dir.copy(this.center).sub(a.position),this.setCameraUp(b.up);var c=b.worldup?b.worldup:b.up;c.distanceToSquared(this.sceneUpDirection)>1e-4&&this.setWorldUpVector(c),z&&!this.navApi.getTransitionActive()&&(z=!1,this.setCurrentViewAsHome(!1)),this.cube&&requestAnimationFrame(this.cube.render)},this.refresh=function(){this.cube&&this.cube.refreshCube()},THREE.Box2.prototype.setCenter=function(a){var b=new THREE.Vector2(Math.abs(this.max.x-this.min.x)/2,Math.abs(this.max.y-this.min.y)/2);return this.min.copy(a).sub(b),this.max.copy(a).add(b),this},THREE.Box2.prototype.getIcon2DCoords=function(a,b){var c=this.center;b.set((a.x-c.x)/(this.size().x/2),(a.y-c.y)/(this.size().y/2))},THREE.Matrix3.prototype.makeRotationFromQuaternion=function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return b[0]=1-(m+o),b[3]=k-r,b[6]=l+q,b[1]=k+r,b[4]=1-(j+o),b[7]=n-p,b[2]=l-q,b[5]=n+p,b[8]=1-(j+m),this},THREE.Quaternion.prototype.setFromRotationMatrix3=function(a){var b,c=a.elements,d=c[0],e=c[3],f=c[6],g=c[1],h=c[4],i=c[7],j=c[2],k=c[5],l=c[8],m=d+h+l;return m>0?(b=.5/Math.sqrt(m+1),this.w=.25/b,this.x=(k-i)*b,this.y=(f-j)*b,this.z=(g-e)*b):d>h&&d>l?(b=2*Math.sqrt(1+d-h-l),this.w=(k-i)/b,this.x=.25*b,this.y=(e+g)/b,this.z=(f+j)/b):h>l?(b=2*Math.sqrt(1+h-d-l),this.w=(f-j)/b,this.x=(e+g)/b,this.y=.25*b,this.z=(i+k)/b):(b=2*Math.sqrt(1+l-d-h),this.w=(g-e)/b,this.x=(f+j)/b,this.y=(i+k)/b,this.z=.25*b),this},THREE.Quaternion.prototype.rotate=function(a){var b=(new THREE.Matrix4).makeRotationFromQuaternion(this),c=b.elements,d=(new THREE.Matrix3).set(c[0],c[1],c[2],c[4],c[5],c[6],c[8],c[9],c[10]);return a.applyMatrix3(d)},THREE.Vector3.prototype.findAngleWith=function(a,b){var c=0,d=this.clone().normalize().clone().dot(a.clone().normalize()),e=this.clone().cross(a).clone().normalize();if(e.clone().length()<Number.MIN_VALUE)c=d>0?0:180;else{b=e.clone().dot(b.clone().normalize())>0?e:-e;var f=(new THREE.Quaternion).setFromAxisAngle(b,90*THREE.Math.degToRad);f=f.clone().rotate(a).clone().normalize().clone().dot(this),c=Math.acos(d)*THREE.Math.radToDeg,Math.abs(c-90)<Number.MIN_VALUE&&(c=90),(c<90&&d*f>0||c>90&&d*f<0||90==c&&f>0)&&(c*=-1)}return c=THREE.Math.degToRad(c)},"contains"in String.prototype||(String.prototype.contains=function(a,b){return-1!==String.prototype.indexOf.call(this,a,b)}),Math.linearClamp=function(a,b,c){return a<=b?0:a>=c?1:(a-b)/(c-b)},Math.easeClamp=function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;var d=(a-b)/(c-b);return.5*(Math.sin((d-.5)*Math.PI)+1)},Math.linearInterp=function(a,b,c){return b*(1-a)+c*a},Math.equalityClamp=function(a,b,c){return a<=b?b:a>=c?c:a},Math.round2=function(a){return Math.round(100*a)/100},Math.round1=function(a){return Math.round(10*a)/10},this.animateTransition=function(b){if(b){var c=!1,e=0;if(this.setCameraOrtho(b.isOrtho),r.elapsedTime>=K.duration)return e=1,r.center.copy(b.center),r.pivot.copy(b.pivot),a.position.copy(b.position),a.up.copy(b.up),a.target.copy(b.center),b.isOrtho||(a.fov=b.fov),a.dirty=!0,c=!b.worldUp.equals(this.sceneUpDirection),c&&this.setWorldUpVector(b.worldUp),this.currentlyAnimating=!1,d(c),this.showPivot(!1),this.cube&&requestAnimationFrame(this.cube.render),this.addHistoryElement(),this.navApi.setTransitionActive(!1),void this.transitionCompletedCallback();this.currentlyAnimating=!0,this.showPivot(!0),this.navApi.setTransitionActive(!0);var f=K.destinationPercent;e=Math.easeClamp(r.elapsedTime/K.duration,0,f);var g=1-e;r.elapsedTime+=v/500;var h=r.center.clone().multiplyScalar(g).add(b.center.clone().multiplyScalar(e)),i=a.position.clone().multiplyScalar(g).add(b.position.clone().multiplyScalar(e)),j=a.up.clone().multiplyScalar(g).add(b.up.clone().multiplyScalar(e)),k=a.pivot.clone().multiplyScalar(g).add(b.pivot.clone().multiplyScalar(e)),l=this.sceneUpDirection.clone().multiplyScalar(g).add(b.worldUp.clone().multiplyScalar(e)),m=a.fov*g+b.fov*e;r.center.copy(h),r.pivot.copy(k),a.position.copy(i),a.up.copy(j),a.target.copy(h),b.isOrtho||(a.fov=m),a.dirty=!0,c=l.distanceToSquared(this.sceneUpDirection)>1e-4,c&&this.setWorldUpVector(l),a.lookAt(r.center),d(c),this.cube&&requestAnimationFrame(this.cube.render),requestAnimationFrame(function(){r.animateTransition(b)})}},this.sphericallyInterpolateTransition=function(b){var c,e,f,g=0;if(this.currentlyAnimating=!0,this.navApi.setTransitionActive(!0),r.elapsedTime>=K.duration)g=1,this.currentlyAnimating=!1;else{var h=K.destinationPercent;g=Math.easeClamp(r.elapsedTime/K.duration,0,h),r.elapsedTime+=v/500}if(1===g)e=M.position,c=M.center,f=M.up;else{var i=new THREE.Matrix3,j=G.clone();j.slerp(H,g),i.makeRotationFromQuaternion(j);var k=Math.linearInterp(g,E,F),l=i.elements;c=L.center.clone().multiplyScalar(1-g).add(M.center.clone().multiplyScalar(g)),e=c.clone().sub(new THREE.Vector3(l[0],l[1],l[2]).multiplyScalar(k)),f=new THREE.Vector3(l[3],l[4],l[5])}r.center.copy(c),a.position.copy(e),a.up.copy(f),r.navApi.getUsePivotAlways()||r.pivot.copy(c),a.lookAt(r.center),!0===this.currentlyAnimating?(this.showPivot(!0),requestAnimationFrame(function(){r.sphericallyInterpolateTransition(b)})):(this.navApi.setTransitionActive(!1),this.showPivot(!1),this.addHistoryElement(),this.orthographicFaces&&this.isFaceView()&&this.setCameraOrtho(!0),b&&b()),d(!1),this.cube&&requestAnimationFrame(this.cube.render)},this.getOrientation=function(){if(this.cube){var b=Math.round1(a.up.x),c=Math.round1(a.up.y),d=Math.round1(a.up.z),e=this.sceneFrontDirection.clone(),f=this.sceneUpDirection.clone(),g=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();e.x=Math.round1(e.x),e.y=Math.round1(e.y),e.z=Math.round1(e.z),f.x=Math.round1(f.x),f.y=Math.round1(f.y),f.z=Math.round1(f.z),g.x=Math.round1(g.x),g.y=Math.round1(g.y),g.z=Math.round1(g.z);var h=g.clone().multiplyScalar(-1),i=f.clone().multiplyScalar(-1),j=e.clone().multiplyScalar(-1);switch(this.cube.currentFace){case"front":if(f.x==b&&f.y==c&&f.z==d)return"up";if(i.x==b&&i.y==c&&i.z==d)return"down";if(g.x==b&&g.y==c&&g.z==d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left";break;case"right":if(f.x==b&&f.y==c&&f.z==d)return"up";if(i.x==b&&i.y==c&&i.z==d)return"down";if(j.x==b&&j.y==c&&j.z==d)return"left";if(e.x==b&&e.y==c&&e.z==d)return"right";break;case"left":if(f.x==b&&f.y==c&&f.z==d)return"up";if(i.x==b&&i.y==c&&i.z==d)return"down";if(e.x==b&&e.y==c&&e.z==d)return"left";if(j.x==b&&j.y==c&&j.z==d)return"right";break;case"back":if(f.x==b&&f.y==c&&f.z==d)return"up";if(i.x==b&&i.y==c&&i.z==d)return"down";if(h.x==b&&h.y==c&&h.z==d)return"right";if(g.x==b&&g.y==c&&g.z==d)return"left";break;case"top":if(j.x==b&&j.y==c&&j.z==d)return"down";if(e.x==b&&e.y==c&&e.z==d)return"up";if(g.x==b&&g.y==c&&g.z==d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left";break;case"bottom":if(e.x==b&&e.y==c&&e.z==d)return"down";if(j.x==b&&j.y==c&&j.z==d)return"up";if(g.x==b&&g.y==c&&g.z==d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left"}}},this.setCameraOrtho=function(b){b&&a.isPerspective&&a.toOrthographic(),b||a.isPerspective||a.toPerspective()},this.resetOrientation=function(){this.setCameraOrtho(this.originalHomeVector.isOrtho),this.sceneUpDirection.copy(this.originalHomeVector.worldUp),this.sceneFrontDirection.copy(this.originalHomeVector.worldFront),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.setCameraUp(this.sceneUpDirection),d(!0)},this.setCurrentViewAsFront=function(){this.cube&&(this.cube.currentFace="front"),this.sceneUpDirection.copy(a.up.clone()),this.sceneFrontDirection.copy(this.getView()).normalize(),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.orthographicFaces&&this.setCameraOrtho(!0),d(!0)},this.setCurrentViewAsTop=function(){this.cube&&(this.cube.currentFace="top"),this.sceneUpDirection.copy(this.getView()).multiplyScalar(-1).normalize(),this.sceneFrontDirection.copy(a.up),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),d(!0)},this.calculateCubeTransform=function(b){var c=this.sceneUpDirection.clone(),d=this.sceneFrontDirection.clone(),e=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();L=a.clone(),L.center=r.center.clone(),L.pivot=r.pivot.clone(),M=a.clone(),M.center=r.center.clone(),M.pivot=r.pivot.clone();var f=new THREE.Vector3(0,0,0);b.contains("back")&&(f=f.add(d)),b.contains("front")&&(f=f.sub(d)),b.contains("top")&&(f=f.add(c)),b.contains("bottom")&&(f=f.sub(c)),b.contains("right")&&(f=f.add(e)),b.contains("left")&&(f=f.sub(e));var g=c,h=f.clone().normalize();if(1-Math.abs(h.dot(c))<Number.MIN_VALUE)for(var i=this.getView().normalize(),j=[d.clone(),d.clone().negate(),e.clone(),e.clone().negate()],k=h.dot(c)>0?1:-1,l=i.clone().add(a.up.clone().multiplyScalar(k)).normalize(),m=-2,n=0;n<4;n++){var o=l.dot(j[n]);o>m&&(m=o,g=j[n].multiplyScalar(k))}F=E=this.getView().length(),M.position.copy(M.center.clone().add(f.multiplyScalar(F/f.length()))),M.up.copy(g);var p=L.center.clone().sub(L.position).normalize(),q=p.clone().cross(L.up).normalize(),s=q.clone().cross(p).normalize(),t=new THREE.Matrix3;t.set(p.x,s.x,q.x,p.y,s.y,q.y,p.z,s.z,q.z),G.setFromRotationMatrix3(t),p=M.center.clone().sub(M.position).normalize(),q=p.clone().cross(M.up).normalize(),s=q.clone().cross(p).normalize(),t.set(p.x,s.x,q.x,p.y,s.y,q.y,p.z,s.z,q.z),I.setFromAxisAngle(p,0),J.setFromAxisAngle(s,0),H.setFromRotationMatrix3(t),H.multiply(I).multiply(J).normalize()},this.centerShot=function(b){L&&!b||(r.elapsedTime=0,L=M=a.clone(),L.center=r.center);var c=r.pivot.clone(),e=c.clone().sub(L.position),f=L.center.clone().sub(L.position).normalize(),g=L.up.clone(),h=f.clone().cross(g).normalize();g=h.clone().cross(f).normalize();var i=h.clone().multiplyScalar(h.dot(e)),j=g.clone().multiplyScalar(g.dot(e)),k=i.clone().add(j);M.position.copy(L.position.clone().add(k)),M.center=c,M.pivot=c;var l=0;if(r.elapsedTime>=K.duration)l=1;else{var m=K.destinationPercent;l=Math.easeClamp(r.elapsedTime/K.duration,0,m),r.elapsedTime+=v/2e3}var n=a.position.clone().multiplyScalar(1-l).add(M.position.clone().multiplyScalar(l)),o=r.center.clone().multiplyScalar(1-l).add(M.center.clone().multiplyScalar(l)),p=r.pivot.clone().multiplyScalar(1-l).add(M.pivot.clone().multiplyScalar(l));a.position.copy(n),r.center.copy(o),r.pivot.copy(p),a.lookAt(r.center),d(!1),
1===l?this.addHistoryElement():requestAnimationFrame(function(){r.centerShot(!1)})},this.levelShot=function(){var b=this.getView(),c=b.length(),d=this.sceneUpDirection.clone(),e=a.up.clone().normalize(),f=b.normalize(),g=f.dot(d);if(1-Math.abs(g)>Number.MIN_VALUE){var h=f.clone().cross(d);f=d.clone().cross(h),f.normalize()}else f=e.clone();f.multiplyScalar(c);var i={center:f.add(a.position),up:d,position:a.position,pivot:r.center.clone().add(f),fov:a.fov,worldUp:d};r.elapsedTime=0,r.animateTransition(i)},this.fitToWindow=function(){var b=this.getView(),c=a.up.clone();b.normalize(),c.normalize(),M=a.clone(),M.center=r.center,c=e(c,b),c.normalize(),M.up.copy(c);var d=b.clone().cross(c);d.normalize();var f=R.clone(),g=S.clone(),h=[f,g],i=new THREE.Vector3(g.x-f.x,g.y-f.y,g.z-f.z);h[2]=new THREE.Vector3(g.x,f.y,g.z),h[3]=new THREE.Vector3(g.x,f.y,f.z),h[4]=new THREE.Vector3(g.x,g.y,f.z),h[5]=new THREE.Vector3(f.x,g.y,g.z),h[6]=new THREE.Vector3(f.x,g.y,f.z),h[7]=new THREE.Vector3(f.x,f.y,g.z);for(var j=0;j<8;j++){var k=h[j].clone().sub(a.position);h[j].setX(k.clone().dot(d)),h[j].setY(k.clone().dot(c)),h[j].setZ(k.clone().dot(b))}var l,m,n,o,p=THREE.Math.degToRad(a.topFov),q=THREE.Math.degToRad(a.bottomFov),s=THREE.Math.degToRad(a.leftFov),t=THREE.Math.degToRad(a.rightFov);l=s>=0?Number.MAX_VALUE:Number.MIN_VALUE,m=t>=0?Number.MAX_VALUE:Number.MIN_VALUE,n=p>=0?Number.MAX_VALUE:Number.MIN_VALUE,o=q>=0?Number.MAX_VALUE:Number.MIN_VALUE;for(var u=1/Math.tan(t),v=-1/Math.tan(s),w=1/Math.tan(p),x=-1/Math.tan(q),y=0;y<8;y++){var z=h[y].clone(),A=z.z-v*z.x;l=s>=0?Math.min(l,A):Math.max(l,A),A=z.z-u*z.x,m=t>=0?Math.min(m,A):Math.max(m,A),A=z.z-w*z.y,n=p>=0?Math.min(n,A):Math.max(n,A),A=z.z-x*z.y,o=q>=0?Math.min(o,A):Math.max(o,A)}var B=(m-l)/(v-u),C=v*B+l,D=(o-n)/(w-x),E=w*D+n,F=0;if(C<=E){var G=(p-q)/2;if(Math.abs(G)>Number.MIN_VALUE){var H=1/Math.tan(G);D=D-E/H+C/H}F=C}else{var I=(t-s)/2;if(Math.abs(I)>Number.MIN_VALUE){var J=1/Math.tan(I);B=B-C/J+E/J}F=E}var K=new THREE.Vector3(B,D,F),L=d.clone().multiplyScalar(K.x),N=c.clone().multiplyScalar(K.y),O=b.clone().multiplyScalar(K.z);K=L.clone().add(N.clone().add(O)),M.position.add(K);var P=i.clone().sub(M.position).dot(b);M.center=M.position.clone().add(b.multiplyScalar(P)),M.pivot=i.clone();var Q={center:M.center,up:M.up,position:M.position,pivot:M.pivot,fov:a.fov,worldUp:r.sceneUpDirection.clone()};r.elapsedTime=0,r.animateTransition(Q)},this.updatePivotPosition=function(b){var c,d,e=new THREE.Vector3(b.x/window.innerWidth*2-1,-b.y/window.innerHeight*2+1,.5);if(e=e.unproject(a),c=new THREE.Raycaster(a.position,e.sub(a.position).normalize()),d=c.intersectObjects(objects),"zoom"==r.mode)if(void 0!==d[0]){var f=d[0].point;r.pivot.copy(f)}else{var g=i(b);r.pivot.copy(g.rayO.clone().add(g.rayD))}else if(void 0!==d[0]){wheel.cursorImage("pivot");var f=d[0].point;r.isMouseDown||r.pivot.copy(f)}else wheel.cursorImage("SWInvalidArea")},this.onDrawHeight=function(b,c,d,e,f){var g=new THREE.Vector3(0,1,0),h=a.position.clone().dot(g),i=Math.linearClamp(h,r.minSceneBound,r.maxSceneBound),j=i-.5;t&&(t.find("img#updownImageA").remove(),t.prepend('<img src="'+f+'SWheighthandleA.png" id="updownImageA" style="position:fixed; z-index:9999; top:'+(d-86*j)+"px; left:"+c+'px;"/>'),e||t.prepend('<img src="'+f+'SWheighthandleI.png" id="updownImageI" style="position:fixed; z-index:9998; top:'+(d-86*j)+"px; left:"+c+'px;"/>'))},this.drawDropdownMenu=function(a,b,c,d,e,f,g){var h=0;if(s)f.appendChild(s);else{s=document.createElement("div"),s.className="dropDownMenu",s.style.top="100px",s.style.left="-400px";for(var i=0,j=0,k=0;k<a.length;k++){var l;if(null===a[k])l=document.createElement("li"),l.style.height="1px",i+=1,l.style.backgroundColor="#E0E0E0";else{var m=Autodesk.Viewing.i18n.translate(a[k]);if(j=m.length>j?m.length:j,c[k]){l=document.createElement("div");var n=document.createElement("input"),o=document.createElement("label");n.type="radio",n.className="dropDownMenuCheck",o.innerHTML=m,o.className="dropDownMenuCheckText",l.appendChild(n),l.appendChild(o),l.className="dropDownMenuCheckbox"}else l=document.createElement("li"),l.textContent=m,l.className=b[k]?"dropDownMenuItem":"dropDownMenuItemDisabled";l.id="menuItem"+h,h++,i+=25,l.setAttribute("data-i18n",a[k])}s.appendChild(l)}f.appendChild(s),s.style.minWidth=Math.max(256,7.4*j)+"px";var p=s.getBoundingClientRect().width;this.menuSize.x=p,this.menuSize.y=i}h=0;for(var k=0;k<a.length;k++)if(null!==a[k]){if(c[k]){var q="menuItem"+h,r=document.getElementById(q);r&&(r.children[0].checked=c[k]())}h++}var t=e-15,u=d+1,v=this.canvas.getBoundingClientRect();u+this.menuSize.x>v.right&&(u=d-this.menuSize.x-1),t+this.menuSize.y>v.bottom&&(t=v.bottom-this.menuSize.y),t-=g.y,u-=g.x,s.style.top=t+"px",s.style.left=u+"px",this.menuOrigin.x=u,this.menuOrigin.y=t},this.removeDropdownMenu=function(a){a.removeChild(s)},this.isFaceView=function(){return q(this.center.clone().sub(a.position).normalize())&&q(a.up)},this.startInteraction=function(a,b){this.startCursor=new THREE.Vector2(a,b),this.startState={saveCenter:this.center.clone(),saveEye:this.camera.position.clone(),savePivot:this.pivot.clone(),saveUp:this.camera.up.clone()},this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new THREE.Vector3(0,0,0),this.navApi.setTransitionActive(!0)},this.orbit=function(b,c,e,f){if(this.navApi.isActionEnabled("orbit")&&!0!==this.currentlyAnimating){var g="wheel";if(r.orthographicFaces&&!a.isPerspective&&(a.toPerspective(),f&&f.saveEye.copy(this.camera.position)),f&&(g="cube"),"cube"==g?(this.saveCenter.copy(f.saveCenter),this.saveEye.copy(f.saveEye),this.savePivot.copy(f.savePivot),this.saveUp.copy(f.saveUp),this.useSnap=!0,this.doCustomOrbit=!0):(this.saveCenter.copy(this.center),this.savePivot.copy(this.pivot),this.saveEye.copy(a.position),this.saveUp.copy(a.up),this.useSnap=!1,this.doCustomOrbit=!1),k()&&void 0==B&&(B=this.saveCenter.clone(),A=this.saveEye.clone(),D=this.savePivot.clone(),C=this.saveUp.clone()),this.preserveOrbitUpDirection){var i=h(b.x-c.x,b.y-c.y),l=h(e.x,e.y),m=this.sceneUpDirection.clone(),n=this.sceneFrontDirection.clone(),o=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),p=k()?D:this.savePivot,q=k()?A:this.saveEye,s=k()?B:this.saveCenter,t=k()?C:this.saveUp,u=p.clone().sub(q).normalize(),v=s.clone().sub(q).normalize(),w=v.clone().cross(t),x=q.clone().sub(p).length(),y=q.clone().sub(s).length(),z=u.clone().multiplyScalar(-1),E=v.clone().multiplyScalar(-1),F=w,G=t.clone();if(!this.constrainOrbitHorizontal){m.dot(this.saveUp)<-.009&&(i.x=-i.x,l.x=-l.x);var H=0;H=k()?l.x*this.orbitMultiplier:this.useSnap?this.lastSnapRotateX+j("h",0,-l.x):i.x*this.orbitMultiplier,this.lastSnapRotateX=H;var I=(new THREE.Quaternion).setFromAxisAngle(m,-H);z.applyQuaternion(I),E.applyQuaternion(I),F.applyQuaternion(I),G.applyQuaternion(I)}if(!this.constrainOrbitVertical){var J=n.clone().multiplyScalar(n.dot(F)),K=o.clone().multiplyScalar(o.dot(F)),L=J.clone().add(K);L.clone().normalize();var M=0;if(k())M=l.y*this.orbitMultiplier;else{var N=j("v",0,l.y);M=this.useSnap?this.lastSnapRotateY+N:i.y*this.orbitMultiplier}var O=(new THREE.Quaternion).setFromAxisAngle(L,-M);if(this.navApi.getOrbitPastWorldPoles())z.applyQuaternion(O).normalize(),E.applyQuaternion(O).normalize(),G.applyQuaternion(O).normalize();else{var P=G.clone();P.applyQuaternion(O).normalize();if(m.dot(P)<0){var Q=E.clone();Q.applyQuaternion(O).normalize();var R=Q.angleTo(m);Math.abs(R)>.5*Math.PI&&(R-=R>0?Math.PI:-Math.PI),M-=R,O.setFromAxisAngle(L,-M),z.applyQuaternion(O).normalize(),E.applyQuaternion(O).normalize(),G.applyQuaternion(O).normalize()}else z.applyQuaternion(O).normalize(),E.applyQuaternion(O).normalize(),G.applyQuaternion(O).normalize()}this.lastSnapRotateY=M}var S=z.multiplyScalar(x).add(p);a.position.copy(S),a.up.copy(G),this.center.copy(S),this.center.sub(E.multiplyScalar(y)),k()&&(B.copy(this.center),A.copy(a.position),D.copy(this.pivot),C.copy(a.up))}a.lookAt(this.center),d(!1)}},this.endInteraction=function(){this.navApi.setTransitionActive(!1)},this.look=function(b){if(this.navApi.isActionEnabled("walk")){var c=h(b.x,b.y),e=this.userLookSpeed,f=this.getView(),g=a.up,i=f.clone().cross(g).normalize(),j=this.sceneUpDirection.clone(),k=c.clone();k.x*=Math.PI,k.y*=Math.PI/a.aspect,k.multiplyScalar(e);var l=(new THREE.Quaternion).setFromAxisAngle(i,-k.y);if(a.keepSceneUpright&&!this.navApi.getOrbitPastWorldPoles()){var m=g.clone();if(m.applyQuaternion(l).normalize(),m.dot(j)<0){var n=f.clone();n.applyQuaternion(l);var o=n.angleTo(j);Math.abs(o)>.5*Math.PI&&(o-=o>0?Math.PI:-Math.PI),k.y-=o,l.setFromAxisAngle(i,-k.y)}}f=l.clone().rotate(f),g=l.clone().rotate(g),g.normalize();var p=a.keepSceneUpright?j:g,q=(new THREE.Quaternion).setFromAxisAngle(p,-k.x);f=q.clone().rotate(f),g=q.clone().rotate(g),this.center.copy(f.add(a.position)),a.up.copy(g),a.lookAt(this.center),d(!1)}},this.pan=function(b){if(this.navApi.isActionEnabled("pan")){b=h(b.x,b.y);var c=this.getView(),e=a.up.clone().cross(c),f=c.clone().cross(e);e.normalize(),f.normalize(),c.normalize();var g=this.pivot.clone().sub(a.position),i=c.clone().dot(g),j=i*(Math.tan(THREE.Math.degToRad(a.leftFov))+Math.tan(THREE.Math.degToRad(a.rightFov))),k=i*(Math.tan(THREE.Math.degToRad(a.topFov))+Math.tan(THREE.Math.degToRad(a.bottomFov))),l=b.x*Math.abs(j),m=b.y*Math.abs(k),n=new THREE.Vector3,o=e.clone().multiplyScalar(l),p=f.clone().multiplyScalar(m);n=o.clone().add(p).clone().multiplyScalar(this.userPanSpeed),a.position.add(n),this.center.add(n),a.lookAt(this.center),d(!1)}},this.zoom=function(b){if(this.navApi.isActionEnabled("zoom")){var c=this.userZoomSpeed,e=Number.MAX_VALUE,f=b.x+b.y,g=Math.pow(c,f),h=this.pivot.clone().sub(this.pivot.clone().sub(this.saveEye).clone().multiplyScalar(g)),i=h.clone().add(r.D.clone().multiplyScalar(r.D.clone().dot(this.pivot.clone().sub(h).clone())));if(!(g>=e)){if(f>0){Math.pow(c,f-0);if(f<0)return void(Q=0);a.position.copy(h),this.center.copy(i);var j=h.clone().sub(this.saveEye).dot(r.D);j>e?(a.position.copy(this.saveEye.sub(r.D).clone().multiplyScalar(e)),Q=e>0?-1:0):Q=-j/e}else a.position.copy(h),this.center.copy(i);a.lookAt(this.center),d(!1)}}},this.walk=function(b,c,e,f,g){if(this.navApi.isActionEnabled("walk")){var i=this.sceneUpDirection.clone(),j=this.sceneFrontDirection.clone(),k=this.sceneFrontDirection.clone().cross(this.sceneUpDirection);l(b,c)?(wheel.cursorImage("SWWalk"),n(!0,b,c),x=c.x,y=c.y):n(!1,b,c),x=b.x,y=b.y;var m=h(x-c.x,y-c.y),o=-m.x,p=-m.y,q=o<0?-1:1,r=p<0?-1:1,s=Math.abs(o),t=Math.abs(p),u=new THREE.Vector2(30,30);u=h(u.x,u.y),s=l(b,c)?0:Math.abs(o)-u.x,t=l(b,c)?0:Math.abs(p)-u.y;s/=.25,t/=.25,s=s<1?Math.easeClamp(s,0,1):Math.pow(s,1),t=t<1?Math.easeClamp(t,0,1):Math.pow(t,1);var v=s>0?s*q:0,w=t>0?t*r:0,z=this.getView(),A=z.length();z.normalize();z.clone().cross(a.up).normalize();var B=k.clone().multiplyScalar(k.clone().dot(z)),C=j.clone().multiplyScalar(j.clone().dot(z)),D=C.clone().add(B);D=D.clone().length()>Number.MIN_VALUE?D.normalize():a.up;var E=w*(1*this.walkMultiplier),F=D,G=Math.cos(.65);1!=G&&(i.clone().dot(a.up)<-Number.MIN_VALUE&&i.clone().dot(z)<-G||i.clone().dot(a.up)>Number.MIN_VALUE&&i.clone().dot(z)>G)&&(F=-F);var H=-v*this.walkMultiplier*.05,I=a.up;(i.clone().dot(a.up)<-Number.MIN_VALUE||Math.abs(i.clone().dot(a.up))<Number.MIN_VALUE&&i.clone().dot(z)>Number.MIN_VALUE)&&(H=-H),I=i;var J=(new THREE.Quaternion).setFromAxisAngle(I,H);J.normalize(),z=J.clone().rotate(z),z.normalize(),a.up.copy(J.clone().rotate(a.up)),a.up.normalize(),a.position.add(F.clone().multiplyScalar(E)),this.center.copy(a.position.clone().add(z.clone().multiplyScalar(A))),F=i,F.normalize(),0===E&&(E=.01),a.lookAt(this.center),d(!1)}},this.updown=function(b){if(!this.navApi.getIsLocked()){var c=b,e=p(c);r.m_amount+=e;var f=new THREE.Vector3(0,1,0),g=r.saveEye.clone().sub(f.clone().multiplyScalar(r.m_amount)),h=g.clone().dot(f);a.position.copy(g),h<r.minSceneBound&&a.position.add(f.clone().multiplyScalar(r.minSceneBound-h)),h>r.maxSceneBound&&a.position.add(f.clone().multiplyScalar(r.maxSceneBound-h)),this.center.copy(a.position.clone().add(r.saveCenter.clone().sub(r.saveEye))),a.lookAt(this.center),d(!1)}},this.addHistoryElement=function(){},this.addIntermediateHistoryElement=function(){this.rewindParams.snapped?this.rewindParams.history=this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):this.rewindParams.slideOffset.x>0?this.rewindParams.history=this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):this.rewindParams.history=this.rewindParams.history.slice(0,this.rewindParams.timelineIndex+1),this.addHistoryElement()},this.clearHistory=function(){this.rewindParams.history.length=0,this.rewindParams.timelineIndex=0,this.rewindParams.timelineIndexSlide=0,this.rewindParams.resetWeights=!0},this.openTimeline=function(a){this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex,this.rewindParams.resetWeights&&(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=this.rewindParams.snappingEnabled),0===this.rewindParams.history.length&&this.addHistoryElement();for(var b=0;b<this.rewindParams.history.length;b++){var c=b-this.rewindParams.timelineIndex,d=this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize;this.rewindParams.history[b].thumbnailBounds.setCenter(new THREE.Vector2(a.x+c*d,a.y).add(this.rewindParams.slideOffset)),this.rewindParams.resetWeights&&(this.rewindParams.history[b].weight=b==this.rewindParams.timelineIndex?1:0)}this.rewindParams.resetWeights&&(this.rewindParams.resetWeights=!1);var d=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize);if(this.rewindParams.open=!0,this.rewindParams.openLocation=a.clone(),this.rewindParams.openLocationOrigin=a.clone(),this.rewindParams.openBracket=a.clone(),this.rewindParams.openBracketA=new THREE.Vector2(d,a.y),this.rewindParams.openBracketB=new THREE.Vector2(window.innerWidth-d,a.y),this.rewindParams.openBracketA.x>this.rewindParams.openBracketB.x){var e=this.rewindParams.openBracketA.x;this.rewindParams.openBracketA.x=this.rewindParams.openBracketB.x,this.rewindParams.openBracketB.x=e}this.rewindParams.locationOffset=new THREE.Vector2(0,0),this.rewindParams.snapOffset=new THREE.Vector2(0,0)},this.slideTimeline=function(a){if(this.rewindParams.open&&0!==this.rewindParams.history.length){var b=a.clone().add(this.rewindParams.locationOffset),c=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize),d=c,e=window.innerWidth-c,f=this.rewindParams.history[0].thumbnailBounds.center().x,g=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x,h=0;if(b.x<this.rewindParams.openBracketA.x){h=b.x-this.rewindParams.openBracketA.x;var i=f-h;d<i&&(h=Math.min(h+(i-d),0))}if(b.x>this.rewindParams.openBracketB.x){h=b.x-this.rewindParams.openBracketB.x;var j=g-h;e>j&&(h=Math.max(h+(j-e),0))}this.rewindParams.openLocation.x+=h,this.rewindParams.openBracketA.x+=h,this.rewindParams.openBracketB.x+=h,this.rewindParams.openBracket.x=b.x-(this.rewindParams.openLocation.x-this.rewindParams.openLocationOrigin.x);var k=new THREE.Vector2(-h,0),l=b.clone().sub(this.rewindParams.openLocation.clone().sub(this.rewindParams.openLocationOrigin));k.x+=this.rewindParams.snapOffset.x,this.rewindParams.snapOffset.x=0;var m=!1;if(this.rewindParams.snappingEnabled)for(var n=0;n<this.rewindParams.history.length;n++){var o=this.rewindParams.history[n].thumbnailBounds.center().add(k);if(Math.abs(o.x-l.x)<4||this.rewindParams.snapped&&Math.abs(o.x-l.x)<16){m=!0,0!==h?(this.rewindParams.snapOffset.x=o.x-l.x,k.x-=this.rewindParams.snapOffset.x):this.rewindParams.openBracket.x+=o.x-l.x,l.x=o.x;break}}this.rewindParams.snapped=m;for(var p=-1,q=0,r=0;r<this.rewindParams.history.length;r++){var s=this.rewindParams.history[r].thumbnailBounds.clone();if(this.rewindParams.history[r].thumbnailBounds.setCenter(this.rewindParams.history[r].thumbnailBounds.center().add(k)),this.rewindParams.history[r].thumbnail){var t=this.rewindParams.history[r].thumbnailBounds.center().x-this.rewindParams.thumbnailSize/2;$("#rewindFrame"+r).css("left",t),$("#rewindBorder"+r).css("left",t-4)}var u=new THREE.Vector2(2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize),2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize));s.setFromCenterAndSize(s.center(),u);var v=new THREE.Vector2(0,0);s.getIcon2DCoords(l,v);var w=1-Math.abs(Math.equalityClamp(v.x,-1,1));this.rewindParams.history[r].weight=w,0===r&&l.x<s.center().x&&(this.rewindParams.history[r].weight=1),r===this.rewindParams.history.length-1&&l.x>s.center().x&&(this.rewindParams.history[r].weight=1),q+=this.rewindParams.history[r].weight,this.rewindParams.history[r].weight>p&&(p=this.rewindParams.history[r].weight,this.rewindParams.snappingEnabled&&1==this.rewindParams.history[r].weight?(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=!0):this.rewindParams.slideOffset.x=this.rewindParams.history[r].thumbnailBounds.center().x-l.x,this.rewindParams.timelineIndexSlide=r)}for(var x=0;x<this.rewindParams.history.length;x++)this.rewindParams.history[x].weight=this.rewindParams.history[x].weight/q;var y=this.rewindParams.history[0].thumbnailBounds.center().x,z=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x;this.rewindParams.openBracket.x<y?(this.rewindParams.locationOffset.x+=y-this.rewindParams.openBracket.x,this.rewindParams.openBracket.x=y):this.rewindParams.openBracket.x>z&&(this.rewindParams.locationOffset.x+=z-this.rewindParams.openBracket.x,this.rewindParams.openBracket.x=z)}},this.shiftBackOneElement=function(){0!==this.rewindParams.history.length&&(this.rewindParams.timelineIndex>0||0!==this.rewindParams.slideOffset.x)&&((this.rewindParams.snapped||this.rewindParams.slideOffset.x>0)&&this.rewindParams.timelineIndex--,this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex,this.rewindParams.resetWeights=!0,r.elapsedTime=0,this.animateToRewindIndex())},this.animateToRewindIndex=function(){var b=this.rewindParams.timelineIndex,c=0;if(r.elapsedTime>=K.duration)c=1;else{var e=K.destinationPercent;c=Math.easeClamp(r.elapsedTime/K.duration,0,e),r.elapsedTime+=v/500}r.center.copy(r.center.clone().multiplyScalar(1-c).clone().add(this.rewindParams.history[b].camera.center.clone().multiplyScalar(c))),a.position.copy(a.position.clone().multiplyScalar(1-c).clone().add(this.rewindParams.history[b].camera.position.clone().multiplyScalar(c))),a.up.copy(this.rewindParams.history[b].camera.up),r.pivot.copy(r.center),a.lookAt(r.center),d(!1),this.cube&&requestAnimationFrame(this.cube.render),1!==c&&requestAnimationFrame(function(){r.animateToRewindIndex()})},this.closeTimeline=function(){this.rewindParams.timelineIndex!=this.rewindParams.timelineIndexSlide&&(this.rewindParams.timelineIndex=this.rewindParams.timelineIndexSlide),this.rewindParams.open=!1},this.getInterpolatedCamera=function(){var b=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e4);b.center=new THREE.Vector3(0,0,0),b.pivot=new THREE.Vector3(0,0,0),b.leftFov=0,b.rightFov=0,b.topFov=0,b.bottomFov=0,b.up.set(0,0,0);for(var c=0;c<this.rewindParams.history.length;c++){var e=this.rewindParams.history[c].camera,f=this.rewindParams.history[c].weight;b.center.add(e.center.clone().multiplyScalar(f)),b.position.add(e.position.clone().multiplyScalar(f)),b.up.add(e.up.clone().multiplyScalar(f)),b.rotation.add(e.rotation.clone().multiplyScalar(f)),b.pivot.add(e.pivot.clone().multiplyScalar(f)),b.leftFov+=e.leftFov*f,b.rightFov+=e.rightFov*f,b.topFov+=e.topFov*f,b.bottomFov+=e.bottomFov*f}a.position.copy(b.position),a.up.copy(b.up),a.rotation=b.rotation,a.leftFov=b.leftFov,a.rightFov=b.rightFov,a.topFov=b.topFov,a.bottomFov=b.bottomFov,r.center.copy(b.center),r.pivot.copy(b.pivot),a.lookAt(r.center),a.up.normalize(),d(!1)}};var av=Autodesk.Viewing,avp=Autodesk.Viewing.Private;avp.Autocam.ViewCube=function(a,b,c,d,e){function f(a,b){var c={};return 0===a.type.indexOf("touch")?a.touches.length>0?(c.clientX=a.touches[0].clientX,c.clientY=a.touches[0].clientY,c.pageX=a.touches[0].pageX,c.pageY=a.touches[0].pageY,c.screenX=a.touches[0].screenX,c.screenY=a.touches[0].screenY,c.movementX=c.screenX-b.prevX,c.movementY=c.screenY-b.prevY,c.which=h.navApi.getUseLeftHandedInput()?3:1):c=b.prevCoords:(c.clientX=a.clientX,c.clientY=a.clientY,c.pageX=a.pageX,c.pageY=a.pageY,c.screenX=a.screenX,c.screenY=a.screenY,c.which=a.which,T?(c.movementX=a.movementX||a.mozMovementX||a.webkitMovementX||0,c.movementY=a.movementY||a.mozMovementY||a.webkitMovementY||0):(c.movementX=c.screenX-b.prevX,c.movementY=c.screenY-b.prevY)),b.prevX=c.screenX,b.prevY=c.screenY,b.prevCoords=c,c}var g=this,h=b,i=b.camera;b.setCube(this),g.currentFace="front",g.showTriad=e&&e.showTriad;var j,k,l,m,n,o,p,q=["top,front","top right","top,left","top,back","bottom,front","bottom,right","bottom,left","bottom,back","left,front","front,right","right,back","back,left"],r=["front,top,right","back,top,right","front,top,left","back,top,left","front,bottom,right","back,bottom,right","front,bottom,left","back,bottom,left"],s=["Go Home",null,"Orthographic","Perspective","Perspective with Ortho Faces",null,"Set current view as Home","Focus and set as Home","Reset Home",null,"Set current view as Front","Set current view as Top","Reset orientation"],t=[!0,null,!0,!0,!0,null,!0,!0,!0,null,!0,!0,!0],u=[null,null,function(){return!h.orthographicFaces&&!i.isPerspective},function(){return!h.orthographicFaces&&i.isPerspective},function(){return h.orthographicFaces},null,null,null,null,null,null,null,null],v=[];g.pcam=new THREE.PerspectiveCamera(45,1,1,2e3),g.ocam=new THREE.OrthographicCamera(-265,265,265,-265,-1e3,1e3),g.ocam.fov=g.pcam.fov,g.ocam.aspect=g.pcam.aspect,g.camera=i.isPerspective?g.pcam:g.ocam,g.camera.position.copy(i.position),g.center=new THREE.Vector3(0,0,0),g.camera.lookAt(g.center);var w,x,y,z,A,B,C,D,E,F,G,H,I=[],J=[],K=[],L=[],M=[],N=null,O=null,P=null,Q=0,R=0,S=!0,T=!1,U=!1,V=!1,W=-1!=navigator.userAgent.search("Chrome"),X=-1!=navigator.platform.search("Win32"),Y=!1,Z=!1,$=[];this.width=0,this.height=0,this.animSpeed=500,this.animate=!0,this.compass=!1,this.viewScaleFactorCompass=1.5,this.viewScale=1,this.draggable=!0,this.wantHomeButton=!1,this.wantRollArrows=!0,this.wantContextMenu=!0,this.inactiveOpacity=.5;var _=function(a){var b=a.getBoundingClientRect();return{x:b.left,y:b.top,w:b.width,h:b.height}},aa=function(a){a.preventDefault(),a.stopPropagation(),U=document.pointerLockElement===c||document.mozPointerLockElement===c||document.webkitPointerLockElement===c},ba=function(a,b){var c=a/2,d={x:16711680,y:65280,z:255},e=new THREE.Matrix4,f=new THREE.Matrix4;if(1===b.z){var g=new THREE.Vector3(0,1,0);f.makeRotationAxis(g,Math.PI/2),g.set(1,1,1).normalize(),f.multiply(e.makeRotationAxis(g,2*-Math.PI/3))}var h=new THREE.PlaneBufferGeometry(50,50),i=function(a,b){var c=document.createElement("canvas");c.width=c.height=128;var d=c.getContext("2d");d.font="128px Arial",d.fillStyle="rgba(255,255,255,1)",d.textAlign="center",d.textBaseline="middle",d.fillText(a,c.width/2,c.height/2);var e=new THREE.Texture(c);return e.needsUpdate=!0,new THREE.Mesh(h,new THREE.MeshBasicMaterial({map:e,side:THREE.DoubleSide,transparent:!0,color:b,depthWrite:!1,depthTest:!0}))};n=new THREE.Scene;var j=new THREE.BoxGeometry(a,10,10),k=new THREE.Mesh(j,new THREE.MeshBasicMaterial({color:d.x,shading:THREE.SmoothShading})),l=new THREE.Mesh(j,new THREE.MeshBasicMaterial({color:d.y,shading:THREE.SmoothShading})),m=new THREE.Mesh(j,new THREE.MeshBasicMaterial({color:d.z,shading:THREE.SmoothShading}));k.applyMatrix(e.makeTranslation(5,-c,-c)),l.applyMatrix(e.makeRotationZ(Math.PI/2)),l.applyMatrix(e.makeTranslation(-c,5,-c)),m.applyMatrix(e.makeRotationY(Math.PI/2)),m.applyMatrix(e.makeTranslation(-c,-c,5)),k.applyMatrix(f),l.applyMatrix(f),m.applyMatrix(f),n.add(k),n.add(l),n.add(m);var o=i("X",d.x),p=i("Y",d.y),q=i("Z",d.z),r=-(50+c)/2-20,s=c+50;o.position.set(s,r,r),p.position.set(r,s,r),q.position.set(r,r,s),o.position.applyMatrix4(f),p.position.applyMatrix4(f),q.position.applyMatrix4(f),v.push(o),v.push(p),v.push(q),n.add(o),n.add(p),n.add(q)},ca=function(){h.navApi.isActionEnabled("orbit")&&(c.style.opacity="1.0",Z=!1),requestAnimationFrame(g.render)},da=function(a){if(Z||h.viewCubeMenuOpen||!h.navApi.isActionEnabled("orbit"))h.navApi.isActionEnabled("orbit")&&(c.style.opacity=1);else{var b=Math.max(4*Math.abs((a.clientX-H.x)/H.w-.5)-1,0),d=Math.max(4*Math.abs((a.clientY-H.y)/H.h-.5)-1,0),e=Math.max(0,Math.min(Math.sqrt(b*b+d*d),1));c.style.opacity=1-e*(1-g.inactiveOpacity)}},ea=function(){h.viewCubeMenuOpen||(c.style.opacity=g.inactiveOpacity,Z=!0,requestAnimationFrame(g.render))},fa=function(a){var b=new Image,c=av.endpoint.getUseCredentials()&&(-1===a.indexOf("://")||-1!==a.indexOf(window.location.host));b.crossOrigin=c?"use-credentials":"anonymous";var d=new THREE.Texture(b);return b.onload=function(){d.needsUpdate=!0,++R>=11&&requestAnimationFrame(g.render)},b.src=a,d},ga=function(){var a,b=[],c=[];b[0]=ra(0,0),b[1]=ra(0,Math.PI/2),b[2]=ra(0,-Math.PI/2),b[3]=ra(0,Math.PI),b[4]=ra(Math.PI/2,0),b[5]=ra(Math.PI/2,Math.PI/2),b[6]=ra(Math.PI/2,-Math.PI/2),b[7]=ra(Math.PI/2,Math.PI),c[0]=qa(0,0,0),c[1]=qa(0,Math.PI/2,0),c[2]=qa(0,-Math.PI/2,0),c[3]=qa(0,Math.PI,0),c[4]=qa(Math.PI/2,0,0),c[5]=qa(Math.PI/2,Math.PI/2,0),c[6]=qa(Math.PI/2,-Math.PI/2,0),c[7]=qa(Math.PI/2,Math.PI,0),c[8]=qa(0,0,Math.PI/2),c[9]=qa(0,0,-Math.PI/2),c[10]=qa(-Math.PI/2,0,-Math.PI/2),c[11]=qa(-Math.PI,0,-Math.PI/2),I.push(pa(0,0)),I[0].name="front",K.push(I[0]),M.push(I[0]),l.add(I[0]),I.push(pa(0,Math.PI/2)),I[1].name="right",K.push(I[1]),M.push(I[1]),l.add(I[1]),I.push(pa(0,Math.PI)),I[2].name="back",K.push(I[2]),M.push(I[2]),l.add(I[2]),I.push(pa(0,-Math.PI/2)),I[3].name="left",K.push(I[3]),M.push(I[3]),l.add(I[3]),I.push(pa(Math.PI/2,0)),I[4].name="bottom",K.push(I[4]),M.push(I[4]),l.add(I[4]),I.push(pa(-Math.PI/2,0)),I[5].name="top",K.push(I[5]),M.push(I[5]),l.add(I[5]),a=I.length;var d;for(d=0;d<b.length;d++)I.push(b[d]),I[a+d].name=r[d],l.add(I[a+d]),K.push(I[a+d]),M.push(I[a+d]);for(a=I.length,d=0;d<c.length;d++)I.push(c[d]),I[a+d].name=q[d],l.add(I[a+d]),K.push(I[a+d]),M.push(I[a+d])},ha=function(a,b,c){var d,e=new THREE.Vector3;if("PerspectiveCamera"===b.type)e.copy(a),e.unproject(b),d=new THREE.Raycaster(b.position,e.sub(b.position).normalize());else{var f=new THREE.Vector3;f.copy(a),f.unproject(b),e.copy(b.position).negate().normalize(),d=new THREE.Raycaster(f,e)}return d.intersectObjects(c)},ia=function(a,b){var c=a.clientX-b.x,d=a.clientY-b.y;return c=c/b.w*2-1,d=(b.h-d)/b.h*2-1,new THREE.Vector3(c,d,.5)},ja=function(a){if(a.preventDefault(),a.stopPropagation(),h.navApi.isActionEnabled("orbit")&&!h.currentlyAnimating){var b=f(a,g);H=_(c),c.removeEventListener("mousemove",na,!1),document.addEventListener("mouseup",ma,!1),document.addEventListener("touchend",ma,!1),h.navApi.getUsePivotAlways()||(h.pivot.copy(h.center),h.navApi.setPivotPoint(h.center),h.navApi.setPivotSetFlag(!1)),h.startInteraction(b.pageX,b.pageY);var d,e;0==h.rewindParams.history.length&&h.addHistoryElement(),h.rewindParams.snapped&&h.rewindParams.timelineIndex+1==h.rewindParams.history.length||h.addIntermediateHistoryElement();var i=h.navApi.getUseLeftHandedInput()?1:3;if(b.which!==i){if(g.animSpeed<=0)return void avp.logger.error("animSpeed cannot be 0 or less, use ViewCube.animate flag to turn on and off animation",av.errorCodeString(av.ErrorCodes.VIEWER_INTERNAL_ERROR));e=ia(b,H),d=ha(e,g.camera,M),d.length>0&&(ua(),g.draggable&&(document.addEventListener("mousemove",ka,!1),document.addEventListener("touchmove",ka,!1),T&&(c.requestPointerLock(),V=W&&X)))}}},ka=function(a){if(a.preventDefault(),a.stopPropagation(),g.animSpeed<=0)return document.removeEventListener("mousemove",ka,!1),document.removeEventListener("touchmove",ka,!1),void avp.logger.error("animSpeed cannot be 0 or less",av.errorCodeString(av.ErrorCodes.VIEWER_INTERNAL_ERROR));if(!h.currentlyAnimating){var b=f(a,g);if(T&&V&&(V=!1,b.movementX=b.movementY=0),U&&(b.movementX>300||b.movementY>300)&&(b.movementX=0,b.movementY=0),b.movementX===b.movementY&&0===b.movementX)return void(h.currentlyAnimating=!1);S=!1,Y=!0,h.showPivot(!0),h.currentCursor=new THREE.Vector2(b.pageX,b.pageY),h.orbit(h.currentCursor,h.startCursor,new THREE.Vector3(-b.movementX,b.movementY,0),h.startState),g.camera.lookAt(g.center),requestAnimationFrame(g.render)}},la=function(a){a||(document.removeEventListener("mouseup",ma,!1),document.removeEventListener("touchend",ma,!1)),document.removeEventListener("mousemove",ka,!1),document.removeEventListener("touchmove",ka,!1),c.addEventListener("mousemove",na,!1),U&&document.exitPointerLock()},ma=function(a){a.preventDefault(),a.stopPropagation();var b,d,e;if(h.currentlyAnimating||Y)return h.endInteraction(),h.showPivot(!1),Y=!1,void la(!1);var j=f(a,g);if(h.viewCubeMenuOpen){var k=j.clientX-H.x,l=j.clientY-H.y;if(h.menuOrigin.x<=k&&k<=h.menuOrigin.x+h.menuSize.x&&h.menuOrigin.y<=l&&l<=h.menuOrigin.y+h.menuSize.y){var m=Math.floor((l-5-h.menuOrigin.y)/25),n=function(a){avp.logger.track({name:"navigation/"+a,aggregate:"count"})};switch(m){case 0:n("home"),h.goHome();break;case 1:n("setortho"),h.setOrthographicFaces(!1),h.toOrthographic(),g.camera=g.ocam;break;case 2:n("setpersp"),h.setOrthographicFaces(!1),h.toPerspective(),g.camera=g.pcam;break;case 3:h.setOrthographicFaces(!0),S?(h.toOrthographic(),g.camera=g.ocam):(h.toPerspective(),g.camera=g.pcam);break;case 4:n("sethome"),h.setCurrentViewAsHome(!1);break;case 5:n("focushome"),h.setCurrentViewAsHome(!0);break;case 6:n("resethome"),h.resetHome();break;case 7:n("setfront"),h.setCurrentViewAsFront();break;case 8:n("settop"),h.setCurrentViewAsTop();break;case 9:h.resetOrientation()}}return h.viewCubeMenuOpen=!1,h.removeDropdownMenu(c),(j.clientX<H.x||j.clientX>H.w+H.x||j.clientY<H.y||j.clientY>H.h+H.y)&&ea(),g.mouseMoveSave&&g.processMouseMove(g.mouseMoveSave),h.endInteraction(),void la(!1)}var o=h.navApi.getUseLeftHandedInput()?1:3;if(j.which===o)return h.viewCubeMenuOpen=!0,h.drawDropdownMenu(s,t,u,j.clientX,j.clientY,c,H),void la(!0);var q=ia(j,H);if(b=ha(q,g.camera,M),d=ha(q,p,J),e=ha(q,p,L),d.length>0&&S){var r=h.getOrientation();switch(g.currentFace){case"front":switch(r){case"up":d[0].object===J[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case"right":d[0].object===J[0]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case"down":d[0].object===J[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;case"left":d[0].object===J[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case"right":switch(r){case"up":d[0].object===J[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[2]?(h.calculateCubeTransform("back"),
g.currentFace="back"):d[0].object===J[3]&&(h.calculateCubeTransform("front"),g.currentFace="front");break;case"right":d[0].object===J[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case"down":d[0].object===J[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[3]&&(h.calculateCubeTransform("back"),g.currentFace="back");break;case"left":d[0].object===J[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case"left":switch(r){case"up":d[0].object===J[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[3]&&(h.calculateCubeTransform("back"),g.currentFace="back");break;case"right":d[0].object===J[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case"down":d[0].object===J[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[3]&&(h.calculateCubeTransform("front"),g.currentFace="front");break;case"left":d[0].object===J[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case"back":switch(r){case"up":d[0].object===J[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;case"right":d[0].object===J[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case"down":d[0].object===J[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):d[0].object===J[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case"left":d[0].object===J[0]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):d[0].object===J[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case"top":switch(r){case"up":d[0].object===J[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case"right":d[0].object===J[0]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[3]&&(h.calculateCubeTransform("back"),g.currentFace="back");break;case"down":d[0].object===J[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;case"left":d[0].object===J[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[3]&&(h.calculateCubeTransform("front"),g.currentFace="front")}break;case"bottom":switch(r){case"up":d[0].object===J[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case"right":d[0].object===J[0]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[3]&&(h.calculateCubeTransform("front"),g.currentFace="front");break;case"down":d[0].object===J[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):d[0].object===J[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;case"left":d[0].object===J[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):d[0].object===J[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):d[0].object===J[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):d[0].object===J[3]&&(h.calculateCubeTransform("back"),g.currentFace="back")}}h.elapsedTime=0,h.sphericallyInterpolateTransition()}if(e.length>0){if(h.elapsedTime=0,g.wantHomeButton&&e[0].object===L[F])return h.goHome(),void la(!1);if(g.wantContextMenu&&e[0].object===L[G])return h.viewCubeMenuOpen=!0,h.drawDropdownMenu(s,t,u,j.clientX,j.clientY,c,H),void la(!0);if(g.wantRollArrows&&S&&(e[0].object===L[C]||e[0].object===L[D])){var v=e[0].object===L[D],w={center:h.center.clone(),position:i.position.clone(),pivot:i.pivot.clone(),fov:i.fov,worldUp:h.sceneUpDirection.clone(),isOrtho:!1===i.isPerspective},x=h.center.clone().sub(i.position).normalize();v?w.up=i.up.clone().cross(x):(w.up=i.up.clone().multiplyScalar(-1),w.up.cross(x)),w.up.normalize(),h.elapsedTime=0,h.animateTransition(w)}}if(b.length>0){var y=b[0].object.name;g.mouseMoveSave=a,g.cubeRotateTo(y)}la(!1)};this.cubeRotateTo=function(a){g.currentFace=a,h.orthographicFaces&&-1!==g.currentFace.indexOf(",")&&h.setCameraOrtho(!1),h.calculateCubeTransform(g.currentFace),h.elapsedTime=0,h.sphericallyInterpolateTransition(function(){g.mouseMoveSave&&g.processMouseMove(g.mouseMoveSave)})},this.processMouseMove=function(a){var b,c,d;if(h.viewCubeMenuOpen||h.currentlyAnimating)return void(g.mouseMoveSave=a);g.mouseMoveSave=null;var e=f(a,g),i=ia(e,H);if(b=ha(i,g.camera,K),c=ha(i,p,J),d=ha(i,p,L),N&&!Y&&(N.material.color.setHex(14540253),N=null,requestAnimationFrame(g.render)),c.length>0&&!Y){N=c[0].object;for(var j=B.children.length;--j>=0;)if(N===J[j]){N=B.children[j],N.material.color.setHex(45055);break}requestAnimationFrame(g.render)}O&&!Y&&(O.material.opacity=0,O=null,requestAnimationFrame(g.render)),b.length>0&&!Y&&(O=b[0].object,O.material.opacity=.3,requestAnimationFrame(g.render)),d.length>0&&!Y?P!==d[0].object&&(g.wantHomeButton&&d[0].object===L[F]?(P=d[0].object,L[F].material.map=$[0]):g.wantRollArrows&&d[0].object===L[C]?(P=d[0].object,L[E].material.map=$[1]):g.wantRollArrows&&d[0].object===L[D]?(P=d[0].object,L[E].material.map=$[2]):g.wantContextMenu&&d[0].object===L[G]?(P=d[0].object,L[G].material.map=$[6]):g.wantHomeButton&&P===L[F]?(P=null,L[F].material.map=$[3]):!g.wantRollArrows||P!==L[C]&&P!==L[D]&&P!==L[E]?g.wantContextMenu&&P===L[G]&&(P=null,L[G].material.map=$[5]):(P=null,L[E].material.map=$[4]),requestAnimationFrame(g.render)):null===P||Y||(g.wantHomeButton&&P===L[F]?(P=null,L[F].material.map=$[3]):!g.wantRollArrows||P!==L[C]&&P!==L[D]&&P!==L[E]?g.wantContextMenu&&P===L[G]&&(P=null,L[G].material.map=$[5]):(P=null,L[E].material.map=$[4]),requestAnimationFrame(g.render))};var na=function(a){h.navApi.isActionEnabled("orbit")&&g.processMouseMove(a)},oa=function(){H=_(c),g.width=c.offsetWidth,g.height=c.offsetHeight,g.pcam.aspect=g.ocam.aspect=g.width/g.height,g.pcam.updateProjectionMatrix(),g.ocam.updateProjectionMatrix(),g.camera.topFov=g.camera.bottomFov=g.camera.fov/2,g.camera.leftFov=g.camera.rightFov=g.camera.aspect*g.camera.fov/2,g.pcam.aspect=g.ocam.aspect=g.camera.aspect,g.pcam.topFov=g.ocam.topFov=g.camera.topFov,g.pcam.bottomFov=g.ocam.bottomFov=g.camera.bottomFov,g.pcam.leftFov=g.ocam.leftFov=g.camera.leftFov,g.pcam.rightFov=g.ocam.rightFov=g.camera.rightFov,g.renderer.setSize(g.width,g.height),requestAnimationFrame(g.render)},pa=function(a,b){var c,d=new THREE.Geometry,e=new THREE.Vector3(0,0,0),f=new THREE.Vector3(60,-60,105),g=new THREE.Vector3(60,60,105),h=new THREE.Vector3(-60,60,105),i=new THREE.Vector3(-60,-60,105);return d.vertices.push(e),d.vertices.push(f),d.vertices.push(g),d.vertices.push(h),d.vertices.push(i),d.faces.push(new THREE.Face3(1,2,3)),d.faces.push(new THREE.Face3(1,3,4)),d.applyMatrix((new THREE.Matrix4).makeRotationX(a)),d.applyMatrix((new THREE.Matrix4).makeRotationY(b)),d.computeFaceNormals(),d.computeVertexNormals(),c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),new THREE.Mesh(d,c)},qa=function(a,b,c){var d,e=new THREE.Geometry,f=new THREE.Vector3(60,105,105),g=new THREE.Vector3(-60,105,105),h=new THREE.Vector3(-60,60,105),i=new THREE.Vector3(60,60,105),j=new THREE.Vector3(60,105,60),k=new THREE.Vector3(-60,105,60),l=new THREE.Vector3(-60,105,105),m=new THREE.Vector3(60,105,105);return e.vertices.push(f),e.vertices.push(g),e.vertices.push(h),e.vertices.push(i),e.vertices.push(j),e.vertices.push(k),e.vertices.push(l),e.vertices.push(m),e.faces.push(new THREE.Face3(0,1,2)),e.faces.push(new THREE.Face3(0,2,3)),e.faces.push(new THREE.Face3(4,5,6)),e.faces.push(new THREE.Face3(4,6,7)),e.applyMatrix((new THREE.Matrix4).makeRotationX(a)),e.applyMatrix((new THREE.Matrix4).makeRotationY(b)),e.applyMatrix((new THREE.Matrix4).makeRotationZ(c)),e.computeFaceNormals(),e.computeVertexNormals(),d=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),new THREE.Mesh(e,d)},ra=function(a,b){var c,d=new THREE.Geometry,e=new THREE.Vector3(105,105,105),f=new THREE.Vector3(60,105,105),g=new THREE.Vector3(60,60,105),h=new THREE.Vector3(105,60,105),i=new THREE.Vector3(105,105,60),j=new THREE.Vector3(105,105,105),k=new THREE.Vector3(105,60,105),l=new THREE.Vector3(105,60,60),m=new THREE.Vector3(105,105,105),n=new THREE.Vector3(105,105,60),o=new THREE.Vector3(60,105,60),p=new THREE.Vector3(60,105,105);return d.vertices.push(e),d.vertices.push(f),d.vertices.push(g),d.vertices.push(h),d.vertices.push(i),d.vertices.push(j),d.vertices.push(k),d.vertices.push(l),d.vertices.push(m),d.vertices.push(n),d.vertices.push(o),d.vertices.push(p),d.faces.push(new THREE.Face3(0,1,2)),d.faces.push(new THREE.Face3(0,2,3)),d.faces.push(new THREE.Face3(4,5,6)),d.faces.push(new THREE.Face3(4,6,7)),d.faces.push(new THREE.Face3(8,9,10)),d.faces.push(new THREE.Face3(8,10,11)),d.applyMatrix((new THREE.Matrix4).makeRotationX(a)),d.applyMatrix((new THREE.Matrix4).makeRotationY(b)),d.computeFaceNormals(),d.computeVertexNormals(),c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),new THREE.Mesh(d,c)},sa=function(a){var b=h.cubeFront.clone(),c=h.sceneUpDirection.clone(),d=b.clone().cross(c);c.copy(d).cross(b),b.normalize(),c.normalize(),d.normalize();var e=new THREE.Vector3(b.x,c.x,d.x).multiplyScalar(a.x);return e.add(new THREE.Vector3(b.y,c.y,d.y).multiplyScalar(a.y)),e.add(new THREE.Vector3(b.z,c.z,d.z).multiplyScalar(a.z)),e};this.render=function(){g.camera=i.isPerspective?g.pcam:g.ocam;var a=g.compass?g.viewScaleFactorCompass*g.viewScale:g.viewScale,b=h.center.clone().sub(i.position).normalize(),c=i.up.normalize(),d=new THREE.Matrix4;b=sa(b),c=sa(c),g.camera.position.copy(b),g.camera.position.multiplyScalar(-a/g.camera.position.length()),g.camera.up=c.normalize(),g.camera.lookAt(g.center),ta();var e=g.renderer;if(e){for(var f=0;f<v.length;f++)d.lookAt(g.camera.position,v[f].position,g.camera.up),v[f].setRotationFromMatrix(d);e.clear(),e.render(j,g.camera),e.render(k,g.camera),e.render(m,g.camera),g.renderTriad&&e.render(n,g.camera),e.render(l,g.camera),e.render(o,p)}};var ta=function(){S=h.isFaceView(),!S||Z||h.currentlyAnimating?ua():va(),Z?wa():xa(),Z?ya():za()},ua=function(){o.remove(B),L[E].material.opacity=0,L[G].material.opacity=0},va=function(){o.add(B);var a=g.wantRollArrows?1:0;L[E].material.opacity=a,L[G].material.opacity=a},wa=function(){A.material.opacity=av.isMobileDevice()?1:0},xa=function(){A.material.opacity=g.wantContextMenu?1:0},ya=function(){y.material.opacity=0},za=function(){y.material.opacity=g.wantHomeButton?1:0};this.refreshCube=function(){oa()},this.setSize=function(a,b){if(g.width=a,g.height=b,c.children.length>1)for(var d=1;d<c.children.length;d++)c.children[d].style.bottom=(g.height/5).toString()+"px";oa()},this.useTransparency=function(a){Z=a,a?(c.onmouseover=ca,c.onmousemove=da,c.onmouseout=ea,ea()):(c.onmouseover=null,c.onmouseout=null,c.onmousemove=null,c.style.opacity="1.0")},this.showTriad=function(a){a!==g.renderTriad&&(g.renderTriad=a,requestAnimationFrame(g.render))},this.dtor=function(){this.renderer=null},function(){var a=c.getBoundingClientRect();g.width=a.width,g.height=a.height,H=_(c),p=new THREE.PerspectiveCamera(70,g.height/g.width,1,1e4),p.position.set(0,0,500),j=new THREE.Scene,k=new THREE.Scene,l=new THREE.Scene,m=new THREE.Scene,o=new THREE.Scene,S=!0,Q=200,g.viewScale=3.5*Q;var e=THREE.LinearFilter,f=Autodesk.Viewing.Private.getResourceUrl,i="res/textures/",n=d||i,q=(new THREE.DDSLoader).load(f(n+"VCcrossRGBA8small.dds"));q.minFilter=q.maxFilter=e;var r=THREE.ShaderLib.cube,s=Autodesk.Viewing.Shaders.createShaderMaterial(r);s.depthWrite=!1,s.uniforms.tCube.value=q;var t=new THREE.BoxGeometry(Q,Q,Q,4,4,4),u=new THREE.BoxGeometry(Q+1,Q+1,Q+1,4,4,4);w=new THREE.Mesh(t,s),w.position.set(0,0,0),k.add(w);var v=fa(f(i+"VCedge1.png"));v.minFilter=v.maxFilter=e,x=new THREE.Mesh(u,new THREE.MeshBasicMaterial({map:v,overdraw:!1,transparent:!0,shading:THREE.SmoothShading})),x.position.set(0,0,0),m.add(x),ba(Q+20,b.getWorldUpVector());var I=Q,K=new THREE.Geometry,M=new THREE.Vector3(-30,0,0),N=new THREE.Vector3(30,0,0),O=new THREE.Vector3(0,-30,0);K.vertices.push(M),K.vertices.push(N),K.vertices.push(O),K.faces.push(new THREE.Face3(1,0,2)),K.computeFaceNormals();var P=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),R=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),U=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),V=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),W=new THREE.PlaneBufferGeometry(.5*Q,.3*Q,2,2),X=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),Y=new THREE.Mesh(K,P),Z=new THREE.Mesh(W,X);Y.position.set(0,I,0),Z.position.set(0,.9*I,.1);var ca=new THREE.Mesh(K,R),da=new THREE.Mesh(W,X);ca.position.set(0,-I,0),da.position.set(0,.9*-I,.1),ca.rotation.z+=Math.PI,da.rotation.z+=Math.PI;var ea=new THREE.Mesh(K,U),ha=new THREE.Mesh(W,X);ea.position.set(I,0,0),ha.position.set(.9*I,0,.1),ea.rotation.z-=Math.PI/2,ha.rotation.z-=Math.PI/2;var ia=new THREE.Mesh(K,V),ka=new THREE.Mesh(W,X);ia.position.set(-I,0,0),ka.position.set(.9*-I,0,.1),ia.rotation.z+=Math.PI/2,ka.rotation.z+=Math.PI/2,B=new THREE.Object3D,B.position.set(0,0,0),B.add(Y),B.add(ca),B.add(ea),B.add(ia),o.add(Z),o.add(da),o.add(ha),o.add(ka),o.add(B),J.push(Z),J.push(da),J.push(ha),J.push(ka);var la=new THREE.PlaneBufferGeometry(Q/3,Q/3,2,2),ma=new THREE.MeshBasicMaterial({map:fa(f(i+"VChome.png")),transparent:!0,shading:THREE.FlatShading});y=new THREE.Mesh(la,ma),y.position.set(-Q,Q,0),F=L.length,o.add(y),L.push(y);var oa=new THREE.PlaneBufferGeometry(1.5*Q,1.5*Q,2,2),pa=new THREE.MeshBasicMaterial({map:fa(f(i+"VCarrows.png")),shading:THREE.FlatShading,transparent:!0}),qa=new THREE.Mesh(oa,pa);qa.position.set(.5*Q+20,.5*Q+20,0);var ra=new THREE.PlaneBufferGeometry(.6*Q,.45*Q,2,2),sa=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),ta=new THREE.Mesh(ra,sa);ta.position.set(.5*Q+20,Q+20,.1);var ua=new THREE.PlaneBufferGeometry(.45*Q,.6*Q,2,2),va=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),wa=new THREE.Mesh(ua,va);wa.position.set(Q+20,.5*Q+20,.1),o.add(qa),o.add(ta),o.add(wa),C=L.length,L.push(ta),D=L.length,L.push(wa),E=L.length,L.push(qa);var xa=new THREE.PlaneBufferGeometry(Q/2.3,Q/2.3,2,2),ya=new THREE.MeshBasicMaterial({map:fa(f(i+"VCcontext.png")),transparent:!0,shading:THREE.FlatShading});A=new THREE.Mesh(xa,ya),A.position.set(Q,-Q,0),G=L.length,o.add(A),L.push(A);var za=new THREE.Geometry;za.vertices.push(new THREE.Vector3(0,0,0)),za.vertices.push(new THREE.Vector3(-Q/2,-Q/2-20,-Q/2)),za.vertices.push(new THREE.Vector3(Q/2,-Q/2-20,-Q/2)),za.vertices.push(new THREE.Vector3(Q/2,-Q/2-20,Q/2)),za.vertices.push(new THREE.Vector3(-Q/2,-Q/2-20,Q/2)),za.faces.push(new THREE.Face3(4,3,2)),za.faces.push(new THREE.Face3(4,2,1));var Aa;Aa=new THREE.MeshBasicMaterial({color:0,transparent:!0,opacity:.5}),z=new THREE.Mesh(za,Aa),j.add(z),ga(),"CANVAS"===h.renderer.toUpperCase()?g.renderer=new THREE.CanvasRenderer:"WEBGL"===h.renderer.toUpperCase()?g.renderer=new avp.FireflyWebGLRenderer({alpha:!0,antialias:!1}):(avp.logger.warn("Incorrect use of Autocam.renderer property"),g.renderer=new THREE.CanvasRenderer),g.useTransparency(!0),g.setSize(g.width,g.height),g.camera.topFov=g.camera.bottomFov=g.camera.fov/2,g.camera.leftFov=g.camera.rightFov=g.camera.aspect*g.camera.fov/2,g.pcam.topFov=g.ocam.topFov=g.camera.topFov,g.pcam.bottomFov=g.ocam.bottomFov=g.camera.bottomFov,g.pcam.leftFov=g.ocam.leftFov=g.camera.leftFov,g.pcam.rightFov=g.ocam.rightFov=g.camera.rightFov,g.renderer.autoClear=!1,g.renderer.setSize(g.width,g.height),g.renderer.sortObjects=!1,c.appendChild(g.renderer.domElement),c.addEventListener("touchstart",ja,!1),c.addEventListener("mousedown",ja,!1),c.addEventListener("mousemove",na,!1),T=!1,T&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,c.requestPointerLock=c.requestPointerLock||c.mozRequestPointerLock||c.webkitRequestPointerLock,document.addEventListener("pointerlockchange",aa,!1),document.addEventListener("mozpointerlockchange",aa,!1),document.addEventListener("webkitpointerlockchange",aa,!1)),$.push(fa(f(i+"VChomeS.png"))),$.push(fa(f(i+"VCarrowsS0.png"))),$.push(fa(f(i+"VCarrowsS1.png"))),$.push(fa(f(i+"VChome.png"))),$.push(fa(f(i+"VCarrows.png"))),$.push(fa(f(i+"VCcontext.png"))),$.push(fa(f(i+"VCcontextS.png")))}()},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.KeyCode={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,SEMICOLONMOZ:59,EQUALSMOZ:61,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,LCOMMAND:91,RCOMMAND:93,PLUS:107,PLUSMOZ:171,DASHMOZ:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,DASHMOZNEW:173,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222,COMMANDMOZ:224},Autodesk.Viewing.ToolController=function(a,b,c,d,e){function f(a){return a.getPriority instanceof Function&&a.getPriority()||0}function g(a,c){return b.navigation.getUseLeftHandedInput()&&0===a||k&&1===a||j&&!m&&0===a&&c.ctrlKey}var h=Autodesk.Viewing,i=Autodesk.Viewing.Private;this.domElement=b.canvasWrap,this.selector=a.selector,this.autocam=c,this.lastClickX=-1,this.lastClickY=-1,this.scrollInputEnabled=!0;var j=-1!=navigator.userAgent.search("Mac OS"),k=-1!=navigator.userAgent.search("Firefox"),l=-1!==navigator.userAgent.search("Chrome"),m=-1!==navigator.userAgent.search("Safari")&&!l,n={},o=[],p=!1,q=-1,r=-1,s=!1,t=null,u=null,v=!1,w={},x=this,y=Autodesk.Viewing.KeyCode;this.__registerToolByName=function(a,b){n[b]=a},this.registerTool=function(a){var b=a.getNames();if(!b||0==b.length)return i.logger.warn("Cannot register tool with no name."),!1;for(var c=!1,e=0;e<b.length;++e)"default"!==b[e]&&(this.__registerToolByName(a,b[e]),c=!0);return a.utilities=d,a.controller=this,a.register&&a.register(),c},this.deregisterTool=function(a){this.deactivateTool(a.getName());var b=a.getNames();if(!b||0==b.length)return!1;for(var c=b.length;--c>=0;)this.__deregisterToolName(b[c]);return a.deregister&&a.deregister(),a.utilities=null,a.controller=null,!0},this.__deregisterToolName=function(a){a in n&&(!function(a){for(var b=o.length;--b>=0;)o[b].activeName===a&&(n[a].deactivate(a),o.splice(b,1))}(a),delete n[a])},this.getTool=function(a){return n[a]},this.getActiveToolName=function(){var a=o.length;return a>0?o[a-1].activeName:"default"},this.getActiveTool=function(){var a=o.length;return a>0?o[a-1]:n.default},this.isToolActivated=function(a){for(var b=0;b<o.length;b++)if(o[b].activeName===a)return!0;return!1},this.setToolActiveName=function(a){var b=n[a];b&&(b.activeName=a)},this.activateTool=function(a){if(p)return!1;var c=n[a];if(c){void 0===c.count&&(c.count=0);var d=null;o.length&&"intercept"===o[o.length-1].activeName&&(d=o.pop());for(var e=0,g=0;g<o.length;g++)o[g]===c&&c.count++,f(o[g])<=f(c)&&(e=g+1);return c.activeName=a,0===c.count&&(c.count++,o.splice(e,0,c)),c.activate(a,b),d&&o.push(d),b.dispatchEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,toolName:a,tool:c,active:!0}),!0}return i.logger.warn("activateTool not found: "+a),!1},this.deactivateTool=function(a){if(p)return!1;for(var c=o.length;--c>=0;)if(o[c].activeName===a)return 1===n[a].count&&o.splice(c,1),n[a].count--,n[a].deactivate(a),b.dispatchEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,toolName:a,tool:o[c],active:!1}),!0;return i.logger.warn("deactivateTool not found: "+a),!1},this.getToolNames=function(){return Object.keys(n)},this.setDefaultTool=function(a){var b=this.getDefaultTool();return!(!a||a===b)&&(this.__registerToolByName(a,"default"),b&&b.deactivate("default"),a.activate("default"),!0)},this.getDefaultTool=function(){return n.default},this.setDefaultTool(e),this.setIsLocked=function(a){var b=p;return p=!!a,b},this.getIsLocked=function(){return p},this.__checkCursor=function(){for(var a=null,c=o.length;--c>=0;){var d=o[c];if(d.getCursor&&(a=d.getCursor()))break}a||(a="auto"),t!=a&&(b.canvas.style.cursor=a,t=a)},this.update=function(a){this.__checkCursor();var c=!1;d&&d.update()&&(c=!0);for(var e=o.length;--e>=0;){var f=o[e];f.update&&f.update(a)&&(c=!0)}if(b.navigation.getCamera().dirty?(b.navigation.updateCamera(),c=!0,this.cameraUpdated=!0):this.cameraUpdated=!1,c)b.navigation.updateCamera(),this.moveDelay=Date.now()+150;else if(0!==this.moveDelay){var g=this.moveDelay-Date.now();g>0?c=!0:this.moveDelay=0}return c},this.__clientToCanvasCoords=function(b,c,d){var e=a.getCanvasBoundingClientRect(),f=e.width,g=e.height,h=b.clientX-e.left,i=b.clientY-e.top;b.canvasX=h,b.canvasY=i,b.normalizedX=h/f*2-1,b.normalizedY=(g-i)/g*2-1,c&&c.set(h/f,i/g,0),d&&d.set(h,i)},this.__invokeStack=function(a,b,c){for(var d=o.length;--d>=0;){var e=o[d];if(e[a]&&e[a](b,c))return!0}var f=this.getDefaultTool();return!(!f[a]||!f[a](b,c))},this.distributeEvent=function(a,b,c){return this.__invokeStack(a,b,c)},this.handleResize=function(){b.navigation.setScreenViewport(b.container.getBoundingClientRect());for(var a=o.length;--a>=0;){var c=o[a];c.handleResize&&c.handleResize()}},this.handleSingleClick=function(a){var b=this.applyButtonMappings(a);this.lastClickX=a.clientX,this.lastClickY=a.clientY,this.__invokeStack("handleSingleClick",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleDoubleClick=function(a){var b=this.applyButtonMappings(a);this.__invokeStack("handleDoubleClick",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleSingleTap=function(a){this.lastClickX=a.canvasX,this.lastClickY=a.canvasY,this.__invokeStack("handleSingleTap",a)&&(a.preventDefault(),a.stopPropagation())},this.handleDoubleTap=function(a){this.lastClickX=a.canvasX,this.lastClickY=a.canvasY,this.__invokeStack("handleDoubleTap",a)&&(a.preventDefault(),a.stopPropagation())},this.handleWheelInput=function(a,b){this.__invokeStack("handleWheelInput",a)&&(b.preventDefault(),b.stopPropagation())},this.applyButtonMappings=function(a){var c=a.button;return"buttons"in a&&(a.firefoxSpoof?c=0:!s||1&a.buttons?2===c&&1&a.buttons&&(c=0,a.firefoxSpoof=s=!0):(a.firefoxSpoof=!0,s=!1,c=0)),b.navigation.getUseLeftHandedInput()&&(c=0===c?2:2===c?0:c),c},this.applyKeyMappings=function(a,b){switch(a.keyCode){case y.LCOMMAND:case y.RCOMMAND:case y.COMMANDMOZ:return j&&a.metaKey&&a.shiftKey?null:y.CONTROL;case y.SHIFT:return b&&j&&a.metaKey?null:y.SHIFT;case y.EQUALSMOZ:return y.EQUALS;case y.DASHMOZNEW:case y.DASHMOZ:return y.DASH}return a.keyCode},this.handleKeyDown=function(a){var b=this.applyKeyMappings(a,!0);b&&this.__invokeStack("handleKeyDown",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleKeyUp=function(a){var b=this.applyKeyMappings(a,!0);b&&this.__invokeStack("handleKeyUp",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleButtonDown=function(a,b){this.__invokeStack("handleButtonDown",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleButtonUp=function(a,b){this.__invokeStack("handleButtonUp",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleMouseMove=function(a){this.__invokeStack("handleMouseMove",a)&&(a.preventDefault(),a.stopPropagation())},this.handleBlur=function(a){this.__invokeStack("handleBlur",a)&&(a.preventDefault(),a.stopPropagation())},this.keydown=function(a){if((!u||x.domElement.contains(u))&&!(document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||document.activeElement instanceof HTMLSelectElement)){if(document.activeElement){var b=document.activeElement.getAttribute("contenteditable");if("true"===b||""===b)return}j&&a.metaKey&&a.keyCode!=y.LCOMMAND&&a.keyCode!=y.RCOMMAND||x.handleKeyDown(a)}},this.keyup=function(a){j&&a.metaKey&&a.keyCode!=y.LCOMMAND&&a.keyCode!=y.RCOMMAND||x.handleKeyUp(a)},this.mousedown=function(a){function b(a){x.applyButtonMappings(a)===c&&(document.removeEventListener("mouseup",b),x.mouseup(a))}h.isIE11&&h.inFullscreen()||document.activeElement&&document.activeElement.blur&&document.activeElement.blur(),x.__clientToCanvasCoords(a);var c=x.applyButtonMappings(a);if(x.handleButtonDown(a,c),q=a.canvasX,r=a.canvasY,g(c,a)){var d=w,e=void 0!==d.time&&a.timeStamp-d.time<500,f=void 0!==d.x&&void 0!==d.y&&Math.abs(d.x-a.canvasX)<=2&&Math.abs(d.y-a.canvasY)<=2;(!e||!f||d.clickCount&&2<=d.clickCount)&&(d.clickCount=0),d.clickCount?1===d.clickCount&&(d.clickCount=2):(d.clickCount=1,d.x=a.canvasX,d.y=a.canvasY,d.time=a.timeStamp)}document.addEventListener("mouseup",b,!1),x.registerWindowMouseMove()},this.mousemove=function(a){x.__clientToCanvasCoords(a);var b=q-a.canvasX,c=r-a.canvasY;(Math.abs(b)>2||Math.abs(c)>2)&&(q=-1,r=-1),x.handleMouseMove(a)},this.mouseup=function(a){x.__clientToCanvasCoords(a);var b=x.applyButtonMappings(a);x.handleButtonUp(a,b);var c=q-a.canvasX,d=r-a.canvasY;if(q=-1,r=-1,Math.abs(c)<=2&&Math.abs(d)<=2&&x.handleSingleClick(a),g(b,a)){var e=w;2===e.clickCount&&(x.handleDoubleClick(a),e.clickCount=0,e.x=void 0,e.y=void 0,e.time=void 0)}x.unregisterWindowMouseMove()},this.doubleclick=function(a){x.__clientToCanvasCoords(a),q=a.canvasX,r=a.canvasY,x.handleDoubleClick(a)},this.mousewheel=function(a){if(x.scrollInputEnabled){var b=0;if(a.wheelDelta)b=a.wheelDelta/40;else if(a.detail)b=-a.detail;else if(a.deltaY){var c=k?1:40;b=-a.deltaY/c}x.handleWheelInput(b,a)}},this.blur=function(a){x.handleBlur(a)},this.mouseover=function(a){u=a.target},this.registerWindowMouseMove=function(){window.addEventListener("mousemove",x.mousemove),window.addEventListener("mouseover",x.mouseover),x.domElement.removeEventListener("mousemove",x.mousemove),x.domElement.removeEventListener("mouseover",x.mouseover)},this.unregisterWindowMouseMove=function(){window.removeEventListener("mousemove",x.mousemove),window.removeEventListener("mouseover",x.mouseover),x.domElement.addEventListener("mousemove",x.mousemove),x.domElement.addEventListener("mouseover",x.mouseover)},this.enableMouseButtons=function(a){a&&!v?(this.domElement.addEventListener("mousedown",this.mousedown),this.domElement.addEventListener("dblclick",this.doubleclick),this.domElement.addEventListener("mousemove",this.mousemove),this.domElement.addEventListener("mouseover",this.mouseover)):!a&&v&&(this.domElement.removeEventListener("mousedown",this.mousedown),this.domElement.removeEventListener("dblclick",this.doubleclick),this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover));var b=v;return v=a,b},this.domElement.addEventListener("mousewheel",this.mousewheel,!1),this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,!1),window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1),window.addEventListener("blur",this.blur,!1),this.uninitialize=function(){for(v&&(this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover),window.removeEventListener("mousemove",x.mousemove),window.removeEventListener("mouseover",x.mouseover)),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup),window.removeEventListener("blur",this.blur),this.domElement=null,this.selector=null,this.autocam=null;o.length>0;)this.deactivateTool(o[o.length-1].activeName);n=null,o=null,x=null,d=null,b=null,a=null,u=null},this.set2DMode=function(a){},this.setAutocam=function(a){},this.syncCamera=function(){},this.recordHomeView=function(){var a=b.navigation.getCamera();c.sync(a),c.setHomeViewFrom(a)},this.setMouseWheelInputEnabled=function(a){this.scrollInputEnabled=a}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.ViewingUtilities=function(a,b,c){function d(a){var b=.6,c=0,d=new THREE.SphereGeometry(1),e=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:b,transparent:!0}),f=new THREE.Mesh(d,e),g=a,h=1;g.createOverlayScene("pivot"),f.visible=!1,this.shown=function(){return f.visible},this.show=function(a,d,i){f.scale.x=d*h,f.scale.y=d*h,f.scale.z=d*h,f.position.set(a.x,a.y,a.z),e.opacity=b,f.visible=!0,g.addOverlay("pivot",f),g.invalidate(!1,!1,!0),c=i?Date.now()+500:0},this.hide=function(){f.visible&&(f.visible=!1,g.removeOverlay("pivot",f),g.invalidate(!1,!1,!0),c=0)},this.fade=function(){if(c>0){var a=c-Date.now();if(a<=0)return this.hide(),!0;var d=a/500*b;return e.opacity=d,!0}return!1},this.fading=function(){return c>0},this.setSize=function(a){h=a},this.setColor=function(a,c){e.color=new THREE.Color(a),void 0!==c&&(b=c,e.opacity=b)}}function e(a,b,c){var d=b.clone().sub(a)
;if(0===d.lengthSq())return d.copy(c);var e=d.clone().cross(c);return 0===e.lengthSq()&&(c.z>c.y?d.y-=1e-4:d.z-=1e-4,e.crossVectors(d,c)),e.cross(d).normalize()}this.autocam=b,this.viewerImpl=a;var f=c.getCamera(),g={},h={},i=new d(this.viewerImpl);this.transitionView=function(a,d,g,h,i,j,k){i=i||c.getWorldUpVector();var l=j?e(a,d,i):h;l||(l=f.up),k=k||d;var m={position:a,center:d,pivot:k,fov:g,up:l,worldUp:i,isOrtho:!1===f.isPerspective};b.goToView(m)},this.goHome=function(){this.viewerImpl.track({name:"navigation/home",aggregate:"count"}),b.goHome()},this.getHitPoint=function(a,b){b=1-b,a=2*a-1,b=2*b-1;var c=new THREE.Vector3(a,b,1),d=this.viewerImpl.hitTestViewport(c,!1);return d?d.intersectPoint:null},this.activatePivot=function(a){if(this.viewerImpl.model&&!this.viewerImpl.model.is2d()){var b=f.isPerspective?c.getPivotPlaneDistance():c.getEyeVector().length(),d=c.getVerticalFov(),e=2*b*Math.tan(THREE.Math.degToRad(.5*d)),g=c.getScreenViewport(),h=window.devicePixelRatio||1,j=5*e/(g.height*h);i.show(c.getPivotPoint(),j,a)}},this.pivotActive=function(a,b){if(a=a&&!c.getIs2D(),b=b||!1,!a&&i.shown())return void i.hide();a&&this.activatePivot(b)},this.pivotUpdate=function(){i.shown()&&i.fade()&&this.viewerImpl.invalidate(!1,!1,!0)},this.setPivotPoint=function(a,b,d){c.setPivotPoint(a),b||c.setTarget(a),d&&c.setPivotSetFlag(!0),this.setTemporaryPivot(null),c.getIs2D()||i.shown()&&this.activatePivot(i.fading())},this.savePivot=function(a){a||(a="default"),g[a]=c.getPivotPoint(),h[a]=c.getPivotSetFlag()},this.restorePivot=function(a){if(a||(a="default"),g[a]){var b=h[a];this.setPivotPoint(g[a],!0,b),b||c.setPivotSetFlag(!1),delete g[a],delete h[a]}},this.setTemporaryPivot=function(a){if(a){var b=c.getPivotPoint(),d=c.getPivotSetFlag();this.setPivotPoint(a,!0,d),g.TEMP=b,h.TEMP=d}else delete g.TEMP,delete h.TEMP},this.removeTemporaryPivot=function(){this.restorePivot("TEMP")},this.setPivotSize=function(a){i.setSize(a)},this.setPivotColor=function(a,b){i.setColor(a,b)},this.getBoundingBox=function(a){return this.viewerImpl.getFitBounds(a)},this.fitToView=function(a){this.viewerImpl.track({name:"navigation/fit",aggregate:"count"}),this.viewerImpl.fitToView(this.viewerImpl.selector.getAggregateSelection(),a),this.activatePivot(!0)},this.update=function(){c.getRequestFitToView()&&!c.getTransitionActive()&&(c.setRequestFitToView(!1),this.fitToView()),c.getRequestHomeView()&&!c.getTransitionActive()&&(c.setRequestHomeView(!1),this.goHome());var a=c.getRequestTransition();return a&&!c.getTransitionActive()&&(c.setRequestTransition(!1),this.transitionView(a.position,a.coi,a.fov,a.up,a.worldUp,a.reorient,a.pivot)),!1}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.DefaultHandler=function(a,b,c){this.clickConfig=null,this.getNames=function(){return["default"]},this.getName=function(){return this.getNames()[0]},this.setClickBehavior=function(a){this.clickConfig=a},this.getClickBehavior=function(){return this.clickConfig},this.activate=function(a){},this.deactivate=function(a){},this.handleAction=function(b,d){for(var e=0;e<b.length;++e)switch(b[e]){case"selectOnly":a.selector&&d&&a.selector.setSelection([d.dbId],d.model);break;case"deselectAll":a.selector&&a.selector.setSelection([]);break;case"selectToggle":a.selector&&d&&a.selector.toggleSelection(d.dbId,d.model);break;case"isolate":d&&a.isolate(d.dbId);break;case"showAll":a.showAll();break;case"setCOI":d&&d.intersectPoint&&(c.setPivotPoint(d.intersectPoint,!0,!0),c.pivotActive(!0,!0));break;case"hide":d&&a.hide(d.dbId);break;case"show":d&&a.show(d.dbId);break;case"toggleVisibility":d&&a.toggleVisibility(d.dbId);break;case"focus":a.selector&&(d?a.selector.setSelection([d.dbId],d.model):a.selector.setSelection([]),c.fitToView())}},this.handleSingleClick=function(b,d){var e=b.ctrlKey||b.metaKey,f=b.shiftKey,g=b.altKey;if(0===d){var h=new THREE.Vector3(b.normalizedX,b.normalizedY,1),i=a.hitTestViewport(h,!1),j="click";e&&(j+="Ctrl"),f&&(j+="Shift"),g&&(j+="Alt");var k=i?"onObject":"offObject";if(this.clickConfig&&this.clickConfig[j]&&this.clickConfig[j][k])return this.handleAction(this.clickConfig[j][k],i),!0}else if(1===d&&f&&!g&&!e){var h=new THREE.Vector3(b.normalizedX,b.normalizedY,1),i=a.hitTestViewport(h,!1);if(i&&i.intersectPoint)return c.setPivotPoint(i.intersectPoint,!0,!0),c.pivotActive(!0,!0),!0}return!1},this.handleDoubleClick=function(d,e){if(a.selector&&0===e){var f=new THREE.Vector3(d.normalizedX,d.normalizedY,1),g=a.hitTestViewport(f,!1);return g?a.selector.setSelection([g.dbId],g.model):a.selector.clearSelection(),c.fitToView(),!0}return 1===e&&(b.fitBounds(!1,c.getBoundingBox(!0)),b.setPivotSetFlag(!1),!0)},this.handleSingleTap=function(c){if(c.clientX=c.pointers[0].clientX,c.clientY=c.pointers[0].clientY,a.api.triggerSingleTapCallback(c),c.hasOwnProperty("pointers")&&2===c.pointers.length)return b.setRequestHomeView(!0),!0;if(a.selector){var d=new THREE.Vector3(c.normalizedX,c.normalizedY,1),e=a.hitTestViewport(d,!1);return e?(a.selector.setSelection([e.dbId],e.model),a.api.triggerSelectionChanged([e.dbId])):(a.selector.clearSelection(),a.api.triggerSelectionChanged(null)),!0}return!1},this.handleDoubleTap=function(b){b.clientX=b.pointers[0].clientX,b.clientY=b.pointers[0].clientY,a.api.triggerDoubleTapCallback(b);var d=this.handleSingleTap(b,0);return c.fitToView(),d},this.handlePressHold=function(b){return"press"===b.type&&(b.clientX=b.pointers[0].clientX,b.clientY=b.pointers[0].clientY,a.api.triggerContextMenu(b))}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.GestureRecognizers={singletap:[Hammer.Tap,{event:"singletap",threshold:7,time:400}],singletap2:[Hammer.Tap,{event:"singletap2",pointers:2,threshold:7,time:400}],press:[Hammer.Press,{event:"press",time:500,threshold:50}],doubletap:[Hammer.Tap,{event:"doubletap",taps:2,interval:300,threshold:6,posThreshold:30}],doubletap2:[Hammer.Tap,{event:"doubletap2",pointers:2,taps:2,interval:300,threshold:6,posThreshold:40}],drag:[Hammer.Pan,{event:"drag",pointers:1}],drag3:[Hammer.Pan,{event:"drag3",pointers:3,threshold:15}],pan:[Hammer.Pan,{event:"pan",pointers:2,threshold:20}],pinch:[Hammer.Pinch,{event:"pinch",pointers:2,enable:!0,threshold:.05}],rotate:[Hammer.Rotate,{event:"rotate",pointers:2,enable:!0,threshold:7}]},Autodesk.Viewing.GestureHandler=function(a){var b=Autodesk.Viewing,c=a.navigation,d=["gestures"],e=this,f=!0,g=!0,h=null,i=!1,j=b.isTouchDevice();c.setIsTouchDevice(j),j&&(h=new Hammer.Manager(a.canvasWrap,{recognizers:[b.GestureRecognizers.drag,b.GestureRecognizers.doubletap,b.GestureRecognizers.doubletap2,b.GestureRecognizers.singletap,b.GestureRecognizers.singletap2,b.GestureRecognizers.press,b.GestureRecognizers.drag3,b.GestureRecognizers.pan,b.GestureRecognizers.pinch,b.GestureRecognizers.rotate],inputClass:b.isIE11?Hammer.PointerEventInput:Hammer.TouchInput}),h.get("pinch").recognizeWith([h.get("drag")]),a.canvasWrap.addEventListener("touchstart",this.onTouchStart,!1)),this.onTouchStart=function(a){a.preventDefault()},this.getNames=function(){return d},this.getName=function(){return d[0]},this.isActive=function(){return i},this.__clientToCanvasCoords=function(b){var c,d,e=a.impl.getCanvasBoundingClientRect(),f=e.width,g=e.height;b.hasOwnProperty("center")?(c=b.center.x-e.left,d=b.center.y-e.top):(c=b.pointers[0].clientX-e.left,d=b.pointers[0].clientY-e.top),b.canvasX=c,b.canvasY=d,b.normalizedX=c/f*2-1,b.normalizedY=(g-d)/g*2-1},this.distributeGesture=function(a){e.__clientToCanvasCoords(a),e.controller.distributeEvent("handleGesture",a)&&a.preventDefault()},this.onSingleTap=function(a){e.__clientToCanvasCoords(a),e.controller.distributeEvent("handleSingleTap",a)&&a.preventDefault()},this.onDoubleTap=function(a){e.__clientToCanvasCoords(a),e.controller.distributeEvent("handleDoubleTap",a)&&a.preventDefault()},this.onPressHold=function(a){e.__clientToCanvasCoords(a),e.controller.distributeEvent("handlePressHold",a)&&a.preventDefault()},this.onHammerInput=function(a){e.setMouseDisabledWhenTouching(a)},this.setMouseDisabledWhenTouching=function(a){a.isFirst?f=e.controller.enableMouseButtons(!1):a.isFinal&&setTimeout(function(){e.controller.enableMouseButtons(f)},10)},this.activate=function(a){h&&!i&&(h.on("dragstart dragmove dragend",this.distributeGesture),h.on("singletap",this.onSingleTap),h.on("singletap2",this.onSingleTap),h.on("doubletap",this.onDoubleTap),h.on("doubletap2",this.onDoubleTap),h.on("press pressup",this.onPressHold),h.on("drag3start drag3move drag3end",this.distributeGesture),g&&(h.on("panstart panmove panend",this.distributeGesture),h.on("pinchstart pinchmove pinchend",this.distributeGesture),h.on("rotatestart rotatemove rotateend",this.distributeGesture)),h.on("hammer.input",this.onHammerInput),h.get("doubletap2").recognizeWith("doubletap"),h.get("singletap2").recognizeWith("singletap"),h.get("singletap").requireFailure("doubletap")),i=!0},this.deactivate=function(a){h&&i&&(h.off("dragstart dragmove dragend",this.distributeGesture),h.off("singletap",this.onSingleTap),h.off("singletap2",this.onSingleTap),h.off("doubletap",this.onDoubleTap),h.off("doubletap2",this.onDoubleTap),h.off("press pressup",this.onPressHold),h.off("drag3start drag3move drag3end",this.distributeGesture),g&&(h.off("panstart panmove panend",this.distributeGesture),h.off("pinchstart pinchmove pinchend",this.distributeGesture),h.off("rotatestart rotatemove rotateend",this.distributeGesture)),h.off("hammer.input",this.onHammerInput)),i=!1},this.update=function(){return!1},this.handleBlur=function(a){return!1},this.disableTwoFingerSwipe=function(){g=!1,h&&(h.remove(Hammer.Pan),h.remove(Hammer.Pinch),h.remove(Hammer.Rotate),h.off("panstart panmove panend",this.distributeGesture),h.off("pinchstart pinchmove pinchend",this.distributeGesture),h.off("rotatestart rotatemove rotateend",this.distributeGesture))}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.OrbitDollyPanTool=function(a,b){function c(){var a=da;return K===J&&!a.SHIFT&&!(a.ALT^a.CONTROL)||K===J&&a.SHIFT&&a.CONTROL||K===I&&!a.SHIFT&&!a.CONTROL||K===I&&a.ALT||K===I&&a.CONTROL&&!a.ALT||K===H&&a.SHIFT&&!a.CONTROL&&!a.ALT||"pan"===v&&K!==I&&!a.ALT&&!("pinch"===w)||a.SPACE}function d(){var a=da;return K===J&&a.SHIFT&&!a.ALT&&!a.CONTROL||K===J&&a.ALT&&!a.SHIFT&&!a.CONTROL||"dolly"===v&&!a.ALT&&!("pinch"===w)}function e(){var a=da;return!(a.CONTROL||a.ALT||a.SHIFT||K!==J&&K!==I)}function f(){var a=q.getCamera().near,b=a>0?q.getPosition():q.getEyeVector().normalize().multiplyScalar(a).add(q.getPosition());return q.getPivotPoint().sub(b).dot(q.getEyeVector())<=0}function g(a,b){var c={left:0,top:0,width:window.innerWidth,height:window.innerHeight};Y.set((a-.5*c.width-c.left)/(.5*c.width),(.5*c.height+c.top-b)/(.5*c.height),0);var d=Y.length();return _?d<Math.SQRT1_2?Y.z=Math.sqrt(1-d*d):Y.z=.5/d:d>1?Y.normalize():Y.z=Math.sqrt(1-d*d),U.copy(r.position).sub(r.pivot),W.copy(r.up).setLength(Y.y),W.add(X.copy(r.up).cross(U).setLength(Y.x)),W.add(U.setLength(Y.z)),W}function h(){if(q.isActionEnabled("orbit")){U.subVectors(r.position,r.pivot),V.subVectors(r.position,r.target);var a=V.length();V.normalize();var b=Math.acos(S.dot(T)/S.length()/T.length());b&&(b*=o,Z.crossVectors(S,T).normalize(),$.setFromAxisAngle(Z,-b),U.applyQuaternion($),r.up.applyQuaternion($),T.applyQuaternion($),V.applyQuaternion($),aa?S.copy(T):($.setFromAxisAngle(Z,b*(ba-1)),S.applyQuaternion($))),r.position.addVectors(r.pivot,U),r.target.subVectors(r.position,V.multiplyScalar(a)),r.dirty=!0}}function i(a,b){return-1!==a.indexOf(b,a.length-b.length)}function j(a){var b=a.pointers[1].clientX-a.pointers[0].clientX,c=a.pointers[1].clientY-a.pointers[0].clientY;return Math.sqrt(b*b+c*c)}var k,l,m,n=(Autodesk.Viewing.Private,this),o=2,p=-1!=navigator.userAgent.search("Mac OS"),q=b.navigation,r=q.getCamera(),s=["orbit","freeorbit","dolly","pan"],t=s[0],u=[t],v=t,w=null,x=1,y=1,z=0,A=0,B=0,C=0,D=!1,E=null,F=!1,G={SHIFT:16,CONTROL:17,ALT:18,SPACE:32,PAGEUP:33,PAGEDOWN:34,LEFT:37,UP:38,RIGHT:39,DOWN:40,ZERO:48,EQUALS:187,DASH:189},H=0,I=1,J=2,K=-5,L=new THREE.Vector3,M=new THREE.Vector3,N=new THREE.Vector2,O=new THREE.Vector2,P=new THREE.Vector2,Q=new THREE.Vector2,R=new THREE.Vector3,S=new THREE.Vector3,T=new THREE.Vector3,U=new THREE.Vector3,V=new THREE.Vector3,W=new THREE.Vector3,X=new THREE.Vector3,Y=new THREE.Vector3,Z=new THREE.Vector3,$=new THREE.Quaternion,_=!1,aa=!0,ba=.2,ca=[!1,!1,!1,!1,!1,!1],da={SHIFT:0,ALT:0,CONTROL:0,SPACE:0},ea=function(b){a.renderer().rolloverObjectId(0,null,0)},fa=1,ga=5,ha=.025;this.getNames=function(){return s},this.getName=function(){return s[0]},this.activate=function(b){u.push(b),v=b,a.canvas.addEventListener("mouseout",ea)},this.deactivate=function(b){var c=u.length-1;c>0&&u[c]===b&&(u.pop(),v=u[c-1]),0===u.length&&a.canvas.removeEventListener("mouseout",ea)},this.adjustDollyLookSpeed=function(a){0===a?(ha=.025,ga=5):(ha*=a>0?1.1:.9,ga*=a>0?1.1:.9,ha<1e-6&&(ha=1e-6),ga<1e-6&&(ga=1e-6))},this.getDollySpeed=function(a){var b=q.getEyeVector(),c=q.getPosition(),d=a.clone().sub(c).dot(b.normalize()),e=d*ha;return Math.abs(e)<.01?e<0?-.01:.01:e},this.getLookSpeed=function(){return ga},this.coiIsActive=function(){return q.getPivotSetFlag()&&q.isPointVisible(q.getPivotPoint())},this.adjustSpeed=function(a){this.adjustDollyLookSpeed(a),this.utilities.autocam&&(this.utilities.autocam.orbitMultiplier=this.getLookSpeed())},this.getTriggeredMode=function(){return K===I&&da.SHIFT?u[1]:d()||0!==R.z?e()?"pan":"dolly":c()?"pan":"pan"===w||"pinch"===w?"dollypan":v},this.initTracking=function(a,b){var c;if(r.isPerspective){c=.5*(r.near+r.far);var d=this.utilities.getHitPoint(a,b),e=q.getPosition();if(d&&d.sub){var f=d.sub(e),g=q.getEyeVector().normalize();c=Math.abs(g.dot(f))}else{if(q.getPivotSetFlag()&&q.isPointVisible(q.getPivotPoint())){var h=q.getPivotPlaneDistance();h>1e-5&&(c=h)}}}else c=q.getEyeVector().length();fa=c},this.initOrbit=function(){this.utilities.setTemporaryPivot(f()?q.getTarget():null)},this.getActiveMode=function(){return t},this.getCursor=function(){switch(t){case"freeorbit":case"orbit":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto";case"dolly":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), auto";case"pan":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC), auto"}return null},this.getMotionDelta=function(a,b){var c=q&&q.getReverseZoomDirection()?-1.5:1.5;p&&(c*=-1),ca[0]&&(M.x+=.01,P.x+=20),ca[1]&&(M.x-=.01,P.x-=20),ca[2]&&(M.y+=.01,P.y+=20),ca[3]&&(M.y-=.01,P.y-=20),ca[4]&&(M.z+=c),ca[5]&&(M.z-=c);var d=M.x-L.x,e=M.y-L.y,f=M.z-L.z;Math.abs(d)<.001&&(d=0),Math.abs(e)<.001&&(e=0),Math.abs(f)<.001&&(f=0),a.set(d,e,f),b&&b.set(P.x-O.x,P.y-O.y)},this.stepMotionDelta=function(a,b){b?(L.x+=.6*a.x,L.y+=.6*a.y,L.z+=.6*a.z):L.copy(M),O.copy(P)},this.getFitBounds=function(){return this.utilities.viewerImpl.zoomBoundsChanged&&(m=this.utilities.viewerImpl.getVisibleBounds(!0),this.utilities.viewerImpl.zoomBoundsChanged=!1),m},this.update=function(){var a,c=!1,d=!1;this.getMotionDelta(R,Q);var e=R.x,f=R.y,g=R.z;if(D||this.checkInteractionMode(),D=K>-1,D&&this.controller.setIsLocked(!0),0!==e||0!==f||0!==g){switch(t){case"orbit":this.utilities.autocam&&this.utilities.autocam.startState&&(Q.x=-Q.x,E&&this.utilities.autocam.orbit(P,E,Q.multiplyScalar(o),this.utilities.autocam.startState));break;case"freeorbit":h();break;case"dolly":var i,j,m;g*=.6,K>=H?(f=-f,g=Math.abs(e)>Math.abs(f)?e:f,q.getReverseZoomDirection()&&(g*=-1),g*=100,e=0,f=0,j=m=.5):(a=q.getScreenViewport(),k&&l?(j=k/a.width,m=l/a.height):j=m=.5),i=!q.getIs2D()&&q.getZoomTowardsPivot()?this.coiIsActive()?q.getPivotPoint():q.getWorldPoint(.5,.5):q.getWorldPoint(j,m),q.dollyFromPoint(g*this.getDollySpeed(i),i,this.getFitBounds());break;case"pan":q.panRelative(-e,f,fa);break;case"dollypan":0===e&&0===f||q.panRelative(-e,f,fa),a=q.getScreenViewport(),j=k/a.width,m=l/a.height,i=q.getWorldPoint(j,m);var n=q.getPosition(),p=q.getIs2D()?n.sub(i).length():fa,u=z/A-1,v=u*p;q.dollyFromPoint(v,i,this.getFitBounds());var C=new THREE.Vector3,G=new THREE.Quaternion,I=q.getCameraUpVector(),J=C.copy(r.position).sub(r.target).normalize();G.setFromAxisAngle(J,1.2*B),I.applyQuaternion(G),q.getIs2D()||q.setCameraUpVector(I),z=A,y=x,fa=p+v}d=!0}return this.stepMotionDelta(R,"pan"!==t&&"dollypan"!==t),-1===K&&Math.abs(g)<1e-5&&(this.interactionEnd(-1),c=!0,d=!0),(da.SHIFT||da.ALT)&&-1!==s.indexOf(b.getActiveNavigationTool())&&(d=!0),!F&&(c||K>-5)&&(K>-1&&(L.copy(M),this.utilities.removeTemporaryPivot()),this.utilities.autocam.endInteraction(),K=-5,D&&this.controller.setIsLocked(!1),D=!1,E=null,w=null),d?this.utilities.pivotActive(q.getPivotSetFlag(),K<=-1):this.utilities.pivotUpdate(),r.dirty},this.checkInteractionMode=function(){var a=this.getTriggeredMode();a!==t&&("pan"===(t=a)&&K>-1||"dollypan"===t)&&this.initTracking(L.x,L.y)},this.interactionStart=function(a,b){(b||a>K)&&(K=a,F=!0,a>-1&&("pan"===t&&this.initTracking(L.x,L.y),"orbit"===t&&this.initOrbit()),this.utilities.pivotActive(q.getPivotSetFlag(),-1===a),this.utilities.autocam&&(this.utilities.autocam.sync(r),this.utilities.autocam.startInteraction(O.x,O.y),E=O.clone()))},this.interactionCheck=function(){(ca[0]||ca[1]||ca[2]||ca[3]||ca[4]||ca[5]||da.SHIFT||da.CONTROL||da.ALT||da.SPACE)&&this.interactionStart(-4,!0)},this.interactionEnd=function(a){a===K&&(-1!==a&&this.utilities.pivotActive(!1),F=!1)},this.isInteractionActive=function(){return F},this.handleWheelInput=function(b){if(this.isDragging)return!1;if(q.getIs2D()){var c=q.getScreenViewport(),d=a.intersectGround(k+c.width,l+c.height);this.utilities.setPivotPoint(d,!0,!0)}return q.getReverseZoomDirection()&&(b*=-1),M.z+=b,0!=b&&this.interactionStart(-1),!0},this.resetKeys=function(){this.autoMove(-1,!1),da.SHIFT=0,da.CONTROL=0,da.ALT=0,da.SPACE=0},this.autoMove=function(a,b){b&&this.isDragging||(a<0?ca[0]=ca[1]=ca[2]=ca[3]=ca[4]=ca[5]=b:ca[a]=b,b||this.interactionEnd(-4),this.interactionCheck())},this.updateModifierState=function(a){da.CONTROL=p&&a.metaKey||a.ctrlKey?1:0,da.SHIFT=a.shiftKey?1:0,da.ALT=a.altKey?1:0},this.handleKeyDown=function(a,b){this.updateModifierState(a);var c=!1;switch(b){case G.EQUALS:this.adjustSpeed(1),c=!0;break;case G.DASH:this.adjustSpeed(-1),c=!0;break;case G.ZERO:this.adjustSpeed(0),c=!0;break;case G.LEFT:this.autoMove(0,!0),c=!0;break;case G.RIGHT:this.autoMove(1,!0),c=!0;break;case G.PAGEUP:this.autoMove(2,!0),c=!0;break;case G.PAGEDOWN:this.autoMove(3,!0),c=!0;break;case G.UP:this.autoMove(4,!0),c=!0;break;case G.DOWN:this.autoMove(5,!0),c=!0;break;default:return!1}return this.isDragging||this.interactionStart(-4),c},this.handleKeyUp=function(a,b){this.updateModifierState(a);var c=!1;switch(b){case G.LEFT:this.autoMove(0,!1),c=!0;break;case G.RIGHT:this.autoMove(1,!1),c=!0;break;case G.PAGEUP:this.autoMove(2,!1),c=!0;break;case G.PAGEDOWN:this.autoMove(3,!1),c=!0;break;case G.UP:this.autoMove(4,!1),c=!0;break;case G.DOWN:this.autoMove(5,!1),c=!0;break;default:return!1}return c&&(this.interactionEnd(-4),F||this.interactionCheck()),c},this.handleDollyPan=function(a){k=a.canvasX,l=a.canvasY;var b=q.getScreenViewport();P.x=k,P.y=l,M.x=P.x/b.width,M.y=P.y/b.height,A=j(a);var c=THREE.Math.degToRad(a.rotation);B=c-C,Math.abs(B)>1&&(B=0),C=c,i(a.type,"start")&&(z=A,y=1,B=0,C=c),x=a.scale},this.handleGesture=function(a){switch(a.type){case"dragstart":return w="drag",this.handleButtonDown(a,0);case"dragmove":return"drag"!==w&&(this.handleButtonDown(a,0),w="drag"),this.handleMouseMove(a);case"dragend":return"drag"===w&&(this.handleButtonUp(a,0),w=null,!0);case"panstart":return w="pan",this.handlePanStart(a),this.handleDollyPan(a),!0;case"panmove":return"pan"!==w&&(w="pan",this.handlePanStart(a)),this.handleDollyPan(a);case"panend":return"pan"===w&&(this.isDragging=!1,this.handleDollyPan(a),this.interactionEnd(3),!0);case"pinchstart":return this.isDragging=!0,w="pinch",L.x=.5*(a.normalizedX+1),L.y=1-.5*(a.normalizedY+1),N.set(a.canvasX,a.canvasY),O.set(a.canvasX,a.canvasY),D=!1,this.interactionStart(3),this.handleDollyPan(a),!0;case"pinchmove":return"pinch"===w&&this.handleDollyPan(a);case"pinchend":return"pinch"===w&&(this.isDragging=!1,this.handleDollyPan(a),this.interactionEnd(3),!0)}return!1},this.handleButtonDown=function(a,b){return this.updateModifierState(a),L.x=.5*(a.normalizedX+1),L.y=1-.5*(a.normalizedY+1),O.set(a.canvasX,a.canvasY),M.copy(L),P.copy(O),S.copy(g(a.canvasX,a.canvasY)),T.copy(S),k=a.canvasX,l=a.canvasY,this.isDragging=!0,this.interactionStart(b),!0},this.handlePanStart=function(a){return this.isDragging=!0,L.x=.5*(a.normalizedX+1),L.y=1-.5*(a.normalizedY+1),N.set(a.canvasX,a.canvasY),O.set(a.canvasX,a.canvasY),this.interactionStart(3),!0},this.handleButtonUp=function(a,b){return this.updateModifierState(a),M.x=.5*(a.normalizedX+1),M.y=1-.5*(a.normalizedY+1),P.set(a.canvasX,a.canvasY),T.copy(g(a.canvasX,a.canvasY)),S.copy(T),k=a.canvasX,l=a.canvasY,this.interactionEnd(b),this.isDragging=!1,!0},this.handleMouseMove=function(b){return this.updateModifierState(b),this.isDragging?(M.x=.5*(b.normalizedX+1),M.y=1-.5*(b.normalizedY+1),P.set(b.canvasX,b.canvasY),T.copy(g(b.canvasX,b.canvasY)),k=b.canvasX,l=b.canvasY,!0):(L.x=.5*(b.normalizedX+1),L.y=1-.5*(b.normalizedY+1),O.set(b.canvasX,b.canvasY),M.x=L.x,M.y=L.y,P.copy(O),k=b.canvasX,l=b.canvasY,b.target===a.canvas&&a.rolloverObject(k,l),!1)},this.handleBlur=function(a){this.resetKeys(),this.interactionEnd(K)},b.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(a){n.handleBlur(a)})},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.HotGestureTool=function(a){var b=(navigator.userAgent.search("Mac OS"),a.navigation),c=(b.getCamera(),["hottouch"]),d={SHIFT:0,ALT:0,CONTROL:0},e=null,f=null,g=!1,h=!1,i=null,j={SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,LCOMMAND:91,RCOMMAND:93,COMMANDMOZ:224};this.getNames=function(){return c},this.getName=function(){return c[0]},this.activate=function(a){},this.deactivate=function(a){},this.__checkStart=function(){i&&(this.controller.distributeEvent("handleGesture",i),i=null)},this.update=function(){if(this.controller.getIsLocked())return!1;var b=a.getActiveNavigationTool(),c=!1===g&&!0===h,d=!0===g&&!1===h;if(c||d){var i=c?"worldup":"fov";if(b===i)return!1;if(b===e)return a.setActiveNavigationTool(i),e=i,this.__checkStart(),!1;f=b,a.setActiveNavigationTool(i),e=i,this.__checkStart()}else e&&(a.setActiveNavigationTool(f),e=null,f=null);return!1},this.resetKeys=function(){d.SHIFT=0,d.CONTROL=0,d.ALT=0},this.updateModifierState=function(a){d.CONTROL=a.ctrlKey?1:0,d.SHIFT=a.shiftKey?1:0,d.ALT=a.altKey?1:0},this.handleGesture=function(b){if(b===i)return!1;switch(b.type){case"drag3start":a.navigation.isActionEnabled("fov")&&(i=b,g=!0);break;case"drag3move":break;case"drag3end":g=!1;break;case"rotatestart":a.navigation.isActionEnabled("roll")&&(i=b,h=!0);break;case"rotatemove":break;case"rotateend":h=!1}return!1},this.handleKeyDown=function(a,b){switch(this.updateModifierState(a),b){case j.SHIFT:d.SHIFT=1;break;case j.CONTROL:d.CONTROL=1;break;case j.ALT:d.ALT=1}return!1},this.handleKeyUp=function(a,b){switch(this.updateModifierState(a),b){case j.SHIFT:d.SHIFT=0;break;case j.CONTROL:d.CONTROL=0;break;case j.ALT:d.ALT=0}return!1},this.handleButtonDown=function(a,b){return this.updateModifierState(a),!1},this.handleButtonUp=function(a,b){return this.updateModifierState(a),!1},this.handleMouseMove=function(a){return this.updateModifierState(a),!1},this.handleBlur=function(a){return this.resetKeys(),!1}},AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.HotkeyManager=function(){function a(){return p}function b(){return p[0]}function c(a,b){return a-b}function d(a,b,d){if(k.some(function(b){return b.id===a}))return!1;for(var e=0;e<b.length;e++)k.push({id:a,keys:b[e].keycodes.sort(c).join(),onPress:b[e].onPress,onRelease:b[e].onRelease,options:d||{}});return!0}function e(a){for(var b=!1,c=k.length-1;c>=0;c--)k[c].id===a&&(k.splice(c,1),b=!0);return b}function f(){var a,b,c=l.join();for(b=0;b<n.length;)a=n[b],a.keys===c?n.splice(b,1):b++;for(b=0;b<m.length;)a=m[b],a.keys!==c?m.splice(b,1):b++}function g(a,b){if(-1===l.indexOf(b)){for(var c=l.join(),d=l.slice(0),e=0;e<l.length&&l[e]<b;)e++;l.splice(e,0,b);var g=l.join(),h=l.slice(0);f();var i,j=[],o=[];for(e=k.length-1;e>=0;e--)i=k[e],i.keys===c&&i.onRelease?j.unshift(i):i.keys===g&&i.onPress&&o.unshift(i);for(e=j.length-1;e>=0&&(i=j[e],!i.onRelease(d));e--)i.options.tryUntilSuccess&&n.unshift(i);for(e=o.length-1;e>=0&&(i=o[e],!i.onPress(h));e--)i.options.tryUntilSuccess&&m.unshift(i)}}function h(a,b){var c=l.join(),d=l.slice(0),e=l.indexOf(b);e>-1&&l.splice(e,1);var g=l.join(),h=l.slice(0);f();var i,j=[],o=[];for(e=k.length-1;e>=0;e--)i=k[e],i.keys===c&&i.onRelease?j.unshift(i):i.keys===g&&i.onPress&&o.unshift(i);for(e=j.length-1;e>=0&&(i=j[e],!i.onRelease(d));e--)i.options.tryUntilSuccess&&n.unshift(i);for(e=o.length-1;e>=0&&(i=o[e],!i.onPress(h));e--)i.options.tryUntilSuccess&&m.unshift(i)}function i(){var a,b;for(b=0;b<n.length;)a=n[b],!0===a.onRelease(a.keys.split())?n.splice(b,1):b++;for(b=0;b<m.length;)a=m[b],!0===a.onPress(a.keys.split())?m.splice(b,1):b++;return!1}function j(){for(var a=l.length-1;a>=0;a--)h(null,l[a])}var k=[],l=[],m=[],n=[],o=Autodesk.Viewing.KeyCode,p=["hotkeys"];return{pushHotkeys:d,popHotkeys:e,handleKeyDown:g,handleKeyUp:h,handleBlur:j,getName:b,getNames:a,activate:function(){},deactivate:function(){},update:i,KEYCODES:o}},Autodesk.Viewing.theHotkeyManager=new Autodesk.Viewing.HotkeyManager,AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.FovTool=function(a){function b(a){return a<0&&a>-3?-3:a>0&&a<3?3:a}var c=a.navigation,d=c.getCamera(),e=["fov"],f=!1,g=0,h=null,i=null,j=!1,k=0,l=-5,m=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3,p=null;this.getNames=function(){return e},this.getName=function(){return e[0]},this.activate=function(a){k=0},this.deactivate=function(a){l=-5},this.getCursor=function(){return 0!==k&&-5===l?null:"url(data:image/x-icon;base64,AAACAAEAGBgAAAAAAACICQAAFgAAACgAAAAYAAAAMAAAAAEAIAAAAAAAYAkAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAACEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAwMD/yEhIf8AAABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAGknJyf/goKC/8/Pz/8aGhr/AAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAABTFBQU/2lpaf/MzMz///////////+Wlpb/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAOAAAAKFTU1P/t7e3////////////8PDw////////////AQEB/wAAAAEAAAAAAAAAFAAAAH0KCgr/AAAAYwAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAjCwsL/6Ghof/t7e3///////Dw8P9MTEz/LS0t//Pz8///////Ghoa/wAAABoAAAANDQ0N/319ff+rq6v/Y2Nj/wAAAK8AAABGAAAA////////////AAAA/wAAAF0hISH/jIyM////////////sLCw/xEREf8AAACHAAAArKysrP//////V1dX/wAAAFcAAABSUlJS//f39///////8PDw/6+vr/86Ojr/LS0t////////////FRUV/1xcXP/Gxsb/+Pj4//Hx8f9MTEz/AAAAsAAAAEcAAAAAAAAAZ2dnZ///////pKSk/wAAAKQAAACtra2t///////////////////////m5ub/kZGR/wAAAP8AAAD/q6ur//Hx8f//////vb29/x0dHf8AAACIAAAAAAAAAAAAAAAAAAAAOjo6Ov//////5+fn/wAAAOcAAADd3d3d////////////////////////////+/v7/9bW1v/i4uL//v7+//Pz8/9hYWH/AAAAvQAAAFQAAAAAAAAAAAAAAAAAAAAAAAAAJycnJ//6+vr//////wMDA/8AAADv7+/v/////////////////////////////////////////////////7y8vP8ODg7/AAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJiYmJv/6+vr//////wkJCf8AAADv7+/v//////////////////////////////////f39//9/f3//////+np6f+UlJT/GBgY/wAAAH0AAAACAAAAAAAAAAAAAAAAAAAAKSkpKf///////v7+/w0NDf8AAADd3d3d////////////////////////////29vb/39/f/+Xl5f/5+fn////////////5ubm/1RUVP8CAgL/AAAAPwAAAAAAAAAAAAAAOTk5Of//////8PDw/wgICP8AAAChoaGh/////////////////+np6f+YmJj/QkJC/wAAAP8AAAD/UFBQ/7e3t//39/f///////////+oqKj/EBAQ/wAAAIgAAAAAAAAAZ2dnZ///////29vb/wEBAf8AAAA4NTU1/9zc3P/t7e3/tbW1/01NTf8AAACYAAAA////////////AwMD/wsLC/9oaGj/y8vL////////////8fHx/zg4OP8AAACWAAAApaWlpf//////n5+f/wAAAJ8AAAAAAAAAczg4OP9LS0v/EhIS/wAAAE0AAAAAAAAA////////////FRUV/wAAABUAAABoJSUl/4GBgf/i4uL///////////9+fn7/Pz8///b29v//////SkpK/wAAAEoAAAAAAAAAAAAAADgAAABLAAAAEgAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAJQAAAIE8PDz/np6e//z8/P/////////////////8/Pz/CQkJ/wAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAA8DAwM/09PT/+7u7v///////////+QkJD/AAAAkwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////Dw8P/wAAAA8AAAAAAAAAAAAAAAAAAAAAAAAADAAAAFIYGBj/aGho/729vf8WFhb/AAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////FRUV/wAAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAQEB/w8PD/8AAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////DAwM/wAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8x/h/nO/4fw1D+HwFy/h4BRu4YAHOGEABkAAAAXAAAIFwAAOBnAAHgIAAD4GUAAOB4AABgXAAAIGMAAABtggAAVMYYAHT+HgE7/g8BcP4Pw2/+D+dc/h//XP///2c=), auto"},this.getMotionDelta=function(a){var b=n.x-m.x,c=n.y-m.y,d=n.z-m.z;Math.abs(b)<.001&&(b=0),Math.abs(c)<.001&&(c=0),Math.abs(d)<.001&&(d=0),a.set(b,c,d)},this.stepMotionDelta=function(a,b){b?(m.x+=.6*a.x,m.y+=.6*a.y,m.z+=.6*a.z):m.copy(n)},this.getAccumulatedWheelDelta=function(){var a=Date.now(),c=0;return i&&a-i>100?(c=b(g),g=0,h=null,i=null,j=!1):h&&a-h>100&&(j?Math.abs(g)>=3&&(c=g,g=0):(c=b(g),j=!0,g=0)),c},this.update=function(){var a=!1,b=l>-5;if(l>-5){this.controller.setIsLocked(!0),this.getMotionDelta(o);var e=o.x,g=o.y,h=o.z;if(0!==e||0!==g||0!==h)if(b=!0,l>=0)g=-g,0!==(h=Math.abs(e)>Math.abs(g)?e:g)&&(h*=-1,
c.setVerticalFov(c.getVerticalFov()*(1+h),!0));else{var i=this.getAccumulatedWheelDelta()/3;0!==i&&c.setFocalLength(c.getFocalLength()+i,!0)}this.stepMotionDelta(o,!0),-1===l&&Math.abs(h)<1e-5&&(this.interactionEnd(-1),a=!0)}return b?this.utilities.pivotActive(c.getPivotSetFlag(),!0):this.utilities.pivotUpdate(),!f&&(a||l>-5)&&(l>-1&&m.copy(n),l=-5,this.controller.setIsLocked(!1)),d.dirty},this.interactionStart=function(a,b){(b||a>l)&&(l=a,f=!0),c.toPerspective()},this.interactionEnd=function(a){a===l&&(-1!==a&&this.utilities.pivotActive(!1),f=!1)},this.handleWheelInput=function(a){if(l>-1)return!1;c.getReverseZoomDirection()&&(a*=-1),n.z+=a,g+=a;var b=Date.now();return h||(h=b),i=b,0!=a&&this.interactionStart(-1),!0},this.handleGesture=function(a){switch(a.type){case"dragstart":return this.handleButtonDown(a,0);case"dragmove":return this.handleMouseMove(a);case"dragend":return this.handleButtonUp(a,0);case"drag3start":return p="drag",this.handleButtonDown(a,0);case"drag3move":return"drag"===p&&this.handleMouseMove(a);case"drag3end":return"drag"===p&&this.handleButtonUp(a,0),p=null,!1}return!1},this.handleButtonDown=function(a,b){return k+=1<<b,2!==b&&(m.x=.5*(a.normalizedX+1),m.y=1-.5*(a.normalizedY+1),n.copy(m),this.interactionStart(b),!0)},this.handleButtonUp=function(a,b){return k-=1<<b,2!==b&&(n.x=.5*(a.normalizedX+1),n.y=1-.5*(a.normalizedY+1),this.interactionEnd(b),!0)},this.handleMouseMove=function(a){return n.x=.5*(a.normalizedX+1),n.y=1-.5*(a.normalizedY+1),l>-1},this.handleBlur=function(a){return this.interactionEnd(l),!1}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.WorldUpTool=function(a,b){function c(a,b){function c(a,b){var c=Math.abs(a-b);return c>l?c:Math.min(l-c,c)}function d(a,b){var c=p(a);return c.distanceToSquared(b)<m||(B.set(-b.x,-b.y,-b.z),c.distanceToSquared(B)<m)}function h(a,b){for(var e=W+X+2*Math.PI/180,f=0;f<6;++f)if(Q[f]!==Z)for(var g=f+1;g<6;++g)if(Q[g]!==Z){var h=c(Q[f],Q[g]);if(h<e){if(a[f]<a[g]&&!d(f,b)||d(g,b)){Q[f]=Z;break}Q[g]=Z}}}function i(a){return a>l?a:a<=0?a+Math.PI:a-Math.PI}function j(a,b,c){var d=a.clone().normalize(),e=new Array(3),f=new Array(6);e[0]=k(1,0,0,d),e[1]=k(0,1,0,d),e[2]=k(0,0,1,d);var g,j=b.clone().cross(d).normalize();for(g=0;g<3;++g){var l=e[g];f[g]=l.length(),f[g]<$?Q[g]=Z:(l.multiplyScalar(1/f[g]),Q[g]=Math.atan2(j.dot(l),b.dot(l)))}for(Q[3]=i(Q[0]),Q[4]=i(Q[1]),Q[5]=i(Q[2]),f[3]=f[0],f[4]=f[1],f[5]=f[2],h(f,c),g=0;g<6;++g)if(Q[g]!==Z){var m=B.set(0,0,1);C.setFromAxisAngle(m,Q[g]);var n=B.set(0,.54,0);n.applyQuaternion(C),O[g].position.copy(n),O[g].visible=!0}else O[g].visible=!1}function n(){M=new THREE.Object3D;var a=new THREE.RingGeometry(.5-.01*F,.5,60),b=new THREE.Mesh(a,z);I=b;var c=.007*F,d=new THREE.BoxGeometry(.93,c,c),e=new THREE.BoxGeometry(c,.93,c),f=new THREE.BoxGeometry(c,c,.93);J=new THREE.Mesh(d,z),K=new THREE.Mesh(e,z),L=new THREE.Mesh(f,z),M.add(J),M.add(K),M.add(L),N=new THREE.Mesh(new THREE.CircleGeometry(.005),z),M.add(N),O=new Array(6),P=new Array(6);for(var g=0;g<6;++g){var h=.005*F,i=.0025*F;O[g]=new THREE.Mesh(new THREE.CircleGeometry(h,16),z),P[g]=new THREE.Mesh(new THREE.CircleGeometry(i,16),z),P[g].visible=!1,O[g].add(P[g]),b.add(O[g])}return M.add(b),M}function o(a,b,c,d,e){return M||(M=n()),g.orient(I,b,D.position,d),j(c,e,d),M.scale.x=a,M.scale.y=a,M.scale.z=a,M.position.copy(b),M}function p(a){if(A.set(0,0,0),a>=0){var b=a>=3?-1:1;a%=3,0===a&&(A.x=b),1===a&&(A.y=b),2===a&&(A.z=b)}return T&&A.multiplyScalar(-1),A}function q(a,b){for(var d=c(Q[0],a),e=0,f=1;f<6;++f){var g=c(Q[f],a);g<d&&(d=g,e=f)}return R=d,d<b?e:-1}function r(a){g.setWorldUpVector(a,!0)}function s(a){if(0!==a){var b=30*Math.PI/180,c=B.copy(D.position).sub(H).normalize();C.setFromAxisAngle(c,a);var d=g.getWorldUpVector(),e=Math.abs(c.angleTo(d));(e<b||Math.PI-e<b)&&d.copy(g.getCameraUpVector()),d.applyQuaternion(C),r(d)}}function t(){if(!U){var a=q(S,W);if(a>=0)return R=0,U=!0,S=Q[a],p(a)}return!1}function u(){if(U){if(q(S,X)<0)return U=!1,!0;R=0}return!1}function v(a,b,c,d){if(a<b)return p(c).distanceToSquared(d)<m;return!1}function w(a,b){a.dot(b)<0&&(b=b.clone().multiplyScalar(-1)),g.orient(N,H,D.position,b),N.position.copy(b.multiplyScalar(.495));for(var d=!1,e=U?X:W,f=0;f<6;++f){var h=c(Q[f],S),i=v(h,e,f,a);i&&(d=!0);var j=i?4:3*(1-3*h/Math.PI);j<1&&(j=1),j*=F,P[f].visible=i;var k=O[f];k.scale.x=j,k.scale.y=j,k.scale.z=j}return J.visible=d,K.visible=d,L.visible=d,d}function x(a){S+=a,S>Math.PI?S-=l:S<=-Math.PI&&(S=l+S);var b=t();if(b)V=S,r(b);else if(u()){var c=S-V;s(c),V=0}else{if(U)return!1;s(a)}return!0}var y=2*Math.tan(THREE.Math.degToRad(15)),z=new THREE.MeshPhongMaterial({color:12303291,ambient:12303291,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1}),A=new THREE.Vector3,B=new THREE.Vector3,C=new THREE.Quaternion,D=new THREE.PerspectiveCamera(30,b.aspect,b.near,b.far),E=b,F=1,G=1,H=null,I=null,J=null,K=null,L=null,M=null,N=null,O=null,P=null,Q=new Array(6),R=0,S=0,T=!1,U=!0,V=0,W=5*Math.PI/180,X=7*Math.PI/180,Y=1,Z=1e3,$=.1;a.createOverlayScene("roll",null,null,D),this.updateRollCamera=function(a,b){D.position.copy(E.position),D.quaternion.copy(E.quaternion),D.up.copy(E.up),D.aspect=E.aspect,a&&b&&(D.near=b-a,D.far=b+a),D.updateProjectionMatrix()},this.isSnapped=function(){return U},this.resize=function(){var a=Y*y,b=a*E.aspect,c=(E.aspect<1?b:a)*G;M.scale.x=c,M.scale.y=c,M.scale.z=c},this.start=function(b,c){this.updateHUD(b,c),a.addOverlay("roll",M)},this.updateHUD=function(a,b){H=a,b<e?b=e:b>f&&(b=f),G=b,F=f/b;var c=A.copy(a).sub(E.position);Y=c.length();var d=Y*y,h=d*E.aspect,i=(E.aspect<1?h:d)*b;this.updateRollCamera(i,Y);var j=g.getWorldUpVector(),k=g.getCameraUpVector();o(i,a,c,j,k),S=0,V=0;var l=j.dot(k);T=l<0,U=w(j,k)},this.handleRoll=function(a,b,c){if(this.updateRollCamera(),w(g.getWorldUpVector(),g.getCameraUpVector()),0!==a||0!==b){var d=c.x-a-.5,e=c.y-b-.5,f=c.x-.5,h=c.y-.5;return x(Math.atan2(h,f)-Math.atan2(e,d))}return!1},this.handleRollTouch=function(a){this.updateRollCamera(),w(g.getWorldUpVector(),g.getCameraUpVector());var b=a-S;return Math.abs(b)>.001&&x(b)},this.end=function(){a.removeOverlay("roll",M)}}function d(a){var b=a.pointers[1].clientX-a.pointers[0].clientX,c=a.pointers[1].clientY-a.pointers[0].clientY,d=Math.sqrt(b*b+c*c),e=g.getScreenViewport();return d/Math.min(e.width,e.height)}var e=.35,f=.8,g=b.navigation,h=g.getCamera(),i=["worldup"],j=this,k=function(){var a=new THREE.Vector3;return function(b,c,d,e){var f=new THREE.Vector3(b,c,d),g=e.dot(f);return a.copy(e),a.multiplyScalar(g),f.sub(a)}}(),l=2*Math.PI,m=1e-5,n=!1,o=!1,p=!1,q=new c(a,h),r=new THREE.Vector3,s=new THREE.Vector3,t=new THREE.Vector3,u=null,v=0,w={x:.5,y:.5},x=1;this.getNames=function(){return i},this.getName=function(){return i[0]},this.activate=function(a){b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),p=!1},this.deactivate=function(a){q.end(),b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),this.utilities.restorePivot(),u=null,n=!1,p=!1},this.getCursor=function(){return"auto"},this.getMotionDelta=function(a){var b=s.x-r.x,c=s.y-r.y,d=s.z-r.z;Math.abs(b)<.001&&(b=0),Math.abs(c)<.001&&(c=0),Math.abs(d)<.001&&(d=0),a.set(b,c,d)},this.stepMotionDelta=function(){r.copy(s)},this.update=function(){if(!p){var a=g.getEyeVector(),b=.5*(h.near+h.far);a.normalize().multiplyScalar(b);var c=a.add(h.position);this.utilities.savePivot(),this.utilities.setPivotPoint(c,!0,!0),this.utilities.pivotActive(!0);q.start(c,.65),p=!0}var d=o;this.getMotionDelta(t);var e=t.x,f=t.y,i=t.z;return(o||"roll"===u||n&&(0!==e||0!==f||0!==i))&&(o="roll"===u?q.handleRollTouch(v):q.handleRoll(e,f,s)),this.stepMotionDelta(),h.dirty&&(d=!0),d},this.handleResize=function(){q.resize(),o=!0},this.handleGesture=function(a){switch(a.type){case"dragstart":return u="drag",this.handleButtonDown(a,0);case"dragmove":return this.handleMouseMove(a);case"dragend":return u=null,this.handleButtonUp(a,0);case"rotatestart":return b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),u="roll",v=THREE.Math.degToRad(a.rotation),w={x:.5*(a.normalizedX+1),y:1-.5*(a.normalizedY+1)},x=d(a),!0;case"rotatemove":return v=THREE.Math.degToRad(a.rotation),"roll"===u;case"rotateend":return b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),v=THREE.Math.degToRad(a.rotation),u=null,!1}return!1},this.handleWheelInput=function(a){return!0},this.handleCameraChange=function(){var a=g.getEyeVector(),b=.5*(h.near+h.far);a.normalize().multiplyScalar(b);var c=a.add(h.position);q.updateHUD(c,.65)},this.handleButtonDown=function(a,c){return r.x=.5*(a.normalizedX+1),r.y=1-.5*(a.normalizedY+1),s.copy(r),n=!0,u=null,this.controller.setIsLocked(!0),b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,j.handleCameraChange),!0},this.handleButtonUp=function(a,c){return s.x=.5*(a.normalizedX+1),s.y=1-.5*(a.normalizedY+1),n=!1,o=!0,this.controller.setIsLocked(!1),b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,j.handleCameraChange),!0},this.handleMouseMove=function(a){return s.x=.5*(a.normalizedX+1),s.y=1-.5*(a.normalizedY+1),!0},this.handleBlur=function(a){return n=!1,u=null,!1}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.ToolInterface=function(){this.names=["unnamed"],this.getNames=function(){return this.names},this.getName=function(){return this.names[0]},this.getPriority=function(){return 0},this.register=function(){},this.deregister=function(){},this.activate=function(a,b){},this.deactivate=function(a){},this.update=function(a){return!1},this.handleSingleClick=function(a,b){return!1},this.handleDoubleClick=function(a,b){return!1},this.handleSingleTap=function(a){return!1},this.handleDoubleTap=function(a){return!1},this.handleKeyDown=function(a,b){return!1},this.handleKeyUp=function(a,b){return!1},this.handleWheelInput=function(a){return!1},this.handleButtonDown=function(a,b){return!1},this.handleButtonUp=function(a,b){return!1},this.handleMouseMove=function(a){return!1},this.handleGesture=function(a){return!1},this.handleBlur=function(a){return!1},this.handleResize=function(){}},function(){"use strict";function a(a,b){function e(){return b.getData().instanceTree}function f(){return b.getData().instanceTree||b.getData().fragmentMap}function g(c){var d=e();if(n[c]>0)0==--n[c]&&a.highlightObjectNode(b,c,!1);else if(n[c]<0)throw"Selection State machine broken. Negatively selected object!";d&&d.enumNodeChildren(c,function(a){g(a)},!1)}function h(c){var d=e();n[c]?n[c]++:(a.highlightObjectNode(b,c,!0),n[c]=1),d&&d.enumNodeChildren(c,function(a){h(a)},!1)}function i(a){if(void 0!==a&&m.selectedObjectIds[a])return!0}function j(a){var b=e();if(!b||(a=b.findNodeForSelection(a,m.selectionMode),b.isNodeSelectable(a))){i(a)||(m.selectedObjectIds[a]=a,m.selectionCount++,h(a))}}function k(a){i(a)&&(g(a),m.selectedObjectIds[a]=0,m.selectionCount--)}function l(a){if(m.selectionCount!==a.length)return!1;for(var b=0;b<a.length;b++)if(!i(a[b]))return!1;return!0}var m=this;this.selectedObjectIds={},this.selectionCount=0,this.selectionMode=c.SelectionMode.LEAF_OBJECT;var n={};this.getInstanceTree=e,this.getFragmentMap=f,this.getSelectionLength=function(){return m.selectionCount},this.getSelection=function(){var a=[],b=m.selectedObjectIds;for(var c in b)if(b[c]){var d=parseInt(c);a.push(d)}return a},this.isSelected=function(a){return i(a)},this.clearSelection=function(a){if(this.selectionCount>0){var b=m.selectedObjectIds;for(var c in b){var d=parseInt(c);void 0!==d&&g(d)}m.selectedObjectIds={},m.selectionCount=0}},this.deselectInvisible=function(){var c=!1,d=m.selectedObjectIds,e=a.visibilityManager;for(var f in d){var g=parseInt(f);g&&!e.isNodeVisible(b,g)&&(k(g),c=!0)}return c},this.toggleSelection=function(a){if(!a)return void d.logger.error("Attempting to select node 0.",c.errorCodeString(c.ErrorCodes.VIEWER_INTERNAL_ERROR));i(a)?k(a):j(a)},this.setSelectionMode=function(a){this.clearSelection(!0),this.selectionMode=a},this.setSelection=function(a){if(!l(a)&&(this.clearSelection(!0),null!=a&&0!==a.length))for(var b=0;b<a.length;b++)j(a[b])},this.getSelectionBounds=function(){var a=new THREE.Box3,c=new THREE.Box3,d=f();if(d){var e=b.getFragmentList(),g=m.selectedObjectIds;for(var h in g){var i=parseInt(h);d.enumNodeFragments(i,function(b){e.getWorldBounds(b,c),a.union(c)},!0)}}return a},this.getSelectionVisibility=function(){var a=!1,c=!1,d=m.selectedObjectIds;for(var e in d){var g=parseInt(e);if(g){var h=f();if(h&&h.isNodeHidden(g)?c=!0:a=!0,a&&c)break}}return{hasVisible:a,hasHidden:c,model:b}},this.dtor=function(){this.selectedObjectIds=null}}function b(b){function e(){h.length>1&&d.logger.warn("This selection call does not yet support multiple models.")}function f(){for(var a=[],d=0;d<h.length;d++){var e=[],f=[],g=h[d].selector.selectedObjectIds,i=h[d].selector.getFragmentMap();for(var j in g)if(g[j]){var k=parseInt(j);k&&(e.push(k),i&&i.enumNodeFragments(k,function(a){f.push(a)},!1))}e.length&&a.push({fragIdsArray:f,dbIdArray:e,nodeArray:e,model:h[d]})}var l;1===h.length&&(l={type:c.SELECTION_CHANGED_EVENT,fragIdsArray:a[0]?a[0].fragIdsArray:[],dbIdArray:a[0]?a[0].dbIdArray:[],nodeArray:a[0]?a[0].dbIdArray:[],model:h[0]},b.api.dispatchEvent(l)),l={type:c.AGGREGATE_SELECTION_CHANGED_EVENT,selections:a},b.api.dispatchEvent(l)}function g(){for(var a=!1,b=0;b<h.length;b++)a=h[b].selector.deselectInvisible()||a;a&&f()}var h=[];this.highlightDisabled=!1,this.highlightPaused=!1,this.selectionDisabled=!1,this.addModel=function(c){-1==h.indexOf(c)&&(c.selector=new a(b,c),h.push(c))},this.removeModel=function(a){var b=h.indexOf(a);a.selector.getSelection();a.selector.clearSelection(),a.selector=null,h.splice(b,1)},this.getSelectionLength=function(){for(var a=0,b=0;b<h.length;b++)a+=h[b].selector.getSelectionLength();return a},this.getSelection=function(){return e(),h.length>1&&d.logger.warn("Use getAggregateSelection instead of getSelection when there are multiple models in the scene."),h[0].selector.getSelection()},this.getAggregateSelection=function(){for(var a=[],b=0;b<h.length;b++){var c=h[b].selector.getSelection();c&&c.length&&a.push({model:h[b],selection:c})}return a},this.clearSelection=function(a){for(var b=0;b<h.length;b++)h[b].selector.clearSelection(a);a||f()},this.toggleSelection=function(a,b){b||(e(),b=h[0]),b.selector.toggleSelection(a),f()},this.setSelectionMode=function(a){for(var b=0;b<h.length;b++)h[b].selector.setSelectionMode(a)},this.setSelection=function(a,b){if(!this.selectionDisabled){if(a&&0!==a.length){if(b)for(var c=0;c<h.length;c++)h[c]!==b&&h[c].selector.clearSelection();else e(),b=h[0];b.selector.setSelection(a)}else this.clearSelection(!0);f()}},this.setAggregateSelection=function(a){if(!this.selectionDisabled){if(a&&0!==a.length)for(var b=0;b<a.length;++b){var c=a[b].model,d=a[b].ids;c.selector.setSelection(d)}else this.clearSelection(!0);f()}},this.getSelectionBounds=function(){if(1==h.length)return h[0].selector.getSelectionBounds();for(var a=new THREE.Box3,b=0;b<h.length;b++){var c=h[b].selector.getSelectionBounds();a.union(c)}return a},this.getSelectionVisibility=function(){for(var a={hasVisible:!1,hasHidden:!1,details:[]},b=0;b<h.length;b++){var c=h[b].selector.getSelectionVisibility();a.hasVisible=a.hasVisible||c.hasVisible,a.hasHidden=a.hasHidden||c.hasHidden,a.details.push(c)}return a},this.dtor=function(){for(var a=0;a<h.length;a++)h[a].selector.dtor()},b.api.addEventListener(c.ISOLATE_EVENT,function(a){g()}),b.api.addEventListener(c.HIDE_EVENT,function(a){g()})}var c=Autodesk.Viewing,d=c.Private;d.Selector=a,d.MultiModelSelector=b}(),function(){"use strict";function a(a){this.viewerImpl=a,this.models=[]}function b(a){var b=a.getAggregateIsolatedNodes();if(1===a.models.length){var d={type:c.ISOLATE_EVENT,nodeIdArray:b.length?b[0].ids:[],model:a.models[0]};a.viewerImpl.api.dispatchEvent(d)}var d={type:c.AGGREGATE_ISOLATION_CHANGED_EVENT,isolation:b};a.viewerImpl.api.dispatchEvent(d)}var c=Autodesk.Viewing,d=c.Private,e=function(a,b){this.viewerImpl=a,this.model=b,this.isolatedNodes=[],this.hiddenNodes=[]};e.prototype.getInstanceTree=function(){return this.model?this.model.getData().instanceTree:null},e.prototype.getFragmentMap=function(){return this.model?this.model.getData().instanceTree||this.model.getData().fragmentMap:null},e.prototype.getIsolatedNodes=function(){return this.isolatedNodes.slice(0)},e.prototype.getHiddenNodes=function(){return this.hiddenNodes.slice(0)},e.prototype.setAllVisibility=function(a){var b=this.model?this.model.getRootId():null;b&&this.setVisibilityOnNode(b,a),this.model.getData().is2d&&this.model.setAllVisibility(a)},e.prototype.isNodeVisible=function(a){var b=this.getInstanceTree();return b?!b.isNodeHidden(a):-1==this.hiddenNodes.indexOf(a)&&(0==this.isolatedNodes.length||-1!=this.isolatedNodes.indexOf(a))},e.prototype.isolate=function(a){var b=this.getInstanceTree(),c=b?b.getRootId():null,d="number"==typeof a&&a===c||"object"==typeof a&&a.dbId===c;a&&!d?this.isolateMultiple(Array.isArray(a)?a:[a]):this.isolateNone()},e.prototype.isolateNone=function(){this.model.setAllVisibility(!0),this.viewerImpl.sceneUpdated(!0),this.setAllVisibility(!0),this.hiddenNodes=[],this.isolatedNodes=[],this.viewerImpl.invalidate(!0)},e.prototype.isolateMultiple=function(a){if(a&&0!=a.length){this.setAllVisibility(!1),this.model.getData().is2d||(this.model.setAllVisibility(!1),this.viewerImpl.sceneUpdated(!0)),this.isolatedNodes=a.slice(0),this.hiddenNodes=[];for(var b=0;b<a.length;b++)this.setVisibilityOnNode(a[b],!0)}else this.isolateNone();this.viewerImpl.invalidate(!0)},e.prototype.hide=function(a){var b;if(Array.isArray(a)){for(var d=0;d<a.length;++d)this.setVisibilityOnNode(a[d],!1);a.length>0&&(b={type:c.HIDE_EVENT,nodeIdArray:a,model:this.model})}else this.setVisibilityOnNode(a,!1),b={type:c.HIDE_EVENT,nodeIdArray:[a],model:this.model};b&&this.viewerImpl.api.dispatchEvent(b)},e.prototype.show=function(a){var b;if(Array.isArray(a)){for(var d=0;d<a.length;++d)this.setVisibilityOnNode(a[d],!0);a.length>0&&(b={type:c.SHOW_EVENT,nodeIdArray:a,model:this.model})}else this.setVisibilityOnNode(a,!0),b={type:c.SHOW_EVENT,nodeIdArray:[a],model:this.model};b&&this.viewerImpl.api.dispatchEvent(b)},e.prototype.toggleVisibility=function(a){var b=this.getFragmentMap().isNodeHidden(a);this.setVisibilityOnNode(a,b);var d={type:b?c.SHOW_EVENT:c.HIDE_EVENT,nodeIdArray:[a],model:this.model};this.viewerImpl.api.dispatchEvent(d)},e.prototype.setVisibilityOnNode=function(a,b){var c=this.viewerImpl,d=this.model,e=this.getFragmentMap(),f=!b,g=d.getData().is2d;this.viewerImpl.matman();e?e.enumNodeChildren(a,function(a){e.setNodeHidden(a,f),g?d.getFragmentList().setObject2DGhosted(a,!b):e.enumNodeFragments(a,function(a){d.setVisibility(a,b)},!1)},!0):g?d.getFragmentList().setObject2DGhosted(a,!b):d.setVisibility(a,b),c.sceneUpdated(!0),this.updateNodeVisibilityTracking(a,b)},e.prototype.updateNodeVisibilityTracking=function(a,b){var c=b;if(this.isolatedNodes.length>0){var d=this.isolatedNodes.indexOf(a);c&&-1===d?this.isolatedNodes.push(a):c||-1===d||(this.isolatedNodes.splice(d,1),0===this.isolatedNodes.length&&(this.hiddenNodes=[this.model.getRootId()]))}else{var e=this.hiddenNodes.indexOf(a);c||-1!==e?c&&-1!==e&&this.hiddenNodes.splice(e,1):this.hiddenNodes.push(a)}var f=this.getInstanceTree();f&&f.root&&f.root.dbId===a&&(b?(this.isolatedNodes=[],this.hiddenNodes=[]):(this.isolatedNodes=[],this.hiddenNodes=[a]))},e.prototype.setNodeOff=function(a,b){var c=this.viewerImpl,d=this.model,e=this.getFragmentMap(),f=d.getData().is2d;e?e.enumNodeChildren(a,function(a){e.setNodeOff(a,b),f?d.getFragmentList().setObject2DVisible(a,!b):e.enumNodeFragments(a,function(a){d.getFragmentList().setFragOff(a,b)},!1)},!0):f?d.getFragmentList().setObject2DVisible(a,!b):d.getFragmentList().setFragOff(a,b),c.sceneUpdated(!0)},c.Private.VisibilityManager=e,a.prototype.addModel=function(a){-1==this.models.indexOf(a)&&(a.visibilityManager=new e(this.viewerImpl,a),this.models.push(a))},a.prototype.removeModel=function(a){var b=this.models.indexOf(a);a.visibilityManager.isolateNone(),a.visibilityManager=null,this.models.splice(b,1)},a.prototype.warn=function(){this.models.length>1&&d.logger.warn("This selection call does not yet support multiple models.")},a.prototype.getAggregateIsolatedNodes=function(){for(var a=[],b=this.models,c=0;c<b.length;c++){var d=b[c].visibilityManager.getIsolatedNodes();d&&d.length&&a.push({model:b[c],ids:d})}return a},a.prototype.getIsolatedNodes=function(a){return a||(this.warn(),a=this.models[0]),a.visibilityManager.getIsolatedNodes()},a.prototype.getAggregateHiddenNodes=function(){for(var a=[],b=this.models,c=0;c<b.length;c++){var d=b[c].visibilityManager.getHiddenNodes();d&&d.length&&a.push({model:b[c],ids:d})}return a},a.prototype.getHiddenNodes=function(a){return a||(this.warn(),a=this.models[0]),a.visibilityManager.getHiddenNodes()},a.prototype.isNodeVisible=function(a,b){return a||(this.warn(),a=this.models[0]),a.visibilityManager.isNodeVisible(b)},a.prototype.isolate=function(a,c){c||(this.warn(),c=this.models[0]),c.visibilityManager.isolate(a),b(this)},a.prototype.aggregateIsolate=function(a){if(a&&0!==a.length){for(var c=this.models.concat(),d=0;d<a.length;++d){var e=a[d].model,f=a[d].ids||a[d].selection,g=c.indexOf(e);c.splice(g,1),e.visibilityManager.isolate(f)}for(;c.length;)c.pop().visibilityManager.setAllVisibility(!1)}else for(var d=0;d<this.models.length;++d)this.models[d].visibilityManager.isolateNone();b(this)},a.prototype.hide=function(a,b){b||(this.warn(),b=this.models[0]),b.visibilityManager.hide(a)},a.prototype.show=function(a,b){b||(this.warn(),b=this.models[0]),b.visibilityManager.show(a)},a.prototype.toggleVisibility=function(a,b){b||(this.warn(),b=this.models[0]),b.visibilityManager.toggleVisibility(a)},a.prototype.setVisibilityOnNode=function(a,b,c){c||(this.warn(),c=this.models[0]),c.visibilityManager.setVisibilityOnNode(a,b)},a.prototype.setNodeOff=function(a,b,c){c||(this.warn(),c=this.models[0]),c.visibilityManager.setNodeOff(a,b)},c.Private.MultiModelVisibilityManager=a}();var av=Autodesk.Viewing,avp=Autodesk.Viewing.Private,LMV_WORKER_URL=avp.LMV_WORKER_URL||"src/workers/MainWorker-web.js",ENABLE_INLINE_WORKER=avp.ENABLE_INLINE_WORKER||!1;!function(){"use strict";function a(){if(!avp.workerScript){var a=LMV_WORKER_URL,b=avp.getResourceUrl(LMV_WORKER_URL);b&&(a=b),avp.workerScript=WGS.WebWorkerCreator?new WGS.WebWorkerCreator(a,ENABLE_INLINE_WORKER):new WGS.NodeWorkerCreator}return avp.workerScript}avp.workerScript=null,avp.clearWorkerDataURL=function(){avp.workerScript&&avp.workerScript.clearWorkerDataURL()},avp.initWorkerScript=function(b,c){return a().initWorkerScript(b,c)},avp.createWorker=function(){return a().createWorker()},avp.createWorkerWithIntercept=function(){return a().createWorkerWithIntercept()}}(),function(){"use strict";function a(a,b){this.viewer3DImpl=a.viewer3DImpl,this.delegate=WGS.FileLoader.copyDelegate(this,a),this.loading=!1,this.tmpMatrix=new THREE.Matrix4,this.logger=d.logger,this.loadTime=0,this.useInstancing=this.viewer3DImpl.use2dInstancing}function b(a,b){function d(){if(this.fragIds)return a;if(!this.model||!this.data||!this.data.meshes)return null;for(var a=this.fragIds=[],b=0|this.data.baseIndex,c=0;c<this.data.meshes.length;++c)a.push(b++);return a}a.viewer3DImpl.api.dispatchEvent({type:c.FRAGMENTS_LOADED_EVENT,model:a.model,getFragIds:d,data:b})}var c=Autodesk.Viewing,d=c.Private,e="PARSE_F2D_FRAME",f=1,g=2,h=4,i=8,j=1048576,k=function(a,b){function d(a){for(;++a<o.length&&(o[a]&(h|i))!=h;);return a}function k(a){var b=0;if(m.model){var c=m.model.getGeometryList();c&&(b=c.geomMemory/j)}for(var h=d(t),k=b+m.fileMemorySize+n;k+r<a.limit;){var l=-1,p=null;if(q.length>0&&(x||h>o.length))p=q.shift(),l=p.lmv_buffer_id;else{if(!(h<o.length))break;l=h,t=h,h=d(h),x=!0}m.parsingWorker.doOperation({operation:e,bufferId:l,rendered:!!(o[l]&f),promised:!!(o[l]&g),conditional:!!(o[l]&i)}),o[l]&i||(r+=n,o[l]|=i)}}var l=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},m=a;this.options={onDemandLoading:!1,pageOutGeometryEnabled:!1},l(this.options,b),this.options.debug={pageOutStart:.75,pageOutEnd:.5,pixelCullingEnable:!1,pixelCullingThreshold:WGS.PIXEL_CULLING_THRESHOLD},l(this.options.debug,b.debug);var n,o=[],p={},q=[],r=0,s=0,t=-1,u=-1,v=-1,w=0,x=!0,y=0;m.useInstancing?(n=(c.isMobileDevice()?16383:32767)/4|0,n=48*n/j):n=3932100/j;var z=!1,A=[];this.options.limit=Math.max(this.options.limit,10),this.options.debug.pageOutEnd=Math.min(this.options.debug.pageOutEnd,this.options.debug.pageOutStart),this.totalGeomSize=a.totalGeomSize,this.onDemandLoadingEnabled=function(){return this.options.onDemandLoading},this.pageOutGeometryEnabled=function(){return this.options.onDemandLoading},this.pixelCullingEnable=function(){return this.options.debug.pixelCullingEnable},this.pixelCullingThreshold=function(){return this.options.debug.pixelCullingThreshold},this.getMemoryInfo=function(){var a=0;if(m.model){var b=m.model.getGeometryList();b&&(a=b.geomMemory/j)}return this.onDemandLoadingEnabled()?{limit:this.options.limit,effectiveLimit:this.options.limit,loaded:a+m.fileMemorySize}:null},this.loadPackFile=function(a){return!!this.onDemandLoadingEnabled()&&(!(a<0||z&&a>=y)&&(a>v&&(v=a),o[a]&f||(a<=t&&this.reset(),o[a]|=h|f),k(this.options),!0))},this.promisePackFile=function(a){if(!this.onDemandLoadingEnabled())return Promise.reject({reason:"Not supported"});if(a<0||a>=y)return Promise.reject({reason:"Buffer id out of bounds"});var b=p[a];if(b)return k(this.options),b;var c,d;return b=new Promise(function(a,b){c=a,d=b}),b.lmv_resolve=c,b.lmv_reject=d,b.lmv_buffer_id=a,q.push(b),p[a]=b,o[a]|=h|g,k(this.options),b},this.cancelPromisedPackFile=function(a){if(!a||!a.hasOwnProperty("lmv_buffer_id")||p[a.lmv_buffer_id]!=a)return!1;var b=q.indexOf(a);b>=0&&q.splice(b,1);var c=o[a.lmv_buffer_id];return c&i&&(m.parsingWorker.doOperation({operation:e,cancelPromise:a.lmv_buffer_id}),c&f||(r-=n)),c&f?c&=~g:c=0,o[a.lmv_buffer_id]=c,delete p[a.lmv_buffer_id],a.lmv_reject&&a.lmv_reject({canceled:!0}),k(this.options),!0},this.resetIterator=function(){},this.reset=function(){m.parsingWorker.doOperation({operation:e,cancel:!0}),r=0;for(var a=0;a<o.length;++a)o[a]&g?(o[a]&=~f,o[a]&i&&(r+=n)):o[a]=0;this.lastPageOut=-1,t=-1,u=-1,A.length=0,v=y-1,++w},this.addGeomPackMissingLastFrame=function(){return!0},this.needResumeNextFrame=function(){return!1},this.pageOut=function(a,b){var c=m.model.getGeometryList(),d=c.geomMemory/j+m.fileMemorySize,e=Math.min(this.options.debug.pageOutStart*this.options.limit,this.options.limit-1.1*n),f=Math.min(this.options.debug.pageOutEnd*this.options.limit,e);if(d>e){for(var g=0,h=d-f;g<A.length&&h>0;)h-=c.removeGeometry(A[g++],m.viewer3DImpl.glrenderer())/j;for(A.splice(0,g),g=c.geoms.length;--g>0&&h>0;)(g<=u||g>t)&&(h-=c.removeGeometry(g,m.viewer3DImpl.glrenderer())/j);if(b)for(h=c.geomMemory/j-e,g=t;g>0&&h>0;--g)h-=c.removeGeometry(g,m.viewer3DImpl.glrenderer())/j;this.lastPageOut=d-c.geomMemory/j,window&&window.gc&&window.gc()}var i=c.geomMemory/j;if(a&&!z){var k=this.options.limit-i;if(k>0)for(var l=t;(k-=n)>=0;)this.loadPackFile(++l)}return WGS.PAGEOUT_SUCCESS},this.onGeomTraversed=function(a){u=a.svfid-1},this.onGeomCulled=function(a){this.onDemandLoadingEnabled()&&a&&A.push(a.svfid-1)},this.onMeshReceived=function(a,b){if(!this.onDemandLoadingEnabled())return!0;var c=p[b];if(c){c.lmv_resolve&&c.lmv_resolve(),delete p[b];var d=q.indexOf(c);d>=0&&q.splice(d,1)}return!!(o[b]&i&&(0==w||o[b]&g))&&(b>=y&&(y=b+1,s+=a.vb.byteLength+a.indices.byteLength+WGS.GEOMETRY_OVERHEAD),o[b]&f&&m.viewer3DImpl.invalidate(!1,!0),o[b]=0,r-=n,!0)},this.onFinalFrame=function(){this.onDemandLoadingEnabled()&&(z||(this.totalGeomSize=s/j+m.fileMemorySize),z=!0,o.splice(y,o.length).forEach(function(a){a&i&&(r-=n)}))},this.preparedPackFilesSize=function(){return m.fileMemorySize+r+m.model.getGeometryList().geomMemory/j},this.cancelAcknowledged=function(){--w}};a.prototype.transferToDelegate=function(a){return null==this.delegate?(console.warn("Cannot transfer destroyed loader to new delegate"),!1):(this.viewer3DImpl=a.viewer3DImpl,this.delegate=WGS.FileLoader.copyDelegate(this,a),this.model&&this.model.getData()&&this.model.getData().propDbLoader&&this.model.getData().propDbLoader.transferToDelegate(this.delegate),!0)},a.prototype.dtor=function(){this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,d.logger.debug("F2D loader dtor: on init worker script.")),this.streamingWorker&&(this.streamingWorker.terminate(),this.streamingWorker=null,d.logger.debug("F2D loader dtor: on streaming worker.")),this.parsingWorker&&(this.parsingWorker.terminate(),this.parsingWorker=null,d.logger.debug("F2D loader dtor: on parsing worker.")),this.svf&&this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null),this.viewer3DImpl=null,this.loading=!1,this.tmpMatrix=null,this.logger=null,this.loadTime=0,this.svf=null,this.options=null,this.pagingProxy=null},a.prototype.isValid=function(){return null!=this.viewer3DImpl},a.prototype.loadFile=function(a,b,c,e){if(!this.viewer3DImpl)return d.logger.log("F2D loader was already destructed. So no longer usable."),!1;if(this.loading)return d.logger.log("Loading of F2D already in progress. Ignoring new request."),!1;this.loading=!0,this.viewer3DImpl._addLoadingFile(this);var f=a.indexOf("urn:");if(-1!=f){a=decodeURIComponent(a);var g=a.substr(f,a.substr(f).indexOf("/"));d.logger.log("Extracted URN: "+g);var h=g.lastIndexOf(":");this.svfUrn=g.substr(h+1)}else this.svfUrn=a;this.sharedDbPath=b.sharedPropertyDbPath,this.currentLoadPath=a,this.acmSessionId=b.acmSessionId,this.queryParams="",this.acmSessionId&&(this.queryParams="acmsession="+this.acmSessionId),this.options=b,this.options.placementTransform?this.modelScale=this.options.modelScale||this.options.placementTransform.getMaxScaleOnAxis():this.modelScale=this.options.modelScale||1,this.isf2d=!0;var i=this;d.processMemoryOptions(this.viewer3DImpl.api.config);var j=this.viewer3DImpl.api.config&&this.viewer3DImpl.api.config.memory,k=this.memoryOpts={onDemandLoading:!1,debug:{}};return j&&(j.hasOwnProperty("limit")&&(k.limit=j.limit,k.onDemandLoading=!0,WGS.memoryOptimizedLoading=!0,k.pageOutGeometryEnabled=!0),k.debug=j.debug||{}),this.initWorkerScriptToken=this.delegate.workerScript.initWorkerScript(function(){i.loadFydoCB(a,b,c,e)}),!0};a.prototype.loadFydoCB=function(a,f,g,h){this.t0=Date.now();var i=WGS.pathToURL(a);this.streamingWorker=this.delegate.workerScript.createWorker(),this.parsingWorker=this.delegate.workerScript.createWorker();var k=this,l=!0,m=function(){k.memoryOpts.onDemandLoading||(k.parsingWorker.terminate(),k.parsingWorker=null)},n=function(a){if(k.isValid()){var b=function(a){if(a){var b=a.geom_metrics,c=3*(b.arcs+b.circ_arcs);c+=b.circles,c+=b.pline_points-(b.plines||0),c+=b.rasters,c+=b.ptri_indices/3*3;var e,f=d.isMobileDevice?16383:32767;k.useInstancing?(c+=b.ptri_indices/3,e=0,f/=4):(e=6*c+b.ptri_indices,c*=4,c+=b.ptri_points);var g=(c*(48+WGS.GEOMETRY_OVERHEAD/f)+2*e)/j+k.fileMemorySize,h=k.memoryOpts;h.onDemandLoading&&!h.debug.force&&g<h.limit&&(h.onDemandLoading=!1,h.pageOutGeometryEnabled=!1),k.totalGeomSize=g}return k.memoryOpts.onDemandLoading};l&&h&&(l=!1,h());var m;a.data&&"F2DBLOB"==a.data.type?(a.data.hasOwnProperty("f2dSize")&&(k.fileMemorySize=a.data.f2dSize/j),b(a.data.metadata),m={operation:"PARSE_F2D",data:a.data.buffer,metadata:a.data.metadata,manifest:a.data.manifest,basePath:a.data.basePath,f2dLoadOptions:{modelSpace:f.modelSpace,bgColor:f.bgColor,isMobile:c.isMobileDevice(),useInstancing:k.useInstancing,onDemandLoading:k.memoryOpts.onDemandLoading},url:i},k.parsingWorker.doOperation(m,[m.data]),k.streamingWorker.terminate(),k.streamingWorker=null):a.data&&"F2DSTREAM"==a.data.type?(a.data.hasOwnProperty("f2dSize")&&(k.fileMemorySize=2*a.data.f2dSize/j),b(a.data.metadata),m={operation:e,
data:a.data.frames,url:i,f2dLoadOptions:{modelSpace:f.modelSpace,bgColor:f.bgColor,isMobile:c.isMobileDevice(),useInstancing:k.useInstancing,onDemandLoading:k.memoryOpts.onDemandLoading}},a.data.metadata&&(m.metadata=a.data.metadata,m.manifest=a.data.manifest),a.data.finalFrame&&(m.finalFrame=!0,k.streamingWorker.terminate(),k.streamingWorker=null,k.fileMemorySize/=2),a.data.progress&&k.viewer3DImpl.signalProgress(100*a.data.progress,c.ProgressState.LOADING),k.parsingWorker.doOperation(m,m.data?[m.data]:void 0)):a.data&&"F2DAssetURL"==a.data.type?d.assets=d.assets.concat(a.data.urls):a.data&&a.data.assetRequest?d.assets.push(a.data.assetRequest):a.data&&a.data.progress||(a.data&&a.data.debug?d.logger.debug(a.data.message):a.data&&a.data.error?(k.loading=!1,k.streamingWorker.terminate(),k.streamingWorker=null,g&&g.call(this,a.data.error)):(d.logger.error("F2D download failed.",c.errorCodeString(c.ErrorCodes.NETWORK_FAILURE)),k.loading=!1,k.streamingWorker.terminate(),k.streamingWorker=null))}},o=function(a){if(k.isValid()){l&&h&&(l=!1,h());var e,f;if(a.data&&a.data.f2d){for(e=k.svf=a.data.f2d,m(),d.logger.info("Num polylines: "+e.numPolylines),d.logger.info("Line segments: "+e.numLineSegs),d.logger.info("Circular arcs: "+e.numCircles),d.logger.info("Ellipitcal arcs:"+e.numEllipses),d.logger.info("Plain triangles:"+e.numTriangles),d.logger.info("Total # of op codes generated by fydo.parse: "+e.opCount),k.onModelRootLoadDone(k.svf),g&&g(null,k.model),k.viewer3DImpl.api.dispatchEvent({type:c.MODEL_ROOT_LOADED_EVENT,svf:k.svf,model:k.model}),f=0;f<e.meshes.length;f++)k.processReceivedMesh2D(e.meshes[f],f);e.meshes=null,k.onGeomLoadDone(),k.loading=!1}else if(a.data&&a.data.f2dframe){var i=0;if(a.data.meshes){var j=a.data.bbox;k.svf.bbox=new THREE.Box3(j.min,j.max),i=a.data.baseIndex}else k.svf=a.data.f2dframe,i=a.data.baseIndex;if(e=k.svf,e.fragments&&e.fragments.initialized||(k.onModelRootLoadDone(e),g&&g(null,k.model),k.viewer3DImpl.api.dispatchEvent({type:c.MODEL_ROOT_LOADED_EVENT,svf:e,model:k.model})),a.data.meshes&&a.data.meshes.length){for(f=0;f<a.data.meshes.length;f++)k.processReceivedMesh2D(a.data.meshes[f],i+f);k.pagingProxy&&k.pagingProxy.onDemandLoadingEnabled()&&b(k,a.data)}if(a.data.finalFrame){var n=a.data.cumulativeProps;for(var o in n)e[o]=n[o];m(),k.onGeomLoadDone(),k.loading=!1,k.pagingProxy&&k.pagingProxy.onFinalFrame()}}else a.data&&a.data.progress||(a.data&&a.data.debug?d.logger.debug(a.data.message):a.data&&a.data.canceled&&k.pagingProxy?k.pagingProxy.cancelAcknowledged():a.data&&a.data.error?(k.loading=!1,m(),d.logger.error("Error while processing F2d: "+JSON.stringify(a.data.error.args)),g&&g.call(this,a.data.error)):(d.logger.error("F2D download failed.",c.errorCodeString(c.ErrorCodes.NETWORK_FAILURE)),k.loading=!1,m()))}};this.streamingWorker.addEventListener("message",n,!1),this.parsingWorker.addEventListener("message",o,!1);var p={operation:"STREAM_F2D",url:i,objectIds:f.ids,queryParams:this.queryParams};return this.streamingWorker.doOperation(d.initLoadContext(p)),!0},a.prototype.processReceivedMesh=function(a){var b=a.packId+":"+a.meshIndex,c=this.svf,e=c.fragments,f=e.mesh2frag[b];if(void 0===f)return void d.logger.warn("Mesh "+b+" was not referenced by any fragments.");Array.isArray(f)||(f=[f]),d.BufferGeometryUtils.meshToGeometry(a);var g=f.length,h=this.model;h.getGeometryList().addGeometry(a.geometry,g,a.meshIndex+1);for(var i=a.geometry.attributes.index.array||a.geometry.ib,j=i.length/3,k=0;k<f.length;k++){var l=0|f[k];h.getFragmentList().getOriginalWorldMatrix(l,this.tmpMatrix),this.options.placementTransform&&(this.tmpMatrix=(new THREE.Matrix4).multiplyMatrices(this.options.placementTransform,this.tmpMatrix));var m=e.materials[l].toString();e.polygonCounts&&(e.polygonCounts[l]=j);var n=this.viewer3DImpl.setupMesh(this.model,a.geometry,m,this.tmpMatrix);h.activateFragment(l,n)}e.mesh2frag[b]=null,e.numLoaded+=f.length,e.numLoaded},a.prototype.processReceivedMesh2D=function(a,b){if(!this.pagingProxy||this.pagingProxy.onMeshReceived(a,b)){var c={mesh:a,is2d:!0,packId:"0",meshIndex:b},d="0:"+b,e=this.svf.fragments;if(!e.fragId2dbId[b]){var f=Object.keys(c.mesh.dbIds).map(function(a){return parseInt(a)});e.fragId2dbId[b]=f;for(var g=0;g<f.length;g++){var h=f[g],i=e.dbId2fragId[h];Array.isArray(i)?i.push(b):e.dbId2fragId[h]=void 0!==i?[i,b]:b}a.material.modelScale=this.modelScale;var j=this.viewer3DImpl;e.materials[b]=this.viewer3DImpl.matman().create2DMaterial(this.model,a.material,!1,!1,function(){j.invalidate(!1,!0,!1)}),e.length++}e.mesh2frag[d]=b,this.processReceivedMesh(c)}},a.prototype.onModelRootLoadDone=function(a){a.fragments={},a.fragments.mesh2frag={},a.fragments.materials=[],a.fragments.fragId2dbId=[],a.fragments.dbId2fragId=[],a.fragments.length=0,a.fragments.initialized=!0,a.geomMemory=0,a.fragments.numLoaded=0,a.gpuNumMeshes=0,a.gpuMeshMemory=0,a.nextRepaintPolys=1e4,a.numRepaints=0,a.urn=this.svfUrn,a.acmSessionId=this.acmSessionId,a.basePath="";var b=this.currentLoadPath.lastIndexOf("/");-1!=b&&(a.basePath=this.currentLoadPath.substr(0,b+1)),a.loadOptions=this.options;var e=Date.now();this.loadTime+=e-this.t0,d.logger.log("SVF load: "+(e-this.t0)),this.t0=e,a.bbox=(new THREE.Box3).copy(a.bbox);var f=this.model=new c.Model(a);f.loader=this;var g=this.memoryOpts;this.viewer3DImpl.modelQueue().getModels().length>0&&(g.pageOutGeometryEnabled=!1),g.onDemandLoading&&(this.pagingProxy=new k(this,g)),f.initialize(this.pagingProxy),!(this.model.getFragmentList().onDemandLoadingEnabled()&&c.isMobileDevice())&&!this.options.skipPropertyDb&&(this.svf.propDbLoader=new WGS.PropDbLoader(this.sharedDbPath,this.model,this.delegate)),d.logger.log("scene bounds: "+JSON.stringify(a.bbox));var h={category:"metadata_load_stats",urn:a.urn,layers:a.layerCount};d.logger.track(h),this.viewer3DImpl.signalProgress(5,c.ProgressState.ROOT_LOADED),this.viewer3DImpl.invalidate(!1,!1)},a.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0,this.svf.fragments.entityIndexes=null,this.memoryOpts.onDemandLoading||(this.svf.fragments.mesh2frag=null);var a=Date.now(),b="Fragments load time: "+(a-this.t0);this.loadTime+=a-this.t0,this.options.skipPropertyDb||this.loadPropertyDb(),d.logger.log(b);var e={category:"model_load_stats",is_f2d:!0,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,urn:this.svfUrn};d.logger.track(e,!0),d.assets&&c.isBrowser&&window.webkit&&(!function(a){if(c.isBrowser){var b=window.webkit.messageHandlers.callbackHandler;if(!b)return;b.doOperation?b.doOperation({command:"assets",data:a}):b.postMessage&&b.postMessage({command:"assets",data:a})}}(d.assets),d.assets=null),this.currentLoadPath=null,this.isf2d=void 0,this.memoryOpts.onDemandLoading?this.viewer3DImpl.onDemandLoadComplete(this.model):this.viewer3DImpl.onLoadComplete(this.model)},a.prototype.loadPropertyDb=function(){this.svf.propDbLoader&&this.svf.propDbLoader.load()},a.prototype.is3d=function(){return!1},d.F2DLoader=a,d.F2DPagingProxy=k,c.FileLoaderManager.registerFileLoader("f2d",["f2d"],d.F2DLoader)}(),function(){"use strict";var a=function(a,b){this.viewer3DImpl=a.viewer3DImpl,this.delegate=WGS.FileLoader.copyDelegate(this,a),this.loading=!1};a.prototype.transferToDelegate=function(a){return null==this.delegate?(console.warn("Cannot transfer destroyed loader to new delegate"),!1):(this.viewer3DImpl=a.viewer3DImpl,this.delegate=WGS.FileLoader.copyDelegate(this,a),this.model&&this.model.getData()&&this.model.getData().propDbLoader&&this.model.getData().propDbLoader.transferToDelegate(this.delegate),!0)},a.prototype.dtor=function(){this.viewer3DImpl=null,this.model=null,this.svf=null,this.logger=null,this.loading=!1},a.prototype.isValid=function(){return null!=this.viewer3DImpl},a.prototype.loadFile=function(a,b,c,d){if(!this.viewer3DImpl)return avp.logger.log("Scalaris loader was already destructed. So no longer usable."),!1;if(this.loading)return avp.logger.log("Loading of Scalaris already in progress. Ignoring new request."),!1;this.loading=!0,this.viewer3DImpl._addLoadingFile(this),this.currentLoadPath=a;var e="",f=this.currentLoadPath.lastIndexOf("/");-1!=f&&(e=this.currentLoadPath.substr(0,f+1)),this.basePath=e,this.options=b,this.options.debug={},this.options.preserveView=!0;var g=this;return this.initWorkerScriptToken=this.delegate.workerScript.initWorkerScript(function(){g.loadScalarisCB(a,g.options,c,d)}),!0},a.prototype.loadScalarisCB=function(a,b,c,d){var e=!0,f=this,g=this.svfWorker=this.delegate.workerScript.createWorkerWithIntercept(),h=function(a){var b=function(){g&&(g.clearAllEventListenerWithIntercept(),g.terminate(),f.svfWorker=null,g=null)};if(e&&d&&(e=!1,d()),a.data&&a.data.geometry){var h=f.svf=a.data.geometry;f.onModelRootLoadDone(h),c&&c(null,f.model),f.viewer3DImpl.api.dispatchEvent({type:WGS.MODEL_ROOT_LOADED_EVENT,svf:h,model:f.model}),f.svf.loadDone=!1}else a.data&&a.data.progress?1==a.data.progress&&setTimeout(function(){f.onGeomLoadDone(),f.loading=!1,b()},0):a.data&&a.data.error?(f.loading=!1,b(),c&&c(a.data.error,null)):a.data&&a.data.debug?avp.logger.debug(a.data.message):(avp.logger.error("Scalaris load failed.",av.errorCodeString(av.ErrorCodes.NETWORK_FAILURE)),f.loading=!1,b())};g.addEventListenerWithIntercept(h);var i={url:WGS.pathToURL(a),basePath:this.currentLoadPath,scalarisProtoPath:avp.getResourceUrl("res/protobuf/scalaris.proto")};return i.operation="LOAD_SCALARIS",g.doOperation(avp.initLoadContext(i)),!0},a.prototype.onModelRootLoadDone=function(a){this.viewer3DImpl._removeLoadingFile(this),a.basePath=this.basePath,a.disableStreaming=!0,a.geomPolyCount=0,a.gpuNumMeshes=0,a.gpuMeshMemory=0,a.fragments={length:a.meshCount,numLoaded:0,boxes:null,transforms:null,materials:null,fragId2dbId:null,entityIndexes:null,mesh2frag:null},a.animations=null,a.nodeToDbId={},a.loadOptions=this.options,a.bbox=new THREE.Box3(a.min,a.max);var b=this.model=new av.Model(a);a.urn&&b.setUUID(a.urn),b.initialize(),b.loader=this,this.viewer3DImpl.signalProgress(5,av.ProgressState.ROOT_LOADED),this.viewer3DImpl.invalidate(!1,!1)},a.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0;var a=this.svf.fragments.length;this.svf.numGeoms=a,this.svf.fragments.numLoaded=a,this.svf.fragments.boxes=new Float32Array(6*a),this.svf.fragments.transforms=new Float32Array(12*a),this.svf.fragments.materials=new Int32Array(a),this.svf.fragments.fragId2dbId=new Int32Array(a),this.svf.fragments.mesh2frag=new Int32Array(a);var b=function(a){if(0===a.offsets.length)for(var b=a.attributes.index.array.length/3,c=b/21845,d=0;d<c;d++){var e={start:21845*d*3,count:3*Math.min(b-21845*d,21845)};a.addDrawCall(e.start,e.count)}},c=function(a){0==a.attributes.normal.array.length&&(a.attributes.normal.array=new Float32Array(a.attributes.position.array.length),a.computeVertexNormals())},d=this.svf,e=function(a){var d=new THREE.BufferGeometry;if(d.byteSize=0,d.addAttribute("index",new THREE.BufferAttribute(new Uint32Array(a.indices),1)),d.addAttribute("position",new THREE.BufferAttribute(new Float32Array(a.vertices),3)),d.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(a.normals),3)),a.hasOwnProperty("uvs")&&a.uvs.byteLength>0&&(d.byteSize+=a.uvs.byteLength,d.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(a.uvs),2))),d.hasColors=!1,a.hasOwnProperty("colors")&&a.colors.byteLength>0&&(d.byteSize+=a.colors.byteLength,d.addAttribute("color",new THREE.BufferAttribute(new Float32Array(a.colors),3)),d.hasColors=!0,d.colorsNeedUpdate=!0),d.attributes.index.array.length>0&&d.attributes.position.array.length>0){if(a.hasOwnProperty("offsets")&&a.offsets.byteLength>0){d.byteSize+=a.offsets.byteLength;for(var e=0;e<a.offsets.length;e++){var f=a.offsets[e];d.addDrawCall(f.start,f.count)}}return a.min?d.boundingBox=new THREE.Box3(new THREE.Vector3(a.min.x,a.min.y,a.min.z),new THREE.Vector3(a.max.x,a.max.y,a.max.z)):d.computeBoundingBox(),a.bbox.min=a.min=d.boundingBox.min,a.bbox.max=a.max=d.boundingBox.max,b(d),c(d),d.byteSize+=a.indices.byteLength+a.vertices.byteLength+a.normals.byteLength,d.polyCount=d.attributes.index.array.length/3,d}return null}(d);d.geomPolyCount+=e.polyCount;this.createInstanceTree(0);this.model.getGeometryList().addGeometry(e,1,0);var f=new THREE.Matrix4,g=this.viewer3DImpl.setupMesh(this.model,e,null,f);d.fragments.materials[0]=null,d.fragments.fragId2dbId[0]=2,d.fragments.mesh2frag[0]=0;var h=d.fragments.boxes;h[0]=d.min.x,h[1]=d.min.y,h[2]=d.min.z,h[3]=d.max.x,h[4]=d.max.y,h[5]=d.max.z;for(var i=d.fragments.transforms,j=0;j<12;j++)i[j]=0;if(i[0]=i[4]=i[8]=1,this.model.activateFragment(0,g,!!d.placementTransform),this.currentLoadPath=null,this.viewer3DImpl.api.setModelUnits("meter"),this.viewer3DImpl.onLoadComplete(this.model),this.viewer3DImpl.api.config.disabledExtensions.scalarisSimulation&&e.hasColors&&d.colors.byteLength){var k=this.viewer3DImpl.getMaterials().defaultMaterial;k.vertexColors=THREE.NoColors,k.needsUpdate=!0,this.viewer3DImpl.invalidate(!0,!0,!1)}this.viewer3DImpl.api.fitToView()},a.prototype.createInstanceTree=function(a){var b=new avp.InstanceTreeStorage(2,1),c=[2],d=[];b.setNode(1,0,"RootNode",0,c,[]),b.setNode(2,1,"Geometry",0,d,[a]);var e=new avp.InstanceTreeAccess(b,0);e.computeBoxes(this.svf.fragments.boxes),this.svf.instanceTree=new avp.InstanceTree(e,1,1)},a.prototype.is3d=function(){return!0},av.ScalarisLoader=a,av.FileLoaderManager.registerFileLoader("scalaris",["scalaris"],av.ScalarisLoader)}(),function(){"use strict";function a(a){var d=a.viewer3DImpl,e=function(a,b){var d=[80,75,1,2],e=b;if(a[e++]!==d[0]||a[e++]!==d[1]||a[e++]!==d[2]||a[e++]!==d[3])return c.logger.error("invalid file header signature"),null;var f={};return f.version=a[e++],f.os=a[e++],f.needVersion=a[e++]|a[e++]<<8,f.flags=a[e++]|a[e++]<<8,f.compression=a[e++]|a[e++]<<8,f.time=a[e++]|a[e++]<<8,f.date=a[e++]|a[e++]<<8,f.crc32=(a[e++]|a[e++]<<8|a[e++]<<16|a[e++]<<24)>>>0,f.compressedSize=(a[e++]|a[e++]<<8|a[e++]<<16|a[e++]<<24)>>>0,f.plainSize=(a[e++]|a[e++]<<8|a[e++]<<16|a[e++]<<24)>>>0,f.fileNameLength=a[e++]|a[e++]<<8,f.extraFieldLength=a[e++]|a[e++]<<8,f.fileCommentLength=a[e++]|a[e++]<<8,f.diskNumberStart=a[e++]|a[e++]<<8,f.internalFileAttributes=a[e++]|a[e++]<<8,f.externalFileAttributes=a[e++]|a[e++]<<8|a[e++]<<16|a[e++]<<24,f.relativeOffset=(a[e++]|a[e++]<<8|a[e++]<<16|a[e++]<<24)>>>0,f.filename=String.fromCharCode.apply(null,a.slice(e,e+=f.fileNameLength)),f.extraField=a.slice(e,e+=f.extraFieldLength),f.comment=a.slice(e,e+f.fileCommentLength),f.length=e-b,f},f=function(a){var b=[80,75,3,4],d=0;if(a[d++]!==b[0]||a[d++]!==b[1]||a[d++]!==b[2]||a[d++]!==b[3])return c.logger.error("invalid local file header signature"),null;var e={};return e.needVersion=a[d++]|a[d++]<<8,e.flags=a[d++]|a[d++]<<8,e.compression=a[d++]|a[d++]<<8,e.time=a[d++]|a[d++]<<8,e.date=a[d++]|a[d++]<<8,e.crc32=(a[d++]|a[d++]<<8|a[d++]<<16|a[d++]<<24)>>>0,e.compressedSize=(a[d++]|a[d++]<<8|a[d++]<<16|a[d++]<<24)>>>0,e.plainSize=(a[d++]|a[d++]<<8|a[d++]<<16|a[d++]<<24)>>>0,e.fileNameLength=a[d++]|a[d++]<<8,e.extraFieldLength=a[d++]|a[d++]<<8,e.filename=String.fromCharCode.apply(null,a.slice(d,d+=e.fileNameLength)),e.extraField=a.slice(d,d+=e.extraFieldLength),e.length=d,e},g=function(a){var b=f(a),c=b.length,d=b.compressedSize;return a.slice(c,c+d)},h=function(a,b,c){for(var d,f=0,g=[],h=null,i=0;i<c;++i){if(!(d=e(a,f)))return null;h&&(h.contentSize=d.relativeOffset-h.relativeOffset),f+=d.length,g[d.filename]=d,h=d}return h.contentSize=b-h.relativeOffset,g},i=function(a,b,d,e,f,g){var h=null;if(!c.offline){b&&(h="acmsession="+b);var i="start="+d+"&end="+(e+d);h?h+="&"+i:h=i}var j=c.initLoadContext({queryParams:h});c.ViewingService.getItem(j,a,f,g)};this.continueLoadFile=function(a,e,f,g,h,i){function j(){function g(c){this.bbox=new THREE.Box3,this.basePath=a,this.is2d=!0;var e=c&&c.paperWidth>=0?c.paperWidth:h.texWidth,f=c&&c.paperHeight>=0?c.paperHeight:h.texHeight;this.pageToModelTransform=h.getPageToModelTransform(e,f),this.metadata={},this.metadata.page_dimensions={};var g=this.metadata.page_dimensions;g.page_width=e,g.page_height=f,g.page_units=c.paperUnits,this.loadDone=!0,this.isLeaflet=!0,d.signalProgress(100,b.ProgressState.LOADING),h.texWidth>0&&(this.maxPixelPerUnit=h.texWidth/h.getQuadWidth())}var i=new g(e.loadOptions);i.loadOptions=e,m.getVisibleBounds(i.bbox);var j=new b.Model(i);j.initFromCustomIterator(m),m.callWhenRefined(function(){var a=Date.now();i.loadTime=a-k.t0,c.logger.log("SVF load: "+i.loadTime)}),f(null,j)}var k=this,l=e.loadOptions.loadFromZip?"{z}/{x}_{y}.jpeg":a;h.initFromLoadOptions(l,e.loadOptions,i);var m=null;g&&g();var n=!h.valid();n&&h.initForSimpleImage(a,j),h.pixelRatio=d.glrenderer().getPixelRatio(),m=new c.ModelIteratorTexQuad(h,d.getMaterials()),n||j()},this.loadFile=function(a,d,e,f){var j=this;this.t0=Date.now();var k=new c.TexQuadConfig,l=null,m=d.acmSessionId;if(d.loadOptions&&d.loadOptions.loadFromZip){l=function(a,b,d){for(var e,f=a.split("/")[0]-k.levelOffset,h=0;h<k.zips.length;h++)if(f<=k.zips[h].zipMaxLevel){e=k.zips[h];break}if(!e)return d("Failed loading texture - tile's level doesn't exists."),!1;var i=e.fileTable[a];if(!i)return d("Failed loading texture - entry does not exist inside fileTable."),!1;var j={extractImage:g},l=i.relativeOffset,n=i.relativeOffset+i.contentSize;if(e.rawData)j.rawData=e.rawData.slice(l,n);else{var o="start="+l+"&end="+n;j.queryParams=o}WGS.TextureLoader.loadTextureWithSecurity(e.urnZip,!1,THREE.UVMapping,b,m,c.initLoadContext,!k.valid(),j)};var n=function(){return d.loadOptions.zips.every(function(a){return!!a.fileTable})};d.loadOptions.zips.forEach(function(g){var o=g.centralDirOffset,p=g.centralDirLength,q=g.centralDirEntries,r=function(b){c.offline&&(g.rawData=b,b=b.slice(o,o+p));var i=h(b,o,q);if(!i)return e("Failed parsing central directory of the zip.",null),!1;g.fileTable=i,n()&&j.continueLoadFile(a,d,e,f,k,l)},s=function(a){c.logger.error("Zip download failed: "+a.statusText,b.errorCodeString(b.ErrorCodes.NETWORK_FAILURE)),e("Zip download failed: "+a.statusText,null)};i(g.urnZip,m,o,p,r,s)})}else l=function(a,b,d){WGS.TextureLoader.loadTextureWithSecurity(a,!1,THREE.UVMapping,b,m,c.initLoadContext,!k.valid())},this.continueLoadFile(a,d,e,f,k,l)}}var b=Autodesk.Viewing,c=Autodesk.Viewing.Private;a.computeLevelOffset=function(a){for(var b=1,d=0,e=0;e<20;e++){if((b*=2)>a)return d;d++}return c.logger.log("unexpected leaflet tileSize"),0},a.prototype.is3d=function(){return!1},Autodesk.Viewing.Private.LeafletLoader=a,Autodesk.Viewing.FileLoaderManager.registerFileLoader("Leaflet",["jpeg","jpg","png"],c.LeafletLoader)}(),function(){"use strict";function a(a,b,c){var d=b||65536;this.FULL_COUNT=0|(c||32767),this.useInstancing=a,this.stride=12,this.vb=new ArrayBuffer(4*this.stride*(this.useInstancing?d/4:d)),this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.ib=this.useInstancing?null:new Uint16Array(d),this.reset(0)}var b=Autodesk.Viewing,c=b.Private,d=2*Math.PI,e=[0,1,3,0,3,2];a.prototype.reset=function(a){this.vcount=a,this.icount=0,this.minx=this.miny=1/0,this.maxx=this.maxy=-1/0,this.dbIds={},this.numEllipticals=0,this.numCirculars=0,this.numTriangleGeoms=0},a.prototype.expandStride=function(){},a.prototype.addToBounds=function(a,b){a<this.minx&&(this.minx=a),a>this.maxx&&(this.maxx=a),b<this.miny&&(this.miny=b),b>this.maxy&&(this.maxy=b)},a.prototype.setCommonVertexAttribs=function(a,b,c,d,e,f,g,h){b&=255,c&=255,h&=255,f&=65535,g&=65535,this.vbi[a+8]=b|c<<8|h<<16,this.vbi[a+6]=d,this.vbi[a+7]=e,this.vbi[a+9]=f|g<<16,this.dbIds[e]=1},a.prototype.addVertexTriangleGeom=function(a,b,c,d,e,f,g,h,i,j){for(var k=this.vcount,l=this.vbf,m=this.useInstancing?1:4,n=0;n<m;n++){var o=(k+n)*this.stride;l[o]=a,l[o+1]=b,l[o+2]=c,l[o+3]=d,l[o+4]=e,l[o+5]=f,this.setCommonVertexAttribs(o,0+n,5,g,h,i,j,0),this.vcount++}return k},a.prototype.addVertexLine=function(a,b,c,d,e,f,g,h,i,j,k){for(var l=this.vcount,m=this.vbf,n=this.useInstancing?1:4,o=0;o<n;o++){var p=(l+o)*this.stride;m[p]=a,m[p+1]=b,m[p+2]=c,m[p+3]=d,m[p+4]=.5*f,m[p+5]=e,this.setCommonVertexAttribs(p,0+o,1,g,h,i,j,k),this.vcount++}return l},a.prototype.addVertexTexQuad=function(a,b,c,d,e,f,g,h,i){for(var j=this.vcount,k=this.vbf,l=this.useInstancing?1:4,m=0;m<l;m++){var n=(j+m)*this.stride;k[n]=a,k[n+1]=b,k[n+2]=e,k[n+3]=c,k[n+4]=d,this.setCommonVertexAttribs(n,0+m,4,f,g,h,i,0),this.vcount++}return j},a.prototype.addVertexArc=function(a,b,c,d,e,f,g,h,i,j,k,l){for(var m=this.vcount,n=this.vbf,o=e==f?2:3,p=this.useInstancing?1:4,q=0;q<p;q++){var r=(m+q)*this.stride;n[r]=a,n[r+1]=b,n[r+2]=c,n[r+3]=d,n[r+4]=.5*h,n[r+5]=e,3===o&&(n[r+10]=f,n[r+11]=g),this.setCommonVertexAttribs(r,0+q,o,i,j,k,l,0),this.vcount++}return m},a.prototype.addVertex=function(a,b,c,d,e,f){if(!this.useInstancing){var g=this.vcount,h=this.stride*g,i=this.vbf;return i[h]=a,i[h+1]=b,this.setCommonVertexAttribs(h,0,0,c,d,e,f,0),this.vcount++,g}},a.prototype.addVertexPolytriangle=function(a,b,c,d,e,f){this.useInstancing||(this.addVertex(a,b,c,d,e,f),this.addToBounds(a,b))},a.prototype.addIndices=function(a,b){if(!this.useInstancing){var c=this.ib,d=this.icount;if(d+a.length>=c.length){for(var e=new Uint16Array(2*Math.max(a.length,c.length)),f=0;f<d;++f)e[f]=c[f];this.ib=c=e}for(var f=0;f<a.length;++f)c[d+f]=b+a[f];this.icount+=a.length}},a.prototype.finalizeQuad=function(a){this.useInstancing||this.addIndices(e,a)},a.prototype.addSegment=function(a,b,c,d,e,f,g,h,i,j,k){var l=c-a,m=d-b,n=l||m?Math.atan2(m,l):0,o=l||m?Math.sqrt(l*l+m*m):0,p=this.addVertexLine(a,b,n,o,e,f,g,h,i,j,k);this.finalizeQuad(p),this.addToBounds(a,b),this.addToBounds(c,d)},a.prototype.addTriangleGeom=function(a,b,c,d,e,f,g,h,i,j){this.numTriangleGeoms++;var k=this.addVertexTriangleGeom(a,b,c,d,e,f,g,h,i,j);this.finalizeQuad(k),this.addToBounds(a,b),this.addToBounds(c,d),this.addToBounds(e,f)},a.prototype.addArc=function(a,b,c,e,g,h,i,j,k,l,m,n){g==h?this.numCirculars++:this.numEllipticals++;var o=f(c,e);c=o.start,e=o.end,0==c&&0==e&&(e=d);var p=Math.abs(c-e);if(p>1e-4&&Math.abs(p-d)>1e-4){var q=a+g*Math.cos(c),r=b+h*Math.sin(c);this.addSegment(q,r,q,r,0,j,k,l,m,n);var s=a+g*Math.cos(e),t=b+h*Math.sin(e);this.addSegment(s,t,s,t,0,j,k,l,m,n)}else this.addToBounds(a-g,b-h),this.addToBounds(a+g,b+h);var u=this.addVertexLine(a,b,0,1e-4,0,0,1,l,m,n);this.finalizeQuad(u);var v=this.addVertexArc(a,b,c,e,g,h,i,j,k,l,m,n);this.finalizeQuad(v);var p,q,r,s,t},a.prototype.addTexturedQuad=function(a,b,c,d,e,f,g,h,i){var j=this.addVertexTexQuad(a,b,c,d,e,f,g,h,i);this.finalizeQuad(j);var k=.5*Math.cos(e),l=.5*Math.sin(e),m=Math.abs(c*k)+Math.abs(d*l),n=Math.abs(c*l)+Math.abs(d*k);this.addToBounds(a-m,b-n),this.addToBounds(a+m,b+n)},a.prototype.isFull=function(a){a=a||3;var b=this.useInstancing?4:1;return this.vcount*b+a>this.FULL_COUNT},a.prototype.toMesh=function(){var a={};a.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4)),a.vbstride=this.stride;var b=this.useInstancing?1:0;if(a.vblayout={fields1:{offset:0,itemSize:3,bytesPerItem:4,divisor:b,normalize:!1},fields2:{offset:3,itemSize:3,bytesPerItem:4,divisor:b,normalize:!1},color4b:{offset:6,itemSize:4,bytesPerItem:1,divisor:b,normalize:!0},dbId4b:{offset:7,itemSize:4,bytesPerItem:1,divisor:b,normalize:!1},flags4b:{offset:8,itemSize:4,bytesPerItem:1,divisor:b,normalize:!1},layerVp4b:{offset:9,itemSize:4,bytesPerItem:1,divisor:b,normalize:!1}},this.stride>10&&(a.vblayout.extraParams={offset:10,itemSize:2,bytesPerItem:4,divisor:b,normalize:!1}),this.useInstancing){a.numInstances=this.vcount;var c=new Int32Array([0,1,2,3]);a.vblayout.instFlags4b={offset:0,itemSize:4,bytesPerItem:1,divisor:0,normalize:!1},a.vblayout.instFlags4b.array=c.buffer;a.indices=new Uint16Array(e)}else a.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));a.dbIds=this.dbIds;var d=this.maxx-this.minx,f=this.maxy-this.miny,g=Math.max(d,f);a.boundingBox={min:{x:this.minx,y:this.miny,z:.001*-g},max:{x:this.maxx,y:this.maxy,z:.001*g}};a.boundingSphere={center:{x:.5*(this.minx+this.maxx),y:.5*(this.miny+this.maxy),z:0},radius:.5*Math.sqrt(d*d+f*f)};return a};var f=function(a,b){function c(){function c(a,b){return Math.abs(a-b)<.001}c(a,0)&&(a=0),c(b,0)&&(b=0),c(a,d)&&(a=d),c(b,d)&&(b=d)}if(c(),a>b)for(;a>d;)a-=d,b-=d;else for(;b>d;)a-=d,b-=d;return c(),a<0&&b>0&&(a+=d),{start:a,end:b}};c.VertexBufferBuilder=a}(),function(){"use strict";function a(a){this.bounds=a,this.point=new THREE.Vector4,this.point.z=0,this.point.w=1}var b=(Autodesk.Viewing,Autodesk.Viewing.Private);Math.PI;b.VertexBufferReader=function(a,b){this.vb=a.vb.buffer,this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.ib=a.ib,this.stride=a.vbstride,this.vcount=this.vbf.length/this.stride,this.useInstancing=!!b},b.VertexBufferReader.prototype.getDbIdAt=function(a){return this.vbi[a*this.stride+7]},b.VertexBufferReader.prototype.getVertexFlagsAt=function(a){return this.vbi[a*this.stride+8]},b.VertexBufferReader.prototype.getLayerIndexAt=function(a){return 65535&this.vbi[a*this.stride+9]},b.VertexBufferReader.prototype.getViewportIndexAt=function(a){return this.vbi[a*this.stride+9]>>16&65535},b.VertexBufferReader.prototype.decodeLineAt=function(a,b,c,d){if(d.onLineSegment){var e=this.stride*a,f=this.vbf[e],g=this.vbf[e+1],h=this.vbf[e+2],i=this.vbf[e+3],j=f+i*Math.cos(h),k=g+i*Math.sin(h);d.onLineSegment(f,g,j,k,c)}},b.VertexBufferReader.prototype.decodeCircularArcAt=function(a,b,c,d){if(d.onCircularArc){var e=this.stride*a,f=this.vbf[e],g=this.vbf[e+1],h=this.vbf[e+2],i=this.vbf[e+3],j=this.vbf[e+5];d.onCircularArc(f,g,h,i,j,c)}},b.VertexBufferReader.prototype.decodeEllipticalArcAt=function(a,b,c,d){if(d.onEllipticalArc){var e=this.stride*a,f=this.vbf[e],g=this.vbf[e+1],h=this.vbf[e+2],i=this.vbf[e+3],j=this.vbf[e+5],k=this.vbf[e+10],l=this.vbf[e+11];d.onEllipticalArc(f,g,h,i,j,k,l,c)}},b.VertexBufferReader.prototype.decodeTexQuadAt=function(a,b,c,d){if(d.onTexQuad){var e=this.stride*a,f=this.vbf[e],g=this.vbf[e+1],h=this.vbf[e+2],i=this.vbf[e+3],j=this.vbf[e+4];d.onTexQuad(f,g,i,j,h,c)}},b.VertexBufferReader.prototype.decodeOneTriangleAt=function(a,b,c,d){if(d.onOneTriangle){var e=this.stride*a,f=this.vbf[e],g=this.vbf[e+1],h=this.vbf[e+2],i=this.vbf[e+3],j=this.vbf[e+4],k=this.vbf[e+5];d.onOneTriangle(f,g,h,i,j,k,c)}},b.VertexBufferReader.prototype.decodeTriangleIndexed=function(a,b,c,d,e,f){if(f.onOneTriangle){var g=this.stride*a,h=this.vbf[g],i=this.vbf[g+1];g=this.stride*b;var j=this.vbf[g],k=this.vbf[g+1];g=this.stride*c;var l=this.vbf[g],m=this.vbf[g+1];f.onOneTriangle(h,i,j,k,l,m,e)}},b.VertexBufferReader.prototype.enumGeomsForObject=function(a,b){if(this.useInstancing)for(var c=0;c<this.vcount;){var d=this.getVertexFlagsAt(c),e=d>>8&255,f=this.getLayerIndexAt(c),g=this.getViewportIndexAt(c),h=this.getDbIdAt(c)===a;if(h)switch(e){case 1:this.decodeLineAt(c,f,g,b);break;case 2:this.decodeCircularArcAt(c,f,g,b);break;case 3:this.decodeEllipticalArcAt(c,f,g,b);break;case 4:this.decodeTexQuadAt(c,f,g,b);break;case 5:this.decodeOneTriangleAt(c,f,g,b)}c+=1}else for(var c=0;c<this.ib.length;){var i=this.ib[c],d=this.getVertexFlagsAt(i),e=d>>8&255,f=this.getLayerIndexAt(i),g=this.getViewportIndexAt(i),h=this.getDbIdAt(i)===a;if(0===e)h&&this.decodeTriangleIndexed(this.ib[c],this.ib[c+1],this.ib[c+2],f,g,b),c+=3;else{if(h)switch(e){case 1:this.decodeLineAt(i,f,g,b);break;case 2:this.decodeCircularArcAt(i,f,g,b);break;case 3:this.decodeEllipticalArcAt(i,f,g,b);break;case 4:this.decodeTexQuadAt(i,f,g,b);break;case 5:this.decodeOneTriangleAt(i,f,g,b)}c+=6}}},b.VertexBufferReader.prototype.enumGeomsForVisibleLayer=function(a,b){if(this.useInstancing)for(var c=0;c<this.vcount;){var d=this.getVertexFlagsAt(c),e=d>>8&255,f=this.getLayerIndexAt(c),g=this.getViewportIndexAt(c),h=!a||0!==f&&-1!==a.indexOf(f);if(h)switch(e){case 1:this.decodeLineAt(c,f,g,b);break;case 2:this.decodeCircularArcAt(c,f,g,b);break;case 3:this.decodeEllipticalArcAt(c,f,g,b);break;case 4:this.decodeTexQuadAt(c,f,g,b);break;case 5:this.decodeOneTriangleAt(c,f,g,b)}c+=1}else for(var c=0;c<this.ib.length;){var i=this.ib[c],d=this.getVertexFlagsAt(i),e=d>>8&255,f=this.getLayerIndexAt(i),g=this.getViewportIndexAt(i),h=!a||0!==f&&-1!==a.indexOf(f);if(0===e)h&&this.decodeTriangleIndexed(this.ib[c],this.ib[c+1],this.ib[c+2],f,g,b),c+=3;else{if(h)switch(e){case 1:this.decodeLineAt(i,f,g,b);break;case 2:this.decodeCircularArcAt(i,f,g,b);break;case 3:this.decodeEllipticalArcAt(i,f,g,b);break;case 4:this.decodeTexQuadAt(i,f,g,b);break;case 5:this.decodeOneTriangleAt(i,f,g,b)}c+=6}}},a.prototype.onVertex=function(a,b,c){this.point.x=a,this.point.y=b,this.bounds.expandByPoint(this.point)},a.prototype.onLineSegment=function(a,b,c,d,e){this.onVertex(a,b),this.onVertex(c,d)},a.prototype.onCircularArc=function(a,b,c,d,e,f){this.onEllipticalArc(a,b,c,d,e,e,0,f)},a.prototype.onEllipticalArc=function(a,b,c,d,e,f,g,h){0==g?c<=0&&d>=2*Math.PI-1e-5?this.onTexQuad(a,b,2*e,2*f,g,h):(this.point.x=a+Math.cos(c)*e,this.point.y=b+Math.sin(c)*f,this.bounds.expandByPoint(this.point),this.point.x=a+Math.cos(d)*e,this.point.y=b+Math.sin(d)*f,this.bounds.expandByPoint(this.point),c>d&&(this.point.x=a+e,this.point.y=b,this.bounds.expandByPoint(this.point),c-=2*Math.PI),c<.5*Math.PI&&d>.5*Math.PI&&(this.point.x=a,this.point.y=b+f,this.bounds.expandByPoint(this.point)),c<Math.PI&&d>Math.PI&&(this.point.x=a-e,this.point.y=b,this.bounds.expandByPoint(this.point)),c<1.5*Math.PI&&d>1.5*Math.PI&&(this.point.x=a,this.point.y=b-f,this.bounds.expandByPoint(this.point))):this.onTexQuad(a,b,2*e,2*f,g,h)},a.prototype.onTexQuad=function(a,b,c,d,e,f){var g=.5*c,h=.5*c;if(0==e)this.onVertex(a-g,b-h),this.onVertex(a+g,b+h);else{var i=new THREE.Matrix4,j=new THREE.Matrix4;i.makeRotationZ(e),j.makeTranslation(a,b,0),j.multiply(i);for(var k=0;k<4;k++)this.point.x=k%2==1?g:-g,this.point.y=k>=2?h:-h,this.point.applyMatrix4(j),this.bounds.expandByPoint(this.point)}},a.prototype.onOneTriangle=function(a,b,c,d,e,f,g){this.onVertex(a,b),this.onVertex(c,d),this.onVertex(e,f)},b.BoundsCallback=a}(),function(){"use strict";function a(){this.entries={},this.add=function(a,b){this.entries[a]={callback:b}},this.remove=function(a){this.entries[a]&&delete this.entries[a]},this.render=function(){for(var a in this.entries)this.entries[a].callback()}}Autodesk.Viewing.Private.RenderCallbacks=a}(),function(){"use strict";var a=Autodesk.Viewing,b=a.Private,c=Object.freeze({Color:"Color",Depth:"Depth",ModelId:"ModelId",Overlay:"Overlay",Post1:"Post1",PostDisplay:"PostDisplay",SSAO:"SSAO",Post2:"Post2",Highlight:"Highlight"});b.RenderTargets=c}(),function(){"use strict";function a(){function a(a,b,c,d,e){var f=new THREE.WebGLRenderTarget(a,b,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:c,type:d,stencilBuffer:$});return e&&(f.shareDepthFrom=e),f.name="depthTarget",f}function d(b){try{var c=a(2,2,b.format,b.type);y.setRenderTarget(c);var d=y.context,e=d.checkFramebufferStatus(d.FRAMEBUFFER);return y.setRenderTarget(null),c.dispose(),e===d.FRAMEBUFFER_COMPLETE}catch(a){return!1}}function e(){var a=Ia?[{format:THREE.RGBFormat,type:THREE.HalfFloatType},{format:THREE.RGBAFormat,type:THREE.HalfFloatType},{format:THREE.RGBFormat,type:THREE.FloatType},{format:THREE.RGBAFormat,type:THREE.FloatType}]:[{format:THREE.RGBFormat,type:THREE.FloatType},{format:THREE.RGBAFormat,type:THREE.FloatType},{format:THREE.RGBFormat,type:THREE.HalfFloatType},{format:THREE.RGBAFormat,type:THREE.HalfFloatType}],b=a.find(d);b?(Ra=!0,Pa=b.format,Qa=b.type):(Ra=!1,c.logger.warn("Depth target is unsupported for this device."))}function f(){var a=$a.NormalsShader;z=$a.createShaderMaterial(a),z.blending=THREE.NoBlending,z.packedNormals=!0,z.depthWrite=!1;var b={NoCutPlanes:1,Instancing:2,Count:4},c=[];c[0]=null;for(var d=1;d<b.Count;d++){var e=z.clone();d&b.NoCutPlanes&&(e.cutPlanes=null,e.blending=THREE.NoBlending,e.packedNormals=!0,e.doNotCut=!0),d&b.Instancing&&(e.useInstancing=!0),
c[d]=e}z.variants=c,z.getCustomOverrideMaterial=function(a){var c=!a||!a.cutplanes||0==a.cutplanes.length,d=a.useInstancing,e=(c?b.NoCutPlanes:0)|(d?b.Instancing:0);return this.variants[e]}}function g(){var a=$a.EdgeShader;A=$a.createShaderMaterial(a),A.depthWrite=!0,A.depthTest=!0,A.isEdgeMaterial=!0,A.transparent=!0,A.blending=THREE.NormalBlending;var c={Instancing:1,Count:2},d=[];d[0]=null;for(var e=1;e<c.Count;e++){var f=A.clone();f.defines=b.ObjectAssign({},A.defines),f.isEdgeMaterial=!0,e&c.Instancing&&(f.useInstancing=!0),d[e]=f}A.variants=d,A.getCustomOverrideMaterial=function(a){var b=a.useInstancing,d=b?c.Instancing:0,e=this.variants[d]||A;return e.uniforms.color.value=Ma?La?Ga:Fa:Ea,e.uniforms.color.needsUpdate=!0,e}}function h(a){a(z);for(var b=1;b<z.variants.length;b++)a(z.variants[b])}function i(){function a(a){a.material.blending=THREE.NoBlending,a.material.depthWrite=!1,a.material.depthTest=!1}f(),g(),J=new $a.LmvShaderPass($a.SAOShader),a(J),I=new $a.LmvShaderPass($a.SAOBlurShader),a(I),L=new $a.LmvShaderPass($a.SAOMinifyFirstShader),a(L),K=new $a.LmvShaderPass($a.SAOMinifyShader),a(K),M=new $a.LmvShaderPass($a.FXAAShader),a(M),N=new $a.LmvShaderPass($a.CelShader),a(N),O=new $a.LmvShaderPass($a.BlendShader),a(O),H=new $a.LmvShaderPass($a.BackgroundShader),a(H),P=new $a.LmvShaderPass($a.CopyShader),a(P),Q=new $a.LmvShaderPass($a.ClearShader),a(Q),R=new $a.LmvShaderPass($a.HighlightShader),R.material.depthWrite=!1,R.material.depthTest=!1,R.material.blending=THREE.CustomBlending,R.material.blendDst=THREE.DstAlphaFactor,R.material.blendDstAlpha=THREE.OneFactor,R.material.blendSrc=THREE.OneMinusDstAlphaFactor,R.material.blendSrcAlpha=THREE.OneMinusDstAlphaFactor,R.material.blendEquation=THREE.AddEquation,R.material.uniforms.edgeColor.value=Fa.clone(),R.material.transparent=!0}function j(a){switch(a){case c.RenderTargets.Color:return!0;case c.RenderTargets.Depth:return Ra&&(Ya.sao||Ya.postProcShaded);case c.RenderTargets.ModelId:return Ya.idbuffer||Ya.occlusionid;case c.RenderTargets.Overlay:return!0;case c.RenderTargets.SSAO:return Ya.sao;case c.RenderTargets.Post1:return Ya.antialias||Ya.sao||Ya.customPresentPass||Ya.postProcShaded;case c.RenderTargets.Post2:return Ya.postProcShaded||Ya.customPresentPass;case c.RenderTargets.PostDisplay:return Ya.antialias&&Ya.postProcShaded;case c.RenderTargets.Highlight:return!0}}function k(a,b,d){var e=null;switch(a){case c.RenderTargets.ModelId:e=new THREE.WebGLRenderTarget(b,d,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,type:THREE.UnsignedByteType,stencilBuffer:$}),e.generateMipmaps=!1,e.shareDepthFrom=ha,e.canReadPixels=!0}return e}function l(a,b){var c=3*a[1],d=3*(a[3]-a[1])-c;return(((1-c-d)*b+d)*b+c)*b}function m(){ua=new THREE.WebGLRenderTarget(Ya.deviceWidth,Ya.deviceHeight,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,stencilBuffer:$}),ua.generateMipmaps=!1,ua.shareDepthFrom=ha}function n(a,b,c,d){return a[b++]=c[d],a[b++]=c[d+1],a[b++]=c[d+2],a[b++]=c[d+3],a[b++]=c[d+1],a[b++]=c[d+2],a[b++]=c[d],a[b++]=c[d+4],a[b++]=c[d+2],a[b++]=c[d+3],a[b++]=c[d+4],a[b++]=c[d+2],a[b++]=c[d],a[b++]=c[d+1],a[b++]=c[d+5],a[b++]=c[d+3],a[b++]=c[d+1],a[b++]=c[d+5],a[b++]=c[d],a[b++]=c[d+4],a[b++]=c[d+5],a[b++]=c[d+3],a[b++]=c[d+4],a[b++]=c[d+5],b}function o(a,b,c){return a[b++]=c,a[b++]=c+1,a[b++]=c+5,a[b++]=c,a[b++]=c+5,a[b++]=c+4,a[b++]=c,a[b++]=c+2,a[b++]=c+3,a[b++]=c,a[b++]=c+3,a[b++]=c+1,a[b++]=c,a[b++]=c+4,a[b++]=c+6,a[b++]=c,a[b++]=c+6,a[b++]=c+2,a[b++]=c+7,a[b++]=c+6,a[b++]=c+4,a[b++]=c+7,a[b++]=c+4,a[b++]=c+5,a[b++]=c+7,a[b++]=c+5,a[b++]=c+1,a[b++]=c+7,a[b++]=c+1,a[b++]=c+3,a[b++]=c+7,a[b++]=c+3,a[b++]=c+2,a[b++]=c+7,a[b++]=c+2,a[b++]=c+6,b}function p(a,b,c,d){var e=new Float32Array(24*d),f=new Uint16Array(36*d),g=0,h=0,i=0;for(d+=c;c<d;++c,i+=8)h=o(f,h,i),g=n(e,g,a,6*b[c]);var j=new THREE.BufferGeometry;return j.addAttribute("position",new THREE.BufferAttribute(e,3)),j.addAttribute("index",new THREE.BufferAttribute(f,1)),j.streamingDraw=!0,j.streamingIndex=!0,j}function q(a,b,c,d){for(var e=new Float32Array(3*d),f=new Float32Array(3*d),g=0,h=d+c;c<h;++c){var i=6*b[c];f[g]=a[i+3]-a[i],e[g++]=a[i++],f[g]=a[i+3]-a[i],e[g++]=a[i++],f[g]=a[i+3]-a[i],e[g++]=a[i++]}var j=new THREE.BufferGeometry;j.addAttribute("position",new THREE.BufferAttribute(wa,3)),j.addAttribute("index",new THREE.BufferAttribute(xa,1));var k=new THREE.BufferAttribute(e,3);k.divisor=1;var l=new THREE.BufferAttribute(f,3);return l.divisor=1,j.addAttribute("instOffset",k),j.addAttribute("instScaling",l),j.numInstances=d,j.streamingDraw=!0,j.streamingIndex=!0,j}function r(){wa=new Float32Array(24),xa=new Uint16Array(36),o(xa,0,0),n(wa,0,[0,0,0,1,1,1],0)}function s(a,b){for(var c=!!b,d=ta[b].length;d<a;++d){var e=$a.createShaderMaterial(WGS.OcclusionShader);e.useInstancing=c,e.depthWrite=!1,e.uniforms.color.value.set(_a[d][0],_a[d][1],_a[d][2]),e.uniforms.opacity.value=ab[d],e.defaultAttributeValues.instRotate=[1,0,0,0],e.blending=THREE.CustomBlending,e.blendDst=THREE.SrcColorFactor,e.blendSrc=THREE.ZeroFactor,e.blendEquation=THREE.AddEquation,e.transparent=!0,ta[b][d]=e}}function t(){var a=[O.uniforms.useOverlay.value,O.uniforms.highlightRange.value,O.uniforms.objID.value];return O.uniforms.useOverlay.value=0,O.uniforms.highlightRange.value=0,O.uniforms.objID.value=0,a}function u(a){O.uniforms.useOverlay.value=a[0],O.uniforms.highlightRange.value=a[1],O.uniforms.objID.value=a[2]}function v(){var a=O.uniforms.useAO.value;return O.uniforms.useAO.value=0,a}function w(a){O.uniforms.useAO.value=a}function x(){var a=ja,b=ha;if(O.uniforms.useAO.value){var c=t();O.render(y,a,b),b=a,a=ma,u(c)}if(N.render(y,a,b),b=a,a=a===ja?ma:ja,O.uniforms.useOverlay.value||O.uniforms.highlightRange.value||O.uniforms.objID.value){var c=v();O.render(y,a,b),b=a,w(c)}return b}var y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=[],$=!1,_=!1,aa=null,ba=[],ca=null,da=!1,ea=!1,fa=!1,ga=null,ha=null,ia=null,ja=null,ka=null,la=null,ma=null,na=[],oa=[],pa=0,qa=0,ra=0,sa=1,ta=[[],[]],ua=null,va=null,wa=null,xa=null,ya=null,za=!1,Aa=new Uint8Array(4),Ba=[0,0],Ca=(new THREE.Color).setRGB(1,1,1),Da=(new THREE.Color).setRGB(0,0,0),Ea=new THREE.Vector4(0,0,0,.3),Fa=new THREE.Vector4(1,1,1,1),Ga=new THREE.Vector4(1,1,1,.5),Ha=null,Ia=!1,Ja=!0,Ka=!1,La=!1,Ma=!1,Na=!1,Oa=!1,Pa=THREE.RGBFormat,Qa=THREE.FloatType,Ra=!1,Sa=null,Ta=!1,Ua=0,Va=0,Wa=0,Xa=[.42,0,1,1],Ya={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,idbuffer:!0,occlusionid:!0,customPresentPass:!1,postProcShaded:!1,envMapBg:!1,swapBlackAndWhite:!1,numIdTargets:1},Za={},$a=Autodesk.Viewing.Shaders;this.settings=Ya,this.init=function(a,d,f){if(i(),!a)return void c.logger.error("You need a gl context to make a renderer. Things will go downhill from here.",b.errorCodeString(b.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED));Ia=b.isMobileDevice(),Ya.idbuffer=!Ia,X=d,Y=f,y=a,$=!!y.context.getContextAttributes().stencil,e()},this.setDepthMaterialOffset=function(a,b,c){h(function(d){d.polygonOffset=a,d.polygonOffsetFactor=b,d.polygonOffsetUnits=c,d.extraDepthOffset&&(d.polygonOffsetFactor+=d.extraDepthOffset),d.needsUpdate=!0})},this.overlayUpdate=function(){if(0===Va||-1===Va)return!1;var a=O.uniforms.highlightIntensity.value,b=.004*(performance.now()-Ua);b=Math.min(b,1);var c=l(Xa,b);return a!=c&&(O.uniforms.highlightIntensity.value=c,!0)},this.clearHighlight=function(){if(da=!1,j(c.RenderTargets.Highlight)){y.setClearColor(Da,0);for(var a=0;a<na.length;++a)y.clearTarget(na[a],!0,!1,!1)}},this.setHighlightLights=function(a){E=a},this.beginScene=function(a,d,e,f){if(C=d,G=a.fog,D=e,ea=!1,fa=!1,!ha&&X)this.initPostPipeline(Ya.sao,Ya.antialias);else if(!ha&&!X)return void(za||(c.logger.error("Rendering to a canvas that was resized to zero. If you see this message you may be accidentally leaking a viewer instance.",b.errorCodeString(b.ErrorCodes.VIEWER_INTERNAL_ERROR)),za=!0));if(f){if(Ha&&!Ya.envMapBg){if(Ya.swapBlackAndWhite){var g=new THREE.Color(1,1,1),h=new THREE.Color(0,0,0);Ha.equals(g)?y.setClearColor(h,1):Ha.equals(h)?y.setClearColor(g,1):y.setClearColor(Ha,1)}else y.setClearColor(Ha,1);y.clearTarget(ha,!0,!0,$)}else H.uniforms.uCamDir.value=C.worldUpTransform?C.getWorldDirection().clone().applyMatrix4(C.worldUpTransform):C.getWorldDirection(),H.uniforms.uCamUp.value=C.worldUpTransform?C.up.clone().applyMatrix4(C.worldUpTransform):C.up,H.uniforms.uResolution.value.set(X,Y),H.uniforms.uHalfFovTan.value=Math.tan(THREE.Math.degToRad(.5*C.fov)),y.clearTarget(ha,!1,!0,$),H.render(y,ha,null);for(var i=0;i<oa.length;i++)y.setClearColor(Ca,1),y.clearTarget(oa[i],!0,!1,!1);this.clearHighlight(),Ta=!1}if(j(c.RenderTargets.Depth)){f&&(y.setClearColor(Da,0),y.clearTarget(W,!0,!1,!1));var k=d.near,l=d.far;J.uniforms.cameraNear.value=k,J.uniforms.cameraFar.value=l,N.uniforms.cameraNear.value=k,N.uniforms.cameraFar.value=l,L.uniforms.cameraNear.value=k,L.uniforms.cameraInvNearFar.value=1/(k-l);var m=d.projectionMatrix.elements;d.isPerspective?J.uniforms.projInfo.value.set(-2/(ha.width*m[0]),-2/(ha.height*m[5]),(1-m[8])/m[0],(1+m[9])/m[5]):J.uniforms.projInfo.value.set(-2/(ha.width*m[0]),-2/(ha.height*m[5]),(1-m[12])/m[0],(1-m[13])/m[5]),N.uniforms.projInfo.value.copy(J.uniforms.projInfo.value);var n=d.isPerspective?0:1;J.uniforms.isOrtho.value=n,N.uniforms.isOrtho.value=n;J.uniforms.projScale.value=ha.height*m[5]*.125}Ya.sao||(O.uniforms.useAO.value=0),this.renderScenePart(a,!0,!0,!1,0,!0)},this.copyOcclusionIds=function(){return Ya.occlusionid&&oa[0]&&Sa?(Ta||y.readRenderTargetPixels(oa[0],0,0,oa[0].width,oa[0].height,Sa),Sa):null},this.renderScenePart=function(a,b,d,e,f,g){if(e&&Ya.occlusionid&&oa[0]&&Sa&&a instanceof c.RenderBatch&&(Ta=!1),ea=!1,fa=!1,a.fog=G,_){var h=f?1:0;y.state.buffers.stencil.setFunc(y.context.ALWAYS,h,1)}var i,k;if(b){if(k=void 0,(g||D!==F)&&(k=D,F=k),Na&&Oa)j(c.RenderTargets.ModelId)&&e&&j(c.RenderTargets.Depth)?y.render(a,C,[ha,W].concat(oa),!1,k):j(c.RenderTargets.Depth)?y.render(a,C,[ha,W],!1,k):j(c.RenderTargets.ModelId)&&e?y.render(a,C,[ha].concat(oa)):y.render(a,C,ha,!1,k);else if(Oa)j(c.RenderTargets.ModelId)&&e?y.render(a,C,[ha].concat(oa),!1,k):y.render(a,C,ha,!1,k),j(c.RenderTargets.Depth)&&d&&!a.sortObjects&&(i=a.overrideMaterial,a.overrideMaterial=z,z.depthWrite!==l&&(z.depthWrite=l,z.needsUpdate=!0),y.render(a,C,W,!1),a.overrideMaterial=i);else{var l=!1;b?y.render(a,C,ha,!1,k):l=!0,j(c.RenderTargets.ModelId)&&e&&(B?(i=a.overrideMaterial,a.overrideMaterial=B,y.render(a,C,oa[0],!1),a.overrideMaterial=i):(y.setProgramPrefix(1,"#define ID_COLOR","#define ID_COLOR"),y.render(a,C,oa[0],!1),y.setProgramPrefix(0,"","")),l=!1),j(c.RenderTargets.Depth)&&d&&!a.sortObjects&&(i=a.overrideMaterial,z.depthWrite!==l&&(z.depthWrite=l,z.needsUpdate=!0),a.overrideMaterial=z,y.render(a,C,W,!1),a.overrideMaterial=i)}b&&Ka&&(i=a.overrideMaterial,a.overrideMaterial=A,y.context.depthFunc(y.context.LESS),y.render(a,C,[ha],!1),y.context.depthFunc(y.context.LEQUAL),a.overrideMaterial=i)}if(f){k=void 0,E!==F&&(k=E,F=k),i=a.overrideMaterial,Ma=!0,A.depthWrite=!1;for(var m=0;m<Z.length;++m){var n=Z[m];f&1<<m&&(da=!0,La=n.renderHidden,A.depthTest=!La,a.overrideMaterial=n.material,y.render(a,C,na[n.target],!1,k),k=void 0)}Ma=!1,La=!1,A.depthWrite=!0,A.depthTest=!0,a.overrideMaterial=i}};var _a=[[0,1,1],[1,0,1],[1,1,0],[1,1,1]],ab=[1,1,1,0],bb={};this.occlusionTest=function(a,b,c,d,e){if(!c||c.length<=0||c.length>4)return Promise.reject({error:"fragIds invalid. Must be a nonempty array of fragment id arrays with length <= 4"});var f=[0,0,0,0],g=0;d=d&&y.supportsInstancedArrays()?1:0,(!ta[d]||ta[d].length<c.length)&&s(c.length,d),d&&!wa&&r(),ya||(ya=new THREE.Scene),ya.frustumCulled=!1;var h,i=d?32768:4096;for(h=0;h<c.length;++h){var j=c[h];if(j&&j.length>0){f[h]=b,++g;for(var k,l=ta[d][h],n=j.length,o=0;o<n;o+=k){k=Math.min(i,n-o);var t=d?q(a,j,o,k):p(a,j,o,k),u=new THREE.Mesh(t,l);u.frustumCulled=!1,ya.add(u)}}}switch(ua||m(),y.setClearColor(Ca,1),y.setRenderTarget(ua),y.clear(!0,!1,!1),y.render(ya,C,ua,!1,null),y.clearBlend(),ya.children.forEach(function(a){a.geometry.dispose()}),ya.remove.apply(ya,ya.children),(bb[e[0]]||bb[e[1]]||bb[e[2]]||bb[e[3]])&&this.getRenderTargetPixels("occlusion"),va||(va=new Uint8Array(4*Ya.deviceWidth*Ya.deviceHeight)),y.readRenderTargetPixels(ua,0,0,Ya.deviceWidth,Ya.deviceHeight,va),c.length){case 1:for(h=va.length;g>0&&(h-=4)>=0;)va[h]||(f[0]-=1,g-=!f[0]);return Promise.resolve([f[0]<=0]);case 2:for(h=va.length;g>0&&(h-=4)>=0;)va[h]||(f[0]-=1,g-=!f[0]),va[h+1]||(f[1]-=1,g-=!f[1]);return Promise.resolve([f[0]<=0,f[1]<=0]);case 3:for(h=va.length;g>0&&(h-=4)>=0;)va[h]||(f[0]-=1,g-=!f[0]),va[h+1]||(f[1]-=1,g-=!f[1]),va[h+2]||(f[2]-=1,g-=!f[2]);return Promise.resolve([f[0]<=0,f[1]<=0,f[2]<=0]);case 4:for(h=va.length;g>0&&(h-=4)>=0;)va[h]||(f[0]-=1,g-=!f[0]),va[h+1]||(f[1]-=1,g-=!f[1]),va[h+2]||(f[2]-=1,g-=!f[2]),va[h+3]||(f[3]-=1,g-=!f[3]);return Promise.resolve([f[0]<=0,f[1]<=0,f[2]<=0,f[3]<=0])}},this.setStencilEnabled=function(a){_=$&&a,y.state.buffers.stencil.setTest(a);var b=y.context;y.state.buffers.stencil.setOp(b.KEEP,b.KEEP,a?b.REPLACE:b.KEEP)},this.clearAllOverlays=function(){y.clearTarget(ia,!0,!1,!1)},this.renderOverlays=function(a,b){var c=0;Ma=!0;for(var d in a){var e=a[d],f=e.scene,g=e.camera?e.camera:C;f.children.length&&(c||(c=1,y.setClearColor(Da,0),y.clearTarget(ia,!0,!1,!1)),e.materialPre&&(f.overrideMaterial=e.materialPre),y.render(f,g,ia,!1,b),e.materialPost&&(La=!0,y.context.depthFunc(y.context.GREATER),Ka&&(A.depthWrite=!1,A.depthTest=!1,f.overrideMaterial=A,y.render(f,g,ia,!1)),f.overrideMaterial=e.materialPost,y.render(f,g,ia,!1,b),y.context.depthFunc(y.context.LEQUAL),La=!1),Ka&&e.materialPre&&(A.depthWrite=!1,A.depthTest=!0,f.overrideMaterial=A,y.render(f,g,ia,!1)),f.overrideMaterial=null)}if(Ma=!1,A.depthWrite=!0,A.depthTest=!0,da){c||(c=1,y.setClearColor(Da,0),y.clearTarget(ia,!0,!1,!1));var h=y.state.buffers.stencil;h.setFunc(y.context.EQUAL,0,1),h.setTest(!0),Q.render(y,na[1],null),h.setTest(!1),R.render(y,ia,null)}O.uniforms.useOverlay.value=c},this.computeSSAO=function(a){if(!a&&Ya.sao){if(!ea){if(ga&&ga.length){var b=ga[0];L.uniforms.resolution.value.set(1/b.width,1/b.height),L.render(y,b,W);for(var c=1;c<ga.length;c++){var d=ga[c];K.uniforms.resolution.value.set(1/d.width,1/d.height),K.render(y,d,b),b=d}}J.render(y,la,ha),I.uniforms.axis.value.set(1,0),I.render(y,ja,la),I.uniforms.axis.value.set(0,1),I.render(y,la,ja),ea=!0}O.uniforms.useAO.value=1}else O.uniforms.useAO.value=0},this.presentBuffer=function(a){if(y){if(!(O.uniforms.useAO.value||O.uniforms.useOverlay.value||0!==Va&&-1!==Va||0!==Wa&&-1!==Wa))Ya.antialias?a?(M.render(y,ja,ha),a.render(y,null,ja)):Ya.postProcShaded?(N.render(y,ja,ha),P.render(y,ka,ja),M.render(y,null,ka)):M.render(y,null,ha):a?a.render(y,null,ha):Ya.postProcShaded?(N.render(y,ja,ha),P.render(y,null,ja)):P.render(y,null,ha);else if(Ya.antialias)if(a)O.render(y,ja,ha),M.render(y,ma,ja),a.render(y,null,ma);else if(Ya.postProcShaded){var b=x();P.render(y,ka,b),M.render(y,null,ka)}else O.render(y,ja,ha),M.render(y,null,ja);else if(a)O.render(y,ja,ha),a.render(y,null,ja);else if(Ya.postProcShaded){var b=x();P.render(y,null,b)}else O.render(y,null,ha)}},this.composeFinalFrame=function(a,b){this.computeSSAO(a),b||this.presentBuffer()},this.cleanup=function(){if(ha&&(ha.dispose(),ha=null),W&&(W.dispose(),W=null),ia&&(ia.dispose(),ia=null),ja&&(ja.dispose(),ja=null),la&&(la.dispose(),la=null),ma&&(ma.dispose(),ma=null),ga){for(var a=0;a<ga.length;a++)ga[a].dispose();ga=[]}ua&&(ua.dispose(),ua=null),va=null},this.postProcessEdgesOn=function(){return 0!==N.uniforms.idEdges.value||0!==N.uniforms.normalEdges.value||0!==N.uniforms.depthEdges.value};var cb=function(){var a=0;ia&&Z.forEach(function(b){a=Math.max(a,1+(0|b.target))});for(var b=na.length,c=Math.max(a,b),d=0;d<c;++d){var e=d<b?na[d]:null;d>=b?(e=ia.clone(),na[d]=e,e.name="highlight "+d):d>=a?(e.dispose(),e=null):e.shareDepthFrom!==ia.shareDepthFrom&&(e.dispose(),e=ia.clone(),na[d]=e,e.name="highlight "+d);var f=R.uniforms["tHighlight"+d];f&&f.value!==e&&(f.value=e,O.material.needsUpdate=!0)}na.length=a};this.setSize=function(b,d,e,f){if(X=b,Y=d,Ya.logicalWidth=b,Ya.logicalHeight=d,0===b&&0===d||!y)return void this.cleanup();var g=0|b*y.getPixelRatio(),h=0|d*y.getPixelRatio();Ya.deviceWidth=g,Ya.deviceHeight=h,f||y.setSize(b,d);var i,l=g,m=h;(Ya.useSSAA||Ya.postProcShaded&&!Ia&&y.getPixelRatio()<=1&&this.postProcessEdgesOn())&&(g*=2,h*=2);var n=1/g,o=1/h;if(!e&&ha&&ha.width==g&&ha.height==h||(c.logger.log("Reallocating render targets."),this.cleanup(),ha=new THREE.WebGLRenderTarget(g,h,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,type:Ya.useHdrTarget?THREE.FloatType:THREE.UnsignedByteType,stencilBuffer:$}),ha.generateMipmaps=!1,ha.name="colorTarget",ia=new THREE.WebGLRenderTarget(g,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,stencilBuffer:$}),ia.generateMipmaps=!1,ia.name="overlayTarget",ia.shareDepthFrom=ha,cb(),W=null,ja=null,ka=null,la=null,ma=null,ga=[]),j(c.RenderTargets.Post1)&&(!e&&ja&&ja.width==g&&ja.height==h||(ja=new THREE.WebGLRenderTarget(g,h,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1}),ja.generateMipmaps=!1,ja.name="postTarget1")),!la&&j(c.RenderTargets.SSAO)&&(la=ja.clone(),la.name="SSAO target"),!ma&&j(c.RenderTargets.Post2)&&(ma=ja.clone(),ma.name="post target 2"),!ka&&j(c.RenderTargets.PostDisplay)&&(ka=new THREE.WebGLRenderTarget(l,m,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1}),ka.generateMipmaps=!1,ka.name="postTargetNormal"),j(c.RenderTargets.Depth)){if(e||!W||W.width!=g||W.height!=h){W=a(g,h,Pa,Qa,ha),ga=[];for(var p=0;p<5;p++){var q=new THREE.WebGLRenderTarget(0|g/(2<<p),0|h/(2<<p),{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,depthBuffer:!1,stencilBuffer:!1});q.generateMipmaps=!1,ga.push(q),J.uniforms["tDepth_mip"+(p+1)].value=q}Na=y.verifyMRTWorks([ha,W])}J.uniforms.size.value.set(g,h),J.uniforms.resolution.value.set(n,o),J.uniforms.tDepth.value=W,I.uniforms.size.value.set(g,h),I.uniforms.resolution.value.set(n,o),N.uniforms.tDepth.value=W}if(j(c.RenderTargets.ModelId)){if(e||!oa[0]||oa[0].width!=g||oa[0].height!=h){for(i=0;i<oa.length;i++)oa[i]&&oa[i].dispose();for(oa=[],i=0;i<Ya.numIdTargets;i++){var r=k(c.RenderTargets.ModelId,g,h);r.name="id "+i,oa.push(r)}Oa=y.verifyMRTWorks([ha].concat(oa)),Oa||c.logger.warn("ID buffer requested, but MRT is not supported. Some features will not work."),Sa=new Uint8Array(4*oa[0].width*oa[0].height)}N.uniforms.tID.value=oa[0],N.uniforms.tID.value=oa[0]}else if(oa[0]){for(Sa=null,i=0;i<oa.length;i++)oa[i].dispose(),oa[i]=null;oa.length=0}M.uniforms.uResolution.value.set(n,o),N.uniforms.resolution.value.set(n,o),O.uniforms.tOverlay.value=ia,O.uniforms.tAO.value=la,O.uniforms.useAO.value=Ya.sao?1:0,O.uniforms.resolution.value.set(n,o),O.uniforms.tID.value=oa[0]||null,O.uniforms.tID2.value=oa[1]||null},this.getMaxAnisotropy=function(){return y?y.getMaxAnisotropy():0},this.mrtFlags=function(){return{mrtNormals:Na&&j(c.RenderTargets.Depth),mrtIdBuffer:Oa&&j(c.RenderTargets.ModelId)?Ya.numIdTargets:void 0}},this.setIdTargetCount=function(a){if(!(a>2||a<1)&&a!==Ya.numIdTargets&&(Ya.numIdTargets=a,0!==oa.length&&2===a&&1===oa.length)){var b=oa[0].width,d=oa[0].height,e=k(c.RenderTargets.ModelId,b,d);return e.name="id "+oa.length,oa.push(e),O.uniforms.tID2.value=e,O.material.defines.USE_MODEL_ID="",O.material.needsUpdate=!0,!0}},this.getAntialiasing=function(){return Ya.antialias},this.initPostPipeline=function(a,c){Ya.sao=a&&!b.isIE11&&Ra,Ya.antialias=c&&!b.isIE11,Ya.haveTwoSided&&h(function(a){a.side=THREE.DoubleSide}),h(function(a){a.needsUpdate=!0}),J.material.needsUpdate=!0,I.material.needsUpdate=!0,L.material.needsUpdate=!0,K.material.needsUpdate=!0,M.material.needsUpdate=!0,N.material.needsUpdate=!0,O.material.needsUpdate=!0,H.material.needsUpdate=!0,P.material.needsUpdate=!0,this.setSize(X,Y)},this.setClearColors=function(a,b){(Ha=b?a.equals(b)||Ia?new THREE.Color(.5*(a.x+b.x),.5*(a.y+b.y),.5*(a.z+b.z)):void 0:a.clone())||(H.uniforms.color1.value.copy(a),H.uniforms.color2.value.copy(b))},this.setAOEnabled=function(a){Ya.sao=a&&Ra,this.setSize(X,Y,!1,!0)},this.setAOOptions=function(a,c,d){void 0!==a&&(J.uniforms.radius.value=a,J.uniforms.bias.value=b.isMobileDevice()?.1:.01,I.uniforms.radius.value=a),void 0!==c&&(J.uniforms.intensity.value=c),O.uniforms.aoOpacity.value=void 0!==d?d:1,ea=!1},this.getAOEnabled=function(){return Ya.sao},this.getAORadius=function(){return J.uniforms.radius.value},this.getAOIntensity=function(){return J.uniforms.intensity.value},this.setCubeMap=function(a){H.material.envMap=a,a||this.toggleEnvMapBackground(!1)},this.setEnvRotation=function(a){qa=a,H.material.envRotationSin=Math.sin(a),H.material.envRotationCos=Math.cos(a)},this.getEnvRotation=function(){return qa},this.setEnvExposure=function(a){H.uniforms.envMapExposure.value=Math.pow(2,a),H.material.envMapExposure=Math.pow(2,a),H.material.needsUpdate=!0},this.setTonemapExposureBias=function(a){pa=a,H.uniforms.exposureBias.value=Math.pow(2,a)},this.getExposureBias=function(){return pa},this.setCamera=function(a){C=a},this.setTonemapMethod=function(a){ra=a,y.gammaInput=0!==a,H.material.tonemapOutput=ra,H.material.needsUpdate=!0},this.getToneMapMethod=function(){return ra},this.toggleTwoSided=function(a){Ya.haveTwoSided!=a&&z&&h(function(b){b.side=a?THREE.DoubleSide:THREE.FrontSide,b.needsUpdate=!0}),Ya.haveTwoSided=a},this.toggleEdges=function(a){Ka=a},this.preloadPostProcessStyle=function(a){if(void 0==a)return this.preloadPostProcessStyle("graphite"),void this.preloadPostProcessStyle("pencil");switch(a){case"graphite":if(void 0===ba[0]){THREE.ImageUtils.crossOrigin="";for(var b=0;b<8;b++){var c=Autodesk.Viewing.Private.getResourceUrl("res/postprocess/Graphite"+(b+1)+".png");ba[b]=THREE.ImageUtils.loadTexture(c),ba[b].wrapS=ba[b].wrapT=THREE.RepeatWrapping}N.uniforms.tGraphite1.value=ba[0],N.uniforms.tGraphite2.value=ba[1],N.uniforms.tGraphite3.value=ba[2],N.uniforms.tGraphite4.value=ba[3],N.uniforms.tGraphite5.value=ba[4],N.uniforms.tGraphite6.value=ba[5],N.uniforms.tGraphite7.value=ba[6],N.uniforms.tGraphite8.value=ba[7]}break;case"pencil":null===aa&&(THREE.ImageUtils.crossOrigin="",aa=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/postprocess/ColorPencil_02.png")),aa.wrapS=aa.wrapT=THREE.RepeatWrapping,ca=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/postprocess/paper2.jpg")),ca.wrapS=ca.wrapT=THREE.RepeatWrapping,N.uniforms.tFill.value=aa,N.uniforms.tPaper.value=ca)}},this.setPostProcessParameter=function(a,b){switch(a){case"style":if(Ya.postProcShaded=!1,N.uniforms.style.value=WGS.POSTPROC_STYLE_OFF,Ra){switch(this.preloadPostProcessStyle(b),b){case"edging":Ya.postProcShaded=!0,N.uniforms.style.value=WGS.POSTPROC_STYLE_EDGING;break;case"cel":Ya.postProcShaded=!0,N.uniforms.style.value=WGS.POSTPROC_STYLE_CEL;break;case"graphite":Ya.postProcShaded=!0,N.uniforms.style.value=WGS.POSTPROC_STYLE_GRAPHITE;break;case"pencil":Ya.postProcShaded=!0,N.uniforms.style.value=WGS.POSTPROC_STYLE_PENCIL}Ya.postProcShaded?Ya.idbuffer=!0:Ya.idbuffer=Ja&&!Ia,this.initPostPipeline(Ya.sao,Ya.antialias)}break;case"edges":N.uniforms.idEdges.value=b?1:0,N.uniforms.normalEdges.value=b?1:0,N.uniforms.depthEdges.value=b?1:0,this.initPostPipeline(Ya.sao,Ya.antialias);break;case"idEdges":N.uniforms.idEdges.value=b?1:0,this.initPostPipeline(Ya.sao,Ya.antialias);break;case"normalEdges":N.uniforms.normalEdges.value=b?1:0,this.initPostPipeline(Ya.sao,Ya.antialias);break;case"depthEdges":N.uniforms.depthEdges.value=b?1:0,this.initPostPipeline(Ya.sao,Ya.antialias);break;case"brightness":N.uniforms.brightness.value=b;break;case"contrast":N.uniforms.contrast.value=b;break;case"grayscale":N.uniforms.grayscale.value=b?1:0;break;case"preserveColor":N.uniforms.preserveColor.value=b?1:0;break;case"levels":N.uniforms.levels.value=b;break;case"repeats":N.uniforms.repeats.value=b;break;case"rotation":N.uniforms.rotation.value=b;break;default:console.error("setPostProcessParameter: parameter '"+a+"' is not valid.")}return 0},this.queryPostProcessParameter=function(a,b){return"undefined"!==N.uniforms[a]?N.uniforms[a].value:(c.logger.warning("queryPostProcessParameter: parameter '"+a+"' is not valid"),b)},this.toggleEnvMapBackground=function(a){Ya.envMapBg=a,H.uniforms.envMapBackground.value=a},this.toggleSwapBlackAndWhite=function(a){Ya.swapBlackAndWhite=a},this.enter2DMode=function(a){B=a,Za.sao=Ya.sao,Za.postProcShaded=Ya.postProcShaded,Za.antialias=Ya.antialias,Za.idbuffer=Ya.idbuffer,Za.occlusionid=Ya.occlusionid,Ya.idbuffer=!0,Ya.occlusionid=!1,Ya.postProcShaded=!1,O.material.defines.IS_2D="",this.initPostPipeline(!1,!1)},this.exit2DMode=function(){B=null,Ya.idbuffer=Za.idbuffer&&Ja,Ya.occlusionid=Za.occlusionid,Ya.postProcShaded=Za.postProcShaded,delete O.material.defines.IS_2D,this.initPostPipeline(Za.sao,Za.antialias)},this.idAtPixel=function(a,b,c){if(!oa[0])return 0;var d=0|.5*(a+1)*oa[0].width,e=0|.5*(b+1)*oa[0].height;if(fa&&d===S&&e===T)return c&&(c[0]=U,c[1]=V),U;y.readRenderTargetPixels(oa[0],d,e,1,1,Aa);var f=Aa[2]<<16|Aa[1]<<8|Aa[0],g=0;return oa[1]?(y.readRenderTargetPixels(oa[1],d,e,1,1,Aa),g=Aa[1]<<8|Aa[0],g=g<<16>>16,f=f<<8>>8):f=f<<8>>8,S=d,T=e,U=f,V=g,fa=!0,c&&(c[0]=f,c[1]=g),f},this.idAtPixels=function(a,b,c,d){if(!oa[0])return 0;var e=.5*(a+1)*oa[0].width-.5*(c-1),f=.5*(b+1)*oa[0].height-.5*(c-1),g=new Uint8Array(4*c*c);y.readRenderTargetPixels(oa[0],e,f,c,c,g);var h=void 0;return d&&oa[1]&&(h=new Uint8Array(4*c*c),y.readRenderTargetPixels(oa[1],e,f,c,c,h)),function(){for(var a,b=0,e=0,f=0,i=-1,j=0;j<c*c;j++){var k=b+(c-1)/2,l=e+(c-1)/2;if(k>=0&&k<=c&&l>=0&&l<=c){var m=k+l*c;if(a=g[4*m+2]<<16|g[4*m+1]<<8|g[4*m],(a=a<<8>>8)>=0){if(h){var n=h[4*m+1]<<8|h[4*m];n=n<<16>>16,d[0]=a,d[1]=n}break}}if(b==e||b<0&&b==-e||b>0&&b==1-e){var o=f;f=-i,i=o}b+=f,e+=i}return a}()},this.readbackTargetId=function(){if(!oa[0])return null;var a=new Uint8Array(4*oa[0].width*oa[0].height);return y.readRenderTargetPixels(oa[0],0,0,oa[0].width,oa[0].height,a),{buffer:a,width:oa[0].width,height:oa[0].height}},this.rolloverObjectViewport=function(a,b){if(!Ja)return!1;Ba[1]=0;var c=this.idAtPixel(a,b,Ba);return this.rolloverObjectId(c,null,Ba[1])},this.rolloverObjectId=function(a,b,c){return c=c||0,a<=0&&(a=0),!(!Ja||a===Va&&c===Wa)&&(O.uniforms.highlightIntensity.value=0,O.uniforms.objID.value=a,Ua=performance.now(),Va=a,Wa=c,b?(b.length>1&&b.shift(),O.uniforms.highlightRange.value=1,O.uniforms.objIDStart.value=b[0],O.uniforms.objIDEnd.value=b[b.length-1]):(O.uniforms.highlightRange.value=0,O.uniforms.objIDv4.value.set((255&a)/255,(a>>8&255)/255,(a>>16&255)/255,(a>>24&255)/255),O.uniforms.modelIDv2.value.set((255&c)/255,(c>>8&255)/255)),!0)},this.setSelectionColor=function(a){var b=new THREE.Color(a);b.r=Math.pow(b.r,2),b.g=Math.pow(b.g,2),b.b=Math.pow(b.b,2),O.uniforms.selectionColor.value.set(b),O.material.needsUpdate=!0},this.setSelectionMaterials=function(a){Z.length=a.length;for(var b=0;b<a.length;b++)Z[b]=a[b];return cb(),!0},this.setMemoryLimited=function(a){Ja=!a,Ya.idbuffer=Ya.idbuffer&&Ja,Ya.occlusionid=a,this.setSize(X,Y)},this.isMemoryLimited=function(){return!Ja},this.setUnitScale=function(a){sa=a},this.getUnitScale=function(){return sa},this.getBlendPass=function(){return O},this.getClearPass=function(){return H},this.getColorTarget=function(){return ha},this.getDepthTarget=function(){return W},this.getIdTarget=function(){return oa[0]},this.getDepthMaterial=function(){return z},this.getPostTarget=function(){return ja},this.getEdgeMaterial=function(){return A},this.getNamedTarget=function(a){switch(a){case"color":return ha;case"overlay":return ia;case"id":return oa[0];case"post1":return ja;case"post2":return ma;case"postdisplay":return ka;case"ssao":return la;case"occlusion":return ua;case"depth":return W;case"highlight0":return na[0];case"highlight1":return na[1];case"highlight2":return na[2];case"highlight3":return na[3]}return null},this.getCurrentFramebuffer=function(){return y.getCurrentFramebuffer()}}var b=Autodesk.Viewing,c=b.Private;c.RenderContext=a}(),function(){"use strict";var a=Autodesk.Viewing,b=Autodesk.Viewing.Private;Autodesk.LMVTK;b.DefaultLightPreset=1,b.DefaultLightPreset2d=0,b.ModelSettingsEnvironment=null,b.BackgroundPresets={"Fusion Grey":[230,230,230,150,150,150],"Sky Blue":[226,244,255,156,172,180],Snow:[181,186,199,181,186,199],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],AutoCADModel:[30,40,48,30,40,48],"Dark Grey":[51,51,51,51,51,51],"Dark Sky":[51,51,51,51,51,51],"Infinity Pool":[255,255,255,255,255,255],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],"RaaS SBS":[1,1,1,90,90,90],Plaza:[79,102,130,79,102,130],Field:[202,226,252,202,201,190],Boardwalk:[216,230,248,230,228,220],Custom:[230,230,230,150,150,150]};var c=b.BackgroundPresets;b.LightPresets=[{name:"Simple Grey",path:null,tonemap:0,E_bias:0,directLightColor:[1,.84,.67],ambientColor:[.2,.225,.25],lightMultiplier:1,bgColorGradient:c["Fusion Grey"],darkerFade:!1,rotation:0},{name:"Sharp Highlights",path:"SharpHighlights",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.5,-.2,-.06],bgColorGradient:c["Photo Booth"],darkerFade:!0,rotation:0},{name:"Dark Sky",path:"DarkSky",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:1,lightDirection:[.1,-.55,-1],bgColorGradient:c["Dark Sky"],darkerFade:!1,rotation:0},{name:"Grey Room",path:"GreyRoom",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c["Grey Room"],darkerFade:!0,rotation:0},{name:"Photo Booth",path:"PhotoBooth",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c["Photo Booth"],darkerFade:!0,rotation:0},{name:"Tranquility",path:"TranquilityBlue",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c.Tranquility,darkerFade:!1,rotation:0},{name:"Infinity Pool",path:"InfinityPool",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,.84,.67],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c["Infinity Pool"],darkerFade:!1,rotation:0},{name:"Simple White",path:null,tonemap:0,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25,.25,.25],lightMultiplier:1,bgColorGradient:c.White,saoRadius:.06,saoIntensity:.15,darkerFade:!0,rotation:0},{name:"Riverbank",path:"riverbank",type:"logluv",tonemap:1,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],darkerFade:!1,rotation:0},{name:"Contrast",path:"IDViz",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Midnight,darkerFade:!1,rotation:0},{name:"Rim Highlights",path:"RimHighlights",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.35,-.35,-.5],bgColorGradient:c["Photo Booth"],darkerFade:!0,rotation:0},{name:"Cool Light",path:"CoolLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:c["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Warm Light",path:"WarmLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],
bgColorGradient:c["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Soft Light",path:"SoftLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.5,0],bgColorGradient:c["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Grid Light",path:"GridLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.6,0],bgColorGradient:c["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Plaza",path:"Plaza",type:"logluv",tonemap:1,E_bias:-14,directLightColor:[.9,.9,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.2,-.18,.72],bgColorGradient:c.Plaza,darkerFade:!1,rotation:0},{name:"Snow Field",path:"SnowField",type:"logluv",tonemap:1,E_bias:-10.461343,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[0,-1,0],bgColorGradient:c.Snow,darkerFade:!1,rotation:0},{name:"Field",path:"field",type:"logluv",tonemap:1,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Field,useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Boardwalk",path:"boardwalk",type:"logluv",tonemap:1,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Boardwalk,useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Flat Shading",path:null,tonemap:0,E_bias:0,directLightColor:[0,0,0],ambientColor:[0,0,0],lightMultiplier:0,bgColorGradient:c["Fusion Grey"],darkerFade:!1,rotation:0}],b.DebugEnvironments=[{name:"Crossroads",path:"crossroads",type:"logluv",tonemap:1,E_bias:-5.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Seaport",path:"seaport",type:"logluv",tonemap:1,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!1,rotation:0},{name:"Glacier",path:"glacier",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Midnight,darkerFade:!1,rotation:0},{name:"RaaS Test Env",path:"Reflection",type:"logluv",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["RaaS SBS"],darkerFade:!1,rotation:0}],b.ENABLE_DEBUG&&(b.LightPresets=b.LightPresets.concat(b.DebugEnvironments)),b.copyLightPreset=function(b,c){a.ObjectAssign(c,b),c.name=b.name+" (copy)"}}(),function(){"use strict";function a(a){WGS.MaterialManager.call(this,a);var b=WGS.MaterialManager.prototype,e=new THREE.Color("#0000FF"),f=function(a,b){a.x=b.r,a.y=b.g,a.z=b.b,a.w=1};this.create2DMaterial=function(g,h,i,j,k){var l=g?g.getData():null,m="__lineMaterial__";h.image&&(m+="|image:"+h.image.name),h.clip&&(m+="|clip:"+JSON.stringify(h.clip)),i&&(m+="|id"),j&&(m+="|selection"),h.skipEllipticals&&(m+="|skipEllipticals"),h.skipCircles&&(m+="|skipCircles"),h.skipTriangleGeoms&&(m+="|skipTriangleGeoms"),h.useInstancing&&(m+="|useInstancing");var n=this._getMaterialHash(g,m);if(!this._materials.hasOwnProperty(n)){var o=c.Shaders,p=o.createShaderMaterial(o.LineShader);if(p.is2d=!0,p.transparent=!0,p.depthWrite=!1,p.depthTest=!1,p.side=THREE.DoubleSide,p.blending=THREE.NormalBlending,i?(p.defines.ID_COLOR=1,p.blending=THREE.NoBlending):j?(p.uniforms.tSelectionTexture.value=j,p.uniforms.vSelTexSize.value.set(j.image.width,j.image.height),p.defines.SELECTION_RENDERER=1,p.uniforms.selectionColor.value=new THREE.Vector4(0,0,1,1)):(f(p.uniforms.selectionColor.value,e),a&&a.supportsMRT()&&(p.mrtIdBuffer=this._mrtIdBuffer)),h.skipEllipticals||(p.defines.HAS_ELLIPTICALS=1),h.skipCircles||(p.defines.HAS_CIRCLES=1),h.skipTriangleGeoms||(p.defines.HAS_TRIANGLE_GEOMS=1),h.useInstancing&&(p.defines.USE_INSTANCING=1),h.image){var q=function(a){a.wrapS=THREE.ClampToEdgeWrapping,a.wrapT=THREE.ClampToEdgeWrapping,a.minFilter=THREE.LinearMipMapLinearFilter,a.magFilter=THREE.LinearFilter,a.anisotropy=1,a.flipY=!0,a.generateMipmaps=!0,a.needsUpdate=!0,p.defines.HAS_RASTER_QUADS=1,p.uniforms.tRaster.value=a,-1!==h.image.dataURI.indexOf("png")&&(p.transparent=!0),p.needsUpdate=!0,k&&k(a)};WGS.TextureLoader.loadTextureWithSecurity(h.image.dataURI,!1,THREE.UVMapping,q,l.acmSessionId,d.initLoadContext)}p.modelScale=h.modelScale||1,b.addLineMaterial.call(this,n,p)}return m},this.set2dSelectionColor=function(a){e=new THREE.Color(a),this.forEach(function(a){if(a.is2d&&a.uniforms){var b=a.uniforms.selectionColor;b&&(f(b.value,e),a.needsUpdate=!0)}})}}function b(b){return d.hasOwnProperty("MaterialManager")||(a.prototype=new WGS.MaterialManager(b),a.prototype.constructor=a,d.MaterialManager=a),new d.MaterialManager(b)}var c=Autodesk.Viewing,d=c.Private;Autodesk.Viewing.Private.createMaterialManager=b}(),function(){"use strict";function a(a,b){function c(a,b,c,d,e,f,g){var h=.5*(c-a),i=.5*(d-b);return(2*(b-c)+h+i)*g+(-3*(b-c)-2*h-i)*f+h*e+b}var d,e,f,g,h,i,j,k,l,m=[],n=[];return d=(a.length-1)*b,e=Math.floor(d),f=d-e,m[0]=0===e?e:e-1,m[1]=e,m[2]=e>a.length-2?e:e+1,m[3]=e>a.length-3?e:e+2,i=a[m[0]],j=a[m[1]],k=a[m[2]],l=a[m[3]],g=f*f,h=f*g,n[0]=c(i[0],j[0],k[0],l[0],f,g,h),n[1]=c(i[1],j[1],k[1],l[1],f,g,h),n[2]=c(i[2],j[2],k[2],l[2],f,g,h),n}var b=Autodesk.Viewing.Private,c={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2},d=function(){this.animations=[]};d.prototype.init=function(a){if(!0===a.initialized)return a;for(var b=0;b<a.hierarchy.length;b++){for(var c=0;c<a.hierarchy[b].keys.length;c++)if(a.hierarchy[b].keys[c].time<0&&(a.hierarchy[b].keys[c].time=0),void 0!==a.hierarchy[b].keys[c].rot&&!(a.hierarchy[b].keys[c].rot instanceof THREE.Quaternion)){var d=a.hierarchy[b].keys[c].rot;Array.isArray(d)||(d=[d._x,d._y,d._z,d._w]),a.hierarchy[b].keys[c].rot=(new THREE.Quaternion).fromArray(d)}for(var c=1;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].time===a.hierarchy[b].keys[c-1].time&&(a.hierarchy[b].keys.splice(c,1),c--);for(var c=0;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].index=c}return a.initialized=!0,a},d.prototype.parse=function(a){function b(a,c){if(c.push(a),a.children&&!(a instanceof THREE.Camera))for(var d=0;d<a.children.length;d++)b(a.children[d],c)}var c=[];return b(a,c),c},d.prototype.play=function(a){-1===this.animations.indexOf(a)&&this.animations.push(a)},d.prototype.stop=function(a){var b=this.animations.indexOf(a);-1!==b&&this.animations.splice(b,1)},d.prototype.update=function(a){for(var b=0;b<this.animations.length;b++)this.animations[b].update(a)};var e=function(a,b,d){this.root=a,this.handler=d.animationHandler,this.data=this.handler.init(b),this.hierarchy=this.handler.parse(a),this.viewer=d.viewer,this.animator=d,this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!1,this.delta=.5,this.interpolationType=c.LINEAR,this.setStartAndEndKeyTime()};e.prototype.setStartAndEndKeyTime=function(){if(this.data.hierarchy.length>0){var a=this.data.hierarchy[0].keys;this.startKeyTime=a[0].time,this.endKeyTime=a[a.length-1].time}else this.startKeyTime=this.endKeyTime=0},e.prototype.keyTypes=[],e.prototype.defaultKey={},e.prototype.play=function(a){this.currentTime=void 0!==a?a:0,this.isPlaying=!0,this.isPaused=!1,this.reset(),this.handler.play(this)},e.prototype.pause=function(){!0===this.isPaused?this.handler.play(this):this.handler.stop(this),this.isPaused=!this.isPaused},e.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.handler.stop(this)},e.prototype.goto=function(a){this.isPlaying||this.play(),this.isPaused||this.pause();var b=a-this.currentTime;this.update(b)},e.prototype.reset=function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];void 0===c.animationCache&&(c.animationCache={}),void 0===c.animationCache[this.data.name]&&(c.animationCache[this.data.name]={prevKey:this.defaultKey,nextKey:this.defaultKey,originalMatrix:c.matrix});for(var d=c.animationCache[this.data.name],e=0;e<this.keyTypes.length;e++){for(var f=this.keyTypes[e],g=this.data.hierarchy[a].keys[0],h=this.getNextKeyWith(f,a,1);h.time<this.currentTime&&h.index>g.index;)g=h,h=this.getNextKeyWith(f,a,h.index+1);d.prevKey[f]=g,d.nextKey[f]=h}}this.setStartAndEndKeyTime()},e.prototype.getNextKeyWith=function(a,b,d){var e=this.data.hierarchy[b].keys;for(this.interpolationType===c.CATMULLROM||this.interpolationType===c.CATMULLROM_FORWARD?d=d<e.length-1?d:e.length-1:d%=e.length;d<e.length;d++)if(void 0!==e[d][a])return e[d];return this.data.hierarchy[b].keys[0]},e.prototype.getPrevKeyWith=function(a,b,d){var e=this.data.hierarchy[b].keys;for(d=this.interpolationType===c.CATMULLROM||this.interpolationType===c.CATMULLROM_FORWARD?d>0?d:0:d>=0?d:d+e.length;d>=0;d--)if(void 0!==e[d][a])return e[d];return this.data.hierarchy[b].keys[e.length-1]},e.prototype.isPlayingOutOfRange=function(){return!1===this.isPaused&&(this.currentTime<this.startKeyTime-this.delta||this.currentTime>this.endKeyTime+this.delta)},e.prototype.resetIfLooped=function(){!0===this.loop&&this.currentTime>this.endKeyTime&&(this.currentTime%=this.endKeyTime,this.reset())};var f=function(a,b,c){e.call(this,a,b,c),this.localMatrix=new THREE.Matrix4,this.root.getAnimTransform(),this.relativeTransform=!b.custom||!b.custom.transform||"abs"!==b.custom.transform};f.prototype=Object.create(e.prototype),f.prototype.constructor=f,f.prototype.keyTypes=["pos","rot","scl"],f.prototype.defaultKey={pos:0,rot:0,scl:0},f.prototype.update=function(){function b(){d||(d=new THREE.Vector3,e=new THREE.Vector3,f=new THREE.Quaternion,g=new THREE.Matrix4,h=new THREE.Matrix4)}var d,e,f,g,h,i=[];return function(j){if(!1!==this.isPlaying&&(this.currentTime+=j*this.timeScale,b(),this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var k=0,l=this.hierarchy.length;k<l;k++){for(var m=this.hierarchy[k],n=m.animationCache[this.data.name],o=0;o<this.keyTypes.length;o++){var p=this.keyTypes[o],q=n.prevKey[p],r=n.nextKey[p];if(r.time<=this.currentTime||q.time>=this.currentTime){for(q=this.data.hierarchy[k].keys[0],r=this.getNextKeyWith(p,k,1);r.time<this.currentTime&&r.index>q.index;)q=r,r=this.getNextKeyWith(p,k,r.index+1);n.prevKey[p]=q,n.nextKey[p]=r}var s=q[p],t=r[p];if(r.time!==q.time&&void 0!==s&&void 0!==t){var u=(this.currentTime-q.time)/(r.time-q.time);if(u<0&&(u=0),u>1&&(u=1),"pos"===p)if(this.interpolationType===c.LINEAR)e.x=s[0]+(t[0]-s[0])*u,e.y=s[1]+(t[1]-s[1])*u,e.z=s[2]+(t[2]-s[2])*u,m.position.copy(e);else{i[0]=this.getPrevKeyWith("pos",k,q.index-1).pos,i[1]=s,i[2]=t,i[3]=this.getNextKeyWith("pos",k,r.index+1).pos,u=.33*u+.33;var v=a(i,u);if(e.x=v[0],e.y=v[1],e.z=v[2],m.position.copy(e),this.interpolationType===c.CATMULLROM_FORWARD){var w=a(i,1.01*u);d.set(w[0],w[1],w[2]),d.sub(vector),d.y=0,d.normalize();var x=Math.atan2(d.x,d.z);m.rotation.set(0,x,0)}}else"rot"===p?(THREE.Quaternion.slerp(s,t,f,u),m.quaternion.copy(f)):"scl"===p&&(e.x=s[0]+(t[0]-s[0])*u,e.y=s[1]+(t[1]-s[1])*u,e.z=s[2]+(t[2]-s[2])*u,m.scale.copy(e))}}if(!this.relativeTransform){var y=g.compose(m.position,m.quaternion,m.scale),z=h;m.getOriginalWorldMatrix(z),z.getInverse(z);var A=g.multiplyMatrices(y,z);A.decompose(m.position,m.quaternion,m.scale)}m.updateAnimTransform()}}}();var g=function(a,b,c){e.call(this,a,b,c)};g.prototype=Object.create(e.prototype),g.prototype.constructor=g,g.prototype.keyTypes=["pos","up","target","fov","perspective"],g.prototype.defaultKey={pos:0,up:0,target:0,fov:0,perspective:0},g.prototype.update=function(){function b(){d||(d=new THREE.Vector3,e=new THREE.Vector3)}var d,e,f=[];return function(g){if(!1!==this.isPlaying&&(this.currentTime+=g*this.timeScale,b(),this.resetIfLooped(),!this.isPlayingOutOfRange())){for(var h=0,i=this.hierarchy.length;h<i;h++){for(var j=this.hierarchy[h],k=j.animationCache[this.data.name],l=0;l<this.keyTypes.length;l++){var m=this.keyTypes[l],n=k.prevKey[m],o=k.nextKey[m];if(o.time<=this.currentTime||n.time>=this.currentTime){for(n=this.data.hierarchy[h].keys[0],o=this.getNextKeyWith(m,h,1);o.time<this.currentTime&&o.index>n.index;)n=o,o=this.getNextKeyWith(m,h,o.index+1);k.prevKey[m]=n,k.nextKey[m]=o}var p=n[m],q=o[m];if(o.time!==n.time&&void 0!==p&&void 0!==q){var r=(this.currentTime-n.time)/(o.time-n.time);r<0&&(r=0),r>1&&(r=1);var s;if("pos"===m)s=j.position;else if("up"===m)s=j.up;else if("target"===m)s=j.target;else{if("fov"===m){j.setFov(p+(q-p)*r);continue}if("perspective"===m){var t=r>.5?q:p;t?j.toPerspective():j.toOrthographic();continue}}if(this.interpolationType===c.LINEAR)e.x=p[0]+(q[0]-p[0])*r,e.y=p[1]+(q[1]-p[1])*r,e.z=p[2]+(q[2]-p[2])*r,s.copy(e);else{f[0]=this.getPrevKeyWith(m,h,n.index-1)[m],f[1]=p,f[2]=q,f[3]=this.getNextKeyWith(m,h,o.index+1)[m],r=.33*r+.33;var u=a(f,r);if(e.x=u[0],e.y=u[1],e.z=u[2],s.copy(e),this.interpolationType===c.CATMULLROM_FORWARD){var v=a(f,1.01*r);d.set(v[0],v[1],v[2]),d.sub(s),d.y=0,d.normalize();var w=Math.atan2(d.x,d.z);j.rotation.set(0,w,0)}}}}j.matrixAutoUpdate=!0,j.matrixWorldNeedsUpdate=!0}j.lookAt(j.target),this.animator.updateFlag|=this.animator.UPDATE_CAMERA}}}();var h=function(a,b,c,d){e.call(this,a,b,d),this.nodeId=c,this.epsilon=.1,this.root.setMaterial(this.viewer.matman().cloneMaterial(a.getMaterial(),d.viewer.model))};h.prototype=Object.create(e.prototype),h.prototype.constructor=h,h.prototype.keyTypes=["vis","opa"],h.prototype.defaultKey={viz:1,opa:1},h.prototype.update=function(){return function(a){if(!1!==this.isPlaying&&(this.currentTime+=a*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var b=0,c=this.hierarchy.length;b<c;b++)for(var d=this.hierarchy[b],e=d.animationCache[this.data.name],f=0;f<this.keyTypes.length;f++){var g=this.keyTypes[f],h=e.prevKey[g],i=e.nextKey[g];if(i.time<=this.currentTime||h.time>=this.currentTime){for(h=this.data.hierarchy[b].keys[0],i=this.getNextKeyWith(g,b,1);i.time<this.currentTime&&i.index>h.index;)h=i,i=this.getNextKeyWith(g,b,i.index+1);e.prevKey[g]=h,e.nextKey[g]=i}var j=h[g],k=i[g];if(i.time!==h.time&&void 0!==j&&void 0!==k){var l=d.getMaterial();if("vis"===g){var m=Math.abs(this.currentTime-i.time)<this.epsilon,n=m?k:j;this.viewer.visibilityManager.setNodeOff(this.nodeId,!n)}else if("opa"===g){var o=(this.currentTime-h.time)/(i.time-h.time);o<0&&(o=0),o>1&&(o=1);var p=j+(k-j)*o;l.transparent=1!==p,l.opacity=p,p>0&&this.viewer.visibilityManager.setNodeOff(this.nodeId,!1)}}}}}();var i=function(a,b,c){var d=this;null===a&&(a=function(a,b,c){var e=d.container=document.createElement("div"),f=a.name;e.id=f,e.style.cursor="pointer",e.style.visibility=c;var g=document.createElement("div");g.id=f+"-txt",g.style.cssText="display: none;position: absolute;z-index: 1;",e.appendChild(g);var h=document.createElement("img"),i=a.custom&&a.custom.att&&1===a.custom.att;h.src=i?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABv1BMVEUAAAAAAAAAAAAAAAABAwEAAAAAAAAjSRkAAAAFDASJqnZhg1IqTyAjSRkpTx8hRxggRRcAAAAhRRcKFwgAAACau4R9mnFmiFUhSBgbOhMZNhIAAAAECQMgQxcAAAAAAAAAAAAHDwXB2q2jw4yfvoivyJ6fuI6mv5eSr4KAoWu2trZpiV3Nzc0wVSUhRxhNT01vb28AAAAgRBcAAAAAAAAAAAAhRxgeQBYAAAAAAAAAAAAfQRbP5MC0zqCqyJKpyJJBYje3z6WxyKOFpXF9nmkrTiG+wb5xkGVcf0xYfEg1WSpNTU0hRhgfQhYfQhZVVVVAQEAXMREcOhQcHBwSJw0AAAAAAAAWLxAVLQ8AAAAAAAAfQhYIEgYAAACbvn+DsGCGsmSUunaItGXc6dStypelxY2ZvX2Ntm2JtGnS48fB17G40aWNuWucxH6ny4mUvnPF27aPuHCEsGHV5czI3Lq52KGvzJqz1JmqyJOqzY6ew4OYwHiGs2OEsWHb29vL4LvM5bnD3q2+3KWkyoaLtWuKtmfOzs7IyMi21pyawXqPuG/g4ODX68fI4rTG4LCu0ZKszJKlx4qZwHuBnXR2iXENcZskAAAAXnRSTlMAEAIBCAsF6BUn+vPu7erjsZyBEwP99/TRk3JgRUQ1IxwO/v79/Pv6+fn09PPq08q7sqWDe2xrY01AMBj+/v7+/v37+fn59fXz8u/c1cbFxLWonZiIcm1lYVdSQT8de/EoFwAAAgVJREFUOMutklVz21AQRiNFlswYs+M6DTdN0kCDZWZmuAKDZFtgiO2YYm6TlOEHV53ptGs5j93Xc+a7e3d36P/W9prdZ/PZ17aPxphz3mR0x91G07wTG8TDo5R3HLGH3S6fGPdSo8Na/to6W2HZBEqwPCNULlu1BkFdQSyKx4qxOMoyDDJSRB/HnTcqWbSbTmVS6V3E57hvXicOBZd1gmfj6Z1kPrmTjrMMfRizumDA+k3UTcRSyWg0mkzFEgLNlU3rIIJcns0KqJjJq0I+U0SqUJlZJv8JugU3J/QnHEwu6MCMqPN1pq+H3sFxCgOC7RyT48Ev6qLUL/gmeJrJ/p0DzSnyxTtAGLMbv9dohv8zSbomSqUpOxB0AdNXsUbnGEEQmJzKq3JrLgCaJAzms5LI1enfVefEamc/YzYQYFB6/1xBUsQex3E9UZHkUvO6X48PwQjLTKEjVRVFqUqd8v6naQsMUCNcL8xTrVJZluXyl1K7OW1+7sL71x15cvVH43O7UGi3mmc8lkCE0ByMbvXazwueycbHxiXPrUdv3hLDGiF8au/d4sO7Novtnj9k0BO45uRGTp98f2JlK/RqYzN8TK8bGTjZLTXgfvDp6rMNA0ZADAOWHI6VTYwE4WAZjz/s3V5yvIxADosIPlh0BNXHSdA8LFIfDgE8WDg5hmmx9h/40fgXth2SDk3yjP4AAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABvFBMVEUAAAAAAAADAAAAAAAAAAACAAAAAAAAAAC5PznHVE8BAAAAAADbc27NXVeUDQaZDQaRBwAAAAAAAACHBgDuhoHVa2W9RD2QCAKYCAGPBgB0BQAAAAAAAACMBgAAAAADAAD2jonWb2n2jYjYbWfmeXPNzc3RYFqzODKfFA1RUVGKBgCVBwBvb2+WBwCBBgCFBgCWBwCLBgAAAAAAAACMBgCTBwByBQCTBwBbBACEBgAAAAAAAAAoAgBSBADgeHOoOzXmfnnofnjieHPGvr63t7e0tLTidW/ebmnba2XWZWDAT0qRHBfBSkRNTU2aFxGOBgBYTEsAAACNBgBAQEAAAABbBQAcHBxyBQBKBAAAAABfBAAAAAAAAAAsAgAkAgCJBgDZRT3MOTHQPDTVQjrlUkrjUEjRPjbOOjP/bGTvXFTqV0/fTETNOjL5Zl7eS0PzYFjxXlbiT0fUQTn0e3T7aGDWXFXbSEDTRj/PQTrOPjbb29vgamTxY1zoVE3STETTQjvSPzfOzs7IyMj5g3zzaWLXY13XYVrsXlbbU0zg4OD8lZD4gXq0eHXqd3HscWv2b2jrZmDQZWDdWVLkV1C5y9+5AAAAYHRSTlMAAgUBDggMEeDsIBj+8NHJxpxAEP754tDDtIFsYDkvI/78+/j08/DfycfHxbuvr5mTjYN0bWxkWVZTTDUjEfz8+/n59fT08vHw8PDw5NzV0Mq5uLWrm5iLfX1hV0g/ODZEwKduAAACAklEQVQ4y62SVXPbQBzEa1mWZYaY49ihBhtmKjMzw92JLLBsyxxT2mCZvnCVmU59VpO37Ms97G929nb+p05WXUvTE5GJ6aWuY+yFEdoVdAZd9MjCEYi5J0L3FZutSqVZdIYiPWaj/85j2yszAACGVyq7Lo+RIMZtxRaQOZaTwZZSLbrGLR2+aX54twVykpgVpRzgYbVGz5twYMPTV2ZkKZMupDOSzAiwfNazgQesDO9VASemU6lUWuQAgnyNXsEiiBlbEwE2W9CBQpbVAfRraIZoA5ZosII6EpB6MYrVpLxOQejowKsBL9UGSK+zCnnsF4omB7wkBkQHylDZ+rcDROD3hYcYQE0NHQhQ4f8uCQVG/XF9isJKLtI1TYBQQAgdPlqJzYcWMYBYd58/YJACD6UgpsTVA+51AhvKGgt9zQGN1xN4Dajs/vbtmBXf2mIP3/jGqiW9Q0nlGtn8tXBSnwGPWHYP5PcbLMs2JHFn+6p7WQ/ARTie3/rZm9+pZ+rfP/fawi8dhOFgqLlLX87dHOz/1D9ou/vsrcNiNgBrZzbf338yOXZvbDL2xm4ljCdn6j794cpswr/62p+wWy2m/042oQeMxudedK8mSdzGAy4/9vlm/STRtjGRTz9u3nnge2U3+O2h4o9GfXG7lcLKGWZY8ycduG3sQJCk0Tb+w3S0/Qemc4+eJchuZgAAAABJRU5ErkJggg==",h.id=f+"-img",h.style.cssText="display: block;position: absolute;z-index: 1;",e.appendChild(h),b.api.container.appendChild(e),e.addEventListener("click",function(){g.style.display="none"===g.style.display?"block":"none"});var j=new THREE.SphereGeometry(.01),k=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:.6,transparent:!0}),l=new THREE.Mesh(j,k);return l.visible=!1,void 0===b.overlayScenes.annotation&&b.createOverlayScene("annotation"),b.addOverlay("annotation",l),l}(b,c.viewer,"hidden")),e.call(this,a,b,c),this.id=b.name,this.text="",this.state="hidden",this.epsilon=.1,this.viewer.api.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(b){d.updateText(a.position,d.text)})};i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype.keyTypes=["pos","text","vis"],i.prototype.defaultKey={pos:0,text:"",vis:1},i.prototype.stop=function(){e.prototype.stop.call(this),this.container.parentNode.removeChild(this.container),this.viewer.removeOverlay("annotation",this.root),this.root=null},i.prototype.updateText=function(a,b){var c=function(a,b,c){var d=a.clone(),e=new THREE.Matrix4;return b.updateMatrixWorld(),b.matrixWorldInverse.getInverse(b.matrixWorld),e.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),d.applyProjection(e),{x:(d.x+1)*c.width/2+c.offsetLeft,y:(1-d.y)*c.height/2+c.offsetTop}}(a,this.viewer.camera,this.viewer.canvas),d=document.getElementById(this.id+"-txt");d&&(d.innerHTML=b,d.style.left=c.x+"px",d.style.top=c.y+"px",this.text=b),(d=document.getElementById(this.id+"-img"))&&(d.style.left=c.x+"px",d.style.top=c.y-24+"px")},i.prototype.update=function(){function b(){d||(d=new THREE.Vector3,e=new THREE.Vector3)}var d,e,f=[];return function(g){if(!1!==this.isPlaying&&(this.currentTime+=g*this.timeScale,b(),this.resetIfLooped(),!this.isPlayingOutOfRange())){if(this.isPaused&&this.currentTime<this.startKeyTime){var h=document.getElementById(this.id);return void(h&&(h.style.visibility=this.state))}for(var i=0,j=this.hierarchy.length;i<j;i++){for(var k=this.hierarchy[i],l=k.animationCache[this.data.name],m=0;m<this.keyTypes.length;m++){var n=this.keyTypes[m],o=l.prevKey[n],p=l.nextKey[n];if(p.time<=this.currentTime||o.time>=this.currentTime){for(o=this.data.hierarchy[i].keys[0],p=this.getNextKeyWith(n,i,1);p.time<this.currentTime&&p.index>o.index;)o=p,p=this.getNextKeyWith(n,i,p.index+1);l.prevKey[n]=o,l.nextKey[n]=p}var q=o[n],r=p[n];if(p.time!==o.time&&void 0!==q&&void 0!==r){var s=(this.currentTime-o.time)/(p.time-o.time);if(s<0&&(s=0),s>1&&(s=1),"pos"===n){if(this.interpolationType===c.LINEAR)e.x=q[0]+(r[0]-q[0])*s,e.y=q[1]+(r[1]-q[1])*s,e.z=q[2]+(r[2]-q[2])*s,k.position.copy(e);else if(this.interpolationType===c.CATMULLROM||this.interpolationType===c.CATMULLROM_FORWARD){f[0]=this.getPrevKeyWith("pos",i,o.index-1).pos,f[1]=q,f[2]=r,f[3]=this.getNextKeyWith("pos",i,p.index+1).pos,s=.33*s+.33;var t=a(f,s);if(e.x=t[0],e.y=t[1],e.z=t[2],k.position.copy(e),this.interpolationType===c.CATMULLROM_FORWARD){var u=a(f,1.01*s);d.set(u[0],u[1],u[2]),d.sub(vector),d.y=0,d.normalize();var v=Math.atan2(d.x,d.z);k.rotation.set(0,v,0)}}}else if("text"===n){var w=Math.abs(this.currentTime-p.time)<this.epsilon?r:q;this.updateText(k.position,w)}else if("vis"===n){var h=document.getElementById(this.id);if(h){var x=Math.abs(this.currentTime-p.time)<this.epsilon?r:q;h.style.visibility=x?"visible":"hidden"}}}}k.matrixAutoUpdate=!0,k.matrixWorldNeedsUpdate=!0}}}}();var j=function(a,b,c){this.viewer=c.viewer,null===a&&(a=this.createPolyline([])),e.call(this,a,b,c),this.epsilon=.1};j.prototype=Object.create(e.prototype),j.prototype.constructor=j,j.prototype.keyTypes=["points","vis"],j.prototype.defaultKey={points:[],vis:1},j.prototype.stop=function(){e.prototype.stop.call(this),this.viewer.removeOverlay("polyline",this.root),this.root=null},j.prototype.update=function(){function a(a){a.root&&(a.viewer.removeOverlay("polyline",a.root),a.root=null)}return function(b){if(!1!==this.isPlaying&&(this.currentTime+=b*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){if(this.isPaused&&this.currentTime<this.startKeyTime)return void a(this);for(var c=0,d=this.hierarchy.length;c<d;c++)for(var e=this.hierarchy[c],f=e.animationCache[this.data.name],g=0;g<this.keyTypes.length;g++){var h=this.keyTypes[g],i=f.prevKey[h],j=f.nextKey[h];if(j.time<=this.currentTime||i.time>=this.currentTime){for(i=this.data.hierarchy[c].keys[0],j=this.getNextKeyWith(h,c,1);j.time<this.currentTime&&j.index>i.index;)i=j,j=this.getNextKeyWith(h,c,j.index+1);f.prevKey[h]=i,f.nextKey[h]=j}var k=i[h],l=j[h];if(j.time!==i.time&&void 0!==k&&void 0!==l){var m=(this.currentTime-i.time)/(j.time-i.time);if(m<0&&(m=0),m>1&&(m=1),"points"===h){var n=m<.5?k:l;this.viewer.removeOverlay("polyline",this.root),this.root=null;for(var o=[],p=0;p<n.length;p++){var q=n[p].slice();if(0===p)q[0]=k[p][0]+(l[p][0]-k[p][0])*m,q[1]=k[p][1]+(l[p][1]-k[p][1])*m,q[2]=k[p][2]+(l[p][2]-k[p][2])*m;else if(p===n.length-1){var r=k.length-1,s=l.length-1;q[0]=k[r][0]+(l[s][0]-k[r][0])*m,q[1]=k[r][1]+(l[s][1]-k[r][1])*m,q[2]=k[r][2]+(l[s][2]-k[r][2])*m}var t=new THREE.Vector3(q[0],q[1],q[2]);o.push(t)}this.root=this.createPolyline(o)}else if("vis"===h){var u=Math.abs(this.currentTime-j.time)<this.epsilon?l:k;this.root.visible=u,u||a(this)}}}}}}(),j.prototype.createPolyline=function(a){for(var b=new THREE.Geometry,c=0;c<a.length;c++)b.vertices.push(a[c]);b.computeLineDistances();var d=new THREE.LineDashedMaterial({color:0,dashSize:1,gapSize:.5,linewidth:1}),e=new THREE.Line(b,d,THREE.LineStrip);return void 0===this.viewer.overlayScenes.polyline&&this.viewer.createOverlayScene("polyline"),this.viewer.addOverlay("polyline",e),e},b.Animation=e,b.AnimationHandler=d,b.MeshAnimation=f,b.CameraAnimation=g,b.PolylineAnimation=j,b.VisibilityAnimation=h,b.AnnotationAnimation=i}(),function(){"use strict";var a=Autodesk.Viewing.Private,b=function(a,b){this.animations=[],this.viewer=a,this.keys=[],this.isPlaying=!1,this.isPaused=!0,this.updateFlag=0,this.duration=b,this.currentTime=0,this.onPlayCallback=null,this.animationHandler=new Autodesk.Viewing.Private.AnimationHandler,this.areCameraAnimationsPaused=!1,this.UPDATE_SCENE=1,this.UPDATE_CAMERA=2};b.prototype.destroy=function(){this.stop(),this.viewer=null,this.keys=null,this.animations=null,this.isPlaying=!1,this.isPaused=!1,this.animationHandler=null},b.prototype.add=function(b){if(!(!b.hierarchy||b.hierarchy.length<1||!b.hierarchy[0].keys||b.hierarchy[0].keys.length<2)){var c=null,d=this;if("camera"===b.type?(c=new a.CameraAnimation(d.viewer.camera,b,d),d.animations.push(c)):"annotation"===b.type?(c=new a.AnnotationAnimation(null,b,d),d.animations.push(c)):"polyline"===b.type?(c=new a.PolylineAnimation(null,b,d),d.animations.push(c)):"mesh"!==b.type&&"visibility"!==b.type||d.viewer.model.getData().instanceTree.enumNodeFragments(b.id,function(e){var f=d.viewer.getFragmentProxy(d.viewer.model,e);f&&(c="mesh"===b.type?new a.MeshAnimation(f,b,d):new a.VisibilityAnimation(f,b,b.id,d),d.animations.push(c))},!0),c){for(var e=0,f=b.hierarchy.length;e<f;e++)for(var g=b.hierarchy[e].keys,h=0;h<g.length;h++)void 0===g[h].xk&&d.keys.push(g[h].time);!function(a){a.sort(function(a,b){return a-b}),function(a,b,c){for(b=a.length;c=--b;)for(;c--;)a[b]!==a[c]||a.splice(c,1)}(a)}(d.keys)}this.updateFlag|=this.UPDATE_SCENE}},b.prototype.update=function(a){this.animationHandler.update(a);var b=this.updateFlag;return this.isPlaying&&!this.isPaused&&(this.currentTime+=a,this.currentTime=Math.min(this.currentTime,this.duration),this.onPlayCallback&&this.onPlayCallback(this.duration>0?this.currentTime/this.duration*100:0),this.currentTime>=this.duration&&this.pause(),b|=this.UPDATE_SCENE),this.updateFlag=0,b},b.prototype.play=function(a,b){if(this.onPlayCallback=b,this.currentTime>=this.duration&&this.goto(0),this.isPlaying)return void this.pause();for(var c=0;c<this.animations.length;c++){this.animations[c].play(a)}this.isPlaying=!0,this.isPaused=!1},b.prototype.pause=function(){for(var a=0;a<this.animations.length;a++){var b=this.animations[a];b.isPaused===this.isPaused&&b.pause()}this.isPaused=!this.isPaused,this.areCameraAnimationsPaused=this.isPaused},b.prototype.pauseCameraAnimations=function(){for(var a=0;a<this.animations.length;a++){var b=this.animations[a];b instanceof Autodesk.Viewing.Private.CameraAnimation&&b.pause()}this.areCameraAnimationsPaused=!this.areCameraAnimationsPaused},b.prototype.stop=function(){for(var a=0;a<this.animations.length;a++){this.animations[a].stop()}this.isPlaying=!1,this.isPaused=!1},b.prototype.goto=function(a){if(void 0!==a){for(var b=0;b<this.animations.length;b++){this.animations[b].goto(a)}this.isPlaying=!0,this.isPaused=!0,this.currentTime=a,this.updateFlag|=this.UPDATE_SCENE}},b.prototype.next=function(){var a=function(a,b){for(var c=-1,d=0;d<b.length;d++)if(b[d]>a){c=b[d];break}return c<0?b[b.length-1]:c}(this.currentTime,this.keys);this.goto(a)},b.prototype.prev=function(){var a=function(a,b){for(var c=-1,d=b.length-1;d>-1;d--)if(b[d]<a){c=b[d];break}return c<0?b[0]:c}(this.currentTime,this.keys);this.goto(a)},a.KeyFrameAnimator=b}();var av=Autodesk.Viewing,avp=Autodesk.Viewing.Private,ENABLE_DEBUG=!1;!function(){"use strict";function a(a,b){function c(a){if(!a)return null;var b=window.devicePixelRatio;b||(b=1);var c=av.InitParametersSetting;c.canvas=a,c.devicePixelRatio=b,c.stencil=!0;var d=new avp.FireflyWebGLRenderer(c);return d.context?(d.autoClear=!1,d.sortObjects=!1,d):null}function d(a){var b=$.phase,c=b!=avp.RENDER_HIGHLIGHTED2,d=b==avp.RENDER_NORMAL||b==avp.RENDER_HIGHLIGHTED1,e=(U.settings.idbuffer||U.settings.occlusionid)&&b!=avp.RENDER_HIDDEN,f=b==avp.RENDER_HIGHLIGHTED1||b==avp.RENDER_HIGHLIGHTED2?15:0;e&&U.settings.occlusionid&&a instanceof avp.RenderBatch&&a.sortObjects&&(e=!1),b==avp.RENDER_HIDDEN&&(a.overrideMaterial=ba.fadeMaterial),U.renderScenePart(a,c,d,e,f),a.overrideMaterial=null}function e(a){wa++,ua<=a&&ua>0&&(va=.8*va+.2*(a-ua)),ba.fpsCallback&&ba.fpsCallback(ba.fps())}function f(a){if(ba.keyFrameAnimator){var b=ua>0?(a-ua)/1e3:0,c=ba.keyFrameAnimator.update(b);if(c&&(ba.sceneUpdated(!0),c&ba.keyFrameAnimator.UPDATE_CAMERA))return!0}return!1}function g(){P&&(ba.canvasBoundingclientRectDirty=!0,ba.camera.aspect=Q/R,ba.camera.clientWidth=Q,ba.camera.clientHeight=R,U.setSize(Q,R),ba.controls.handleResize(),Y&&Y.setSize(Q,R),ba.invalidate(!0,!0,!0),P=!1,ba.api.dispatchEvent({type:av.VIEWER_RESIZE_EVENT,width:Q,height:R}))}function h(){if((X.enabled||Y)&&!ba.is2d){var a;if(a=ba.model&&!ba.model.isLoadDone()?ba.model.getData().bbox:ba.getVisibleBounds(!0,!1)){var b=ba.camera,c=a.clone(),d=new THREE.Vector3(1,0,0),e=ja.clone();b.worldUpTransform&&(c.applyMatrix4(b.worldUpTransform),d.applyMatrix4(b.worldUpTransform),e.applyMatrix4(b.worldUpTransform)),c.min.y-=.005*(c.max.y-c.min.y),V&&V.expandByGroundShadow(c,e);var f=c.size(),g=c.center();if(V||(f.x*=1.25,f.z*=1.25,f.x=f.z=Math.max(f.x,f.z)),b.worldUpTransform){var h=(new THREE.Matrix4).getInverse(b.worldUpTransform);g.applyMatrix4(h)}if(X.setTransform(g,f,b.worldup,d),Y){var i=(new THREE.Vector3).subVectors(g,b.worldup.clone().multiplyScalar(f.y/2));Y.setTransform(i,b.worldup,f)}V&&V.setGroundShadowTransform(g,f,b.worldup,d)}}}function i(){return!!qa&&(h(),X.setDirty(),qa=!1,!0)}function j(a){for(var b in ba.selectionMeshes){var c=ba.selectionMeshes[b];if(c.model){var d=c.model.getFragmentList();c.geometry===d.getGeometry(c.fragId)&&d.getWorldMatrix(c.fragId,c.matrix)}}}function k(){V&&(V.state=avp.SHADOWMAP_NEEDS_UPDATE)}function l(){this.highResTimeStamp=-1,this.screenDrawn=Fa.NOTHING_DRAWN,this.screenHasChanged=!1,this.frameBudget=0,this.frameRemaining=0,this.phase=avp.RENDER_NORMAL,this.useStencil=!1,this.signalProgressByRendering=!1,this.tickCount=0,this.beginFrameAvg=0,this.lastBeginFrameTimeStamp=0,this.RENDERMODE_FULL=0,this.RENDERMODE_PROGRESSIVE=1,this.RENDERMODE_SILENT=2,this.renderType=this.RENDERMODE_FULL,this.INITIAL_GROUND_SHADOW=.2,this.cmdListActive=!1,this.cmdIndex=0,this.continueExecution=!0,this.encounteredAlwaysDo=!1,this.finishedFullRender=!0,this.groundShadowInPost=!1,this.drawOverlay=!1,this.cmdIsOpen=!1,this.allocArraySize=0,this.cmdListLength=0,this.cmdList=[],this.paramList=[],this.CMD_NORMAL_SEQUENCE=0,this.CMD_DO_AFTER=1,this.CMD_ALWAYS_DO=2,this.isActive=function(){return this.cmdListActive},this.setFrame=function(a){this.frameBudget=a},this.beginCommandSet=function(){this.cmdListActive=!0,this.cmdIndex=0,this.cmdListLength=0,this.encounteredAlwaysDo=!1,this.tickCount=0,this.screenDrawn=Fa.NOTHING_DRAWN,this.screenHasChanged=!1},this.endCommandSet=function(){this.cmdIsOpen&&(this.cmdIsOpen=!1,this.cmdListLength++)},this._internalSetParam=function(a,b){this.paramList[this.cmdIndex][a]=b},this.addCommand=function(a,b){for(this.cmdIsOpen&&this.cmdListLength++,this.cmdIsOpen=!0;this.allocArraySize<=this.cmdListLength;)this.cmdList[this.cmdListLength]={},this.paramList[this.cmdListLength]={},this.allocArraySize++;return this.cmdList[this.cmdListLength]=a,this.paramList[this.cmdListLength].executionLevel=b||this.CMD_NORMAL_SEQUENCE,this.encounteredAlwaysDo=this.encounteredAlwaysDo||b===this.CMD_ALWAYS_DO,this.cmdListLength},this.setParam=function(a,b){this.cmdIsOpen?this.paramList[this.cmdListLength][a]=b:ENABLE_DEBUG&&avp.logger.error("ERROR: cannot set param when no command is open!")},this.getParam=function(a){return ENABLE_DEBUG&&void 0===this.paramList[this.cmdIndex][a]&&avp.logger.error("ERROR: parameter "+a+" was never set for this command! Go fix it."),this.paramList[this.cmdIndex][a]},this.executeCommandList=function(){if($.cmdListActive){this.frameRemaining=this.frameBudget,ENABLE_DEBUG&&this.cmdIsOpen&&avp.logger.error("ERROR: should call endCommandSet before executing"),this.continueExecution=!0;var a;if(ENABLE_DEBUG&&(0===this.tickCount&&console.log("==================="),console.log("Running commands for "+($.renderType===$.RENDERMODE_PROGRESSIVE?"progressive":$.renderType===$.RENDERMODE_FULL?"full":"silent")+" render, for tick count "+this.tickCount)),this.encounteredAlwaysDo)for(var b=0;b<this.cmdIndex;)this.paramList[b].executionLevel>=$.CMD_ALWAYS_DO&&(ENABLE_DEBUG&&console.log("  ALWAYS DO command "+b+": "+this.cmdList[b].name),this.cmdList[b]()),
b++;for(;this.cmdIndex<this.cmdListLength;)(this.continueExecution||this.paramList[this.cmdIndex].executionLevel>=$.CMD_DO_AFTER)&&(ENABLE_DEBUG&&console.log("  command "+this.cmdIndex+": "+this.cmdList[this.cmdIndex].name+" and "+$.frameRemaining+" frame budget remaining"),this.cmdList[this.cmdIndex]()&&(ENABLE_DEBUG&&console.log("  >>> out of tick time with "+$.frameRemaining),a=this.cmdIndex,this.continueExecution=!1)),this.cmdIndex++;return this.continueExecution?this.cmdListActive=!1:this.cmdIndex=a,this.tickCount++,!this.continueExecution}return!0}}function m(){if($.renderType===$.RENDERMODE_PROGRESSIVE)if($.getParam("GenerateGroundShadow.afterBeauty")){if($.frameRemaining=X.prepareGroundShadow(ba.modelQueue(),0,$.frameRemaining),X.getStatus()==avp.GROUND_RENDERED){if($.getParam("GenerateGroundShadow.signalRedraw"))return ba.requestSilentRender(),ENABLE_DEBUG&&console.log(" $$$$ SIGNAL FULL GROUND SHADOW REDRAW"),!0;$.groundShadowInPost=!0}}else 0===$.tickCount&&X.prepareGroundShadow(ba.modelQueue(),10);else $.frameRemaining=X.prepareGroundShadow(ba.modelQueue(),0,$.frameRemaining);return $.frameRemaining<0&&X.getStatus()===avp.GROUND_UNFINISHED}function n(){return X.getStatus()!==avp.GROUND_UNFINISHED&&ba.renderGroundShadow(),!1}function o(){return $.renderType===$.RENDERMODE_PROGRESSIVE?$.getParam("GenerateGroundReflection.afterBeauty")?($.frameRemaining=Y.prepareGroundReflection(X,ba,!1,0,$.frameRemaining),Y.getStatus()==avp.GROUND_RENDERED&&($.screenDrawn|=Fa.REFLECTION_DRAWN,$.groundShadowInPost&&S.hasTransparentMaterial()&&ba.requestDeferredSilentRender())):0===$.tickCount&&Y.prepareGroundReflection(X,ba,!0,10):$.frameRemaining=Y.prepareGroundReflection(X,ba,!1,0,$.frameRemaining),$.frameRemaining<0&&Y.getStatus()===avp.GROUND_UNFINISHED}function p(){if(V.state===avp.SHADOWMAP_NEEDS_UPDATE)$.frameRemaining=V.startUpdate(Z,$.frameRemaining,ba.camera,ja,S);else if(V.state==avp.SHADOWMAP_INCOMPLETE&&($.frameRemaining=V.continueUpdate(Z,$.frameRemaining,S),V.state==avp.SHADOWMAP_VALID))return ba.requestSilentRender(),ENABLE_DEBUG&&console.log(" $$$$ SIGNAL FULL SHADOW MAP REDRAW"),!0;return $.frameRemaining<0&&V.state!==avp.SHADOWMAP_VALID}function q(){V.state=avp.SHADOWMAP_NEEDS_UPDATE}function r(){if($.signalProgressByRendering&&ba.signalProgress(0,av.ProgressState.RENDERING),$.renderType===$.RENDERMODE_PROGRESSIVE){if($.lastBeginFrameTimeStamp>0){var a=$.highResTimeStamp-$.lastBeginFrameTimeStamp;$.beginFrameAvg=.75*$.beginFrameAvg+.25*a}$.lastBeginFrameTimeStamp=$.highResTimeStamp,$.beginFrameAvg<da&&$.frameBudget<ca?(ba.targetFrameBudget+=1,ba.targetFrameBudget>ca&&(ba.targetFrameBudget=ca)):$.beginFrameAvg>da&&$.frameBudget>ea&&(ba.targetFrameBudget-=1,ba.targetFrameBudget<ea&&(ba.targetFrameBudget=ea))}ba.updateCameraMatrices();var b=$.getParam("BeginScene.clear");return U.beginScene(ba.scene,ba.camera,ba.lightsOn?ba.lights:ba.no_lights,b),ba.toggleHighlightsLights(!0),b&&($.screenDrawn|=Fa.BACKGROUND_DRAWN),$.getParam("BeginScene.signalCameraChanged")&&ba.api.dispatchEvent(ba.cameraChangedEvent),!1}function s(){return $.phase=$.getParam("BeginPhase.phase"),$.useStencil=$.getParam("BeginPhase.useStencil"),$.useStencil||U.setStencilEnabled(!1),ENABLE_DEBUG&&console.log("     render phase is now "+$.phase),Z.reset(ba.camera,$.phase,$.getParam("BeginPhase.moved"),$.phase==avp.RENDER_HIGHLIGHTED1||$.phase==avp.RENDER_HIGHLIGHTED2),!1}function t(){return Z.isEmpty()||Z.isDone()||($.useStencil&&U.setStencilEnabled($.phase<=avp.RENDER_HIGHLIGHTED2),$.screenDrawn|=Fa.MODEL_DRAWN,$.frameRemaining=Z.renderSome(d,$.frameRemaining,Da),$.signalProgressByRendering&&(ba.signalProgress(100*Z.getRenderProgress(),av.ProgressState.RENDERING),ENABLE_DEBUG&&console.log("  %%% percent done "+100*Z.getRenderProgress())),$.useStencil&&U.setStencilEnabled(!1)),!Z.isDone()}function u(){return $.phase=avp.RENDER_FINISHED,U.renderScenePart(ba.sceneAfter,!0,!0,!0,0),ba.renderAfters.render(),!1}function v(){return $.phase=avp.RENDER_FINISHED,!1}function w(){ba.signalProgress(100,av.ProgressState.RENDERING)}function x(){return ba.isOverlayDirty()&&(ba.clearOverlayDirtyFlag(),$.drawOverlay=!0),$.drawOverlay&&(!Z.isEmpty()&&Z.isDone()||ba.showOverlaysWhileMoving?(ba.renderOverlays(),$.screenDrawn|=Fa.OVERLAY_DRAWN):(U.clearAllOverlays(),$.drawOverlay=!1)),!1}function y(){$.screenDrawn|=Fa.ALL_DRAWN}function z(){if($.screenDrawn&&($.phase===avp.RENDER_FINISHED||$.tickCount%ba.frameDisplayRate==0)){var a=!$.getParam("PostAndPresent.performAO")||($.screenDrawn&(Fa.BACKGROUND_DRAWN|Fa.MODEL_DRAWN))==Fa.BACKGROUND_DRAWN;U.composeFinalFrame(a),$.screenHasChanged=!0,$.screenDrawn=Fa.NOTHING_DRAWN,e($.highResTimeStamp),ba.api.dispatchEvent({type:av.RENDER_PRESENTED_EVENT})}return!1}function A(){return ENABLE_DEBUG&&!1===U.getAOEnabled()&&avp.logger.error("AO should be on at this point!"),U.setAOEnabled(!1),!1}function B(){return ENABLE_DEBUG&&!0===U.getAOEnabled()&&avp.logger.error("AO should be off at this point!"),U.setAOEnabled(!0),!1}function C(){return ba.requestSilentRender(),!1}function D(){return $.finishedFullRender=!0,!1}function E(a){$.highResTimeStamp=a=a||0;var b=S.updateMaterials();ba.invalidate(b.needsClear,b.needsRender,b.overlayDirty);var c=f(a),d=ba.controls.update(a),e=Z&&Z.update(a),h=d||c||W||e;Da.moved=h,W=!1;var k=P;g(),la=la||h,na=na||h,oa=oa||h;var l=!1;na?j(a):U.overlayUpdate()&&!na&&(na=l=!0),$.signalProgressByRendering=ba.model&&(ba.model.isLoadDone()||!0===ba.model.getData().partPacksLoadDone)&&!ba.model.getData().isLeaflet,i()&&(la=!0);var E=la,F=Z.frameResumePossible();if(la=la||!F,sa=sa||ra&&!$.cmdListActive,oa&&$.cmdListActive&&(la=!0),la||ma||na||oa||sa)if($.drawOverlay=na,la||ma||sa){var G,H=E?WGS.RESET_RELOAD:la?WGS.RESET_REDRAW:WGS.RESET_NORMAL;la||ma?ba.progressiveRender?($.renderType=$.RENDERMODE_PROGRESSIVE,G=ba.targetFrameBudget):($.renderType=$.RENDERMODE_FULL,G=ba.interruptBudget):($.renderType=$.RENDERMODE_SILENT,G=ba.targetFrameBudget,la=!0,H=WGS.RESET_REDRAW),ra=sa=!1,$.setFrame(G),$.finishedFullRender=!1,$.beginCommandSet();var I=X.enabled&&!ba.is2d&&!xa,J=!!Y&&!ba.is2d&&!xa,K=h||k,L=h&&ba.skipAOWhenMoving&&U.getAOEnabled();$.addCommand(r),$.setParam("BeginScene.signalCameraChanged",K),$.setParam("BeginScene.clear",la),L&&$.addCommand(A,$.CMD_ALWAYS_DO);var M=!1;Z&&(V&&V.state!==avp.SHADOWMAP_VALID&&$.addCommand(p),I&&($.addCommand(m),$.setParam("GenerateGroundShadow.afterBeauty",!1),$.setParam("GenerateGroundShadow.signalRedraw",!1)),J?(Y.setDirty(),$.addCommand(o),$.setParam("GenerateGroundReflection.afterBeauty",!1)):I&&$.addCommand(n),M=Z.hasHighlighted(),M&&($.addCommand(s),$.setParam("BeginPhase.phase",avp.RENDER_HIGHLIGHTED1),$.setParam("BeginPhase.moved",H),$.setParam("BeginPhase.useStencil",M),H=!1,$.addCommand(t)),$.addCommand(s),$.setParam("BeginPhase.phase",avp.RENDER_NORMAL),$.setParam("BeginPhase.moved",H),$.setParam("BeginPhase.useStencil",M),H=!1,$.addCommand(t),!Z.areAllVisible()&&ba.showGhosting?(J&&$.renderType===$.RENDERMODE_PROGRESSIVE||($.addCommand(s),$.setParam("BeginPhase.phase",avp.RENDER_HIDDEN),$.setParam("BeginPhase.moved",H),$.setParam("BeginPhase.useStencil",M),$.addCommand(t)),$.addCommand(v)):$.addCommand(u),$.signalProgressByRendering&&$.addCommand(w)),$.addCommand(x,$.renderType===$.RENDERMODE_PROGRESSIVE?$.CMD_DO_AFTER:$.CMD_NORMAL_SEQUENCE),$.addCommand(z,$.renderType===$.RENDERMODE_PROGRESSIVE?$.CMD_DO_AFTER:$.CMD_NORMAL_SEQUENCE),$.setParam("PostAndPresent.performAO",U.getAOEnabled()&&!L),$.renderType===$.RENDERMODE_PROGRESSIVE&&Z&&(V&&V.state!==avp.SHADOWMAP_VALID&&($.addCommand(q),$.addCommand(p)),I&&($.addCommand(m),$.setParam("GenerateGroundShadow.afterBeauty",!0),$.setParam("GenerateGroundShadow.signalRedraw",!J),$.signalProgressByRendering&&$.addCommand(w)),J&&($.groundShadowInPost=!1,$.addCommand(o),$.setParam("GenerateGroundReflection.afterBeauty",!0),!Z.areAllVisible()&&ba.showGhosting&&($.addCommand(s),$.setParam("BeginPhase.phase",avp.RENDER_HIDDEN),$.setParam("BeginPhase.moved",H),$.setParam("BeginPhase.useStencil",M),$.addCommand(t)),$.addCommand(v),$.addCommand(z),$.setParam("PostAndPresent.performAO",U.getAOEnabled()&&!L),$.signalProgressByRendering&&$.addCommand(w))),L&&($.addCommand(B,$.CMD_ALWAYS_DO),$.addCommand(C)),$.addCommand(D),$.endCommandSet(),la=!1,ma=!1,na=!1,oa=!1}else $.finishedFullRender&&($.beginCommandSet(),ENABLE_DEBUG&&console.log("=====\nOVERLAY DIRTY"),oa&&($.addCommand(U.clearHighlight.bind(U)),Z.hasHighlighted()&&($.addCommand(s),$.setParam("BeginPhase.phase",avp.RENDER_HIGHLIGHTED2),$.setParam("BeginPhase.moved",WGS.RESET_REDRAW),$.setParam("BeginPhase.useStencil",!0),$.addCommand(t))),l?$.addCommand(y):$.addCommand(x,!0),$.addCommand(z,!0),$.setParam("PostAndPresent.performAO",U.getAOEnabled()),$.endCommandSet(),na=!1,oa=!1);aa=$.cmdListActive,$.executeCommandList(),aa!==Ea&&(ba.api.dispatchEvent({type:av.FINAL_FRAME_RENDERED_CHANGED_EVENT,value:{finalFrame:!aa}}),Ea=aa),ua=$.highResTimeStamp}function F(){for(var a in ba.selectionMeshes){var b=ba.selectionMeshes[a];b.model&&b.model.isConsolidated()&&b.model.updateRenderProxy(b,b.fragId)}}function G(a){function b(){if(c.animations){ba.keyFrameAnimator=new avp.KeyFrameAnimator(ba,c.animations.duration);for(var a in c.animations.animations)ba.keyFrameAnimator.add(c.animations.animations[a]);ba.keyFrameAnimator.goto(0),ba.api.dispatchEvent({type:av.ANIMATION_READY_EVENT})}ba.api.removeEventListener(av.OBJECT_TREE_CREATED_EVENT,b)}var c=a.getData();a.isObjectTreeCreated()?b():ba.api.addEventListener(av.OBJECT_TREE_CREATED_EVENT,b)}function H(){if(!av.isMobileDevice()){var a=Z.getModels().length;U.setIdTargetCount(a)&&S.toggleMRTSetting(U.mrtFlags())}}function I(a,b){Ja=Ja||new THREE.Box3,b.updateMatrixWorld(!0),b.traverse(function(b){var c=b.geometry;void 0!==c&&c.visible&&(c.boundingBox||c.computeBoundingBox(),Ja.copy(c.boundingBox),Ja.applyMatrix4(b.matrixWorld),a.union(Ja))})}function J(){var a=new THREE.Box3,b=ba.overlayScenes;for(var c in b)b.hasOwnProperty(c)&&I(a,b[c].scene);return I(a,ba.scene),a}function K(a){var b,c,d;if(-1==a.indexOf(";base64,"))return b=a.split(","),c=b[0].split(":")[1],d=decodeURIComponent(b[1]),new Blob([d],{type:c});b=a.split(";base64,"),c=b[0].split(":")[1],d=window.atob(b[1]);for(var e=d.length,f=new Uint8Array(e),g=0;g<e;++g)f[g]=d.charCodeAt(g);return new Blob([f],{type:c})}function L(a,b,c,d){var e=a.getFragmentList().getVizmesh(b);new avp.VertexBufferReader(e.geometry).enumGeomsForVisibleLayer(c,d)}function M(a,b,c,d){var e=a.getFragmentList().getVizmesh(b);new avp.VertexBufferReader(e.geometry).enumGeomsForObject(c,d)}var N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba=this,ca=1e3/15,da=1e3/30,ea=1e3/120,fa=-1,ga=-1,ha="y",ia=null,ja=null,ka=null,la=!1,ma=!1,na=!1,oa=!1,pa={type:Autodesk.Viewing.PROGRESS_UPDATE_EVENT,state:Autodesk.Viewing.ProgressState.LOADING,percent:0},qa=!1,ra=!1,sa=!1,ta=0,ua=0,va=1e3/60,wa=0,xa=!0,ya=!1,za=!1,Aa=null,Ba=null,Ca=av.getGlobal(),Da={visibleIdCB:function(){return U?U.copyOcclusionIds():null},occlusionTestCB:function(a,b,c,d,e){return U?U.occlusionTest(a,b,c,d,e):Promise.resolve(!0)}},Ea=!0;a&&setInterval(function(){xa||wa<60||ba.track({name:"fps",value:Number(ba.fps().toFixed(2)),aggregate:"last"})},3e4),this.api=b,this.canvas=a,this.loader=null,this.canvasBoundingclientRectDirty=!0,this.initialize=function(){if(N=new THREE.Vector3(0,1,0),Z=new avp.RenderScene,(T=c(a))||av.isNodeJS){U=new avp.RenderContext,U.init(T,a?a.clientWidth:0,a?a.clientHeight:0),this.use2dInstancing=av.isMobileDevice()&&this.glrenderer().supportsInstancedArrays(),S=new avp.createMaterialManager(T),avp.init_UnifiedCamera(THREE),this.camera=new av.UnifiedCamera(a?a.clientWidth:512,a?a.clientHeight:512),this.lightsOn=!1,this.lights=[],this.highlight_lights=[],this.no_lights=[],Aa=(new THREE.Color).setRGB(1,1,1),Ba=(new THREE.Color).setRGB(1,1,1),this.cameraChangedEvent={type:av.CAMERA_CHANGE_EVENT,camera:this.camera},ia=new THREE.Vector3(1,1,1),ja=(new THREE.Vector3).copy(ia),ka=new THREE.Vector3(-1,0,1),this.scene=new THREE.Scene,this.sceneAfter=new THREE.Scene,this.sceneAfter.sortObjects=!1,this.renderAfters=new avp.RenderCallbacks,this.overlayScenes={},this.selectionMaterial2d=null,Ia(),this.createOverlayScene("selection_points",null,null),this.selectionMeshes={},this.fadeMaterial=new THREE.MeshPhongMaterial({color:16777215,opacity:.1,reflectivity:0,transparent:!0,depthWrite:!1}),this.fadeMaterial.packedNormals=!0,S.addInstancingSupport(this.fadeMaterial),S.addMaterial("__fadeMaterial__",this.fadeMaterial,!0),this.setSelectionColor(6724095),this.progressiveRender=!0,this.swapBlackAndWhite=!1,this.targetFrameBudget=da,this.frameDisplayRate=5,av.isMobileDevice()&&(ca*=2,ea/=2,da*=2,this.targetFrameBudget/=2,this.frameDisplayRate/=2),this.interruptBudget=1e10,this.controls={update:function(a){this.camera.lookAt(this.camera.target),this.camera.updateProjectionMatrix(),this.camera.dirty=!1},handleResize:function(){},recordHomeView:function(){},uninitialize:function(){},isToolActivated:function(){return!1}},this.selector=new avp.MultiModelSelector(this),this.visibilityManager=new avp.MultiModelVisibilityManager(this),this.showGhosting=!0,this.showOverlaysWhileMoving=!0,this.skipAOWhenMoving=!1,this.keyFrameAnimator=null,this.zoomBoundsChanged=!0;var b=avp.LightPresets[avp.DefaultLightPreset].bgColorGradient;this.setClearColors(b[0],b[1],b[2],b[3],b[4],b[5]),X=new av.Shaders.GroundShadow(T),X.enabled=!0,$=new l,S.addMaterialNonHDR("groundShadowDepthMaterial",X.getDepthMaterial()),S.addOverrideMaterial("normalsMaterial",U.getDepthMaterial()),S.addOverrideMaterial("edgeMaterial",U.getEdgeMaterial()),U.beginScene(this.scene,this.camera,this.noLights,!0),U.composeFinalFrame(!0,av.isIE11),this._loaderDelegate={eventTarget:this.api,workerScript:avp.workerScript,webGLRenderer:this.glrenderer(),matman:this.matman(),renderScene:this.modelQueue(),model:av.Model,getGeomCache:function(){return ba.geomCache||(ba.geomCache=new WGS.OtgGeomCache(this,function(){return ba.camera}))},initLoadContext:avp.initLoadContext,requestRedraw:function(a){ba.invalidate(a,!0)},reportError:function(a,b){avp.logger.error(b,av.errorCodeString(a))},signalProgress:function(a){ba.signalProgress(a,av.ProgressState.LOADING)},loadPropertyDb:function(a,b){var c=b.getData();c.propDbLoader=new WGS.PropDbLoader(a,b,b.loader.delegate),c.propDbLoader.load()},loadModelTextures:function(a){WGS.TextureLoader.loadModelTextures(a.loader.delegate,a)},toggleTwoSided:function(a){U.toggleTwoSided(a)},viewer3DImpl:this},this._loaderDelegate.eventTarget.addEventListener(WGS.FILE_LOAD_STARTED,function(a){ba._addLoadingFile(a.loader)},!1),this._loaderDelegate.eventTarget.addEventListener(WGS.GEOMETRY_DOWNLOAD_COMPLETE,function(a){a.memoryLimited?ba.onDemandLoadComplete(a.model):ba.onLoadComplete(a.model)},!1),_=function(){var a=!!Z.getMemoryInfo();S.toggleDepthWriteTransparent(!a),U.setMemoryLimited(a),a&&(this.toggleGroundReflection(!1),this.toggleGroundShadow(!1))}.bind(this),this.api.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,_),this.api.addEventListener(av.MODEL_UNLOADED_EVENT,_)}},this.renderGroundShadow=function(a){V?V.state==avp.SHADOWMAP_VALID&&V.renderGroundShadow(ba.camera,a||U.getColorTarget()):(X.renderShadow(ba.camera,a||U.getColorTarget()),X.rendered=!0)};var Fa={NOTHING_DRAWN:0,MODEL_DRAWN:1,BACKGROUND_DRAWN:2,OVERLAY_DRAWN:4,REFLECTION_DRAWN:8,ALL_DRAWN:15};this.setLmvDisplay=function(a){Ca=a},this.run=function(){O=0,setTimeout(function(){!function a(b){O=Ca.requestAnimationFrame(a),E(b)}()},1)},this.toggleProgressive=function(a){this.progressiveRender=a,la=!0},this.toggleVizBuffer=function(a){var b=this.glrenderer();b&&this.isvizCacheEnabled!==a&&(this.isvizCacheEnabled=a,this.model&&b&&(this.model.isvizCacheEnabled=a,this.model.readbackTargetIdCallback=this.renderer().readbackTargetId,b.setIdBufferSource(a?WGS.FRAGMENT_ID:WGS.DB_ID)),la=!0)},this.toggleSwapBlackAndWhite=function(a){this.swapBlackAndWhite=a,U.toggleSwapBlackAndWhite(a),la=!0},this.toggleGhosting=function(a){this.showGhosting=a,la=!0},this.toggleOverlaysWhileMoving=function(a){this.showOverlaysWhileMoving=a},this.togglePostProcess=function(a,b){U.initPostPipeline(a,b),this.fireRenderOptionChanged(),la=!0},this.preloadPostProcessStyle=function(a){U.preloadPostProcessStyle(a)},this.setPostProcessParameter=function(a,b){U.setPostProcessParameter(a,b),this.fireRenderOptionChanged(),this.invalidate(!0)},this.toggleGroundShadow=function(a){X.enabled!==a&&(X.enabled=a,X.clear(),a&&X.setDirty(),h(),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.setGroundShadowColor=function(a){X.enabled&&(X.setColor(a),this.invalidate(!0,!1,!1))},this.setGroundShadowAlpha=function(a){X.enabled&&(X.setAlpha(a),this.invalidate(!0,!1,!1))},this.toggleGroundReflection=function(a){a&&Y||!a&&!Y||(a?(Y=new av.Shaders.GroundReflection(T,this.canvas.clientWidth,this.canvas.clientHeight,{clearPass:U.getClearPass()}),Y.setClearColors(this.clearColorTop,this.clearColorBottom,av.isAndroidDevice()||av.isIOSDevice()),Y.toggleEnvMapBackground(ya),Y.setEnvRotation(U.getEnvRotation()),h()):(Y.cleanup(),Y=void 0),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.setGroundReflectionColor=function(a){Y&&(Y.setColor(a),this.invalidate(!0,!1,!1))},this.setGroundReflectionAlpha=function(a){Y&&(Y.setAlpha(a),this.invalidate(!0,!1,!1))},this.toggleEnvMapBackground=function(a){ya=a,U.toggleEnvMapBackground(a),Y&&Y.toggleEnvMapBackground(a),this.invalidate(!0,!0,!1)},this.isEnvMapBackground=function(){return ya},this.setOptimizeNavigation=function(a){this.skipAOWhenMoving=a},this.renderOverlays=function(){F();var a=this.lightsOn;a||this.toggleLights(!0,!0);var b;this.dir_light1&&(b=this.dir_light1.intensity,this.dir_light1.intensity=1),U.renderOverlays(this.overlayScenes,this.lightsOn?this.lights:this.no_lights),a||this.toggleLights(!1,!0),this.dir_light1&&(this.dir_light1.intensity=b)},this.setLayerVisible=function(a,b){this.layers.setLayerVisible(a,b)},this.isLayerVisible=function(a){return this.layers.isLayerVisible(a)},this.getVisibleLayerIndices=function(){return this.layers.getVisibleLayerIndices()},this.updateCameraMatrices=function(){function a(){b=new THREE.Matrix4,c=new THREE.Matrix4,d=new THREE.Box3}var b,c,d;return function(){d||a();var e=this.camera;if(b.compose(e.position,e.quaternion,e.scale),c.getInverse(b),e.worldup&&this.setWorldUp(e.worldup),this.model){var f=this.getVisibleBounds(!0,na);if(d.copy(f),Y){var g=new THREE.Vector3;g.multiplyVectors(d.max,e.worldup);var h=new THREE.Vector3;h.multiplyVectors(d.min,e.worldup),g.sub(h),g.x>=0?d.min.x-=g.x:d.max.x-=g.x,g.y>=0?d.min.y-=g.y:d.max.y-=g.y,g.z>=0?d.min.z-=g.z:d.max.z-=g.z}V&&V.groundShapeBox&&d.union(V.groundShapeBox),d.applyMatrix4(c);var i=1e-5*(d.max.z-d.min.z),j=.5*(d.max.y-d.min.y),k=-(d.max.z+i)-j,l=-(d.min.z-i)+j;e.isPerspective&&(k=Math.max(k,Math.min(1,1e-4*Math.abs(l-k))),l<0&&(l=1e-4),k=Math.max(k,1e-5*l)),l=Math.max(l,k),e.near=k,e.far=l,e.updateProjectionMatrix(),e.updateMatrixWorld();var m,n;if(this.model.is2d()){var o=this.intersectGroundViewport(new THREE.Vector3(0,0,1));m=o?e.position.distanceTo(o):e.position.distanceTo(f.center()),n=U.settings.deviceHeight/(2*m*Math.tan(THREE.Math.degToRad(.5*e.fov))),S.updatePixelScale(n),S.updateSwapBlackAndWhite(this.swapBlackAndWhite)}else{var p,q=S.getCutPlanesRaw();if(q&&q.length){var r=q[0],s=e.target.clone().sub(e.position).normalize(),t=s.dot(r);if(0===t)p=f.center();else{var u=-(e.position.clone().dot(r)+r.w)/t;p=f.clampPoint(s.multiplyScalar(u).add(e.position))}}else p=f.center();m=e.position.distanceTo(p),n=U.settings.deviceHeight/(2*m*Math.tan(THREE.Math.degToRad(.5*e.fov))),S.updatePixelScale(n)}}}}(),this.initLights=function(){this.dir_light1=new THREE.DirectionalLight(Aa,1),this.dir_light1.position.copy(ka),this.highlight_dir_light1=new THREE.DirectionalLight(Aa,1),this.highlight_dir_light1.intensity=1,this.highlight_dir_light1.position.copy(ka),this.amb_light=new THREE.AmbientLight(Ba),this.highlight_amb_light=new THREE.AmbientLight(Ba),this.lights=[this.dir_light1,this.amb_light],this.highlight_lights=[this.highlight_dir_light1,this.highlight_amb_light],this.camera.add(this.dir_light1),this.camera.add(this.dir_light1.target),this.camera.add(this.highlight_dir_light1),this.camera.add(this.highlight_dir_light1.target),za=!0};var Ga=function(a,b,c,d){var e=avp.LightPresets[fa],f=e.ambientColor,g=e.directLightColor;f=f||Ba.toArray(),g=g||Aa.toArray(),c?(d&&a?a.color.setRGB(.5*g[0],.5*g[1],.5*g[2]):a&&a.color.setRGB(f[0],f[1],f[2]),b&&b.color.setRGB(g[0],g[1],g[2])):a&&d&&a.color.setRGB(f[0],f[1],f[2])};this.toggleHighlightsLights=function(a){this.highlight_amb_light&&(this.highlightsOn=a,Ga(this.highlight_amb_light,this.highlight_dir_light1,a,!0),U.setHighlightLights(a?this.highlight_lights:this.no_lights))},this.toggleLights=function(a,b){this.amb_light&&(this.lightsOn=a,Ga(this.amb_light,this.dir_light1,a,b))},this.syncCamera=function(a){this.camera.updateProjectionMatrix(),a&&this.setWorldUp(this.api.navigation.getWorldUpVector()),W=!0},this.setViewFromFile=function(a,b){if(a){var c,d=a.getDefaultCamera();if(d)c=d;else{c={};var e=a.getBoundingBox(),f=e.size();if(c.target=e.center(),a.is2d()){c.isPerspective=!1;var g=f.x/f.y,h=this.camera.aspect;c.orthoScale=h>g?f.y:f.x/h,c.up=new THREE.Vector3(0,0,1),c.position=c.target.clone(),c.position.z+=c.orthoScale,c.target.y+=1e-6*f.y}else c.isPerspective=!0,c.fov=this.camera.fov,c.up=this.camera.up.clone(),c.position=c.target.clone(),c.position.z+=1.5*Math.max(f.x,f.y,f.z)}this.setViewFromCamera(c,b)}},this.adjustOrthoCamera=function(a){if(!a.isPerspective&&this.model){var b=this.model.getBoundingBox(),c=b.size(),d=a.target.clone().sub(a.position),e=d.length();if(e>1e3*c.length()){var f=a.position.distanceTo(b.center());a.target.copy(a.position).add(d.normalize().multiplyScalar(f))}else if(Math.abs(e-a.orthoScale)/e>1e-5){avp.logger.warn("Ortho scale does not match eye-target distance. One of them is likely wrong, but which one?");var g=0===a.fov&&1===a.orthoScale,h=!g;h&&a.position.copy(a.target).add(d.normalize().multiplyScalar(-a.orthoScale))}}},this.setViewFromCamera=function(a,b){this.adjustOrthoCamera(a);var c,d=this.model.getMetadata("navigation hint","value",null),e=this.controls.isToolActivated("freeorbit")||b&&"Freeorbit"===d,f=this.model?this.model.getUpVector():null;c=f?(new THREE.Vector3).fromArray(f):e?a.up.clone():av.Navigation.snapToAxis(a.up.clone()),e?this.api.prefs&&this.api.prefs.set("fusionOrbitConstrained",c.equals(a.up)):a.up=c;var g=this.api.navigation;if(g){var h=this.camera;if(b)h.up.copy(a.up),h.position.copy(a.position),h.target.copy(a.target),a.isPerspective?h.fov=a.fov:(h.saveFov=a.fov,h.fov=av.UnifiedCamera.ORTHO_FOV),h.isPerspective=a.isPerspective,h.orthoScale=a.orthoScale,h.dirty=!0,g.setWorldUpVector(e?c:h.up),g.setView(h.position,h.target),g.setPivotPoint(h.target),this.syncCamera(!0);else if(h.isPerspective=a.isPerspective,a.isPerspective||(h.saveFov=a.fov,a.fov=av.UnifiedCamera.ORTHO_FOV),e)g.setRequestTransitionWithUp(!0,a.position,a.target,a.fov,a.up,c);else{var i=this.model.getData().bbox;i.containsPoint(a.target)||a.target.copy(i.center());var j=g.computeOrthogonalUp(a.position,a.target);g.setRequestTransitionWithUp(!0,a.position,a.target,a.fov,j,c)}}W=!0},this.setViewFromViewBox=function(a,b,c,d){if(a.is2d()){var e={},f=a.getBoundingBox(),g={width:b[2]-b[0],height:b[3]-b[1]};g.aspect=g.width/g.height,g.centerX=b[0]+g.width/2,g.centerY=b[1]+g.height/2;var h=this.camera.aspect;h>g.aspect?e.orthoScale=g.height:e.orthoScale=g.width/h,e.isPerspective=!1,e.position=new THREE.Vector3(g.centerX,g.centerY,f.center().z+e.orthoScale),e.target=new THREE.Vector3(g.centerX,g.centerY,f.center().z),e.target.y+=1e-6*g.height,e.up=new THREE.Vector3(0,0,1),this.setViewFromCamera(e,d)}},this.setWorldUp=function(a){if(!N.equals(a)){N.copy(a);var b=Math.abs(a.x);ha="x",Math.abs(a.y)>b&&(ha="y",b=Math.abs(a.y)),Math.abs(a.z)>b&&(ha="z");var c=new THREE.Vector3(0,1,0);ba.camera.worldUpTransform=function(a,b){var c=(new THREE.Vector3).crossVectors(b,a).normalize(),d=Math.acos(a.dot(b));return(new THREE.Matrix4).makeRotationAxis(c,d)}(c,a),this.sceneUpdated(!1)}},this.addModel=function(a){if(a){var b=!!this.model,c=a.is2d();if(this.model||(this.model=a,c||this.toggleVizBuffer(this.isvizCacheEnabled),U.setUnitScale(a.getUnitScale())),this.layers||(this.layers=new avp.ModelLayers(this)),this.layers.initialized||this.layers.addModel(a),Z.addModel(a),this.selector.addModel(a),this.visibilityManager.addModel(a),c){var d=a.getData();S.initLayersTexture(d.layerCount,d.layersMap);var e=S.create2DMaterial(null,{useInstancing:this.use2dInstancing},!0,!1,function(){ba.invalidate(!1,!0,!1)}),f=S.findMaterial(null,e);if(U.enter2DMode(f),!b){this.is2d=!0,ga=fa,this.setLightPreset(avp.DefaultLightPreset2d);var g=a.getData();if(g.hidePaper){var h=g.bgColor,i=h>>16&255,j=h>>8&255,k=255&h;this.setClearColors(i,j,k,i,j,k)}}}if(this.api.navigation){this.api.navigation.setIs2D(c&&!b),this.api.setActiveNavigationTool();var l=a.getData();l.isLeaflet?this.api.navigation.setConstraints2D(l.bbox,l.maxPixelPerUnit):this.api.navigation.setConstraints2D()}b||a.getData().loadOptions.preserveView||(this.setViewFromFile(a,!0),this.controls.recordHomeView()),this.setupLighting(a),H(),this.fireRenderOptionChanged(),this.invalidate(!0)}},this.setupLighting=function(a){(a=a||this.model)&&!a.is2d()&&(this.setLightPresetFromFile(a)||(ga>=0?(this.setLightPreset(ga,!0),ga=-1):this.setLightPreset(fa,!1)),this.setAOHeuristics(a))},this.getSvfMaterialId=function(a){return this.model.getFragmentList().getSvfMaterialId(a)},this.getMaterials=function(){return S},this.setupMesh=function(a,b,c,d){var e={geometry:b,matrix:d,isLine:b.isLines,isWideLine:b.isWideLines,isPoint:b.isPoints,is2d:b.is2d};return e.material=this.matman().setupMaterial(a,b,c),e},this.onDemandLoadComplete=function(a){if(xa=!1,this.signalProgress(100,av.ProgressState.LOADING),(X&&X.enabled||Y)&&this.invalidate(!1,!0),this.is2d){var b=S.initSelectionTexture(a.getData().maxObjectNumber),c=S.create2DMaterial(a,{useInstancing:this.use2dInstancing},!1,b,function(){ba.invalidate(!1,!0,!1)});this.selectionMaterial2d=S.findMaterial(a,c),this.createOverlayScene("selection2d",this.selectionMaterial2d)}a.getData();S.togglePolygonOffset(!0),U.setDepthMaterialOffset(S.getPolygonOffsetOn(),S.getPolygonOffsetFactor(),S.getPolygonOffsetUnits()),S.hasTransparentMaterial()&&this.requestDeferredSilentRender(),G(a),this.api.dispatchEvent({type:av.GEOMETRY_LOADED_EVENT,model:a,onDemandLoad:!0})},this.onLoadComplete=function(a){if(xa=!1,this.signalProgress(100,av.ProgressState.LOADING),(X&&X.enabled||Y)&&this.sceneUpdated(!1),this.is2d){var b=S.initSelectionTexture(a.getData().maxObjectNumber),c=S.create2DMaterial(a,{useInstancing:this.use2dInstancing},!1,b,function(){ba.invalidate(!1,!0,!1)});this.selectionMaterial2d=S.findMaterial(a,c),this.createOverlayScene("selection2d",this.selectionMaterial2d)}a.getData();Z.getGeometryList()&&Z.getGeometryList().printStats(),S.togglePolygonOffset(!0),U.setDepthMaterialOffset(S.getPolygonOffsetOn(),S.getPolygonOffsetFactor(),S.getPolygonOffsetUnits()),a.hasGeometry()?S.hasTransparentMaterial()&&this.requestSilentRender():avp.logger.warn("Loaded model has no geometry."),this.handleInitialVisibility(a),G(a),this.api.dispatchEvent({type:av.GEOMETRY_LOADED_EVENT,model:a})},this.onTextureLoadComplete=function(a){this.api.dispatchEvent({type:av.TEXTURES_LOADED_EVENT,model:a})},this.signalProgress=function(a,b){pa.percent===a&&pa.state===b||(pa.percent=a,pa.state=b,this.api.dispatchEvent(pa))},this.resize=function(a,b){P=!0,Q=a,R=b},this.unloadModel=function(a){(this.removeModel(a)||Z.removeHiddenModel(a))&&(a.dtor(this.glrenderer()),S.cleanup(a),a.loader&&(a.loader.dtor(),a.loader=null),this.api.dispatchEvent({type:av.MODEL_UNLOADED_EVENT,model:a}))},this._addLoadingFile=function(a){this.loaders||(this.loaders=[]),this.loaders.push(a)},this._removeLoadingFile=function(a){if(this.loaders){var b=this.loaders.indexOf(a);b>=0&&this.loaders.splice(b,1)}},this.removeModel=function(a){return!!Z.removeModel(a)&&(this.keyFrameAnimator&&(this.keyFrameAnimator.destroy(),this.keyFrameAnimator=null),this.selector.removeModel(a),this.visibilityManager.removeModel(a),this.layers.removeModel(a),a===this.model&&(this.model=null,Z.isEmpty()||(this.model=Z.getModels()[0])),H(),this.invalidate(!0,!0,!0),!0)},this.unloadCurrentModel=function(){this.is2d&&(this.is2d=void 0,this.selectionMaterial2d=null,this.removeOverlayScene("selection2d"),U.exit2DMode(),fa=ga),U.beginScene(this.scene,this.camera,this.lightsOn?this.lights:this.no_lights,!0),U.composeFinalFrame(!0),this.loaders&&(this.loaders.forEach(function(a){a.dtor()}),this.loaders=[]);for(var a=Z.getModels(),b=a.length-1;b>=0;b--)this.unloadModel(a[b])};var Ha=function(a){var b=[{material:ba.selectionMaterialBase,target:1,renderHidden:!1},{material:ba.selectionMaterialTop,target:0,renderHidden:!0}];if(a){var c=U.getEdgeMaterial();b.splice(1,0,{material:c,target:1,renderHidden:!1}),b.push({material:c,target:0,renderHidden:!0})}U.setSelectionMaterials(b)},Ia=function(){var a=ba.selectionMaterialBase=new THREE.MeshPhongMaterial({specular:526344,ambient:0,opacity:1,transparent:!1});a.packedNormals=!0,a.depthWrite=!0,a.depthTest=!0,a._polygonOffsetOn=!0,a._polygonOffsetFactor=1,a._polygonOffsetUnits=.075,a.side=THREE.DoubleSide;var b=ba.selectionMaterialTop=new THREE.MeshPhongMaterial({specular:526344,ambient:0,opacity:.15,transparent:!0});b.packedNormals=!0,b.depthWrite=!1,b.depthTest=!1,b.side=THREE.DoubleSide,S.addInstancingSupport(a),S.addOverrideMaterial("selectionHighlightBase",a),S.addInstancingSupport(b),S.addOverrideMaterial("selectionHighlightTop",b),Ha(!1)};this.createOverlayScene=function(a,b,c,d){b&&S.addOverrideMaterial(a+"_pre",b),c&&S.addOverrideMaterial(a+"_post",c);var e=new THREE.Scene;e.__lights=this.scene.__lights,this.overlayScenes[a]={scene:e,camera:d,materialPre:b,materialPost:c}},this.removeOverlayScene=function(a){this.overlayScenes[a]&&(delete this.overlayScenes[a],this.invalidate(!1,!1,!0))},this.addOverlay=function(a,b){this.overlayScenes[a].scene.add(b),this.invalidate(!1,!1,!0)},this.addMultipleOverlays=function(a,b){for(var c in b)b.hasOwnProperty(c)&&this.addOverlay(a,b[c])},this.removeOverlay=function(a,b){this.overlayScenes[a]&&(this.overlayScenes[a].scene.remove(b),this.invalidate(!1,!1,!0))},this.removeMultipleOverlays=function(a,b){for(var c in b)b.hasOwnProperty(c)&&this.removeOverlay(a,b[c])},this.clearOverlay=function(a){if(this.overlayScenes[a]){var b,c,d=this.overlayScenes[a].scene;for(c=d.children.length-1;c>=0;--c)(b=d.children[c])&&d.remove(b);this.invalidate(!1,!1,!0)}},this.setClearColors=function(a,b,c,d,e,f){this.clearColorTop=new THREE.Vector3(a/255,b/255,c/255),this.clearColorBottom=new THREE.Vector3(d/255,e/255,f/255),U.setClearColors(this.clearColorTop,this.clearColorBottom),Y&&Y.setClearColors(this.clearColorTop,this.clearColorBottom,av.isAndroidDevice()||av.isIOSDevice()),la=!0,this.fireRenderOptionChanged()};var Ja;this.getVisibleBounds=function(a,b){var c=new THREE.Box3;return Z.isEmpty()||(I(c,this.scene),c=Z.getVisibleBounds(a).union(c),b&&(c=J().union(c))),c},this.getFitBounds=function(a){var b;return a||null===this.selector||(b=this.selector.getSelectionBounds()),b&&!b.empty()||(b=this.getVisibleBounds()),b},this.getRenderProxy=function(a,b){return a.getFragmentList().getVizmesh(b)},this.getLayersRoot=function(){return this.layers.getRoot()},this.promiseRenderProxy=function(a,b){var c=a.getFragmentList().promiseVizmesh(b);return c.lmv_model=a,c},this.cancelPromisedRenderProxy=function(a){return!!a.lmv_model&&a.lmv_model.getFragmentList().cancelPromisedVizmesh(a)},this.getFragmentProxy=function(a,b){return new avp.FragmentPointer(a.getFragmentList(),b)},this.getRenderProxyCount=function(a){return a.getFragmentList().getCount()},this.getRenderProxyDbIds=function(a,b){
return a.getFragmentList().getDbIds(b)},this.isWholeModelVisible=function(a){return!Z||Z.areAllVisible()},this.isNodeVisible=function(a,b){return this.visibilityManager.isNodeVisible(b,a)},this.highlightObjectNode=function(a,b,c){a.is2d()&&(S.highlightObject2D(b,c),this.invalidate(!1,!1,!0));var d=this,e=a.getData().instanceTree||a.getData().fragmentMap;if(e&&!a.is2d())e.enumNodeFragments(b,function(b){d.highlightFragment(a,b,c)},!1);else{var f=b;if(a.is2d()&&(f=a.getData().fragments.dbId2fragId[b]),Array.isArray(f))for(var g=0;g<f.length;g++)d.highlightFragment(a,f[g],c);else d.highlightFragment(a,f,c)}},this.highlightFragment=function(a,b,c){var d=this.getRenderProxy(a,b);if(d){var e=d.is2d||d.isPoint,f=a.id+":"+b;if(e){var g="selection";if(a.is2d()&&(g+="2d"),d.isPoint&&(g+="_points"),c){var h=this.promiseRenderProxy(a,b),i=this;this.selectionMeshes[f]=h,h.then(function(c){var d,e=i.getRenderProxy(c.model,c.fragId);if(e&&e.geometry){if(e.isPoint){var h=e.material.clone();h.color=i.selectionMaterialBase.color,h.needsUpdate=!0,d=new THREE.Mesh(e.geometry,h)}else d=new THREE.Mesh(e.geometry,e.material);d.matrix.copy(e.matrixWorld),d.matrixAutoUpdate=!1,d.matrixWorldNeedsUpdate=!0,d.frustumCulled=!1,d.model=a,d.fragId=b,c.model.getFragmentList().lockGeometry(b),i.addOverlay(g,d),i.selectionMeshes[f]=d}}).catch(function(a){a.canceled||delete i.selectionMeshes[f]})}else if(this.selectionMeshes.hasOwnProperty(f)){var j=this.selectionMeshes[f];j instanceof Promise?this.cancelPromisedRenderProxy(j):(a.getFragmentList().unlockGeometry(b),this.removeOverlay(g,j)),delete this.selectionMeshes[f]}}e&&c||a.setHighlighted(b,c)&&this.invalidateHighlight()}},this.explode=function(a){a!=ta&&(ta=a,Z.explode(a),this.sceneUpdated(!0),this.api.dispatchEvent({type:av.EXPLODE_CHANGE_EVENT,scale:a}))},this.getExplodeScale=function(){return ta},this.setGhostingBrightness=function(a){this.fadeMaterial.color=a?new THREE.Color(1052688):new THREE.Color(16777215),this.fadeMaterial.needsUpdate=!0},this.loadCubeMapFromColors=function(a,b){var c=avp.CreateCubeMapFromColors(a,b);return c.isBgColor=!0,S.setReflectionMap(c),c},this.loadCubeMap=function(a,b){this._reflectionMapPath=a;var c=function(b){a===ba._reflectionMapPath&&(S.setReflectionMap(b),ba.invalidate(!0),b?avp.LightPresets[fa].useIrradianceAsBackground||U.setCubeMap(b):ba.loadCubeMapFromColors(ba.clearColorTop,ba.clearColorBottom))};return WGS.TextureLoader.loadCubeMap(a,b,c)},this.loadIrradianceMap=function(a,b){this._irradianceMapPath=a;var c=function(b){a===ba._irradianceMapPath&&(S.setIrradianceMap(b),ba.invalidate(!0),avp.LightPresets[fa].useIrradianceAsBackground&&U.setCubeMap(b))};return WGS.TextureLoader.loadCubeMap(a,b,c)},this.setLightPreset=function(a,b){if(za||this.initLights(),fa!==a||b){(a<0||avp.LightPresets.length<=a)&&(a=avp.DefaultLightPreset),fa=a;var c=avp.LightPresets[a],d=c.bgColorGradient;if(d||(d=avp.BackgroundPresets.Custom),this.setClearColors(d[0],d[1],d[2],d[3],d[4],d[5]),c&&c.path){var e="res/environments/"+c.path,f=avp.getResourceUrl(e+"_mipdrop."+(c.type||"")+".dds"),g=avp.getResourceUrl(e+"_irr."+(c.type||"")+".dds");this.loadIrradianceMap(g,c.E_bias),this.loadCubeMap(f,c.E_bias),S.setEnvExposure(-c.E_bias),U.setEnvExposure(-c.E_bias),this.setTonemapExposureBias(c.E_bias),this.setTonemapMethod(c.tonemap),this.setGhostingBrightness(c.darkerFade)}else{var h=this.loadCubeMapFromColors(this.clearColorTop,this.clearColorBottom);U.setCubeMap(h),S.setIrradianceMap(null),S.setEnvExposure(-c.E_bias||0),U.setEnvExposure(-c.E_bias||0),this.setTonemapExposureBias(c.E_bias||0),this.setTonemapMethod(c.tonemap||0),this.setGhostingBrightness(c.darkerFade),U.toggleEnvMapBackground(ya),this.invalidate(!0)}var i=av.Shaders.SAOShader.uniforms.radius.value,j=av.Shaders.SAOShader.uniforms.intensity.value;c.hasOwnProperty("saoRadius")&&(i=c.saoRadius),c.hasOwnProperty("saoIntensity")&&(j=c.saoIntensity),U.setAOOptions(i,j);var l=1;null!==c.lightMultiplier&&void 0!==c.lightMultiplier&&(l=c.lightMultiplier),ja.copy(ia),c.lightDirection&&ja.fromArray(c.lightDirection).negate(),V&&k(),this.dir_light1&&(this.dir_light1.intensity=l,c.lightDirection?(this.dir_light1.position.set(-c.lightDirection[0],-c.lightDirection[1],-c.lightDirection[2]),this.highlight_dir_light1.position.set(-c.lightDirection[0],-c.lightDirection[1],-c.lightDirection[2])):(this.dir_light1.position.copy(ka),this.highlight_dir_light1.position.copy(ka))),S.setEnvRotation(c.rotation||0),U.setEnvRotation(c.rotation||0),Y&&Y.setEnvRotation(c.rotation||0),this.toggleLights(0!==l),this.invalidate(!0,!1,!0),this.fireRenderOptionChanged()}},this.setLightPresetFromFile=function(a){if(!a||a.is2d())return!1;var b=a.getMetadata("renderEnvironmentStyle","value",null);if(null===b||""===b)return!1;var c=a.getMetadata("renderEnvironmentGroundReflection","value",null);null!==c&&(this.api.prefs.hasTag("groundReflection","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): groundReflection is locked. No changes."):(this.api.prefs.tag("no-storage","groundReflection"),this.api.setGroundReflection(c)));var d=a.getMetadata("renderEnvironmentGroundShadow","value",null);null!==d&&(this.api.prefs.hasTag("groundShadow","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): groundShadow is locked. No changes."):(this.api.prefs.tag("no-storage","groundShadow"),this.api.setGroundShadow(d)));var e=a.getMetadata("renderEnvironmentAmbientShadows","value",null);null!==e&&(this.api.prefs.hasTag("ambientShadows","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): ambientShadows is locked. No changes."):(this.api.prefs.tag("no-storage","ambientShadows"),this.api.setQualityLevel(e,U.getAntialiasing())));var f=a.getMetadata("renderEnvironmentDisplayLines","value",null);null!==f&&(this.api.prefs.hasTag("lineRendering","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): lineRendering is locked. No changes."):(this.api.prefs.tag("no-storage","lineRendering"),this.api.hideLines(!f)));var g=a.getMetadata("renderEnvironmentDisplayPoints","value",null);null!==g&&(this.api.prefs.hasTag("pointRendering","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): pointRendering is locked. No changes."):(this.api.prefs.tag("no-storage","pointRendering"),this.api.hidePoints(!g)));var h=avp.LightPresets.filter(function(a){return a.name===b});if(h=h[0]||null)if(this.api.prefs.hasTag("lightPreset","ignore-producer"))avp.logger.debug("setLightPresetFromFile(): lightPreset is locked. No changes.");else{this.api.prefs.tag("no-storage","lightPreset");var i=avp.ModelSettingsEnvironment;i||(i=avp.ModelSettingsEnvironment={},avp.LightPresets.push(i)),avp.copyLightPreset(h,i),i.name="(Custom: Model defined)";var j=a.getMetadata("renderEnvironmentExposureBias","value",null),k=a.getMetadata("renderEnvironmentExposureBase","value",null);null!==j&&null!==k&&(i.E_bias=j+k);var l=a.getMetadata("renderEnvironmentBackgroundColor","value",null);this.api.prefs.hasTag("backgroundColorPreset","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): backgroundColorPreset is locked. No changes."):l&&(i.bgColorGradient=[255*l[0],255*l[1],255*l[2],255*l[0],255*l[1],255*l[2]]);var m=a.getMetadata("renderEnvironmentRotation","value",null);null!==m&&(i.rotation=m);var n=avp.LightPresets.indexOf(i);this.setLightPreset(n,!0)}var o=a.getMetadata("renderEnvironmentBackgroundFromEnvironment","value",null);return null!==o&&(this.api.prefs.hasTag("envMapBackground","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): envMapBackground is locked. No changes."):(this.api.prefs.tag("no-storage","envMapBackground"),this.api.setEnvMapBackground(o))),h},this.setLightPresetForAec=function(){for(var a=avp.DefaultLightPresetAec||"Boardwalk",b=-1,c=0;c<avp.LightPresets.length;c++)if(avp.LightPresets[c].name===a){b=c;break}return b>=0&&(this.api.prefs.hasTag("lightPreset","ignore-producer")?avp.logger.debug("setLightPresetForAec(): lightPreset is locked. No changes."):(this.api.prefs.tag("no-storage","lightPreset"),this.setLightPreset(b,!0))),this.api.prefs.hasTag("envMapBackground","ignore-producer")?avp.logger.debug("setLightPresetForAec(): envMapBackground is locked. No changes."):(this.api.prefs.tag("no-storage","envMapBackground"),this.api.setEnvMapBackground(!0)),this.api.prefs.hasTag("edgeRendering","ignore-producer")?avp.logger.debug("setLightPresetForAec(): edgeRendering is locked. No changes."):(this.api.prefs.tag("no-storage","edgeRendering"),this.api.setDisplayEdges(!av.isMobileDevice())),!0},this.setAOHeuristics=function(a){if(a.isAEC()){var b=a.getUnitScale();b>.3?U.setAOOptions(4/b,1,.625):U.setAOOptions(.25/b,1,.625)}else{var c=a.getData().bbox,d=c.size().length();U.setAOOptions(Math.min(10,.05*d))}},this.setTonemapMethod=function(a){a!=U.getToneMapMethod()&&(U.setTonemapMethod(a),S.setTonemapMethod(a),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setTonemapExposureBias=function(a){a!=U.getExposureBias()&&(U.setTonemapExposureBias(a),S.setTonemapExposureBias(a),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setRenderingPrefsFor2D=function(a){if(!av.isNodeJS){var b=!a&&!!this.api.prefs.envMapBackground;this.toggleEnvMapBackground(b)}},this.dtor=function(){window.cancelAnimationFrame(O),this.api.removeEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,_),this.api.removeEventListener(av.MODEL_UNLOADED_EVENT,_),this.unloadCurrentModel(),this.controls=null,this.canvas=null,this.loader=null,this.selector.dtor(),this.selector=null,this.model=null,this.layers=null,this.visibilityManager=null,this.geomCache&&(this.geomCache.dtor(),this.geomCache=null),Z=null,U=null,S.dtor(),S=null},this.hideLines=function(a){return!(!Z||Z.isEmpty())&&(Z.hideLines(a),this.sceneUpdated(!0),!0)},this.hidePoints=function(a){return!(!Z||Z.isEmpty())&&(Z.hidePoints(a),this.sceneUpdated(!0),!0)},this.setDisplayEdges=function(a){U.toggleEdges(a),Ha(a),this.invalidateHighlight(),this.invalidate(!0)},this.getCutPlanes=function(){return S.getCutPlanes()},this.setCutPlanes=function(a){S.setCutPlanes(a),this.sceneUpdated(),this.api.dispatchEvent({type:av.CUTPLANES_CHANGE_EVENT,planes:a})},this.fireRenderOptionChanged=function(){S.toggleMRTSetting(U.mrtFlags()),this.api.dispatchEvent({type:av.RENDER_OPTION_CHANGED_EVENT})},this.viewportToRay=function(a,b){var c=this.camera;a.z=-1;var d=new THREE.Vector3(a.x,a.y,1);return a=a.unproject(c),d=d.unproject(c),d.sub(a).normalize(),b||(b=new THREE.Ray),b.set(c.isPerspective?c.position:a,d),b},this.rayIntersect=function(a,b,c,d,e){var f=Z.rayIntersect(a.origin,a.direction,b,c,d,e);if(this.sceneAfter.children.length){var g=new THREE.Raycaster(a.origin,a.direction,this.camera.near,this.camera.far),h=[];avp.VBIntersector.intersectObject(this.sceneAfter,g,h,!0),h.length&&(!f||h[0].distance<f.distance)&&(f=h[0])}if(!f)return null;var i=f.fragId,j=f.point,k=f.face,l=f.model,m=f.dbId;if(void 0===m&&void 0!==i){m=l.getFragmentList().getDbIds(i);l.getData().instanceTree||l.getData().fragmentMap||(m=i)}return{dbId:m,fragId:i,intersectPoint:j,face:k,model:l}},this.castRayViewport=function(){var a;return function(b,c,d,e,f){return a=a||new THREE.Ray,Z?(this.viewportToRay(b,a),this.rayIntersect(a,c,d,e,f)):{}}}(),this.getCanvasBoundingClientRect=function(){return this.canvasBoundingclientRectDirty&&(this.canvasBoundingclientRectDirty=!1,this.boundingClientRect=this.canvas.getBoundingClientRect()),this.boundingClientRect},this.clientToViewport=function(a,b){var c=this.getCanvasBoundingClientRect();return new THREE.Vector3((a+.5)/c.width*2-1,-(b+.5)/c.height*2+1,1)},this.viewportToClient=function(a,b){var c=this.getCanvasBoundingClientRect();return new THREE.Vector3(.5*(a+1)*c.width-.5,-.5*(b-1)*c.height-.5,0)},this.castRay=function(a,b,c){return this.castRayViewport(this.clientToViewport(a,b),c)},this.intersectGroundViewport=function(a){var b=this.camera,c="z";this.is2d||(c=ha);var d=a;d.z=-1;var e=new THREE.Vector3(d.x,d.y,1);d=d.unproject(b),e=e.unproject(b),e.sub(d).normalize();var f=e;if(Math.abs(f[c])<1e-6)return null;var g;g=b.isPerspective?b.position:d;var h=this.model?this.model.getBoundingBox().min[c]:0,i=(h-g[c])/f[c];return f.multiplyScalar(i),f.add(g),f},this.intersectGround=function(a,b){return this.intersectGroundViewport(this.clientToViewport(a,b))},this.hitTestViewport=function(a,b){var c;if(ba.is2d){var d,e=[];if((d=av.isMobileDevice()?U.idAtPixels(a.x,a.y,45,e):U.idAtPixels(a.x,a.y,5,e))<=0)return null;var f=this.intersectGroundViewport(a),g=Z.findModel(e[1])||ba.model;c={intersectPoint:f,dbId:d,fragId:g.getData().fragments.dbId2fragId[d],model:g}}else c=this.castRayViewport(a,b);return c},this.hitTest=function(a,b,c){return ba.hitTestViewport(this.clientToViewport(a,b),c)},this.snappingHitTestViewport=function(a,b){var c,d,e;if(this.model&&this.model.getData().isLeaflet)d=this.intersectGroundViewport(a),c={intersectPoint:d};else if(ba.is2d){if((e=av.isMobileDevice()?U.idAtPixels(a.x,a.y,101):U.idAtPixels(a.x,a.y,17))<0)return null;d=this.intersectGroundViewport(a);var f=ba.model.getData().fragments,g=f?f.dbId2fragId[e]:-1;c={intersectPoint:d,dbId:e,fragId:g}}else e=U.idAtPixel(a.x,a.y),c=this.castRayViewport(a,b,e>0?[e]:null);return c},this.snappingHitTest=function(a,b,c){return this.snappingHitTestViewport(this.clientToViewport(a,b),c)},this.rolloverObjectViewport=function(a){this.model&&this.model.getData().isLeaflet||U.rolloverObjectViewport(a.x,a.y)&&this.invalidate(!1,!1,!0)},this.rolloverObject=function(a,b){this.selector.highlightPaused||this.selector.highlightDisabled||this.rolloverObjectViewport(this.clientToViewport(a,b))},this.pauseHighlight=function(a){this.selector.highlightPaused=a,a&&(U.rolloverObjectId(-1),this.invalidate(!1,!1,!0))},this.disableHighlight=function(a){this.selector.highlightDisabled=a,a&&(U.rolloverObjectId(-1),this.invalidate(!1,!1,!0))},this.disableSelection=function(a){this.selector.selectionDisabled=a},this.rolloverObjectNode=function(a,b){var c=[];b=b||ba.model;var d=b?b.getData().instanceTree:void 0;if(d){if(d.enumNodeChildren(a,function(a){c.push(a)},!0),c.length>1){var e=c.shift();c.sort(function(a,b){return a-b}),c.unshift(e)}}else c.push(a);var f=b?b.id:0;U.rolloverObjectId(a,c,f)&&this.invalidate(!1,!1,!0)},this.getScreenShotBuffer=function(a,b,c){U.presentBuffer();var d=ba.canvas.toDataURL("image/png"),e=av.isSafari();if(e|=av.isIOSDevice(),e&&(a=a||Q,b=b||R),!a||!b)return d;var f,g,h=0,i=0;a>b||Q/R<a/b?(f=a,g=R/Q*a,i=b/2-g/2):(g=b,f=Q/R*b,h=a/2-f/2);var j=window.URL.createObjectURL(K(ba.canvas.toDataURL("image/png"))),k=new Image;k.src=j;var l=document.createElement("canvas"),m=l.getContext("2d");l.width=a,l.height=b,k.onload=function(){e&&(m.translate(0,g),m.scale(1,-1)),m.drawImage(k,h,i,f,g);var a=l.toDataURL("image/png"),b=window.URL.createObjectURL(K(l.toDataURL("image/png")));c?c(a):window.open(b)}},this.getScreenShot=function(a,b,c){U.presentBuffer();var d=window.URL.createObjectURL(K(ba.canvas.toDataURL("image/png"))),e=av.isSafari();e|=av.isIOSDevice(),e&&(a=a||Q,b=b||R),function(a,b,c,d,e){if(d||b&&c){var f,g,h=0,i=0;b>c||Q/R<b/c?(f=b,g=R/Q*b,i=c/2-g/2):(g=c,f=Q/R*c,h=b/2-f/2);var j=new Image;j.src=a;var k=document.createElement("canvas"),l=k.getContext("2d");k.width=b,k.height=c,j.onload=function(){d&&(l.translate(0,g),l.scale(1,-1)),l.drawImage(j,h,i,f,g);var a=window.URL.createObjectURL(K(k.toDataURL("image/png")));e?e(a):window.open(a)}}else e&&e(a)}(d,a,b,e,c)},this.modelQueue=function(){return Z},this.glrenderer=function(){return T},this.renderer=function(){return U},this.shadowMaps=function(){return V},this.worldUp=function(){return N},this.worldUpName=function(){return ha},this.setUserRenderContext=function(a){U=a||new avp.RenderContext,U.init(T,this.canvas.clientWidth,this.canvas.clientHeight),U.setClearColors(this.clearColorTop,this.clearColorBottom),this.invalidate(!0),this.sceneUpdated(!1)},this.invalidate=function(a,b,c){la=a||la,ma=b||ma,na=c||na},this.invalidateHighlight=function(){oa=!0,this.invalidate(!1,!1,!0)},this.isOverlayDirty=function(){return na},this.clearOverlayDirtyFlag=function(){na=!1},this.sceneUpdated=function(a){this.invalidate(!0,!1,!0),Z&&a&&(Z.invalidateVisibleBounds(),this.zoomBoundsChanged=!0),qa=!0,k()},this.requestSilentRender=function(){ra=sa=!0},this.requestDeferredSilentRender=function(){ra=!0},this.currentLightPreset=function(){return fa},this.matman=function(){return S},this.fps=function(){return 1e3/va},this.setFPSTargets=function(a,b,c){ca=1e3/c,ea=1e3/a,da=1e3/b,this.targetFrameBudget=av.isMobileDevice()?da/4:da},this.track=function(a){avp.logger.track(a)},this.worldToClient=function(a){var b=new THREE.Vector4(a.x,a.y,a.z,1);return b.applyMatrix4(this.camera.matrixWorldInverse),b.applyMatrix4(this.camera.projectionMatrix),b.w>0&&(b.x/=b.w,b.y/=b.w,b.z/=b.w),this.viewportToClient(b.x,b.y)},this.clientToWorld=function(a,b,c){var d=null,e=this.model,f=e.getData();if(e.is2d()){var g=this.intersectGround(a,b);if(g){g.z=0;var h=f.bbox;(f.hidePaper||h.containsPoint(g))&&(d={point:g,model:e})}}else(d=this.hitTest(a,b,c))&&(d.point=d.intersectPoint);return d},this.setSelectionColor=function(a,b){var c=new THREE.Color(a);c.multiplyScalar(.5),this.selectionMaterialBase.color.set(a),this.selectionMaterialTop.color.set(a),this.selectionMaterialBase.emissive.set(c),this.selectionMaterialTop.emissive.set(c),U.setSelectionColor(a),S.set2dSelectionColor(a),this.invalidateHighlight(),this.invalidate(!1,!1,!0)},this.updateViewportId=function(a){S.updateViewportId(a),this.invalidate(!0)},this.findModel=function(a){return Z.findModel(a)},this.getFrameRate=function(){return this.frameDisplayRate},this.setFrameRate=function(a){this.frameDisplayRate=a<1?1:a},this.setShadowLightDirection=function(a){ja.copy(a),k(),this.invalidate(!0,!1,!1),h()},this.getShadowLightDirection=function(a){var b=a||new THREE.Vector3;return b.copy(ja),b},this.toggleShadows=function(a){!!V!=!!a&&(a?V=new avp.ShadowMaps(T):(V.cleanup(S),V=null),h(),this.invalidate(!0,!0,!1))},this.showTransparencyWhenMoving=function(a){Z.enableNonResumableFrames=a},this.fitToView=function(a,b){if(b=!!b,0===a.length){a=Z.getModels().map(function(a){return{model:a,selection:[]}})}for(var c=0,d=0,e=0;e<a.length;++e){var f=a[e].model;if(!f)return!1;f.is2d()?c++:d++}var g=!1;if(d===a.length)g=this._fitToView3d(a,b);else{if(c!==a.length)return avp.logger.warn("Hybrid 2d/3d fitToView() not supported."),!1;g=this._fitToView2d(a,b)}return!!g&&(1===Z.getModels().length&&this.api.dispatchEvent({type:av.FIT_TO_VIEW_EVENT,nodeIdArray:a[0].selection,immediate:b,model:a[0].model}),this.api.dispatchEvent({type:av.AGGREGATE_FIT_TO_VIEW_EVENT,selection:a,immediate:b}),!0)},this._fitToView2d=function(a,b){a.length>1&&avp.logger.warn("fitToView() doesn't support multiple 2D models. Using the first one...");var c=a[0].model,d=a[0].selection,e=new THREE.Box3,f=new avp.BoundsCallback(e);if(d&&0!==d.length)for(var g=c.getData().fragments.dbId2fragId,h=0;h<d.length;h++){var i=g[d[h]];if(Array.isArray(i))for(var j=0;j<i.length;j++)M(c,i[j],d[h],f);else"number"==typeof i&&M(c,i,d[h],f)}else if(this.api.anyLayerHidden()){var k=c.getData().fragments,l=this.getVisibleLayerIndices();for(h=0;h<k.length;h++)L(c,h,l,f)}else e=this.getFitBounds(!0);return!e.empty()&&(this.api.navigation.fitBounds(b,e),!0)},this._fitToView3d=function(a,b){for(var c=!1,d=0;d<a.length;++d)if(a[d].selection.length>0){c=!0;break}var e=new THREE.Box3,f=new THREE.Box3;if(c)for(var g=0;g<a.length;++g){var h=a[g].selection;if(0!==h.length)for(var i=a[g].model,j=i.getFragmentMap(),k=i.getFragmentList(),l=0;l<h.length;++l){var m=parseInt(h[l]);j.enumNodeFragments(m,function(a){k.getWorldBounds(a,f),e.union(f)},!0)}}else e.union(this.getVisibleBounds(!1,!1));return!e.empty()&&(this.api.navigation.fitBounds(b,e),!0)},this.handleInitialVisibility=function(a){function b(b){var d=a.getFragmentList();if(!d.areAllVisible()){var e=a.getFragmentMap(),f=[];b.enumNodeChildren(a.getRootId(),function(a){e.findNodeFragment(a,function(a){return d.isFragVisible(a)},!0)||f.push(a)},!0),f.length&&c.hide(f,a)}}var c=this.api;a.getObjectTree(b)}}av.InitParametersSetting={canvas:null,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!1,depth:!1,devicePixelRatio:null},av.ProgressState={ROOT_LOADED:0,LOADING:1,RENDERING:2},a.prototype.constructor=a,avp.Viewer3DImpl=a}(),Autodesk.Viewing.Private.ViewerState=function(a){var b=Autodesk.Viewing.Private;this.getState=function(c){var d=a.navigation,e={};e.seedURN=this.getSeedUrn();var f=e.objectSet;Array.isArray(f)||(e.objectSet=f=[]),a.model&&!a.model.is2d()&&(f[0]={id:this.getSelectedNodes(),isolated:a.getIsolatedNodes(),hidden:a.getHiddenNodes(),explodeScale:a.getExplodeScale(),idType:"lmv"}),a.model&&a.model.is2d()&&(f[0]={id:this.getSelectedNodes(),isolated:this.getVisibleLayers2d(),allLayers:this.areAllLayersVisible(),hidden:[],idType:"lmv"});var g=e.viewport;g||(g=e.viewport={});var h=d.getCamera().isPerspective;g.name="",g.eye=d.getPosition().toArray(),g.target=d.getTarget().toArray(),g.up=d.getCamera().up.toArray(),g.worldUpVector=d.getWorldUpVector().toArray(),g.pivotPoint=d.getPivotPoint().toArray(),g.distanceToOrbit=d.getPivotPlaneDistance(),g.aspectRatio=this.getAspectRatio(),g.projection=h?"perspective":"orthographic",g.isOrthographic=!h,h?g.fieldOfView=d.getVerticalFov():g.orthographicHeight=this.getOrthographicHeight();var i=e.renderOptions;if(i||(i=e.renderOptions={}),i.environment=b.LightPresets[a.impl.currentLightPreset()].name,i.ambientOcclusion={enabled:a.impl.renderer().getAOEnabled(),radius:a.impl.renderer().getAORadius(),intensity:a.impl.renderer().getAOIntensity()},i.toneMap={method:a.impl.renderer().getToneMapMethod(),exposure:a.impl.renderer().getExposureBias(),lightMultiplier:this.getToneMapIntensity()},i.appearance={ghostHidden:a.impl.showGhosting,ambientShadow:a.prefs.ambientShadows,antiAliasing:a.impl.renderer().settings.antialias,progressiveDisplay:a.prefs.progressiveRendering,swapBlackAndWhite:a.prefs.swapBlackAndWhite,displayLines:a.prefs.lineRendering,displayPoints:a.prefs.pointRendering},a.model&&!a.model.is2d())for(var j=e.cutplanes=[],k=a.getCutPlanes(),l=0;l<k.length;l++)j.push(k[l].toArray());for(var m in a.loadedExtensions){var n=a.loadedExtensions[m];n.getState&&n.getState(e)}return c&&!0!==c&&this.applyFilter(e,c),e},this.restoreState=function(c,d,e){if(!c)return b.logger.warn("restoreState has no viewer state to restore from."),!1;if(!a||!a.model)return b.logger.warn("restoreState has no viewer or model to restore."),!1;d&&!0!==d&&(c=JSON.parse(JSON.stringify(c)),this.applyFilter(c,d));var f=a.navigation,g=a.model.is2d(),h=!g;if(Array.isArray(c.objectSet)&&c.objectSet.length>0){var i=c.objectSet[0],j=i.id;if(j&&(j=this.toIntArray(j),a.select(j)),g){var k=i.isolated;Array.isArray(k)&&k.length>0?(a.setLayerVisible(null,!1),a.impl.setLayerVisible(k,!0)):a.setLayerVisible(null,!0)}else{var l=i.isolated||[];if(l=this.toIntArray(l),a.isolate(l),0===l.length){var m=i.hidden||null;m&&m.length>0&&(m=this.toIntArray(m),a.hide(m))}}if("explodeScale"in i){var n=parseFloat(i.explodeScale);a.explode&&a.explode(n)}}var o=c.viewport;if(o){var p=this.getVector3FromArray(o.eye,f.getPosition()),q=this.getVector3FromArray(o.up,f.getCamera().up),r=this.getVector3FromArray(o.target,f.getTarget()),s="fieldOfView"in o?parseFloat(o.fieldOfView):f.getVerticalFov(),t=this.getVector3FromArray(o.worldUpVector,null);if(!t){var u=a.model?a.model.getUpVector():null;t=u?(new THREE.Vector3).fromArray(u):new THREE.Vector3(0,1,0)}var v=this.getVector3FromArray(o.pivotPoint,f.getPivotPoint()),w=f.getCamera().isPerspective;"isOrthographic"in o&&(w=!o.isOrthographic);var x=this.getOrthographicHeight();"orthographicHeight"in o&&(x=Number(o.orthographicHeight));var y={position:p,target:r,up:q,worldup:t,aspect:a.impl.camera.aspect,fov:s,orthoScale:x,isPerspective:w,pivot:v};this.restoreCameraState(y,e)}var z=c.renderOptions;if(z){var A=a.impl.renderer(),B=a.prefs,C=B.ambientShadows,D=B.antialiasing,E=z.ambientOcclusion;if(E){"enabled"in E&&(C=E.enabled);var F="radius"in E?E.radius:null,G="intensity"in E?E.intensity:null;null!==F&&null!==G&&(F===A.getAORadius()&&G===A.getAOIntensity()||(A.setAOOptions(F,G),A.composeFinalFrame()))}if("environment"in z){var H=this.getLightPresetIndex(z.environment);-1!==H&&H!==B.get("lightPreset")&&h&&a.setLightPreset(H)}var I=z.toneMap;if(I){var J=!1,K="exposure"in I?I.exposure:null,L="lightMultiplier"in I?I.lightMultiplier:null;null!==K&&K!==A.getExposureBias()&&(A.setTonemapExposureBias(K),J=!0),null!==L&&a.impl.dir_light1&&L!==this.getToneMapIntensity()&&(a.impl.dir_light1.intensity=Math.pow(2,L),J=!0),J&&a.impl.invalidate(!0)}var M=z.appearance;M&&("antiAliasing"in M&&(D=M.antiAliasing),"progressiveDisplay"in M&&M.progressiveDisplay!==B.get("progressiveRendering")&&a.setProgressiveRendering(M.progressiveDisplay),"swapBlackAndWhite"in M&&M.swapBlackAndWhite!==B.get("swapBlackAndWhite")&&a.setSwapBlackAndWhite(M.swapBlackAndWhite),"ghostHidden"in M&&M.ghostHidden!==B.get("ghosting")&&h&&a.setGhosting(M.ghostHidden),"displayLines"in M&&M.displayLines!==B.get("lineRendering")&&a.hideLines(!M.displayLines),"displayPoints"in M&&M.displayPoints!==B.get("pointRendering")&&a.hidePoints(!M.displayPoints)),h&&C!==B.ambientShadows&&D!==B.antialiasing&&a.setQualityLevel(C,D)}if(Array.isArray(c.cutplanes)&&a.model&&h){for(var N=[],O=0;O<c.cutplanes.length;O++){var P=c.cutplanes[O];Array.isArray(P)&&P.length>=4&&N.push(new THREE.Vector4(P[0],P[1],P[2],P[3]))}a.setCutPlanes(N)}for(var Q in a.loadedExtensions){var R=a.loadedExtensions[Q];R.restoreState&&R.restoreState(c,e)}return!0},this.restoreCameraState=function(b,c){a.impl.adjustOrthoCamera(b);var d=a.navigation;c?(b.isPerspective?d.toPerspective():d.toOrthographic(),d.setCameraUpVector(b.up),d.setWorldUpVector(b.worldup),d.setView(b.position,b.target),d.setPivotPoint(b.pivot),d.setVerticalFov(b.fov,!1),a.impl.syncCamera(!0)):(a.impl.camera.isPerspective=b.isPerspective,d.setRequestTransitionWithUp(!0,b.position,b.target,b.fov,b.up,b.worldup,b.pivot))},this.areEqual=function(a,b,c){function d(a,b){if(a=a||[],b=b||[],a.length!==b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0}function e(a,b,c){return a=a||[],b=b||[],a.length===b.length&&(0!==a.length&&(f(a[0],b[0],c)||f(a[1],b[1],c)||f(a[2],b[2],c)))}function f(a,b,c){var d=a?parseFloat(a):null,e=a?parseFloat(b):null,f=typeof d,g=typeof e;return"number"===f&&"number"===g?Math.abs(a-b)<c:(a=a||null,b=b||null,a===b)}var g=a,h=b;if(c&&!0!==c&&(g=this.applyFilter(g,c),h=this.applyFilter(h,c)),g.seedURN!==h.seedURN)return!1;var i=g.objectSet||[],j=h.objectSet||[];if(i.length!==j.length)return!1;var k=i[0]||{},l=j[0]||{};if(!(k.idType===l.idType&&f(k.explodeScale,l.explodeScale,1e-9)&&d(k.id,l.id)&&d(k.isolated,l.isolated)&&d(k.hidden,l.hidden)))return!1;var m=g.viewport||{},n=h.viewport||{};return!!(m.name===n.name&&m.projection===n.projection&&m.isOrthographic===n.isOrthographic&&f(m.distanceToOrbit,n.distanceToOrbit,1e-9)&&f(m.fieldOfView,n.fieldOfView,1e-9)&&f(m.orthographicHeight,n.orthographicHeight,1e-9)&&e(m.eye,n.eye,1e-9)&&e(m.target,n.target,1e-9)&&e(m.up,n.up,1e-9)&&e(m.worldUpVector,n.worldUpVector,1e-9)&&e(m.pivotPoint,n.pivotPoint,1e-9))},this.toIntArray=function(a){var b=[];if(Array.isArray(a))for(var c=0,d=a.length;c<d;++c)b.push(parseInt(a[c]));return b},this.extractSelectedNodeIds=function(a){if(a&&Array.isArray(a.objectSet)&&a.objectSet.length>0){var b=a.objectSet[0];return this.toIntArray(b.id)}return[]},this.extractIsolatedNodeIds=function(a){if(a&&Array.isArray(a.objectSet)&&a.objectSet.length>0){var b=a.objectSet[0];return this.toIntArray(b.isolated)}return[]},this.getVector3FromArray=function(a,b){return a instanceof Array&&a.length>2?(a[0]=parseFloat(a[0]),a[1]=parseFloat(a[1]),a[2]=parseFloat(a[2]),(new THREE.Vector3).fromArray(a)):b},this.getSelectedNodes=function(){return a.impl&&a.impl.selector?a.impl.selector.getSelection():[]},this.getVisibleLayers2d=function(){var b=[],c=a.impl.matman(),d=c._layersMap;for(var e in d)d.hasOwnProperty(e)&&c.isLayerVisible(e)&&b.push(e);return b},this.areAllLayersVisible=function(){var b=a.impl.matman(),c=b._layersMap;for(var d in c)if(c.hasOwnProperty(d)&&!b.isLayerVisible(d))return!1;return!0},this.getAspectRatio=function(){var b=a.navigation.getScreenViewport();return b.width/b.height},this.getOrthographicHeight=function(){var b=a.navigation.getCamera();return b.isPerspective?0:Math.abs(2*b.orthographicCamera.top)},this.getSeedUrn=function(){return a.model&&a.model.loader?a.model.loader.svfUrn||"":""},this.getToneMapIntensity=function(){var b=0;return a.impl.dir_light1&&(b=0!=a.impl.dir_light1.intensity?Math.log(a.impl.dir_light1.intensity)/Math.log(2):-1e-20),b},this.getLightPresetIndex=function(a){for(var c=0;c<b.LightPresets.length;c++)if(b.LightPresets[c].name===a)return c;return-1},this.applyFilter=function(a,c){if(!0!==c)for(var d in a)if(a.hasOwnProperty(d)){var e=c[d];void 0===e?(delete a[d],b.logger.log("[applyFilter] C - skipping key ["+d+"] from viewerState; unspecified in filter.")):"boolean"==typeof e?!1===e&&(delete a[d],b.logger.log("[applyFilter] D - skipping key ["+d+"] from viewerState; explicit filtering.")):e instanceof Object?a[d]instanceof Object?this.applyFilter(a[d],c[d]):b.logger.warn("[applyFilter] A - Invalid filter Object for key ["+d+"]"):b.logger.warn("[applyFilter] B - Invalid filter value for key ["+d+"]")}}},Autodesk.Viewing.Private.ViewerState.prototype.constructor=Autodesk.Viewing.Private.ViewerState,function(){"use strict";function a(){this.names=[{symbol:"en",label:"English"},{symbol:"zh-HANS",label:"Chinese Simplified"},{symbol:"zh-HANT",label:"Chinese Traditional"},{symbol:"ja",label:"Japanese"},{symbol:"cs",label:"Czech"},{symbol:"ko",label:"Korean"},{symbol:"pl",label:"Polish"},{symbol:"ru",label:"Russian"},{symbol:"fr",label:"French"},{symbol:"de",label:"German"},{symbol:"it",label:"Italian"},{symbol:"nl",label:"Dutch"},{symbol:"es",label:"Spanish"},{symbol:"pt-BR",label:"Portuguese Brazil"},{symbol:"tr",label:"Turkish"},{symbol:"sv",label:"Swedish"}],this.isSupported=function(a){for(var b=0;b<this.names.length;++b)if(this.names[b].symbol===a)return!0;return!1},this.getSupported=function(a){var b=a.split("-");return a=b.length>1?b[0].toLowerCase()+"-"+b[1].toUpperCase():b[0].toLowerCase(),this.isSupported(a)||(a=a.indexOf("zh-CN")>-1?"zh-HANS":a.indexOf("zh-TW")>-1?"zh-HANT":b.length>1&&this.isSupported(b[0].toLowerCase())?b[0]:"en"),a},this.getLanguages=function(){return this.names.slice()}}Autodesk.Viewing.Private.Lang=new a}(),AutodeskNamespace("Autodesk.Viewing.i18n"),function(){function a(){A="aaaa",U()}function b(){A=null,U()}function c(a,b){if(!b||"function"==typeof b)return a;for(var c in b)a[c]=b[c];return a}function d(a,b,c){var d,e=0,f=a.length,g=void 0===f||"[object Array]"!==Object.prototype.toString.apply(a)||"function"==typeof a;if(c)if(g){for(d in a)if(!1===b.apply(a[d],c))break}else for(;e<f&&!1!==b.apply(a[e++],c););else if(g){for(d in a)if(!1===b.call(a[d],d,a[d]))break}else for(;e<f&&!1!==b.call(a[e],e,a[e++]););return a}function e(a){return"string"==typeof a?a.replace(/[&<>"'\/]/g,function(a){return K[a]}):a}function f(a){var b=function(a){if(window.XMLHttpRequest)return a(null,new XMLHttpRequest);if(window.ActiveXObject)try{return a(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(b){return a(null,new ActiveXObject("Microsoft.XMLHTTP"))}return a(new Error)},c=function(a){if("string"==typeof a)return a;var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},d=function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},e=function(a){
var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a=d(a);var c,e,f,g,h,i,j,k="",l=0;do{c=a.charCodeAt(l++),e=a.charCodeAt(l++),f=a.charCodeAt(l++),g=c>>2,h=(3&c)<<4|e>>4,i=(15&e)<<2|f>>6,j=63&f,isNaN(e)?i=j=64:isNaN(f)&&(j=64),k+=b.charAt(g)+b.charAt(h)+b.charAt(i)+b.charAt(j),c=e=f="",g=h=i=j=""}while(l<a.length);return k},f=function(){for(var a=arguments[0],b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}return a},g=function(a,d,e,h){"function"==typeof e&&(h=e,e={}),e.doNotCache=e.doNotCache||!1,e.data=e.data||{},e.headers=e.headers||{},e.jsonp=e.jsonp||!1,e.async=void 0===e.async||e.async;var i,j=f({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},g.headers,e.headers);if(i="application/json"===j["content-type"]?JSON.stringify(e.data):c(e.data),"GET"===a){var k=[];if(i&&(k.push(i),i=null),e.doNotCache&&k.push("_="+(new Date).getTime()),e.jsonp&&(k.push("callback="+e.jsonp),k.push("jsonp="+e.jsonp)),k=k.join("&"),k.length>1&&(d.indexOf("?")>-1?d+="&"+k:d+="?"+k),e.jsonp){var l=document.getElementsByTagName("head")[0],m=document.createElement("script");return m.type="text/javascript",m.src=d,void l.appendChild(m)}}b(function(b,c){if(b)return h(b);c.open(a,d,e.async);for(var f in j)j.hasOwnProperty(f)&&c.setRequestHeader(f,j[f]);c.onreadystatechange=function(){if(4===c.readyState){var a=c.responseText||"";if(!h)return;h(c.status,a)}},c.send(i)})};({authBasic:function(a,b){g.headers.Authorization="Basic "+e(a+":"+b)},connect:function(a,b,c){return g("CONNECT",a,b,c)},del:function(a,b,c){return g("DELETE",a,b,c)},get:function(a,b,c){return g("GET",a,b,c)},head:function(a,b,c){return g("HEAD",a,b,c)},headers:function(a){g.headers=a||{}},isAllowed:function(a,b,c){this.options(a,function(a,d){c(-1!==d.text().indexOf(b))})},options:function(a,b,c){return g("OPTIONS",a,b,c)},patch:function(a,b,c){return g("PATCH",a,b,c)},post:function(a,b,c){return g("POST",a,b,c)},put:function(a,b,c){return g("PUT",a,b,c)},trace:function(a,b,c){return g("TRACE",a,b,c)}})[a.type?a.type.toLowerCase():"get"](a.url,a,function(b,c){200===b?a.success(c,b,null):a.error(c,b,null)})}function g(a,b){"function"==typeof a&&(b=a,a={}),a=a||{},N.extend(J,a),delete J.fixLng,"string"==typeof J.ns&&(J.ns={namespaces:[J.ns],defaultNs:J.ns}),"string"==typeof J.fallbackNS&&(J.fallbackNS=[J.fallbackNS]),"string"!=typeof J.fallbackLng&&"boolean"!=typeof J.fallbackLng||(J.fallbackLng=[J.fallbackLng]),J.interpolationPrefixEscaped=N.regexEscape(J.interpolationPrefix),J.interpolationSuffixEscaped=N.regexEscape(J.interpolationSuffix),J.lng||(J.lng=N.detectLanguage()),J.lng?J.useCookie&&N.cookie.create(J.cookieName,J.lng,J.cookieExpirationTime,J.cookieDomain):(J.lng=J.fallbackLng[0],J.useCookie&&N.cookie.remove(J.cookieName)),H=N.toLanguages(J.lng),B=H[0],N.log("currentLng set to: "+B);var c=u;if(a.fixLng&&(c=function(a,b){return b=b||{},b.lng=b.lng||c.lng,u(a,b)},c.lng=B),P.setCurrentLng(B),J.resStore)return N.each(J.resStore,function(a,b){N.each(b,function(b,c){i(a,b,c)})}),I=!0,void(b&&b(c));var d=N.toLanguages(J.lng);"string"==typeof J.preload&&(J.preload=[J.preload]);for(var e=0,f=J.preload.length;e<f;e++)for(var g=N.toLanguages(J.preload[e]),h=0,j=g.length;h<j;h++)d.indexOf(g[h])<0&&d.push(g[h]);Autodesk.Viewing.i18n.sync.load(d,J,function(a,d){N.each(d,function(a,b){N.each(b,function(b,c){i(a,b,c)})}),I=!0,b&&b(c)})}function h(a,b){"string"==typeof a&&(a=[a]);for(var c=0,d=a.length;c<d;c++)J.preload.indexOf(a[c])<0&&J.preload.push(a[c]);return g(b)}function i(a,b,c){"string"!=typeof b?(c=b,b=J.ns.defaultNs):J.ns.namespaces.indexOf(b)<0&&J.ns.namespaces.push(b),F[a]=F[a]||{},F[a][b]=F[a][b]||{},N.extend(F[a][b],c)}function j(a,b){"string"!=typeof b&&(b=J.ns.defaultNs),F[a]=F[a]||{},F[a][b]={}}function k(a){J.ns.defaultNs=a}function l(a,b){m([a],b)}function m(a,b){var c={dynamicLoad:J.dynamicLoad,resGetPath:J.resGetPath,getAsync:J.getAsync,customLoad:J.customLoad,ns:{namespaces:a,defaultNs:""}},d=N.toLanguages(J.lng);"string"==typeof J.preload&&(J.preload=[J.preload]);for(var e=0,f=J.preload.length;e<f;e++)for(var g=N.toLanguages(J.preload[e]),h=0,i=g.length;h<i;h++)d.indexOf(g[h])<0&&d.push(g[h]);for(var j=[],k=0,l=d.length;k<l;k++){var m=!1,n=F[d[k]];if(n)for(var o=0,p=a.length;o<p;o++)n[a[o]]||(m=!0);else m=!0;m&&j.push(d[k])}j.length?Autodesk.Viewing.i18n.sync._fetch(j,c,function(c,d){var e=a.length*j.length;N.each(a,function(a,c){J.ns.namespaces.indexOf(c)<0&&J.ns.namespaces.push(c),N.each(j,function(a,f){F[f]=F[f]||{},F[f][c]=d[f][c],0===--e&&b&&(J.useLocalStorage&&Autodesk.Viewing.i18n.sync._storeLocal(F),b())})})}):b&&b()}function n(a,b,c){return"function"==typeof b?(c=b,b={}):b||(b={}),b.lng=a,g(b,c)}function o(){return B}function p(a,b,c,d){if(!a)return a;if(d=d||b,a.indexOf(d.interpolationPrefix||J.interpolationPrefix)<0)return a;var e=d.interpolationPrefix?N.regexEscape(d.interpolationPrefix):J.interpolationPrefixEscaped,f=d.interpolationSuffix?N.regexEscape(d.interpolationSuffix):J.interpolationSuffixEscaped,g="HTML"+f;return N.each(b,function(b,h){var i=c?c+J.keyseparator+b:b;"object"==typeof h&&null!==h?a=p(a,h,i,d):d.escapeInterpolation||J.escapeInterpolation?(a=a.replace(new RegExp([e,i,g].join(""),"g"),h),a=a.replace(new RegExp([e,i,f].join(""),"g"),N.escape(h))):a=a.replace(new RegExp([e,i,f].join(""),"g"),h)}),a}function q(a,b){var c=N.extend({},b);for(delete c.postProcess;-1!=a.indexOf(J.reusePrefix)&&!(++G>J.maxRecursion);){var d=a.lastIndexOf(J.reusePrefix),e=a.indexOf(J.reuseSuffix,d)+J.reuseSuffix.length,f=a.substring(d,e),g=f.replace(J.reusePrefix,"").replace(J.reuseSuffix,"");if(-1!=g.indexOf(",")){var h=g.indexOf(",");if(-1!=g.indexOf("{",h)&&-1!=g.indexOf("}",h)){var i=g.indexOf("{",h),j=g.indexOf("}",i)+"}".length;try{c=N.extend(c,JSON.parse(g.substring(i,j))),g=g.substring(0,h)}catch(a){}}}var k=x(g,c);a=a.replace(f,k)}return a}function r(a){return a.context&&("string"==typeof a.context||"number"==typeof a.context)}function s(a){return void 0!==a.count&&"string"!=typeof a.count&&1!==a.count}function t(a,b){b=b||{};var c=v(a,b),d=y(a,b);return void 0!==d||d===c}function u(a,b){if(b=b||{},!I){N.log("i18next not finished initialization. you might have called t function before loading resources finished.");var c=a.indexOf(":");c<0?c=0:c++;var d=b.defaultValue||a.substr(c);return d&&(d=p(d,b)),d}return G=0,x.apply(null,arguments)}function v(a,b){return void 0!==b.defaultValue?b.defaultValue:a}function w(){for(var a=[],b=1;b<arguments.length;b++)a.push(arguments[b]);return{postProcess:"sprintf",sprintf:a}}function x(a,b){if(b&&"object"!=typeof b?"sprintf"===J.shortcutFunction?b=w.apply(null,arguments):"defaultValue"===J.shortcutFunction&&(b={defaultValue:b}):b=b||{},void 0===a||null===a)return"";"string"==typeof a&&(a=[a]);var c=a[0];if(a.length>1)for(var d=0;d<a.length&&(c=a[d],!t(c,b));d++);var e,f=v(c,b),g=y(c,b),h=b.lng?N.toLanguages(b.lng):H,i=b.ns||J.ns.defaultNs;c.indexOf(J.nsseparator)>-1&&(e=c.split(J.nsseparator),i=e[0],c=e[1]),void 0===g&&J.sendMissing&&(b.lng?O.postMissing(h[0],i,c,f,h):O.postMissing(J.lng,i,c,f,h));var j=b.postProcess||J.postProcess;if(void 0!==g&&j&&Q[j]&&(g=Q[j](g,c,b)),A&&void 0!==g)return A;var k=f;if(f.indexOf(J.nsseparator)>-1&&(e=f.split(J.nsseparator),k=e[1]),k===c&&J.parseMissingKey&&(f=J.parseMissingKey(f)),void 0===g&&(f=p(f,b),f=q(f,b),j&&Q[j])){var l=v(c,b);g=Q[j](l,c,b)}return void 0!==g?g:f}function y(a,b){b=b||{};var c,d,e=v(a,b),f=H;if(!F)return e;if("cimode"===f[0].toLowerCase())return e;if(b.lng&&(f=N.toLanguages(b.lng),!F[f[0]])){var g=J.getAsync;J.getAsync=!1,Autodesk.Viewing.i18n.sync.load(f,J,function(a,b){N.extend(F,b),J.getAsync=g})}var h=b.ns||J.ns.defaultNs;if(a.indexOf(J.nsseparator)>-1){var i=a.split(J.nsseparator);h=i[0],a=i[1]}if(r(b)){c=N.extend({},b),delete c.context,c.defaultValue=J.contextNotFound;if((d=u(h+J.nsseparator+a+"_"+b.context,c))!=J.contextNotFound)return p(d,{context:b.context})}if(s(b)){c=N.extend({},b),delete c.count,c.defaultValue=J.pluralNotFound;var j=h+J.nsseparator+a+J.pluralSuffix,k=P.get(f[0],b.count);if(k>=0?j=j+"_"+k:1===k&&(j=h+J.nsseparator+a),(d=u(j,c))!=J.pluralNotFound)return p(d,{count:b.count,interpolationPrefix:b.interpolationPrefix,interpolationSuffix:b.interpolationSuffix})}for(var l,m=a.split(J.keyseparator),n=0,o=f.length;n<o&&void 0===l;n++){for(var t=f[n],w=0,z=F[t]&&F[t][h];m[w];)z=z&&z[m[w]],w++;if(void 0!==z){var A=Object.prototype.toString.apply(z);if("string"==typeof z)z=p(z,b),z=q(z,b);else if("[object Array]"!==A||J.returnObjectTrees||b.returnObjectTrees){if(null===z&&!0===J.fallbackOnNull)z=void 0;else if(null!==z)if(J.returnObjectTrees||b.returnObjectTrees){if("[object Number]"!==A&&"[object Function]"!==A&&"[object RegExp]"!==A){var B="[object Array]"===A?[]:{};N.each(z,function(c){B[c]=x(h+J.nsseparator+a+J.keyseparator+c,b)}),z=B}}else J.objectTreeKeyHandler&&"function"==typeof J.objectTreeKeyHandler?z=J.objectTreeKeyHandler(a,z,t,h,b):(z="key '"+h+":"+a+" ("+t+")' returned an object instead of string.",N.log(z))}else z=z.join("\n"),z=p(z,b),z=q(z,b);"string"==typeof z&&""===z.trim()&&!0===J.fallbackOnEmpty&&(z=void 0),l=z}}if(void 0===l&&!b.isFallbackLookup&&(!0===J.fallbackToDefaultNS||J.fallbackNS&&J.fallbackNS.length>0))if(b.isFallbackLookup=!0,J.fallbackNS.length){for(var C=0,D=J.fallbackNS.length;C<D;C++)if(l=y(J.fallbackNS[C]+J.nsseparator+a,b)){var E=l.indexOf(J.nsseparator)>-1?l.split(J.nsseparator)[1]:l,G=e.indexOf(J.nsseparator)>-1?e.split(J.nsseparator)[1]:e;if(E!==G)break}}else l=y(a,b);return l}function z(){var a,b=[];if("undefined"!=typeof window&&(!function(){for(var a=window.location.search.substring(1),c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("=");if(e>0){var f=c[d].substring(0,e),g=c[d].substring(e+1);b[f]=g}}}(),b[J.detectLngQS]&&(a=b[J.detectLngQS])),!a&&"undefined"!=typeof document&&J.useCookie){var c=N.cookie.read(J.cookieName);c&&(a=c)}return a||"undefined"==typeof navigator||(a=navigator.language?navigator.language:navigator.userLanguage),a}var A=null;Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&d!=1/0&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);e<c;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&d!=1/0&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d))));for(var e=d>=0?Math.min(d,c-1):c-Math.abs(d);e>=0;e--)if(e in b&&b[e]===a)return e;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var B,C=this,D=C.jQuery||C.Zepto,E={},F={},G=0,H=[],I=!1;"undefined"!=typeof module&&module.exports?module.exports=E:(D&&(D.i18n=D.i18n||E),C.i18n=C.i18n||E);var J={lng:void 0,load:"current",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"res/locales/__lng__/__ns__.json",resPostPath:"res/locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048e5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,shortcutFunction:"sprintf"},K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},L={create:function(a,b,c,d){var e;if(c){var f=new Date;f.setTime(f.getTime()+60*c*1e3),e="; expires="+f.toGMTString()}else e="";d=d?"domain="+d+";":"",document.cookie=a+"="+b+e+";"+d+"path=/"},read:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null},remove:function(a){this.create(a,"",-1)}},M={create:function(a,b,c,d){},read:function(a){return null},remove:function(a){}},N={extend:c,each:d,ajax:"undefined"!=typeof document?f:function(){},cookie:"undefined"!=typeof document?L:M,detectLanguage:z,escape:e,log:function(a){J.debug&&"undefined"!=typeof console&&console.log(a)},toLanguages:function(a){var b=[];if("string"==typeof a&&a.indexOf("-")>-1){var c=a.split("-");a=J.lowerCaseLng?c[0].toLowerCase()+"-"+c[1].toLowerCase():c[0].toLowerCase()+"-"+c[1].toUpperCase(),"unspecific"!==J.load&&b.push(a),"current"!==J.load&&b.push(c[0])}else b.push(a);for(var d=0;d<J.fallbackLng.length;d++)-1===b.indexOf(J.fallbackLng[d])&&J.fallbackLng[d]&&b.push(J.fallbackLng[d]);return b},regexEscape:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}};N.applyReplacement=p;var O={load:function(a,b,c){b.useLocalStorage?O._loadLocal(a,b,function(d,e){for(var f=[],g=0,h=a.length;g<h;g++)e[a[g]]||f.push(a[g]);f.length>0?O._fetch(f,b,function(a,b){N.extend(e,b),O._storeLocal(b),c(null,e)}):c(null,e)}):O._fetch(a,b,function(a,b){c(null,b)})},_loadLocal:function(a,b,c){var d={},e=(new Date).getTime();if(window.localStorage){var f=a.length;N.each(a,function(a,g){var h=window.localStorage.getItem("res_"+g);h&&(h=JSON.parse(h),h.i18nStamp&&h.i18nStamp+b.localStorageExpirationTime>e&&(d[g]=h)),0===--f&&c(null,d)})}},_storeLocal:function(a){if(window.localStorage)for(var b in a)a[b].i18nStamp=(new Date).getTime(),window.localStorage.setItem("res_"+b,JSON.stringify(a[b]))},_fetch:function(a,b,c){var d=b.ns,e={};if(b.dynamicLoad){var f=function(a,b){c(null,b)};if("function"==typeof b.customLoad)b.customLoad(a,d.namespaces,b,f);else{var g=p(b.resGetPath,{lng:a.join("+"),ns:d.namespaces.join("+")});g=Autodesk.Viewing.Private.getResourceUrl(g),N.ajax({url:g,success:function(a,b,c){N.log("loaded: "+g),f(0,a.json())},error:function(a,b,c){N.log("failed loading: "+g),f()},dataType:"text",async:b.getAsync})}}else{var h,i=d.namespaces.length*a.length;N.each(d.namespaces,function(d,f){N.each(a,function(a,d){var g=function(a,b){a&&(h=h||[],h.push(a)),e[d]=e[d]||{},e[d][f]=b,0===--i&&c(h,e)};"function"==typeof b.customLoad?b.customLoad(d,f,b,g):O._fetchOne(d,f,b,g)})})}},_fetchOne:function(a,b,c,d){var e=p(c.resGetPath,{lng:a,ns:b});e=Autodesk.Viewing.Private.getResourceUrl(e),N.ajax({url:e,success:function(a,b,c){N.log("loaded: "+e);var f=a;d(null,JSON.parse(f))},error:function(a,b,c){if(b&&200==b||a&&a.status&&200==a.status)N.log("There is a typo in: "+e);else if(b&&404==b||a&&a.status&&404==a.status)N.log("Does not exist: "+e);else{var f=b||(a&&a.status?a.status:null);N.log(f+" when loading "+e)}d(c,{})},dataType:"text",async:c.getAsync})},postMissing:function(a,b,c,d,e){var f={};f[c]=d;var g=[];if("fallback"===J.sendMissingTo&&!1!==J.fallbackLng[0])for(var h=0;h<J.fallbackLng.length;h++)g.push({lng:J.fallbackLng[h],url:p(J.resPostPath,{lng:J.fallbackLng[h],ns:b})});else if("current"===J.sendMissingTo||"fallback"===J.sendMissingTo&&!1===J.fallbackLng[0])g.push({lng:a,url:p(J.resPostPath,{lng:a,ns:b})});else if("all"===J.sendMissingTo)for(var h=0,i=e.length;h<i;h++)g.push({lng:e[h],url:p(J.resPostPath,{lng:e[h],ns:b})});for(var j=0,k=g.length;j<k;j++){var l=g[j];N.ajax({url:l.url,type:J.sendType,data:f,success:function(a,e,f){N.log("posted missing key '"+c+"' to: "+l.url);for(var g=c.split("."),h=0,i=F[l.lng][b];g[h];)i=h===g.length-1?i[g[h]]=d:i[g[h]]=i[g[h]]||{},h++},error:function(a,b,d){N.log("failed posting missing key '"+c+"' to: "+l.url)},dataType:"json",async:J.postAsync})}}},P={rules:{ach:{name:"Acholi",numbers:[1,2],plurals:function(a){return Number(a>1)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ak:{name:"Akan",numbers:[1,2],plurals:function(a){return Number(a>1)}},am:{name:"Amharic",numbers:[1,2],plurals:function(a){return Number(a>1)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(a){return Number(0===a?0:1==a?1:2==a?2:a%100>=3&&a%100<=10?3:a%100>=11?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(a){return Number(a>1)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ay:{name:"Aymar",numbers:[1],plurals:function(a){return 0}},az:{name:"Azerbaijani",numbers:[1,2],plurals:function(a){return Number(1!=a)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},bo:{name:"Tibetan",numbers:[1],plurals:function(a){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(a){return Number(a>1)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(a){return Number(1!=a)}},cgg:{name:"Chiga",numbers:[1],plurals:function(a){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:a>=2&&a<=4?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:function(a){return Number(1==a?0:2==a?1:8!=a&&11!=a?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},de:{name:"German",numbers:[1,2],plurals:function(a){return Number(1!=a)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(a){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(a){return Number(1!=a)}},en:{name:"English",numbers:[1,2],plurals:function(a){return Number(1!=a)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(a){return Number(1!=a)}},es:{name:"Spanish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},et:{name:"Estonian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},eu:{name:"Basque",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fa:{name:"Persian",numbers:[1],plurals:function(a){return 0}},fi:{name:"Finnish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(a){return Number(a>1)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fr:{name:"French",numbers:[1,2],plurals:function(a){return Number(a>1)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(a){return Number(1==a?0:2==a?1:a<7?2:a<11?3:4)}},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:function(a){return Number(1==a||11==a?0:2==a||12==a?1:a>2&&a<20?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(a){return Number(1!=a)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(a){return Number(1!=a)}},gun:{name:"Gun",numbers:[1,2],plurals:function(a){return Number(a>1)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(a){return Number(1!=a)}},he:{name:"Hebrew",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hr:{name:"Croatian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(a){return Number(1!=a)}},id:{name:"Indonesian",numbers:[1],plurals:function(a){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(a){return Number(a%10!=1||a%100==11)}},it:{name:"Italian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ja:{name:"Japanese",numbers:[1],plurals:function(a){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(a){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(a){return Number(0!==a)}},ka:{name:"Georgian",numbers:[1],plurals:function(a){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(a){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(a){return 0}},kn:{name:"Kannada",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ko:{name:"Korean",numbers:[1],plurals:function(a){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(a){return Number(1==a?0:2==a?1:3==a?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(a){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(a){return Number(a>1)}},lo:{name:"Lao",numbers:[1],plurals:function(a){return 0}},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&(a%100<10||a%100>=20)?1:2)}},lv:{name:"Latvian",numbers:[1,2,0],plurals:function(a){return Number(a%10==1&&a%100!=11?0:0!==a?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(a){return Number(a>1)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(a){return Number(a>1)}},mi:{name:"Maori",numbers:[1,2],plurals:function(a){return Number(a>1)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(a){return Number(1==a||a%10==1?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(a){return Number(1==a?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ms:{name:"Malay",numbers:[1],plurals:function(a){return 0}},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(a){return Number(1==a?0:0===a||a%100>1&&a%100<11?1:a%100>10&&a%100<20?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nl:{name:"Dutch",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(a){return Number(1!=a)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(a){return Number(1!=a)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(a){return Number(a>1)}},or:{name:"Oriya",numbers:[2,1],plurals:function(a){return Number(1!=a)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pap:{name:"Papiamento",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pt_br:{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},rm:{name:"Romansh",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(a){return Number(1==a?0:0===a||a%100>0&&a%100<20?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(a){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(a){return Number(1!=a)}},se:{name:"Northern Sami",numbers:[1,2],plurals:function(a){return Number(1!=a)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:a>=2&&a<=4?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(a){return Number(a%100==1?1:a%100==2?2:a%100==3||a%100==4?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},son:{name:"Songhay",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sq:{name:"Albanian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(a){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(a){return Number(1!=a)}},te:{name:"Telugu",numbers:[1,2],plurals:function(a){return Number(1!=a)}},tg:{name:"Tajik",numbers:[1,2],plurals:function(a){return Number(a>1)}},th:{name:"Thai",numbers:[1],plurals:function(a){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(a){return Number(a>1)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(a){return Number(1!=a)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(a){return Number(a>1)}},tt:{name:"Tatar",numbers:[1],plurals:function(a){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(a){return 0}},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(a){return Number(1!=a)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(a){return Number(a>1)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(a){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(a){return Number(a>1)}},wo:{name:"Wolof",numbers:[1],plurals:function(a){return 0}},yo:{name:"Yoruba",numbers:[1,2],plurals:function(a){return Number(1!=a)}},zh:{name:"Chinese",numbers:[1],plurals:function(a){return 0}}},addRule:function(a,b){P.rules[a]=b},setCurrentLng:function(a){if(!P.currentRule||P.currentRule.lng!==a){var b=a.split("-");P.currentRule={lng:a,rule:P.rules[b[0]]}}},get:function(a,b){var c=a.split("-");return function(b,c){var d;if(d=P.currentRule&&P.currentRule.lng===a?P.currentRule.rule:P.rules[b]){var e=d.plurals(c),f=d.numbers[e];return 2===d.numbers.length&&1===d.numbers[0]&&(2===f?f=-1:1===f&&(f=1)),f}return 1===c?"1":"-1"}(c[0],b)}},Q={},R=function(a,b){Q[a]=b},S=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function b(a,b){for(var c=[];b>0;c[--b]=a);return c.join("")}var c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};return c.format=function(c,d){var e,f,g,h,i,j,k,l=1,m=c.length,n="",o=[];for(f=0;f<m;f++)if("string"===(n=a(c[f])))o.push(c[f]);else if("array"===n){if(h=c[f],h[2])for(e=d[l],g=0;g<h[2].length;g++){if(!e.hasOwnProperty(h[2][g]))throw S('[sprintf] property "%s" does not exist',h[2][g]);e=e[h[2][g]]}else e=h[1]?d[h[1]]:d[l++];if(/[^s]/.test(h[8])&&"number"!=a(e))throw S("[sprintf] expecting number but found %s",a(e));switch(h[8]){case"b":e=e.toString(2);break;case"c":e=String.fromCharCode(e);break;case"d":e=parseInt(e,10);break;case"e":e=h[7]?e.toExponential(h[7]):e.toExponential();break;case"f":e=h[7]?parseFloat(e).toFixed(h[7]):parseFloat(e);break;case"o":e=e.toString(8);break;case"s":e=(e=String(e))&&h[7]?e.substring(0,h[7]):e;break;case"u":e=Math.abs(e);break;case"x":e=e.toString(16);break;case"X":e=e.toString(16).toUpperCase()}e=/[def]/.test(h[8])&&h[3]&&e>=0?"+"+e:e,j=h[4]?"0"==h[4]?"0":h[4].charAt(1):" ",k=h[6]-String(e).length,i=h[6]?b(j,k):"",o.push(h[5]?e+i:i+e)}return o.join("")},c.cache={},c.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw"[sprintf] huh?";if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw"[sprintf] huh?";for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw"[sprintf] huh?";f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";d.push(c)}b=b.substring(c[0].length)}return d},c}(),T=function(a,b){return b.unshift(a),S.apply(null,b)};R("sprintf",function(a,b,c){return c.sprintf?"[object Array]"===Object.prototype.toString.apply(c.sprintf)?T(a,c.sprintf):"object"==typeof c.sprintf?S(a,c.sprintf):a:a});var U=function(a){function b(a){return[null,a]}var c=a||document;Array.prototype.forEach.call(c.querySelectorAll("[data-i18n]"),function(a){var c=a.getAttribute("data-i18n"),d=b(c),e=d[0],f=d[1],g=Autodesk.Viewing.i18n.translate(f);g?e?a.setAttribute(e,g):a.placeholder?a.placeholder=g:a.textContent=g:e?a.setAttribute(e,f):a.textContent=f})};Autodesk.Viewing.i18n.init=g,Autodesk.Viewing.i18n.setLng=n,Autodesk.Viewing.i18n.preload=h,Autodesk.Viewing.i18n.addResourceBundle=i,Autodesk.Viewing.i18n.removeResourceBundle=j,Autodesk.Viewing.i18n.loadNamespace=l,Autodesk.Viewing.i18n.loadNamespaces=m,Autodesk.Viewing.i18n.localize=U,Autodesk.Viewing.i18n.setDefaultNamespace=k,Autodesk.Viewing.i18n.t=u,Autodesk.Viewing.i18n.translate=u,Autodesk.Viewing.i18n.exists=t,Autodesk.Viewing.i18n.detectLanguage=N.detectLanguage,Autodesk.Viewing.i18n.pluralExtensions=P,Autodesk.Viewing.i18n.sync=O,Autodesk.Viewing.i18n.functions=N,Autodesk.Viewing.i18n.lng=o,Autodesk.Viewing.i18n.addPostProcessor=R,Autodesk.Viewing.i18n.options=J,Autodesk.Viewing.i18n.setDebugLocString=a,Autodesk.Viewing.i18n.clearDebugLocString=b}(),function(){"use strict";function a(a){this.parentDiv=a,this.container=document.createElement("div"),this.container.innerHTML=['<div class="path">','<svg width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">','<path d="M2.5,50a47.5,47.5 0 1,0 95,0a47.5,47.5 0 1,0 -95,0" vector-effect="non-scaling-stroke"/>','<path d="M 2.5 50 A 47.5 47.5 0 0 1 47.5 2.5" vector-effect="non-scaling-stroke"/>',"</svg>","</div>",'<div class="message" data-i18n="Spinner Loading">LOADING</div>'].join(""),this.container.className="loading-spinner"}Autodesk.Viewing,Autodesk.Viewing.UI;a.prototype.addClass=function(a){this.container.classList.add(a)},a.prototype.attachToDom=function(){return!this.container.parentNode&&(Autodesk.Viewing.i18n.localize(this.container),this.parentDiv.appendChild(this.container),!0)},a.prototype.removeFromDom=function(){return!!this.container.parentNode&&(this.container.parentNode.removeChild(this.container),!0)},a.prototype.setVisible=function(a){a?this.attachToDom():this.removeFromDom()},Autodesk.Viewing.UI.LoadingSpinner=a}(),function(){"use strict";var a=Autodesk.Viewing.UI,b=(Autodesk.Viewing,Autodesk.Viewing.Private),c=function(){};c.prototype.constructor=c,c.prototype.isTreeNodeGroup=function(a){throw"isTreeNodeGroup is not implemented."},c.prototype.getTreeNodeId=function(a){
throw"getTreeNodeId is not implemented."},c.prototype.getTreeNodeIndex=function(a){throw"getTreeNodeIndex is not implemented."},c.prototype.getTreeNodeParentId=function(a){throw"getTreeNodeParentId is not implemented."},c.prototype.getTreeNodeLabel=function(a){return a.name},c.prototype.getTreeNodeCount=function(){throw"getTreeNodeCount is not implemented."},c.prototype.shouldCreateTreeNode=function(a){return!0},c.prototype.forEachChild=function(a,b){for(var c=a.children?a.children.length:0,d=0;d<c;++d){b(a.children[d])}},c.prototype.createTreeNode=function(a,b,c){var d=document.createElement("label");b.appendChild(d);var e=this.getTreeNodeLabel(a);c&&c.localize&&(d.setAttribute("data-i18n",e),e=Autodesk.Viewing.i18n.translate(e)),d.textContent=e},c.prototype.onTreeNodeClick=function(a,b,c){},c.prototype.onTreeNodeIconClick=function(a,b,c){a.delegate().isTreeNodeGroup(b)&&a.setCollapsed(b,!a.isCollapsed(b))},c.prototype.onTreeNodeDoubleClick=function(a,b,c){},c.prototype.onTreeNodeRightClick=function(a,b,c){},c.prototype.onTreeNodeReized=function(a){},c.prototype.getTreeNodeClass=function(a){return""},c.prototype.getTreeNodeParentMaxSize=function(a){return{width:0,height:0}},c.prototype.getTreeNodeClientHeight=function(a){return 0},c.prototype.getTreeNodeDepthOffset=function(a,b){return 0},c.prototype.onTreeNodeHover=function(a,b,c){},b.TreeDelegate=a.TreeDelegate=c}(),function(){"use strict";var a=Autodesk.Viewing.UI,b=Autodesk.Viewing,c=Autodesk.Viewing.Private,d=function(a,b,c,d){this.myDelegate=a,this.mySelectedNodes=[],this.myOptions=d||{};this.myGroupNodes=[],this.nodeToElement={},this.nodeIdToNode={};var e=this.myRootContainer=this.createHtmlElement_(c,"div","treeview"),f=this.rootElem=this.createElement_(b,e,d,0);this.setInputHandlers_(),d&&d.excludeRoot&&f.classList.add("exclude")};d.prototype.constructor=d,d.prototype.show=function(a){var b=this.myRootContainer;b.style.display=a?"block":"none"},d.prototype.getRootContainer=function(){return this.myRootContainer},d.prototype.getElementForNode=function(a){return"number"!=typeof a&&"string"!=typeof a&&(a=this.myDelegate.getTreeNodeId(a)),this.nodeToElement[a]},d.prototype.delegate=function(){return this.myDelegate},d.prototype.isCollapsed=function(a){return this.hasClass(a,"collapsed")},d.prototype.setCollapsed=function(a,b,c){b?(this.addClass(a,"collapsed",c),this.removeClass(a,"expanded",c)):(this.addClass(a,"expanded",c),this.removeClass(a,"collapsed",c))},d.prototype.setAllCollapsed=function(a){var b,c;a?(b=function(a){return a.classList.contains("expanded")},c=function(a){a.classList.add("collapsed"),a.classList.remove("expanded")}):(b=function(a){return a.classList.contains("collapsed")},c=function(a){a.classList.add("expanded"),a.classList.remove("collapsed")});for(var d=0;d<this.myGroupNodes.length;++d){var e=this.myGroupNodes[d];b(e)&&c(e)}},d.prototype.addToSelection=function(a){for(var b=this,c=a.length,d=0;d<c;++d){var e=a[d];(function(a){return-1===b.mySelectedNodes.indexOf(a)&&(b.mySelectedNodes.push(a),!0)})(e)&&this.addClass(e,"selected")}},d.prototype.removeFromSelection=function(a){for(var b=this,c=a.length-1;c>=0;--c){var d=a[c];(function(a){var c=b.mySelectedNodes.indexOf(a);return-1!==c&&(b.mySelectedNodes.splice(c,1),!0)})(d)&&this.removeClass(d,"selected")}},d.prototype.setSelection=function(a){return this.removeFromSelection(this.mySelectedNodes),this.addToSelection(a),this.mySelectedNodes},d.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedNodes)},d.prototype.isSelected=function(a){return this.hasClass(a,"selected")},d.prototype.scrollTo=function(a){var b=this.getElementForNode(a);if(b){var c=b.offsetTop;for(b=b.parentNode;b&&b!=this.myRootContainer;)c+=b.offsetTop,b=b.parentNode;this.myRootContainer.parentNode.scrollTop=c}},d.prototype.addClass=function(a,b,c){var d=this.getElementForNode(a);if(d){if(c){d=d.parentNode;for(var e=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;d&&d!==e;)d.classList.add(b),d=d.parentNode}else d.classList.add(b);return!0}return!1},d.prototype.removeClass=function(a,b,c){var d=this.getElementForNode(a);if(d){if(c){d=d.parentNode;for(var e=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;d&&d!==e;)d.classList.remove(b),d=d.parentNode}else d.classList.remove(b);return!0}return!1},d.prototype.hasClass=function(a,b){return this.getElementForNode(a).classList.contains(b)},d.prototype.clear=function(){for(var a=this.myRootContainer;a.hasChildNodes();)a.removeChild(a.lastChild);this.nodeToElement={},this.nodeIdToNode={}},d.prototype.createElement_=function(a,b,c,d){function e(b,d,e,f){var h=g.createHtmlElement_(b,d,e),i=g.myDelegate.getTreeNodeId(f);h.setAttribute("lmv-nodeId",i);var j=g.createHtmlElement_(h,"lmvheader"),k=g.createHtmlElement_(j,"icon");return k.addEventListener("mousedown",function(a){a.stopPropagation(),a.preventDefault()},!1),k.addEventListener("click",function(b){g.myDelegate.onTreeNodeIconClick(g,a,b),b.stopPropagation(),b.preventDefault()},!1),g.myDelegate.createTreeNode(a,j,c),h}if(void 0===a||null===a)return null;if(!this.myDelegate.shouldCreateTreeNode(a))return null;var f,g=this,h=this.myDelegate.getTreeNodeId(a);if(g.myDelegate.isTreeNodeGroup(a)){f=e(b,"group","expanded",a),g.nodeToElement[h]=f,g.nodeIdToNode[h]=a;var i=g.myOptions.excludeRoot?1:0;d==i&&(f.style.left="0px"),g.myGroupNodes.push(f),g.myDelegate.forEachChild(a,function(a){g.createElement_(a,f,c,d+1)})}else{f=e(b,"leaf","expanded",a),g.nodeToElement[h]=f,g.nodeIdToNode[h]=a;var i=g.myOptions.excludeRoot?1:0;d==i&&(f.style.marginLeft="0px")}var j=g.myDelegate.getTreeNodeClass(a);return j&&f.classList.add(j),f},d.prototype.setInputHandlers_=function(){var a=this,c=this.myRootContainer,d=function(b){var d=null,e=!1;do{b&&b!==c?b.hasAttribute("lmv-nodeId")?(d=b,e=!0):b=b.parentElement:(d=null,e=!0)}while(!e);if(d){var f=d.getAttribute("lmv-nodeId");return a.nodeIdToNode[f]||null}return null};b.isTouchDevice()&&(this.hammer=new Hammer.Manager(c,{recognizers:[b.GestureRecognizers.doubletap,b.GestureRecognizers.press],inputClass:b.isIE11?Hammer.PointerEventInput:Hammer.TouchInput}),this.hammer.on("doubletap",function(b){var c=d(b.target);null!==c&&a.myDelegate.onTreeNodeDoubleClick(a,c,b)}),this.hammer.on("press",function(b){var c=d(b.target);null!==c&&a.myDelegate.onTreeNodeRightClick(a,c,b)})),c.addEventListener("click",function(b){var c=d(b.target);null!==c&&(a.myDelegate.onTreeNodeClick(a,c,b),b.stopPropagation(),b.target.classList.contains("propertyLink")||b.preventDefault())},!1),c.addEventListener("dblclick",function(b){var c=d(b.target);null!==c&&(a.myDelegate.onTreeNodeDoubleClick(a,c,b),b.stopPropagation(),b.preventDefault())},!1),c.addEventListener("contextmenu",function(b){var c=d(b.target);null!==c&&(a.myDelegate.onTreeNodeRightClick(a,c,b),b.stopPropagation(),b.preventDefault())},!1),c.addEventListener("mouseover",function(b){var c=d(b.target);null!==c&&(a.myDelegate.onTreeNodeHover(a,c,b),b.stopPropagation(),b.preventDefault())},!1),c.addEventListener("mouseout",function(b){var c=b.toElement||b.relatedTarget;if(d(b.target)!=d(c)){a.myDelegate.onTreeNodeHover(a,-1,b),b.stopPropagation(),b.preventDefault()}},!1)},d.prototype.createHtmlElement_=function(a,b,c){var d=document.createElement(b);return a.appendChild(d),c&&(d.className=c),d},d.prototype.iterate=function(a,b){if(void 0!==a&&null!==a&&this.myDelegate.shouldCreateTreeNode(a)){var c=this.getElementForNode(a);if(c){b(a,c);var d=this;this.myDelegate.forEachChild(a,function(a){d.iterate(a,b)})}}},c.Tree=a.Tree=d}(),function(){"use strict";function a(a,b){this.dirty=!1,this.nextFrameId=0,this.scrollY=0,this.delegates=[],this.idToDelegate={},this.options=b,this.rootContainer=document.createElement("div"),this.rootContainer.classList.add("docking-panel-container-gradient"),this.rootContainer.classList.add("treeview"),this.rootContainer.classList.add("on-demand"),a.appendChild(this.rootContainer),this.paddingDiv=document.createElement("div"),this.paddingDiv.style.border=0,this.paddingDiv.style.margin=0,this.paddingDiv.style.padding=0,this.sizedDiv=a.parentNode,this.nodeCssTable=[[],["group"],["leaf"]],this.cssStringToNodeCssTable={"":0,group:1,leaf:2},this.nodeIndexToNodeCssTables={};for(var c=[],d=x,e=0;e<d;++e){var f=m();c[e]=f}this.elementsPool=c,this.elementsUsed=0,this.spinner=new v.LoadingSpinner(a),this.spinner.addClass("tree-loading-spinner");var h=u.isTouchDevice();h&&(this.hammer=new Hammer.Manager(this.rootContainer,{recognizers:[u.GestureRecognizers.doubletap,u.GestureRecognizers.press],inputClass:u.isIE11?Hammer.PointerEventInput:Hammer.TouchInput}));for(var e=0;e<d;++e){var f=c[e];h&&(this.hammer.on("doubletap",n.bind(this)),this.hammer.on("press",o.bind(this))),f.addEventListener("click",p.bind(this)),f.addEventListener("dblclick",q.bind(this)),f.addEventListener("contextmenu",r.bind(this)),f.icon.addEventListener("click",s.bind(this)),f.icon.addEventListener("mousedown",t.bind(this))}g(this)}function b(a){return{width:0|a.sizedDiv.clientWidth,height:0|a.sizedDiv.clientHeight}}function c(a){return a.dirty=!1,f(a),0===a.delegates.length?void a.spinner.setVisible(!1):1===a.delegates.length&&a.delegates[0].isLoading()?void a.spinner.setVisible(!0):1===a.delegates.length&&a.delegates[0].isNotAvailable()?(a.spinner.setVisible(!1),void a.displayNoProperties(!0)):(a.spinner.setVisible(!1),a.displayNoProperties(!1),void d(a))}function d(a){var c=a.rootContainer,d=b(a),f=d.height,g=0,h=0,i=!0;c.appendChild(a.paddingDiv);for(var j=a.delegates.slice(0),l=a.isExcludeRoot();j.length;){var m=j.shift(),n=m.modelDiv;c.appendChild(n);for(var o=[m.getRootId()],p={curr:l?-1:0,popIds:[]};o.length&&i;){if(g>a.scrollY+f+y){i=!1;break}if(a.elementsUsed===a.elementsPool.length){i=!1;break}var q=o.shift(),r=-1===p.curr?0:m.getTreeNodeClientHeight(q),s=g,t=s+r;if(r>0&&t+y>=a.scrollY){var u=a.elementsPool[a.elementsUsed++];u.setAttribute("lmv-nodeId",q),m.createTreeNode(q,u.header);var v=m.getTreeNodeClass(q);v&&u.classList.add(v);var w=k(a,m,q);if(w)for(var x=w.length,z=0;z<x;++z)u.classList.add(w[z]);var A=m.getTreeNodeDepthOffset(q,p.curr);u.header.style.paddingLeft=A+"px",n.appendChild(u)}t+y<a.scrollY&&(h=t),g=t;var B=e(a,m,q);if(B&&B.length>0){p.curr++;for(var C=B[B.length-1],D=p.popIds.length-1;D>=0&&p.popIds[D]===q;)p.popIds[D--]=C;p.popIds.push(C),o=B.concat(o)}for(;p.popIds.length>0&&q===p.popIds[p.popIds.length-1];)p.popIds.pop(),p.curr--}for(a.paddingDiv.style.height=h+"px";o.length;){var q=o.shift(),r=-1===p.curr?0:m.getTreeNodeClientHeight(q),s=g,t=s+r;g=t;var B=e(a,m,q);B&&B.length&&(o=B.concat(o))}}c.style.height=g+"px"}function e(a,b,c){if(!b.isTreeNodeGroup(c))return null;if(a.isCollapsed(b,c))return null;var d=[];return b.forEachChild(c,function(a){d.push(a)}),d}function f(a){for(var b=a.elementsUsed,c=a.elementsPool,d=0;d<b;++d){var e=c[d];e.setAttribute("lmv-nodeId",""),e.className="";for(var f=e.header,g=f.childNodes.length-1,h=0;h<g;++h)f.removeChild(f.lastChild)}a.clear()}function g(a,b){a.dirty&&!b||(b?c(a):(a.dirty=!0,a.nextFrameId=requestAnimationFrame(function(){c(a)})))}function h(a,b){return"number"!=typeof b&&"string"!=typeof b?a.threeDelegate.getTreeNodeId(0|b):b}function i(a,b){for(var c=null;b&&b!==a.rootContainer;){if(b.hasAttribute("lmv-nodeId")){c=b;break}b=b.parentElement}if(!c)return null;var d=c.getAttribute("lmv-nodeId");return parseFloat(d)}function j(a,b){for(var c=null;b&&b!==a.rootContainer;){if(b.hasAttribute("lmv-modelId")){c=b;break}b=b.parentElement}if(!c)return null;var d=c.getAttribute("lmv-modelId");return parseInt(d)}function k(a,b,c){if(b.isControlId(c))return b.getControlIdCss(c);var d=b.getTreeNodeIndex(c);return a.nodeCssTable[a.nodeIndexToNodeCssTables[b.model.id][d]]}function l(a,b,c,d){var e=d.join(" "),f=a.cssStringToNodeCssTable[e]||a.nodeCssTable.length;f===a.nodeCssTable.length&&(a.nodeCssTable.push(d),a.cssStringToNodeCssTable[e]=f);var g=b.getTreeNodeIndex(c);a.nodeIndexToNodeCssTables[b.model.id][g]=f}function m(a,b){var c=document.createElement("lmvheader"),d=document.createElement("icon");c.appendChild(d);var e=document.createElement("div");return e.header=c,e.icon=d,e.appendChild(c),e}function n(a){var b=i(this,a.target);if(b){var c=j(this,a.target),d=this.getDelegate(c);d&&d.onTreeNodeDoubleClick(this,b,a)}}function o(a){var b=i(this,a.target);if(b){var c=j(this,a.target),d=this.getDelegate(c);d&&d.onTreeNodeRightClick(this,b,a)}}function p(a){if(!a.target.classList.contains("group")&&!a.target.classList.contains("leaf")){var b=i(this,a.target);if(b){var c=j(this,a.target),d=this.getDelegate(c);d&&(d.onTreeNodeClick(this,b,a),a.stopPropagation(),a.preventDefault())}}}function q(a){if(!a.target.classList.contains("group")&&!a.target.classList.contains("leaf")){var b=i(this,a.target);if(b){var c=j(this,a.target),d=this.getDelegate(c);d&&(d.onTreeNodeDoubleClick(this,b,a),a.stopPropagation(),a.preventDefault())}}}function r(a){if(!a.target.classList.contains("group")&&!a.target.classList.contains("leaf")){var b=i(this,a.target);if(b){var c=j(this,a.target),d=this.getDelegate(c);d&&(d.onTreeNodeRightClick(this,b,a),a.stopPropagation(),a.preventDefault())}}}function s(a){var b=i(this,a.target);if(b){var c=j(this,a.target),d=this.getDelegate(c);d&&(d.onTreeNodeIconClick(this,b,a),a.stopPropagation(),a.preventDefault())}}function t(a){a.stopPropagation(),a.preventDefault()}var u=Autodesk.Viewing,v=Autodesk.Viewing.UI,w=Autodesk.Viewing.Private,x=150,y=300,z=a.prototype;z.constructor=a,z.pushDelegate=function(a){this.delegates.push(a),this.idToDelegate[a.model.id]=a,g(this)},z.removeDelegate=function(a){for(var b=0;b<this.delegates.length;++b){if(this.delegates[b].model.id===a)return this.delegates.splice(b,1),delete this.idToDelegate[a],delete this.nodeIndexToNodeCssTables[a],void g(this)}},z.setInstanceTree=function(a,b){if(a.setInstanceTree(b),g(this),b){var c=new Uint8Array(a.getTreeNodeCount()),d=function(b){var e=a.getTreeNodeIndex(b);return c[e]=a.isTreeNodeGroup(b)?1:2,a.forEachChild(b,d),!0},e=a.instanceTree.getRootId();d(e);var f=a.model.id;this.nodeIndexToNodeCssTables[f]=c;var h=0,i=0;b.enumNodeChildren(e,function(a){i||(h=a),i++}),this.setAllCollapsed(a,!0);var j=this.options.excludeRoot,k=this.options.startCollapsed;j?(this.setCollapsed(a,e,!1),k||this.setCollapsed(a,h,!1)):k||this.setCollapsed(a,e,!1),g(this,!0)}},z.show=function(a){this.rootContainer.style.display=block},z.getRootContainer=function(){return this.rootContainer},z.getDelegate=function(a){return this.idToDelegate[parseInt(a)]},z.isCollapsed=function(a,b){var c=k(this,a,b);return c&&-1!==c.indexOf("collapsed")},z.setCollapsed=function(a,b,c,d){c?(this.addClass(a,b,"collapsed",d),this.removeClass(a,b,"expanded",d)):(this.addClass(a,b,"expanded",d),this.removeClass(a,b,"collapsed",d))},z.setAllCollapsed=function(a,b){var c=function(b){this.addClass(a,b,"collapsed",!1),this.removeClass(a,b,"expanded",!1)}.bind(b?this:this),d=a.instanceTree.getRootId();this.iterate(a,d,function(b){return a.isTreeNodeGroup(b)&&c(b),!0})},z.addToSelection=function(a,b){for(var c=b.length,d=0;d<c;++d)this.addClass(a,b[d],"selected",!1);g(this)},z.removeFromSelection=function(a,b){for(var c=b.length,d=0;d<c;++d)this.removeClass(a,b[d],"selected",!1);g(this)},z.setSelection=function(a,b){return this.clearSelection(a),this.addToSelection(a,b),this.selectedNodes},z.clearSelection=function(a){var b=[],c=function(d){var e=k(this,a,d);return e&&-1!==e.indexOf("selected")&&(b[0]=d,this.removeFromSelection(a,b)),a.forEachChild(d,c),!0}.bind(this),d=a.instanceTree.getRootId();c(d)},z.isSelected=function(a){var b=k(this,delegate,a);return b&&-1!==b.indexOf("selected")},z.scrollTo=function(a,b){var c=this.getDelegate(b.id),d=!1,e=[],f=function(b,c){if(!(d=d||a===b)){e.push(c.getTreeNodeClientHeight(b));var g=e.length,h=c.isTreeNodeGroup(b)&&-1!==k(this,c,b).indexOf("expanded");c.forEachChild(b,function(a){f(a,c)}),h||d||e.length>g&&e.splice(g)}}.bind(this);this.setCollapsed(c,a,!1,!0);var h=c.getRootId();if(f(h,c),!d)return-1;for(var i=0,j=e.length,l=this.isExcludeRoot()?1:0;l<j;++l)i+=e[l];if(1===this.delegates.length)return g(this,!0),i;for(var l=0;l<this.delegates.length;++l){var m=this.delegates[l];if(m===c)break;e=[],a=-1,d=!1,h=m.getRootId(),f(h,m),j=e.length;for(var n=0,o=0;o<j;++o)n+=e[o];i+=n}return g(this,!0),i},z.addClass=function(a,b,c,d){function e(b,c,d){var e=k(b,a,c);if(e){-1===e.indexOf(d)&&(e=e.slice(0),e.push(d),e.sort(),l(b,a,c,e))}}if(d)for(var f=a.getTreeNodeParentId(h(this,b));f;)e(this,f,c),f=a.getTreeNodeParentId(f);else e(this,b,c);return g(this),!0},z.removeClass=function(a,b,c,d){function e(b,c,d){var e=k(b,a,c);if(e){var f=e.indexOf(d);-1!==f&&(e=e.slice(0),e.splice(f,1),l(b,a,c,e))}}if(d)for(var f=a.getTreeNodeParentId(h(this,b));f;)e(this,f,c),f=a.getTreeNodeParentId(f);else e(this,b,c);return g(this),!0},z.hasClass=function(a,b){return 1!==k(this,delegate,a).indexOf(b)},z.clear=function(){for(var a,b=this.rootContainer;a=b.lastChild;)b.removeChild(a);for(var c=0;c<this.delegates.length;++c)this.delegates[c].clean();this.elementsUsed=0},z.iterate=function(a,b,c){void 0!==b&&null!==b&&a.shouldCreateTreeNode(b)&&c(b)&&a.forEachChild(b,function(b){this.iterate(a,b,c)}.bind(this))},z.forEachDelegate=function(a){for(var b=0;b<this.delegates.length;++b)a(this.delegates[b])},z.destroy=function(){this.clear(),cancelAnimationFrame(this.nextFrameId),this.rootContainer.parentNode.removeChild(this.rootContainer),this.rootContainer=null,this.rootId=-1,this.nodeCssTable=null,this.nodeIndexToNodeCssTables=null,this.cssStringToNodeCssTable=null,this.elementsPool=null,this.elementsUsed=-1,this.scrollY=-1,this.hammer&&(this.hammer.destroy(),this.hammer=null)},z.setScroll=function(a){Math.abs(this.scrollY-a)>y&&(this.scrollY=a,g(this))},z.displayNoProperties=function(a){if(a){if(!this.divNoProps){this.divNoProps=document.createElement("div");var b="Model Browser is not available.";this.divNoProps.innerText=Autodesk.Viewing.i18n.translate(b),this.divNoProps.setAttribute("data-i18n",b),this.divNoProps.classList.add("lmv-no-properties")}if(!this.divNoProps.parentNode){this.rootContainer.parentNode.appendChild(this.divNoProps)}}else this.divNoProps&&this.divNoProps.parentNode&&this.divNoProps.parentNode.removeChild(this.divNoProps)},z.isExcludeRoot=function(){return 1===this.delegates.length&&this.options.excludeRoot},z.getDelegateCount=function(){return this.delegates.length},w.TreeOnDemand=v.TreeOnDemand=a}(),function(){"use strict";var a=(Autodesk.Viewing.UI,function(a,b,c,d){this.kMinWdth=100,this.kMinHeight=100,this.visibilityCallbacks=[],this.movedSinceLastClick=!1,this.parentContainer=a,this.container=document.createElement("div"),this.container.id=b,this.container.lastWidth="",this.container.dockRight=!1,this.container.dockBottom=!1,this.titleLabel=c,d=d||{},d.hasOwnProperty("localizeTitle")||(d.localizeTitle=!0),d.hasOwnProperty("addFooter")||(d.addFooter=!0),this.options=d,this.container.classList.add("docking-panel"),a.appendChild(this.container),this.listeners=[],this.initialize(),this.setVisible(!1)});a.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id),this.container.appendChild(this.title),this.initializeMoveHandlers(this.title),this.setTitle(this.titleLabel||this.container.id,this.options),this.closer=this.createCloseButton(),this.container.appendChild(this.closer),this.options.addFooter&&(this.footer=this.createFooter(),this.container.appendChild(this.footer))},a.prototype.uninitialize=function(){for(var a=0;a<this.listeners.length;++a){var b=this.listeners[a];b.target.removeEventListener(b.eventId,b.callback)}this.listeners=[],this.visibilityCallbacks=[],this.parentContainer.removeChild(this.container),this.parentContainer=null,this.container=null,this.title=null,this.closer=null},a.prototype.addVisibilityListener=function(a){this.visibilityCallbacks.push(a)},a.prototype.setVisible=function(a){if(a){var b=this.getContainerBoundingRect();if(this.container.dockRight){var c=b.width,d=300,e=this.container.lastWidth||this.container.style.width;e||(e=this.container.getBoundingClientRect().width),e&&(d=parseInt(e)),this.container.style.left=c-d+"px"}if(this.container.dockBottom){var f=b.height,g=300,h=this.container.lastHeight||this.container.style.height;h||(h=this.container.getBoundingClientRect().height),h&&(g=parseInt(h));var i=f-g;this.container.style.top=i>0?i+"px":0}this.container.style.maxHeight=b.height+"px",this.container.style.maxWidth=b.width+"px",this.container.style.display="block"}else this.container.lastWidth=this.container.style.width,this.container.lastHeight=this.container.style.height,this.container.style.display="none";for(var j=0;j<this.visibilityCallbacks.length;j++)this.visibilityCallbacks[j](a)},a.prototype.isVisible=function(){return"block"===this.container.style.display},a.prototype.visibilityChanged=function(){},a.prototype.initializeMoveHandlers=function(a){function b(a){var b=m.style.minWidth?parseInt(m.style.minWidth):n.kMinWdth,c=m.style.minHeight?parseInt(m.style.minHeight):n.kMinHeight,d=n.getContainerBoundingRect();m.style.maxWidth&&parseInt(m.style.width)>parseInt(m.style.maxWidth)&&(m.style.width=m.style.maxWidth),m.style.maxHeight&&parseInt(m.style.height)>parseInt(m.style.maxHeight)&&(m.style.height=m.style.maxHeight),parseInt(m.style.width)<b&&(m.style.width=b+"px"),parseInt(m.style.height)<c&&(m.style.height=c+"px"),"touchmove"===a.type&&(a.screenX=a.touches[0].screenX,a.screenY=a.touches[0].screenY),k+=a.screenX-g,l+=a.screenY-h,e=i+k,f=j+l;var o=parseInt(m.style.width),p=parseInt(m.style.height);isNaN(o)&&(o=n.container.getBoundingClientRect().width),isNaN(p)&&(p=n.container.getBoundingClientRect().height),e<5&&(e=0),f<5&&(f=0),m.dockRight=!1,m.dockBottom=!1,d.width-5<e+o&&(e=d.width-o,m.dockRight=!0),d.height-5<f+p&&(f=d.height-p,m.dockBottom=!0),m.style.left=e+"px",m.style.top=f+"px",m.style.maxWidth=d.width-e+"px",m.style.maxHeight=d.height-f+"px",g=a.screenX,h=a.screenY,n.onMove(a,e,f)}function c(a){window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",c),window.removeEventListener("touchmove",b),window.removeEventListener("touchend",c),n.onEndMove(a,e,f)}function d(a){"touchstart"===a.type&&(a.screenX=a.touches[0].screenX,a.screenY=a.touches[0].screenY),g=a.screenX,h=a.screenY,k=0,l=0,i=n.container.offsetLeft,j=n.container.offsetTop,window.addEventListener("mousemove",b,!1),window.addEventListener("mouseup",c,!1),window.addEventListener("touchmove",b,!1),window.addEventListener("touchend",c,!1),a.preventDefault(),n.onStartMove(a,i,j)}var e,f,g,h,i,j,k,l,m=this.container,n=this;n.addEventListener(a,"mousedown",d),n.addEventListener(a,"touchstart",d)},a.prototype.initializeCloseHandler=function(a){var b=this;b.addEventListener(a,"click",function(a){b.setVisible(!1)},!1)},a.prototype.createScrollContainer=function(a){var b=document.createElement("div"),c=b.classList;return c.add("docking-panel-scroll"),c.add("docking-panel-container-solid-color-a"),c.add(a&&a.left?"left":"right"),a&&a.heightAdjustment&&(b.style.height="calc(100% - "+a.heightAdjustment+"px)"),a&&a.marginTop&&(b.style.marginTop=a.marginTop+"px"),b.id=this.container.id+"-scroll-container",this.container.appendChild(b),this.scrollContainer=b,this.scrollEaseCurve=a&&a.scrollEaseCurve||[0,0,.29,1],this.scrollEaseSpeed=a&&a.scrollEaseSpeed||.003,b},a.prototype.createTitleBar=function(a){var b=document.createElement("div");b.classList.add("docking-panel-title"),b.textContent=a;var c=this;return c.addEventListener(b,"click",function(a){c.movedSinceLastClick||c.onTitleClick(a),c.movedSinceLastClick=!1}),c.addEventListener(b,"dblclick",function(a){c.onTitleDoubleClick(a)}),b},a.prototype.createFooter=function(){var a=new avp.ResizeFooter(this.container);return this.container.style.resize="none",a.footer},a.prototype.setTitle=function(a,b){b&&b.localizeTitle?(this.title.setAttribute("data-i18n",a),a=Autodesk.Viewing.i18n.translate(a)):this.title.removeAttribute("data-i18n"),this.title.textContent=a},a.prototype.createCloseButton=function(){var a=document.createElement("div");return a.className="docking-panel-close",this.initializeCloseHandler(a),a},a.prototype.onStartMove=function(a,b,c){},a.prototype.onEndMove=function(a,b,c){},a.prototype.onMove=function(a,b,c){this.movedSinceLastClick=!0},a.prototype.onTitleClick=function(a){},a.prototype.onTitleDoubleClick=function(a){},a.prototype.addEventListener=function(a,b,c){a.addEventListener(b,c),this.listeners.push({target:a,eventId:b,callback:c})},a.prototype.removeEventListener=function(a,b,c){for(var d=0;d<this.listeners.length;++d){var e=this.listeners[d];if(e.target===a&&e.eventId===b&&e.callback===c)return a.removeEventListener(b,c),this.listeners.splice(d,1),!0}return!1},a.prototype.getContentSize=function(){return{height:this.container.clientHeight,width:this.container.clientWidth}},a.prototype.resizeToContent=function(a){if(this.isVisible()){var b=this.getContentSize(),c=b.height,d=this.container.getBoundingClientRect(),e=this.getContainerBoundingRect(),f=this.container.querySelector(".docking-panel-footer");f&&(c+=f.getBoundingClientRect().height);var g=e.height;g-=d.top-e.top+75,a&&void 0!==a.maxHeight&&(g=Math.min(g,a.maxHeight)),c>g&&(c=g),this.container.style.maxHeight=g.toString()+"px",this.container.style.height=c.toString()+"px"}},a.prototype.getContainerBoundingRect=function(){return this.parentContainer.getBoundingClientRect()},a.prototype.animateScroll=function(a,b,c){function d(a,b){var c=3*a[1],d=3*(a[3]-a[1])-c;return(((1-c-d)*b+d)*b+c)*b}function e(j){var k=(j-i)*g;k=Math.min(k,1);var l=d(f,k),m=a+(b-a)*l;h.scrollTop=m,c&&c(m),k<1&&requestAnimationFrame(e)}var f=this.scrollEaseCurve,g=this.scrollEaseSpeed,h=this.scrollContainer,i=performance.now();requestAnimationFrame(e)},Autodesk.Viewing.UI.DockingPanel=a}(),function(){"use strict";function a(a){var b=a.instanceTree;if(b){var c,d=a.rootId,e=b.getNodeName(d),f=0,g=0;b.enumNodeChildren(d,function(a){g||(c=b.getNodeName(a),f=a),g++}),a.hasDoubleRoot=1===g&&e===c,a.rootId=a.hasDoubleRoot?f:d}}function b(a){var b=a.getData();if(!b)return"";var c=b.urn;try{c=atob(b.urn)}catch(a){}var d=c.lastIndexOf("/");return-1===d?c:(c=c.substr(d+1),d=c.indexOf("?"),-1!==d&&(c=c.substr(0,d)),c)}function c(a){var b=a.getData();return b&&b.loadOptions&&b.loadOptions.modelNameOverride?b.loadOptions.modelNameOverride:""}var d=Autodesk.Viewing.UI,e=Autodesk.Viewing,f=Autodesk.Viewing.Private,g=function(a,b){d.TreeDelegate.call(),this.panel=a,this.model=b,this.modelDiv=document.createElement("div"),this.modelDiv.classList.add("model-div"),this.modelDiv.setAttribute("lmv-modelId",b.id),this.instanceTree=null,this.rootId=-1,this.state=1};g.prototype=Object.create(d.TreeDelegate.prototype),g.prototype.constructor=g,g.prototype.isLoading=function(){return 1===this.state},g.prototype.isAvailable=function(){return 2===this.state},g.prototype.isNotAvailable=function(){return 3===this.state},g.prototype.isControlId=function(a){return-1===a||-2===a},g.prototype.getControlIdCss=function(a){return null},g.prototype.getRootId=function(){return this.rootId},g.prototype.getTreeNodeId=function(a){return"object"==typeof a?(f.logger.warn("Object used instead of dbId. Fix it."),a.dbId):a},g.prototype.getTreeNodeIndex=function(a){return this.instanceTree.nodeAccess.dbIdToIndex[a]},g.prototype.getTreeNodeLabel=function(a){if(-1===a){var d=c(this.model);return d||(d=b(this.model)),e.i18n.translate("Loading model",{name:d})}if(-2===a){var d=c(this.model);return d||(d=b(this.model)),d}if(a===this.getRootId()){var d=c(this.model);if(d)return d}return-1e10==a?"Object 0":this.instanceTree.getNodeName(a)||"Object "+a},g.prototype.getTreeNodeClass=function(a){return-1===a||-2===a?"message-unexpected":""},g.prototype.getTreeNodeParentId=function(a){return this.instanceTree.nodeAccess.getParentId(a)},g.prototype.getTreeNodeCount=function(){return this.instanceTree.nodeAccess.getNumNodes()},g.prototype.getTreeNodeClientHeight=function(a){return 36},g.prototype.getTreeNodeDepthOffset=function(a,b){return 13+25*b},g.prototype.isTreeNodeGroup=function(a){return!this.isControlId(a)&&this.instanceTree.getChildCount(a)>0},g.prototype.shouldCreateTreeNode=function(a){return!0},g.prototype.createTreeNode=function(a,b){if(b.addEventListener("mousedown",function(){var a=function(){this.classList.remove("highlight"),document.removeEventListener("mouseup",a)}.bind(b);b.classList.add("highlight"),document.addEventListener("mouseup",a)}),!this.isControlId(a)){var c=document.createElement("div");c.dbId=a,c.classList.add("visibility"),c.addEventListener("mousedown",function(a){a.preventDefault(),a.stopPropagation()}),c.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation();var b=parseInt(a.target.dbId);this.panel.onEyeIcon(b,this.model)}.bind(this)),b.appendChild(c)}if(-1===a){var e=document.createElement("img");e.src=f.getResourceUrl("res/ui/spinner.png"),e.style.animation="lmv-spinner-perpetual-motion 1s infinite linear",e.style.float="right",e.style.marginRight="5px",e.style.width="20px",b.appendChild(e)}var g={localize:-1===a||-2===a};d.TreeDelegate.prototype.createTreeNode.call(this,a,b,g)},g.prototype.onTreeNodeRightClick=function(a,b,c){this.isControlId(b)||this.panel.onTreeNodeRightClick(a,b,this.model,c)},g.prototype.onTreeNodeClick=function(a,b,c){this.isControlId(b)||this.panel.onTreeNodeClick(a,b,this.model,c)},g.prototype.onTreeNodeDoubleClick=function(a,b,c){},g.prototype.onTreeNodeIconClick=function(a,b,c){if(this.isTreeNodeGroup(b)){var d=a.isCollapsed(this,b);a.setCollapsed(this,b,!d)}},g.prototype.onTreeNodeReized=function(a){},g.prototype.forEachChild=function(a,b){this.isControlId(a)||this.instanceTree.enumNodeChildren(a,b)},g.prototype.setInstanceTree=function(b){this.instanceTree=b,this.state=b?2:3,this.rootId=b?b.getRootId():-2,a(this)},g.prototype.clean=function(){for(var a,b=this.modelDiv;a=b.lastChild;)b.removeChild(a)},d.ModelStructureTreeDelegate=g}(),function(){"use strict";var a=Autodesk.Viewing.UI,b=(Autodesk.Viewing.Private,function(b,c,d,e){a.DockingPanel.call(this,b,c,d,e),this.container.classList.add("model-structure-panel"),e=e||{},e.heightAdjustment||(e.heightAdjustment=40),e.marginTop||(e.marginTop=0),e.left=!0,this.createScrollContainer(e),this.onScroll=this.onScroll.bind(this),this.scrollContainer.addEventListener("scroll",this.onScroll),this.scrollContainer.style["overflow-x"]="hidden",this.options=e,this.tree=null,this._pendingModels=[],this.uiCreated=!1;var f=this;this.addVisibilityListener(function(a){a&&(f.uiCreated||f.createUI(),f.resizeToContent())})});b.prototype=Object.create(a.DockingPanel.prototype),b.prototype.constructor=b,b.prototype.uninitialize=function(b){this.scrollContainer.addEventListener("scroll",this.onScroll),this.scrollContainer.parentNode.removeChild(this.scrollContainer),a.DockingPanel.prototype.uninitialize.call(this)},b.prototype.addModel=function(a){a&&(this.uiCreated?this.createTreeUI(a):this._pendingModels.push(a))},b.prototype.unloadModel=function(a){if(a)if(this.uiCreated)this.removeTreeUI(a);else{var b=this._pendingModels.indexOf(a);if(-1===b)return;this._pendingModels.splice(b,1)}},b.prototype.createUI=function(){if(!this.uiCreated){var b="",c=!0;if(this.options&&this.options.defaultTitle?(b=this.options.defaultTitle,c=!!this.options.localizeTitle):(b=this.modelTitle,c=!1),b||(b="Browser"),this.setTitle(b,{localizeTitle:c}),this.uiCreated=!0,this.tree=new a.TreeOnDemand(this.scrollContainer,this.options),0!==this._pendingModels.length){for(var d=0;d<this._pendingModels.length;++d)this.createTreeUI(this._pendingModels[d]);this._pendingModels=[]}}},b.prototype.createTreeUI=function(b){var c=new a.ModelStructureTreeDelegate(this,b);this.tree.pushDelegate(c);var d=this;b.getObjectTree(function(a){d.setInstanceTree(c,a)},function(){d.setInstanceTree(c,null)})},b.prototype.setInstanceTree=function(a,b){this.tree.setInstanceTree(a,b)},
b.prototype.removeTreeUI=function(a){this.tree.removeDelegate(a.id),this.scrollContainer.scrollTop=0,this.onScroll()},b.prototype.onScroll=function(a){this.tree.setScroll(this.scrollContainer.scrollTop)},b.prototype.getNodeLabel=function(a){return this.myDelegate.getNodeLabel(a)},b.prototype.onTreeNodeClick=function(a,b,c,d){throw new Error("Method must be overriden.")},b.prototype.onTreeNodeRightClick=function(a,b,c,d){throw new Error("Method must be overriden.")},b.prototype.onTitleClick=function(a){},b.prototype.onTitleDoubleClick=function(a){},Autodesk.Viewing.UI.ModelStructurePanel=b}(),function(){"use strict";function a(a){a=String(a);var b=' target="blank" class="propertyLink" ';return[{pattern:/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,value:"<a"+b+'href="$&">$&</a>'},{pattern:/(^|[^\/])(www\.[\S]+(\b|$))/gim,value:"$1<a"+b+'href="http://$2">$2</a>'}].reduce(function(a,b){return a.replace(b.pattern,b.value)},a)}var b=Autodesk.Viewing.UI,c=function(a,c,d,e){b.DockingPanel.call(this,a,c,d,e),this.title.classList.add("docking-panel-delimiter-shadow"),this.container.classList.add("property-panel"),this.container.dockRight=!0,this.createScrollContainer({left:!1,heightAdjustment:70,marginTop:0}),this.highlightableElements={};var f=this,g=function(){function a(a){return"category"===a.type}var c=new b.TreeDelegate;return c.getTreeNodeId=function(a){return a.name+(a.hasOwnProperty("value")?a.value:"")+(a.hasOwnProperty("category")?a.category:"")},c.getTreeNodeClass=function(b){return a(b)?f.getCategoryClass(b):f.getPropertyClass(b)},c.isTreeNodeGroup=function(b){return a(b)},c.onTreeNodeClick=function(b,c,d){a(c)?f.onCategoryClick(c,d):f.onPropertyClick(c,d)},c.onTreeNodeRightClick=function(b,c,d){a(c)?f.onCategoryRightClick(c,d):f.onPropertyRightClick(c,d)},c.onTreeNodeDoubleClick=function(b,c,d){a(c)?f.onCategoryDoubleClick(c,d):f.onPropertyDoubleClick(c,d)},c.onTreeNodeIconClick=function(b,c,d){a(c)?f.onCategoryIconClick(c,d):f.onPropertyIconClick(c,d)},c.createTreeNode=function(b,c,d){var e=null;(e=a(b)?f.displayCategory(b,c,d):f.displayProperty(b,c,d))&&(f.highlightableElements[this.getTreeNodeId(b)]=e)},c}();this.tree=new b.Tree(g,null,this.scrollContainer,{})};c.prototype=Object.create(b.DockingPanel.prototype),c.prototype.constructor=c,c.prototype.setProperties=function(a,b){this.removeAllProperties();for(var c=[],d=[],e=0;e<a.length;e++){var f=a[e];if(!f.hidden){var g=a[e].displayCategory;g&&"string"==typeof g&&""!==g?c.push(f):d.push(f)}}if(c.length+d.length===0)return void this.showNoProperties();for(var e=0;e<c.length;e++){var f=c[e],h=f.precision||Autodesk.Viewing.Private.calculatePrecision(f.displayValue),i=Autodesk.Viewing.Private.formatValueWithUnits(f.displayValue,f.units,f.type,h);this.addProperty(f.displayName,i,f.displayCategory)}for(var j=c.length>0,e=0;e<d.length;e++){var f=d[e],h=f.precision||Autodesk.Viewing.Private.calculatePrecision(f.displayValue),i=Autodesk.Viewing.Private.formatValueWithUnits(f.displayValue,f.units,f.type,h);this.addProperty(f.displayName,i,j?"Other":"",j?{localizeCategory:!0}:{})}},c.prototype.showNoProperties=function(){this.removeAllProperties();var a=this.tree.myRootContainer,b=document.createElement("div");b.className="no-properties";var c="No properties to display";b.setAttribute("data-i18n",c),b.textContent=Autodesk.Viewing.i18n.translate(c),a.appendChild(b)},c.prototype.showDefaultProperties=function(){this.showNoProperties(),this.resizeToContent()},c.prototype.areDefaultPropertiesShown=function(){return!this.hasProperties()},c.prototype.addProperty=function(a,b,c,d){if(this.tree.getElementForNode({name:a,value:b,category:c}))return!1;var e=null,f={name:a,value:b,type:"property"};return c?(e=this.tree.getElementForNode({name:c}),e||(e=this.tree.createElement_({name:c,type:"category"},this.tree.myRootContainer,d&&d.localizeCategory?{localize:!0}:null)),f.category=c):e=this.tree.myRootContainer,this.tree.createElement_(f,e,d&&d.localizeProperty?{localize:!0}:null),!0},c.prototype.hasProperties=function(){for(var a in this.highlightableElements)return!0;return!1},c.prototype.removeProperty=function(a,b,c,d){var e={name:a,value:b,category:c},f=this.tree.getElementForNode(e);return!!f&&(delete this.highlightableElements[this.tree.delegate().getTreeNodeId(e)],f.parentNode.removeChild(f),!0)},c.prototype.removeAllProperties=function(){this.highlightableElements={},this.tree.clear()},c.prototype.setCategoryCollapsed=function(a,b){var c=this.tree.delegate().getTreeNodeId(a);this.tree.setCollapsed(c,b)},c.prototype.isCategoryCollapsed=function(a){var b=this.tree.delegate().getTreeNodeId(a);return this.tree.isCollapsed(b)},c.prototype.getContentSize=function(){var a=this.tree.myRootContainer;return{height:a.clientHeight+55,width:a.clientWidth}},c.prototype.highlight=function(a,b){for(var c in this.highlightableElements)for(var d=this.highlightableElements[c],e=0;e<d.length;++e)!function(b){var c=b.innerHTML,d=c.replace(/(<highlight>|<\/highlight>)/gim,"");if(c!==d&&(b.innerHTML=d),a&&""!==a){var e=new RegExp("(\\b"+a+"\\b)","gim"),f=d.replace(e,"<highlight>$1</highlight>");b.innerHTML=f}}(d[e])},c.prototype.displayCategory=function(a,b,c){var d=document.createElement("div"),e=a.name;return c&&c.localize&&(d.setAttribute("data-i18n",e),e=Autodesk.Viewing.i18n.translate(e)),d.textContent=e,d.title=e,d.className="category-name",b.appendChild(d),[d]},c.prototype.displayProperty=function(b,c,d){var e=document.createElement("div"),f=b.name;d&&d.localize&&(e.setAttribute("data-i18n",f),f=Autodesk.Viewing.i18n.translate(f)),e.textContent=f,e.title=f,e.className="property-name";var g=document.createElement("div");g.className="separator";var h=document.createElement("div");h.textContent=b.value;var i=b.value;return h.title=i,i=a(i),h.innerHTML=i,h.className="property-value",c.appendChild(e),c.appendChild(g),c.appendChild(h),[e,h]},c.prototype.getCategoryClass=function(a){return"category"},c.prototype.getPropertyClass=function(a){return"property"},c.prototype.onCategoryClick=function(a,b){this.setCategoryCollapsed(a,!this.isCategoryCollapsed(a))},c.prototype.onPropertyClick=function(a,b){},c.prototype.onCategoryIconClick=function(a,b){this.setCategoryCollapsed(a,!this.isCategoryCollapsed(a))},c.prototype.onPropertyIconClick=function(a,b){},c.prototype.onCategoryDoubleClick=function(a,b){},c.prototype.onPropertyDoubleClick=function(a,b){},c.prototype.onCategoryRightClick=function(a,b){},c.prototype.onPropertyRightClick=function(a,b){},Autodesk.Viewing.UI.PropertyPanel=c}(),function(){var a=Autodesk.Viewing,b=Autodesk.Viewing.Private,c=function(a){this.viewer=a,this.menus=[],this.container=null,this.open=!1};c.prototype.constructor=c,c.prototype.show=function(a,b){var c=this.viewer.container.getBoundingClientRect();Array.isArray(a.changedPointers)&&a.changedPointers.length>0&&(a.clientX=a.changedPointers[0].clientX,a.clientY=a.changedPointers[0].clientY);var d=a.clientX-c.left,e=a.clientY-c.top;this.open||(this.showMenu(b,d,e),this.open=!0)},c.prototype.showMenu=function(c,d,e){var f,g=[],h=document.createElement("div");h.style.left="0",h.style.top="0",h.style.width="100%",h.style.height="100%",h.style.position="absolute",h.style.zIndex="10";var i=document.createElement("div");i.classList.add("menu"),i.classList.add("docking-panel"),i.classList.add("docking-panel-container-solid-color-a"),h.appendChild(i),this.viewer.container.appendChild(h),this.container=h,this.menus.push(i);for(var j=0;j<c.length;++j){var k=c[j],l=k.title,m=k.target,n=k.icon,o=k.shortcut;f=this.createMenuItem(l,n,o),i.appendChild(f),"function"==typeof m?this.addCallbackToMenuItem(f,m):Array.isArray(m)?g.push({menuItem:f,target:m}):b.logger.warn("Invalid context menu option:",l,m)}var p=i.getBoundingClientRect(),q=p.width,r=p.height,s=this.viewer.container.getBoundingClientRect(),t=s.width,u=s.height,v=a.isTouchDevice()&&!this.viewer.navigation.getUseLeftHandedInput();for(v&&(d-=q),d<0&&(d=0),t<d+q&&(d=t-q)<0&&(d=0),e<0&&(e=0),u<e+r&&(e=u-r)<0&&(e=0),i.style.top=Math.round(e)+"px",i.style.left=Math.round(d)+"px",j=0;j<g.length;++j){var w=g[j];f=w.menuItem,p=f.getBoundingClientRect(),d=Math.round((v?p.left:p.right)-s.left),e=Math.round(p.top-s.top),this.addSubmenuCallbackToMenuItem(f,w.target,d,e)}this.OnHide=function(a){"menu-item"!==a.target.className&&0===a.button&&this.hide(a)}.bind(this),this.OnMove=function(a){"menu-item"!==a.target.className&&(this.hide(a),this.show(a,c))}.bind(this),this.container.addEventListener("touchend",this.OnHide),this.container.addEventListener("click",this.OnHide),this.container.addEventListener("contextmenu",this.OnMove)},c.prototype.createMenuItem=function(a,b,c){var d=document.createElement("div");return d.className="menu-item",c=c||"",this.setMenuItemIcon(d,b),this.setMenuItemText(d,a),this.setMenuItemShortcut(d,c),d},c.prototype.setMenuItemIcon=function(a,b){var c=document.createElement("div");c.classList.add("menu-item-icon"),b&&c.classList.add(b),a.appendChild(c)},c.prototype.setMenuItemText=function(a,b){var c=document.createElement("div");c.classList.add("menu-item-text"),c.setAttribute("data-i18n",b),c.textContent=Autodesk.Viewing.i18n.translate(b),a.appendChild(c)},c.prototype.setMenuItemShortcut=function(a,b){var c=document.createElement("div");c.classList.add("menu-item-shortcut"),c.textContent=b,a.appendChild(c)},c.prototype.addCallbackToMenuItem=function(a,b){var c=this;a.addEventListener("click",function(a){return c.hide(),b(),a.preventDefault(),!1},!1)},c.prototype.addSubmenuCallbackToMenuItem=function(a,b,c,d){var e=this;a.addEventListener("click",function(){e.showMenu(b,c,d)},!1)},c.prototype.hide=function(){return!!this.open&&(this.menus=[],this.open=!1,this.container.removeEventListener("touchend",this.OnHide),this.container.removeEventListener("click",this.OnHide),this.container.removeEventListener("contextmenu",this.OnMove),this.container.parentNode.removeChild(this.container),this.container=null,!0)},Autodesk.Viewing.Private.ContextMenu=c}(),function(){"use strict";var a=(Autodesk.Viewing.UI,Autodesk.Viewing.Private),b=function(b){this.viewer=b,this.contextMenu=new a.ContextMenu(b)};b.prototype.constructor=b,b.prototype.show=function(a){var b=this.viewer.getSelectionCount(),c=this.viewer.getSelectionVisibility(),d={numSelected:b,hasSelected:0<b,hasVisible:c.hasVisible,hasHidden:c.hasHidden},e=this.buildMenu(a,d);this.viewer.runContextMenuCallbacks(e,d),e&&0<e.length&&this.contextMenu.show(a,e)},b.prototype.hide=function(){return this.contextMenu.hide()},b.prototype.buildMenu=function(a,b){return null},Autodesk.Viewing.UI.ObjectContextMenu=b}(),Autodesk.Viewing.Private.Preferences=function(a,b){function c(a,c){if(k){if(l.hasTag(a,"no-storage"))return;var d=b.prefix+a;return void 0!==c?localStorage[d]=c:c=localStorage[d],c}}function d(a,b){if("string"!=typeof a||"function"==typeof l[a])return void g.logger.log("Preferences: invalid name="+a);var d=c(a),e=!1;if(void 0!==d)try{d=JSON.parse(d),e=!0}catch(a){}l[a]=e?d:b,j[a]={}}function e(a){k&&(a=b.prefix+a,delete localStorage[a])}"string"==typeof b&&(b={prefix:b}),b||(b={}),b.prefix||(b.prefix="Autodesk.Viewing.Preferences."),b.hasOwnProperty("localStorage")||(b.localStorage=!0);var f=Autodesk.Viewing,g=Autodesk.Viewing.Private,h={},i={},j={},k=b.localStorage&&function(){var a=b.prefix+"test";try{var c=window.localStorage;return c.setItem(a,"1"),c.removeItem(a),!0}catch(a){return!1}}(),l=this;a.addEventListener(f.PREF_CHANGED_EVENT,function(a){var b=i[a.name];if(b){var c=b.changed;c&&c(a.value)}}),a.addEventListener(f.PREF_RESET_EVENT,function(a){var b=i[a.name];if(b){var c=b.reset;c&&c(a.value)}}),a.addEventListener(f.RESTORE_DEFAULT_SETTINGS_EVENT,function(b){var c=a.model.is2d()?"2d":"3d";l.reset(c)}),this.load=function(a){h=a;for(var b in h)h.hasOwnProperty(b)&&d(b,h[b])},this.tag=function(a,b){if(a){b?Array.isArray(b)||(b=[b]):b=Object.keys(h);for(var c=0;c<b.length;++c)j[b[c]][a]=!0}},this.untag=function(a,b){if(a){b?Array.isArray(b)||(b=[b]):b=Object.keys(h);for(var c=0;c<b.length;++c)j[b[c]][a]=!1}},this.hasTag=function(a,b){var c=j[a];return!!c&&!0===c[b]},this.add=function(a,b,c){if(!h.hasOwnProperty(a)){if(h[a]=b,d(a,b),c){Array.isArray(c)||(c=[c]);for(var e=0;e<c.length;++e)this.tag(c[e],a)}return!0}return g.logger.log("Preferences: "+a+" already exists"),!1},this.remove=function(a,b){return!!h.hasOwnProperty(a)&&(delete h[a],delete j[a],delete this[a],b&&e(a),!0)},this.reset=function(b,c){b&&void 0===c&&(c=!0);for(var d in h)if(h.hasOwnProperty(d)){if(b){var g=!!j[d][b];if(c&&!g||!c&&g)continue}this.set(d,h[d],!1)&&a.dispatchEvent({type:f.PREF_RESET_EVENT,name:d,value:this[d]}),e(d)}},this.get=function(a){return this[a]},this.set=function(b,d,e){return this[b]!==d&&(this[b]=d,c(b,d),(void 0===e||e)&&a.dispatchEvent({type:f.PREF_CHANGED_EVENT,name:b,value:d}),!0)},this.addListeners=function(a,b,c){i[a]={changed:b,reset:c}},this.removeListeners=function(a){void 0!==i[a]&&delete i[a]}},AutodeskNamespace("Autodesk.Viewing.Private"),function(){var a=Autodesk.Viewing,b=Autodesk.Viewing.Private;b.OptionSlider=function(b,c,d,e,f){function g(a){a.target!=h.stepperElement&&(h.stepperElement.value=h.sliderElement.value),h.fireChangeEvent()}var h=this;this.tbody=e;var i=f&&f.insertAtIndex?f.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(i);var j=this.sliderRow.insertCell(0);this.caption=document.createElement("div"),this.caption.setAttribute("data-i18n",b),this.caption.textContent=a.i18n.translate(b),this.sliderElement=document.createElement("input"),this.sliderElement.type="range",this.sliderElement.id=b+"_slider",this.sliderElement.min=c,this.sliderElement.max=d,j.appendChild(this.caption),j.appendChild(this.sliderElement),j=this.sliderRow.insertCell(1),this.stepperElement=document.createElement("input"),this.stepperElement.type="number",this.stepperElement.id=b+"_stepper",this.stepperElement.min=c,this.stepperElement.max=d,this.stepperElement.step=1,this.stepperElement.style.width="64px",j.appendChild(this.stepperElement),this.blockEvent=!1,this.stepperElement.addEventListener("change",function(a){a.target!=h.sliderElement&&(h.sliderElement.value=h.stepperElement.value),h.fireChangeEvent()},!1),this.sliderElement.addEventListener("change",g,!1),this.sliderElement.addEventListener("input",g,!1)},b.OptionSlider.prototype.constructor=b.OptionSlider,a.EventDispatcher.prototype.apply(b.OptionSlider.prototype),b.OptionSlider.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value;var a=new CustomEvent("change",{detail:{target:this,value:this.sliderElement.value}});this.dispatchEvent(a)}},b.OptionSlider.prototype.setValue=function(a){this.blockEvent=!0,this.value=a,this.sliderElement.value=a,this.stepperElement.value=a,this.blockEvent=!1},b.OptionSlider.prototype.setDisabled=function(a){this.sliderElement.disabled=a,this.stepperElement.disabled=a,this.caption.disabled=a},b.OptionCheckbox=function(b,c,d,e,f){var g=this;this.tbody=c;var h=f&&f.insertAtIndex?f.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(h),this.sliderRow.classList.add("switch-slider-row");var i=this.sliderRow.insertCell(0);this.caption=document.createElement("div"),this.caption.setAttribute("data-i18n",b),this.caption.textContent=a.i18n.translate(b),i.appendChild(this.caption),i=this.sliderRow.insertCell(1),e&&(this.description=document.createElement("div"),this.description.setAttribute("data-i18n",e),this.description.textContent=a.i18n.translate(e),i.appendChild(this.description),i=this.sliderRow.insertCell(2));var j=document.createElement("label");j.classList.add("switch"),this.checkElement=document.createElement("input"),this.checkElement.type="checkbox",this.checkElement.id=b+"_check",this.checkElement.checked=d,j.appendChild(this.checkElement);var k=document.createElement("div");k.classList.add("slider"),j.appendChild(k),i.appendChild(j),this.blockEvent=!1,this.checked=d,this.checkElement.addEventListener("change",function(a){g.fireChangeEvent()},!1),a.isTouchDevice()&&(this.sliderRowHammer=new Hammer.Manager(this.sliderRow,{recognizers:[[Hammer.Tap]],inputClass:a.isIE11?Hammer.PointerEventInput:Hammer.TouchInput}),this.sliderRowHammer.on("tap",function(a){a.preventDefault(),a.target.click()})),this.checkElement.addEventListener("click",function(a){a.stopPropagation()},!1),this.sliderRow.addEventListener("click",function(a){g.checkElement.disabled||(g.checkElement.checked=!g.checkElement.checked,g.fireChangeEvent())},!1)},b.OptionCheckbox.prototype.constructor=b.OptionCheckbox,a.EventDispatcher.prototype.apply(b.OptionCheckbox.prototype),b.OptionCheckbox.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked;var a=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}});this.dispatchEvent(a)}},b.OptionCheckbox.prototype.setChecked=function(a){this.checkElement.checked!=a&&(this.checkElement.checked=a,this.fireChangeEvent())},b.OptionCheckbox.prototype.setValue=function(a){this.blockEvent=!0,this.checked=a,this.checkElement.checked=a,this.blockEvent=!1},b.OptionCheckbox.prototype.getValue=function(){return this.checkElement.checked},b.OptionCheckbox.prototype.setDisabled=function(a){this.checkElement.disabled=a,this.caption.disabled=a},b.OptionCheckbox.prototype.setVisibility=function(a){this.sliderRow.style.display=a?"table-row":"none"},b.OptionLabel=function(b,c,d){this.tbody=c;var e=d&&d.insertAtIndex?d.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(e);var f=this.sliderRow.insertCell(0);this.caption=document.createElement("div"),this.caption.setAttribute("data-i18n",b),this.caption.textContent=a.i18n.translate(b),f.appendChild(this.caption),f.colSpan="3",this.blockEvent=!1},b.OptionDropDown=function(b,c,d,e,f,g){var h=this;this.tbody=c;var i=g&&g.insertAtIndex?g.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(i),this.dropdownElement=document.createElement("select"),this.dropdownElement.id=b+"_dropdown",this.dropdownElement.classList.add("option-drop-down");for(var j=0;j<d.length;j++){var k=document.createElement("option");k.value=j,k.setAttribute("data-i18n",d[j]),k.textContent=a.i18n.translate(d[j]),this.dropdownElement.add(k)}this.selectedIndex=this.dropdownElement.selectedIndex=e;var l=this.sliderRow.insertCell(0);if(this.caption=document.createElement("div"),this.caption.setAttribute("data-i18n",b),this.caption.textContent=a.i18n.translate(b),l.appendChild(this.caption),f){l.colSpan="2",this.sliderRow=this.tbody.insertRow(i);var l=this.sliderRow.insertCell(0);l.appendChild(this.dropdownElement),l.colSpan="2",this.dropdownElement.classList.add("tabcell")}else{var l=this.sliderRow.insertCell(1);l.appendChild(this.dropdownElement)}l.style.paddingLeft="5px",l.style.paddingRight="5px",this.blockEvent=!1,this.dropdownElement.addEventListener("change",function(a){h.fireChangeEvent()},!1)},b.OptionDropDown.prototype.constructor=b.OptionDropDown,a.EventDispatcher.prototype.apply(b.OptionDropDown.prototype),b.OptionDropDown.prototype.setSelectedIndex=function(a){this.blockEvent=!0,this.selectedIndex=this.dropdownElement.selectedIndex=a,this.blockEvent=!1},b.OptionDropDown.prototype.setSelectedValue=function(a){this.blockEvent=!0,this.dropdownElement.selectedValue=a,this.selectedIndex=this.dropdownElement.selectedIndex,this.blockEvent=!1},b.OptionDropDown.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=this.dropdownElement.selectedIndex;var a=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}});this.dispatchEvent(a)}},b.OptionDropDown.prototype.setDisabled=function(a){this.dropdownElement.disabled=a,this.caption.disabled=a}}(),avp.ResizeFooter=function(a,b){var c=document.createElement("div");c.classList.add("docking-panel-footer");var d=document.createElement("div");d.classList.add("docking-panel-footer-resizer"),c.appendChild(d);var e=!1,f=a.getBoundingClientRect(),g={x:0,y:0},h=document.createElement("div");h.classList.add("adsk-viewing-viewer"),h.classList.add("docking-panel-resize-overlay");var i=function(b){e=!0,f=a.getBoundingClientRect(),document.body.appendChild(h),document.addEventListener("touchmove",k),document.addEventListener("touchcancel",j),document.addEventListener("touchend",j),document.addEventListener("mousemove",k),document.addEventListener("mouseup",j),b.preventDefault(),b.stopPropagation()},j=function(a){document.body.contains(h)&&(document.body.removeChild(h),document.removeEventListener("touchmove",k),document.removeEventListener("touchcancel",j),document.removeEventListener("touchend",j),document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",j),a.preventDefault(),a.stopPropagation())},k=function(c){"touchmove"===c.type&&(c.canvasX=c.touches[0].screenX,c.canvasY=c.touches[0].screenY),e&&(e=!1,g.x=c.canvasX||c.clientX,g.y=c.canvasY||c.clientY);var d=(c.canvasX||c.clientX)-g.x,h=(c.canvasY||c.clientY)-g.y,i=parseInt(f.width+d),j=parseInt(f.height+h);a.style.width=i+"px",a.style.height=j+"px",b&&b(i,j),c.preventDefault(),c.stopPropagation()};d.addEventListener("touchstart",i),d.addEventListener("mousedown",i),a.style.resize="none",a.appendChild(c),this.footer=c,this.resizer=d},function(){"use strict";var a=function(a){this.bg=document.createElement("div"),this.bg.className="progressbg",this.fg=document.createElement("div"),this.fg.className="progressfg",this.bg.appendChild(this.fg),this.lastValue=-1,a.appendChild(this.bg),this.widthScale=this.fg.clientWidth};a.prototype.setPercent=function(a){a!=this.lastValue&&(this.lastValue=a,a>=99?this.bg.style.visibility="hidden":(this.bg.style.visibility="visible",this.fg.style.width=this.widthScale*a*.01+"px"))},Autodesk.Viewing.Private.ProgressBar=a}(),AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.Private.RenderOptionsPanel=function(a){var b=this,c=Autodesk.Viewing,d=Autodesk.Viewing.Private;this.viewer=a,Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"RenderOptionsPanel","Rendering Options"),this.table=document.createElement("table"),this.table.className="adsk-lmv-tftable",this.tbody=document.createElement("tbody"),this.table.appendChild(this.tbody),this.createScrollContainer({heightAdjustment:70}),this.scrollContainer.appendChild(this.table),this.container.style.width="320px",this.container.style.top="260px",this.container.style.left="220px",this.container.style.height="460px",this.container.dockRight=!0,this.postprocStyle=new d.OptionSlider("Postprocess Style",0,4,this.tbody),this.postprocStyle.setValue(0),this.postprocStyle.sliderElement.step=this.postprocStyle.stepperElement.step=1,this.addEventListener(this.postprocStyle,"change",function(c){var d=Math.floor(parseFloat(b.postprocStyle.value)),e="";switch(d){case 0:e="";break;case 1:e="edging";break;case 2:e="cel";break;case 3:e="graphite";break;case 4:e="pencil"}a.impl.preloadPostProcessStyle(),a.impl.setPostProcessParameter("style",e);var f=0!=d;b.edgesToggle.setDisabled(!f),b.grayscaleToggle.setDisabled(!f),b.brightness.setDisabled(!f),b.contrast.setDisabled(!f),b.preserveColor.setDisabled(!f),b.firstParam.setDisabled(d<2),b.secondParam.setDisabled(d<3)}),this.edgesToggle=new d.OptionCheckbox("Display Edges",this.tbody,!0),this.edgesToggle.setDisabled(!0),this.addEventListener(this.edgesToggle,"change",function(c){a.impl.setPostProcessParameter("edges",b.edgesToggle.checked)}),this.grayscaleToggle=new d.OptionCheckbox("Grayscale",this.tbody,!1),this.grayscaleToggle.setDisabled(!0),this.addEventListener(this.grayscaleToggle,"change",function(c){a.impl.setPostProcessParameter("grayscale",b.grayscaleToggle.checked)}),this.brightness=new d.OptionSlider("Brightness",-1,1,this.tbody),this.brightness.setValue(0),this.brightness.sliderElement.step=this.brightness.stepperElement.step=.01,this.brightness.setDisabled(!0),this.addEventListener(this.brightness,"change",function(c){a.impl.setPostProcessParameter("brightness",parseFloat(b.brightness.value))}),this.contrast=new d.OptionSlider("Contrast",-1,1,this.tbody),this.contrast.setValue(0),this.contrast.sliderElement.step=this.contrast.stepperElement.step=.01,this.contrast.setDisabled(!0),this.addEventListener(this.contrast,"change",function(c){a.impl.setPostProcessParameter("contrast",parseFloat(b.contrast.value))}),this.preserveColor=new d.OptionCheckbox("Preserve Color",this.tbody,!1),this.preserveColor.setDisabled(!0),this.addEventListener(this.preserveColor,"change",function(c){a.impl.setPostProcessParameter("preserveColor",b.preserveColor.checked)}),this.firstParam=new d.OptionSlider("2*Levels/Repeats",1,5,this.tbody),this.firstParam.setValue(3),this.firstParam.sliderElement.step=this.firstParam.stepperElement.step=.01,this.firstParam.setDisabled(!0),this.addEventListener(this.firstParam,"change",function(c){switch(Math.floor(parseFloat(b.postprocStyle.value))){case 1:break;case 2:a.impl.setPostProcessParameter("levels",2*parseFloat(b.firstParam.value));break;case 3:case 4:a.impl.setPostProcessParameter("repeats",parseFloat(b.firstParam.value))}}),this.secondParam=new d.OptionSlider("Rotation",0,1,this.tbody),this.secondParam.setValue(0),this.secondParam.sliderElement.step=this.secondParam.stepperElement.step=.01,this.secondParam.setDisabled(!0),this.addEventListener(this.secondParam,"change",function(c){a.impl.setPostProcessParameter("rotation",parseFloat(b.secondParam.value))}),this.saoToggle=new d.OptionCheckbox("AO Enabled",this.tbody,!0),this.addEventListener(this.saoToggle,"change",function(c){var d=b.saoToggle.checked;a.prefs.set("ambientShadows",d),a.setQualityLevel(d,a.impl.renderer().settings.antialias)}),this.saoRadius=new d.OptionSlider("AO Radius",0,200,this.tbody),this.saoRadius.setValue(10),this.saoRadius.sliderElement.step=this.saoRadius.stepperElement.step=.01,this.addEventListener(this.saoRadius,"change",function(c){a.impl.renderer().setAOOptions(parseFloat(b.saoRadius.value),parseFloat(b.saoIntensity.value)),a.impl.renderer().composeFinalFrame()}),this.saoIntensity=new d.OptionSlider("AO Intensity",0,3,this.tbody),this.saoIntensity.setValue(.4),this.saoIntensity.sliderElement.step=this.saoIntensity.stepperElement.step=.01,this.addEventListener(this.saoIntensity,"change",function(c){a.impl.renderer().setAOOptions(parseFloat(b.saoRadius.value),parseFloat(b.saoIntensity.value)),a.impl.renderer().composeFinalFrame()}),this.groundShadowAlpha=new d.OptionSlider("Shadow Alpha",0,2,this.tbody),this.groundShadowAlpha.setValue(1),this.groundShadowAlpha.sliderElement.step=this.groundShadowAlpha.stepperElement.step=.1,this.addEventListener(this.groundShadowAlpha,"change",function(c){a.setGroundShadowAlpha(parseFloat(b.groundShadowAlpha.value))}),this.groundShadowColor=new d.OptionCheckbox("Shadow Color",this.tbody),c.isIE11||(this.groundShadowColor.checkElement.value="#000000",this.groundShadowColor.checkElement.type="color"),this.addEventListener(this.groundShadowColor,"change",function(c){var d=b.groundShadowColor.checkElement.value;a.setGroundShadowColor(new THREE.Color(parseInt(d.substr(1,7),16)))}),this.groundReflectionAlpha=new d.OptionSlider("Reflection Alpha",0,2,this.tbody),this.groundReflectionAlpha.setValue(1),this.groundReflectionAlpha.sliderElement.step=this.groundReflectionAlpha.stepperElement.step=.1,this.addEventListener(this.groundReflectionAlpha,"change",function(c){a.setGroundReflectionAlpha(parseFloat(b.groundReflectionAlpha.value))}),this.groundReflectionColor=new d.OptionCheckbox("Reflection Color",this.tbody),c.isIE11||(this.groundReflectionColor.checkElement.value="#000000",this.groundReflectionColor.checkElement.type="color"),this.addEventListener(this.groundReflectionColor,"change",function(c){var d=b.groundReflectionColor.checkElement.value;a.setGroundReflectionColor(new THREE.Color(parseInt(d.substr(1,7),16)))});for(var e=[],f=0;f<d.LightPresets.length;f++)e.push(d.LightPresets[f].name);this.envSelect=new d.OptionDropDown("Environment",this.tbody,e,a.impl.currentLightPreset()),this.addEventListener(this.envSelect,"change",function(c){var d=b.envSelect.selectedIndex;a.setLightPreset(d)});var g=a.impl.renderer().getToneMapMethod();this.toneMapMethod=new d.OptionDropDown("Tonemap Method",this.tbody,["None","Canon-Lum","Canon-RGB"],g),this.addEventListener(this.toneMapMethod,"change",function(){var c=b.toneMapMethod.selectedIndex;a.impl.setTonemapMethod(c)}),this.exposureBias=new d.OptionSlider("Exposure Bias",-30,30,this.tbody),this.exposureBias.setValue(a.impl.renderer().getExposureBias()),this.exposureBias.sliderElement.step=this.exposureBias.stepperElement.step=.1,this.addEventListener(this.exposureBias,"change",function(c){a.impl.setTonemapExposureBias(b.exposureBias.value,b.whiteScale.value)}),this.exposureBias.setDisabled(0==g),this.whiteScale=new d.OptionSlider("Light Intensity",-5,20,this.tbody);var h=0;a.impl.dir_light1&&(h=0!=a.impl.dir_light1.intensity?Math.log(a.impl.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(h),this.whiteScale.sliderElement.step=this.whiteScale.stepperElement.step=.1,this.addEventListener(this.whiteScale,"change",function(c){a.impl.dir_light1.intensity=Math.pow(2,b.whiteScale.value),a.impl.setTonemapExposureBias(b.exposureBias.value,b.whiteScale.value)}),this.fovAngle=new d.OptionSlider("FOV-degrees",6.88,100,this.tbody),this.fovAngle.setValue(a.getFOV()),this.addEventListener(this.fovAngle,"change",function(c){a.setFOV(parseFloat(b.fovAngle.value))}),this.frameRate=new d.OptionSlider("Frame rate:",1,100,this.tbody),this.frameRate.setValue(a.impl.getFrameRate()),this.frameRate.sliderElement.step=this.frameRate.stepperElement.step=1,this.addEventListener(this.frameRate,"change",function(c){a.impl.setFrameRate(b.frameRate.value)}),this.addEventListener(this.viewer,Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(c){var d=parseFloat(b.fovAngle.value),e=a.getFOV();d!=e&&b.fovAngle.setValue(e)}),this.addEventListener(this.viewer,Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,function(a){b.syncUI()}),this.addVisibilityListener(function(){b.resizeToContent()})},Autodesk.Viewing.Private.RenderOptionsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype),Autodesk.Viewing.Private.RenderOptionsPanel.prototype.constructor=Autodesk.Viewing.Private.RenderOptionsPanel,Autodesk.Viewing.Private.RenderOptionsPanel.prototype.getContentSize=function(){return{height:this.table.clientHeight+75,width:this.table.clientWidth}},Autodesk.Viewing.Private.RenderOptionsPanel.prototype.syncUI=function(){var a=this.viewer.impl,b=0;a.dir_light1&&(b=0!=a.dir_light1.intensity?Math.log(a.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(b),this.exposureBias.setValue(a.renderer().getExposureBias());var c=a.renderer().getToneMapMethod();this.toneMapMethod.setSelectedIndex(c),this.envSelect.setSelectedIndex(a.currentLightPreset()),this.exposureBias.setDisabled(0==c),this.saoToggle.setValue(a.renderer().getAOEnabled()),this.saoRadius.setDisabled(!a.renderer().getAOEnabled()),this.saoIntensity.setDisabled(!a.renderer().getAOEnabled()),this.saoRadius.setValue(a.renderer().getAORadius()),this.saoIntensity.setValue(a.renderer().getAOIntensity()),this.groundShadowAlpha.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundShadowColor.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundReflectionAlpha.setDisabled(!this.viewer.prefs.get("groundReflection")),this.groundReflectionColor.setDisabled(!this.viewer.prefs.get("groundReflection")),this.fovAngle.setValue(this.viewer.getFOV())},Autodesk.Viewing.Private.RenderOptionsPanel.prototype.uninitialize=function(){Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this),this.table=null,this.tbody=null,this.postprocStyle=null,this.edgesToggle=null,this.grayscale=null,this.brightness=null,this.contrast=null,this.preserveColor=null,this.firstParam=null,this.secondParam=null,this.saoToggle=null,this.saoRadius=null,this.saoIntensity=null,this.groundShadowAlpha=null,this.envSelect=null,this.toneMapMethod=null,this.exposureBias=null,this.whiteScale=null,
this.fovAngle=null,this.viewer=null},function(){"use strict";var a=Autodesk.Viewing,b=Autodesk.Viewing.UI,c=function(c,d,e,f){this.viewer=c,this.tree=null,this.layersRoot=null,this.visibilityImages={},this.isMac=-1!==navigator.userAgent.search("Mac OS");c.config.viewableName;b.DockingPanel.call(this,c.container,e,"Layers",f),this.container.classList.add("layers-panel"),this.container.style.top="10px",this.container.style.left="10px";var g=this;c.model?g.build():g.addEventListener(c,a.GEOMETRY_LOADED_EVENT,function(){g.build()});var h=!1;this.addVisibilityListener(function(){h||(h=!0,g.resizeToContent())})};c.prototype=Object.create(b.DockingPanel.prototype),c.prototype.constructor=c,c.prototype.uninitialize=function(){b.DockingPanel.prototype.uninitialize.call(this),this.viewer=null,this.tree=null,this.layersRoot=null,this.scrollContainer=null},c.prototype.build=function(){function c(){function a(b){var c=[];if(-1!==b.name.toLowerCase().indexOf(h))c.push(b);else if(!b.isLayer)for(var d=b.children,e=0;e<d.length;++e)c=c.concat(a(d[e]));return c}h?l&&0<l.childCount&&(e.lockoutClearFilter=!0,i.setLayerVisible(a(l),!0,!0),e.lockoutClearFilter=!1):i.setLayerVisible(null,!0),g=null}function d(a){g&&clearTimeout(g),h=a?a.toLowerCase():a,g=setTimeout(c,500)}var e=this,f=document.createElement("div");f.classList.add("visibility"),f.title=a.i18n.translate("Show/hide all layers"),f.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation(),this.viewer.setLayerVisible(null,this.viewer.allLayersHidden())}.bind(this)),this.container.appendChild(f),this.toogleAllVisibleButton=f;var g=null,h="",i=e.viewer;this.filterbox=new b.Filterbox(this.viewer.container.id+"LayersPanel-Filterbox",{filterFunction:d}),this.container.appendChild(this.filterbox.container),this.createScrollContainer({heightAdjustment:104,marginTop:0});var j=document.createElement("div");j.classList.add("docking-panel-container-gradient"),j.style.width="100%",j.style.height="100%",this.scrollContainer.appendChild(j);var k=function(){var a=new b.TreeDelegate;return a.getTreeNodeId=function(a){return a.id},a.getTreeNodeLabel=function(a){return e.getNodeLabel(a)},a.getTreeNodeClass=function(a){return e.getNodeClass(a)},a.isTreeNodeGroup=function(a){return e.isGroupNode(a)},a.shouldCreateTreeNode=function(a){return e.shouldInclude(a)},a.onTreeNodeClick=function(a,b,c){e.onClick(b,c)},a.onTreeNodeRightClick=function(a,b,c){e.onRightClick(b,c)},a.onTreeNodeDoubleClick=function(a,b,c){e.onDoubleClick(b,c)},a.onTreeNodeIconClick=function(a,b,c){e.onIconClick(b,c)},a.createTreeNode=function(a,b){e.createNode(a,b)},a}(),l=e.layersRoot=e.viewer.impl.getLayersRoot();l&&(e.tree=new b.Tree(k,l,j,{excludeRoot:!0}),e.update(),e.addEventListener(e.viewer,a.LAYER_VISIBILITY_CHANGED_EVENT,function(){e.update()}))},c.prototype.update=function(){function a(a,b){0===b?c.tree.addClass(a.id,"dim"):c.tree.removeClass(a.id,"dim")}function b(d){d.id;if(d.isLayer){a(d,c.viewer.isLayerVisible(d)?1:0)}else for(var e=d.children,f=0;f<e.length;++f)b(e[f])}var c=this;this.layersRoot&&0<this.layersRoot.childCount&&b(c.layersRoot),this.viewer.allLayersHidden()?this.toogleAllVisibleButton.classList.add("dim"):this.toogleAllVisibleButton.classList.remove("dim")},c.prototype.setLayerVisible=function(a,b){var c=b;null===a||b||(c=!this.viewer.impl.layers.isLayerVisible(a)),this.viewer.setLayerVisible(a,c,b),this.viewer.clearSelection()},c.prototype.getNodeLabel=function(a){return a.isLayer||0===a.childCount?a.name:a.name+" ("+a.childCount+")"},c.prototype.getNodeClass=function(a){return""},c.prototype.isGroupNode=function(a){return!a.isLayer},c.prototype.shouldInclude=function(a){return!0},c.prototype.onIconClick=function(a,b){this.setGroupCollapsed(a,!this.isGroupCollapsed(a))},c.prototype.setGroupCollapsed=function(a,b){var c=this.tree.delegate();if(c.isTreeNodeGroup(a)){var d=c.getTreeNodeId(a);this.tree.setCollapsed(d,b)}},c.prototype.isGroupCollapsed=function(a){var b=this.tree.delegate();if(b.isTreeNodeGroup(a)){var c=b.getTreeNodeId(a);return this.tree.isCollapsed(c)}return!1},c.prototype.onClick=function(a,b){},c.prototype.onDoubleClick=function(a,b){},c.prototype.onRightClick=function(a,b){},c.prototype.onImageClick=function(a,b){},c.prototype.getContentSize=function(){var a={width:0,height:this.options.heightAdjustment||0},b=this.filterbox.container;a.width+=b.clientWidth,a.height+=b.clientHeight;var c=this.container.querySelectorAll("leaf");return c.length>1&&(a.height+=c[1].clientHeight*c.length),a},c.prototype.createNode=function(b,c){var d=document.createElement("div");d.dbId=b,d.classList.add("visibility"),d.title=a.i18n.translate("Show/hide this layer"),d.addEventListener("mousedown",function(a){a.preventDefault(),a.stopPropagation()}.bind(this)),d.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation(),this.onImageClick(b,a)}.bind(this)),c.appendChild(d);var e=document.createElement("label");e.textContent=this.getNodeLabel(b),c.appendChild(e)},Autodesk.Viewing.UI.LayersPanel=c}(),AutodeskNamespace("Autodesk.Viewing.UI"),Autodesk.Viewing.UI.SettingsPanel=function(a,b,c,d){Autodesk.Viewing;Autodesk.Viewing.UI.DockingPanel.call(this,a,b,c,d),this.panelTabs=[],this.tabIdToIndex={},this.controls={},this.controlIdCount=0,this.shown=!1;var e=this,f=d&&void 0!==d.width?d.width:340;this.container.style.maxWidth="800px",this.container.style.minWidth=f+"px",this.container.style.top="10px",this.container.style.left=a.offsetWidth/2-170+"px",this.container.style.position="absolute",this.tabContainer=document.createElement("div"),this.tabContainer.classList.add("docking-panel-container-solid-color-b"),this.tabContainer.classList.add("settings-tabs"),this.tabContainer.classList.add("docking-panel-delimiter-shadow"),this.container.appendChild(this.tabContainer),this.tabs=document.createElement("ul"),this.tabContainer.appendChild(this.tabs),this.heightAdjustment=d&&d.heightAdjustment?d.heightAdjustment:179,this.createScrollContainer({left:!1,heightAdjustment:this.heightAdjustment,marginTop:0}),this.tablesContainer=document.createElement("div"),this.tablesContainer.classList.add("settings-tabs-tables-container"),this.scrollContainer.appendChild(this.tablesContainer),this.mouseOver=!1,this.addEventListener(this.container,"mouseover",function(a){var b=a.toElement||a.relatedTarget;if(e.mouseOver)return!0;for(var c=0;b&&b.parentNode&&b.parentNode!=window;){if(b.parentNode==this||b==this){b.preventDefault&&b.preventDefault(),e.mouseOver=!0;for(var c=0;c<e.panelTabs.length;c++)e.panelTabs[c].classList.remove("selectedmouseout");return!0}b=b.parentNode}}),this.addEventListener(this.container,"mouseout",function(a){var b=a.toElement||a.relatedTarget;if(e.mouseOver){for(;b&&b.parentNode&&b.parentNode!=window;){if(b.parentNode==this||b==this)return b.preventDefault&&b.preventDefault(),!1;b=b.parentNode}e.mouseOver=!1;for(var c=0;c<e.panelTabs.length;c++)e.panelTabs[c].classList.contains("tabselected")&&e.panelTabs[c].classList.add("selectedmouseout")}}),this.expandID=function(a){return b+"-"+a}},Autodesk.Viewing.UI.SettingsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype),Autodesk.Viewing.UI.SettingsPanel.prototype.constructor=Autodesk.Viewing.UI.SettingsPanel,Autodesk.Viewing.UI.SettingsPanel.prototype.setVisible=function(a){a&&(this.container.style.display="block",this.shown||this.resizeToContent(),this.shown=!0),Autodesk.Viewing.UI.DockingPanel.prototype.setVisible.call(this,a)},Autodesk.Viewing.UI.SettingsPanel.prototype.addTab=function(a,b,c){function d(b){e.selectTab(a)}var e=this;if(void 0!==this.tabIdToIndex[a])return!1;var f=c&&void 0!==c.className?c.className:null,g=c&&void 0!==c.width?c.width:200,h=c&&void 0!==c.index?c.index:this.panelTabs.length,i=document.createElement("li");i._id=a,i.id=this.expandID(i._id),i.classList.add(f);var j=document.createElement("a"),k=document.createElement("span");k.setAttribute("data-i18n",b),k.textContent=Autodesk.Viewing.i18n.translate(b),j.appendChild(k),i.appendChild(j),this.tabs.appendChild(i);var l=document.createElement("table");l._id=a+"-table",l.id=this.expandID(l._id),l.classList.add("settings-table"),l.classList.add("adsk-lmv-tftable"),l.classList.add(f);var m=document.createElement("tbody");return l.appendChild(m),this.tablesContainer.appendChild(l),this.addEventListener(i,"touchstart",av.touchStartToClick),this.addEventListener(i,"click",d),this.panelTabs.push(i),this.tabIdToIndex[a]=h,g>(this.container.style.minWidth?parseInt(this.container.style.minWidth):0)&&(this.container.style.minWidth=g+"px"),!0},Autodesk.Viewing.UI.SettingsPanel.prototype.removeTab=function(a){var b=this.tabIdToIndex[a];if(!b)return!1;this.panelTabs.splice(b,1),this.tabs.removeChild(tabDom),this.tabIdToIndex={};for(var c=this.panelTabs.length,d=0;d<c;d++){var e=this.panelTabs[d];this.tabIdToIndex[e._id]=d}return!0},Autodesk.Viewing.UI.SettingsPanel.prototype.hasTab=function(a){var b=this.tabIdToIndex[a];return void 0!==this.panelTabs[b]},Autodesk.Viewing.UI.SettingsPanel.prototype.selectTab=function(a){if(this.isTabSelected(a))return!1;for(var b=this.panelTabs.length,c=0;c<b;c++){var d=this.panelTabs[c],e=document.getElementById(this.expandID(d._id+"-table"));a===d._id?(d.classList.add("tabselected"),e.classList.add("settings-selected-table"),this.mouseOver||d.classList.add("selectedmouseout")):(d.classList.remove("tabselected"),e.classList.remove("settings-selected-table"),this.mouseOver||this.panelTabs[c].classList.remove("selectedmouseout"))}return this.scrollContainer.scrollTop=0,!0},Autodesk.Viewing.UI.SettingsPanel.prototype.isTabSelected=function(a){var b=this.tabIdToIndex[a],c=this.panelTabs[b];return c&&c.classList.contains("tabselected")},Autodesk.Viewing.UI.SettingsPanel.prototype.addCheckbox=function(a,b,c,d,e,f){if(void 0===this.tabIdToIndex[a])return null;var g=document.getElementById(this.expandID(a+"-table")),h=new Autodesk.Viewing.Private.OptionCheckbox(b,g.tBodies[0],c,e,f);return h.changeListener=function(a){var b=a.detail.target.checked;d(b)},this.addEventListener(h,"change",h.changeListener),this.addControl(a,h)},Autodesk.Viewing.UI.SettingsPanel.prototype.addSlider=function(a,b,c,d,e,f,g){if(void 0===this.tabIdToIndex[a])return null;var h=document.getElementById(this.expandID(a+"-table")),i=new Autodesk.Viewing.Private.OptionSlider(b,c,d,h.tBodies[0],g);return i.setValue(e),i.sliderElement.step=i.stepperElement.step=1,this.addEventListener(i,"change",function(a){f(a)}),this.addControl(a,i)},Autodesk.Viewing.UI.SettingsPanel.prototype.addDropDownMenu=function(a,b,c,d,e,f){if(void 0===this.tabIdToIndex[a])return null;var g=document.getElementById(this.expandID(a+"-table")),h=new Autodesk.Viewing.Private.OptionDropDown(b,g.tBodies[0],c,d,f);return this.addEventListener(h,"change",function(a){e(a)}),this.addControl(a,h)},Autodesk.Viewing.UI.SettingsPanel.prototype.addControl=function(a,b,c){if(void 0===this.tabIdToIndex[a])return null;if(!b.hasOwnProperty("sliderRow")){var d=c&&c.insertAtIndex?c.insertAtIndex:-1,e=c&&c.caption?c.caption:null,f=document.getElementById(this.expandID(a+"-table"));d>f.length&&(d=-1);var g=f.tBodies[0].insertRow(d),h=g.insertCell(0);if(e){var i=document.createElement("div");i.setAttribute("data-i18n",e),i.textContent=Autodesk.Viewing.i18n.translate(e),h.appendChild(i),h=g.insertCell(1)}else h.colSpan=3;h.appendChild(b),b.sliderRow=g,b.tbody=f.tBodies[0]}var j=this.expandID("adsk_settings_control_id_"+this.controlIdCount.toString());return this.controlIdCount=this.controlIdCount+1,this.controls[j]=b,j},Autodesk.Viewing.UI.SettingsPanel.prototype.removeCheckbox=function(a){return this.removeControl(a)},Autodesk.Viewing.UI.SettingsPanel.prototype.removeSlider=function(a){return this.removeControl(a)},Autodesk.Viewing.UI.SettingsPanel.prototype.removeDropdownMenu=function(a){return this.removeControl(a)},Autodesk.Viewing.UI.SettingsPanel.prototype.removeControl=function(a){var b;if("object"==typeof a&&a.tbody){b=a;for(var c in this.controls)if(this.controls[c]===b){a=c;break}}else b=this.controls[a];if(void 0===b)return!1;var d=b.tbody,e=b.sliderRow,f=e.rowIndex;return d.deleteRow(f),delete this.controls[a],!0},Autodesk.Viewing.UI.SettingsPanel.prototype.getControl=function(a){return this.controls[a]||null},Autodesk.Viewing.UI.SettingsPanel.prototype.getContentSize=function(){for(var a=this.heightAdjustment,b=0,c=0;c<this.panelTabs.length;c++){var d=this.panelTabs[c],e=document.getElementById(this.expandID(d._id+"-table"));b=Math.max(b,e.clientHeight)}return{height:a+b,width:this.container.clientWidth}},function(){"use strict";var a=function(){};a.instances=[],a.displayError=function(b,c,d,e,f){var g=document.createElement("div");g.className="alert-box error",b.appendChild(g);var h=e;h||(h="img-item-not-found");var i=document.createElement("div");i.className="alert-box-image "+h,g.appendChild(i);var j=document.createElement("div");j.className="alert-box-msg",g.appendChild(j);var k=d;k||(k=Autodesk.Viewing.i18n.translate("Error Occurred",{defaultValue:"Error Occurred"}));var l=document.createElement("div");l.className="alert-box-title",l.textContent=k,l.setAttribute("data-i18n",k),j.appendChild(l);var m=document.createElement("div");if(m.className="alert-box-text",m.textContent=c,m.setAttribute("data-i18n",c),j.appendChild(m),f){var n=document.createElement("div");n.className="alert-box-content",j.appendChild(n);var o=document.createElement("ul");o.className="alert-box-content";for(var p=0;p<f.length;p++){var q=f[p];if(q){var r=document.createElement("li"),s=this.extractList(q);if(s.list.length){var t=this.generateListElement(list);o.appendChild(t)}r.innerHTML=s.msg,r.setAttribute("data-i18n",s.msg),o.appendChild(r)}}n.appendChild(o)}var u=document.createElement("div");u.className="alert-box-ok",u.textContent=Autodesk.Viewing.i18n.translate("OK",{defaultValue:"OK"});var v={alertBox:g,container:b};u.addEventListener("click",function(c){g.style.visibility="hidden",b.removeChild(g),a.instances.splice(a.instances.indexOf(v),1)}),g.appendChild(u),g.style.visibility="visible",a.instances.push(v)},a.displayErrors=function(b,c,d){var e=document.createElement("div");e.className="alert-box errors",b.appendChild(e);var f=c;f||(f="img-item-not-found");var g=document.createElement("div");g.className="alert-box-image "+f,e.appendChild(g);var h=document.createElement("div");h.className="alert-box-msg errors",e.appendChild(h);for(var i=0;i<d.length;i++){var j=d[i].header;j||(j=Autodesk.Viewing.i18n.translate("Error",{defaultValue:"Error"}));var k=document.createElement("div");k.className="alert-box-title errors",k.textContent=j,h.appendChild(k);var l=document.createElement("div");l.className="alert-box-text errors";var m=d[i].msg,n=this.extractList(m);if(n.list.length){var o=document.createElement("div"),p=this.generateListElement(n.list);o.appendChild(p),l.textContent=n.msg,l.appendChild(o)}else l.textContent=m;if(h.appendChild(l),d[i].hints){var q=document.createElement("ul");q.className="alert-box-content";for(var r=d[i].hints,s=0;s<r.length;s++){var t=r[s];if(t){var u=document.createElement("li");q.appendChild(u);var n=this.extractList(t);if(n.list.length){var p=this.generateListElement(n.list);q.appendChild(p)}u.innerHTML=n.msg}}h.appendChild(q)}}var v=document.createElement("div");v.className="alert-box-ok",v.textContent=Autodesk.Viewing.i18n.translate("OK",{defaultValue:"OK"});var w={alertBox:e,container:b};v.addEventListener("click",function(c){e.style.visibility="hidden",b.removeChild(e),a.instances.splice(a.instances.indexOf(w),1)}),e.appendChild(v),e.style.visibility="visible",a.instances.push(w)},a.extractList=function(a){var b={msg:a,list:[]};if(a&&-1!=a.indexOf("<ul>")){var c=a.split("<ul>");b.msg=c[0],c=c[1].split("</ul>"),b.list=c[0].split(", "),1===b.list.length&&(b.list=c[0].split(","))}return b},a.generateListElement=function(a){for(var b=document.createElement("ul"),c=0;c<a.length;c++){var d=document.createElement("li");d.textContent=a[c],d.setAttribute("data-i18n",a[c]),b.appendChild(d)}return b},a.dismiss=function(){if(a.instances.length>0){var b=a.instances.pop();return b.alertBox.style.visibility="hidden",b.container.removeChild(b.alertBox),!0}return!1},Autodesk.Viewing.Private.AlertBox=a}(),function(){"use strict";var a=Autodesk.Viewing,b=function(){};b.instances=[],b.displayMessage=function(c,d,e,f,g){function h(a){var b=window.getComputedStyle(a),c={top:parseInt(b["margin-top"]),bottom:parseInt(b["margin-bottom"])};return a.getBoundingClientRect().height+c.top+c.bottom}if(!(b.instances.length>0)){var i=d.msgTitleKey,j=d.msgTitleDefaultValue||i,k=d.messageKey,l=d.messageDefaultValue||k,m=d.buttonText,n=d.checkboxChecked||!1,o=document.createElement("div");o.classList.add("docking-panel"),o.classList.add("hud"),c.appendChild(o);var p=document.createElement("div");if(p.classList.add("docking-panel-title"),p.classList.add("docking-panel-delimiter-shadow"),p.textContent=a.i18n.translate(i,{defaultValue:j}),p.setAttribute("data-i18n",i),o.appendChild(p),e){var q=document.createElement("div");q.classList.add("docking-panel-close"),q.addEventListener("click",function(a){b.dismiss(),e&&e(a)}),o.appendChild(q)}var r=document.createElement("div");r.classList.add("hud-client"),r.classList.add("docking-panel-container-solid-color-b"),o.appendChild(r);var s=document.createElement("div");s.className="hud-message",s.textContent=a.i18n.translate(k,{defaultValue:l}),s.setAttribute("data-i18n",l),r.appendChild(s);var t=h(s);if(f){var u=document.createElement("div");u.classList.add("docking-panel-primary-button"),u.classList.add("hud-button"),u.textContent=a.i18n.translate(m,{defaultValue:m}),u.setAttribute("data-i18n",m),u.addEventListener("click",f),r.appendChild(u),t+=h(u)}if(g){var v=document.createElement("div"),w=document.createElement("input");w.className="hud-checkbox",w.type="checkbox",w.checked=n,v.appendChild(w);var x="Do not show this message again",y=document.createElement("label");y.setAttribute("for",x),y.setAttribute("data-i18n",x),y.textContent=a.i18n.translate(x,{defaultValue:x}),v.appendChild(y),w.addEventListener("change",g),r.appendChild(v),t+=h(g)}r.style.height=t+"px",o.style.height=t+h(p)+"px";var z={hudMessage:o,container:c};b.instances.push(z)}},b.dismiss=function(){if(b.instances.length>0){var a=b.instances.pop();return a.hudMessage.style.visibility="hidden",a.container.removeChild(a.hudMessage),!0}return!1},Autodesk.Viewing.Private.HudMessage=b}(),function(){"use strict";var a=function(){},b=Autodesk.Viewing,c=Autodesk.Viewing.Private;a.prototype.constructor=a,a.prototype.getNodeId=function(a){throw"getId is not implemented."},a.prototype.getNodeLabel=function(a){return a.name},a.prototype.getNodeClass=function(a){return""},a.prototype.hasThumbnail=function(a){return!1},a.prototype.getThumbnailOptions=function(a){return null},a.prototype.getThumbnail=function(a){return null},a.prototype.onNodeClick=function(a,b,c){},a.prototype.onNodeHover=function(a,b,c){},a.prototype.selectItem=function(a){},a.prototype.deselectItem=function(a){},a.prototype.hasContent=function(a){return!1},a.prototype.addContent=function(a,b){};var d=function(a,b,c){this.myDelegate=a,this.mySelectedIds=[];this.myRootContainerId=c+"-browserview",this.idToElement={},this.myRootContainer=document.createElement("div"),this.myRootContainer.id=this.myRootContainerId,this.myRootContainer.classList.add("browserview"),document.getElementById(c).appendChild(this.myRootContainer),this.createElements(b,this.myRootContainer)};d.prototype.constructor=d,d.prototype.show=function(a){a?(this.myRootContainer.classList.remove("browserHidden"),this.myRootContainer.classList.add("browserVisible"),this.myRootContainer.style.display="block"):(this.myRootContainer.classList.remove("browserVisible"),this.myRootContainer.classList.add("browserHidden"),this.myRootContainer.style.display="none")},d.prototype.getRootContainer=function(){return this.myRootContainer},d.prototype.delegate=function(){return this.myDelegate},d.prototype.addToSelection=function(a){for(var b=this,c=0,d=a.length;c<d;++c){var e=a[c];if(function(a){return-1==b.mySelectedIds.indexOf(a)&&(b.mySelectedIds.push(a),!0)}(e)){var f=b.idToElement[e];void 0===f?b.myDelegate.selectItem(e):f.classList.add("selected")}}},d.prototype.removeFromSelection=function(a){for(var b=this,c=a.length-1;c>=0;--c){var d=a[c];if(function(a){var c=b.mySelectedIds.indexOf(a);return-1!=c&&(b.mySelectedIds.splice(c,1),!0)}(d)){var e=this.idToElement[d];void 0===e?b.myDelegate.deselectItem(d):e.classList.remove("selected")}}},d.prototype.setSelection=function(a){return this.removeFromSelection(this.mySelectedIds),this.addToSelection(a),this.mySelectedIds},d.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)},d.prototype.createElements=function(a,b){if(a)for(var c=this,d=0;d<a.length;d++){var e=a[d];c.createElement(e,b)}},d.prototype.createElement=function(a,d){var e=this,f=e.myDelegate.getNodeId(a),g=document.createElement("item");d.appendChild(g),this.idToElement[f]=g,g.onmouseover=function(){e.myDelegate.onNodeHover(e,a)},g.onclick=function(b){e.myRootContainer.querySelector(".flipped").removeClass("flipped"),e.myDelegate.onNodeClick(e,a,b)};var h=document.createElement("div");h.classList.add("card"),g.appendChild(h);var i=document.createElement("div");i.classList.add("browserElement"),h.appendChild(i);var j=e.myDelegate.getNodeLabel(a),k=document.createElement("label");k.innerHTML=j,i.appendChild(k),k.onclick=function(b){e.myDelegate.onNodeClick(e,a,b)};var l=e.myDelegate.getThumbnail(a);if(l){var m=document.createElement("img");m.classList.add("thumb");var n=e.myDelegate.getThumbnailOptions(a);b.Document.requestThumbnailWithSecurity(n,function(a,d){if(a)return void c.logger.error("Failed to load thumbnail: "+l,b.errorCodeString(b.ErrorCodes.NETWORK_FAILURE));m.src=window.URL.createObjectURL(d),m.onload=function(){window.URL.revokeObjectURL(m.src)}}),i.appendChild(m),m.onclick=function(b){e.myDelegate.onNodeClick(e,a,b)}}e.myDelegate.hasContent(a)&&e.myDelegate.addContent(a,h),g.classList.add(e.myDelegate.getNodeClass(a))},Autodesk.Viewing.Private.BrowserDelegate=a,Autodesk.Viewing.Private.Browser=d}(),AutodeskNamespace("Autodesk.Viewing.Private"),function(){var a=Autodesk.Viewing.Private;a.WEBGL_HELP_LINK=null,a.ErrorInfoData={1:{img:"img-reload","globalized-msg":"Viewer-UnknownFailure","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint>Try loading the item again. </hint><hint>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},2:{img:"img-unsupported","globalized-msg":"Viewer-BadData","default-msg":"<title> Sorry </title><message>The item you are trying to view was not processed completely. </message><hint>Try loading the item again.</hint><hint>Please upload the file again to see if that fixes the issue.</hint>"},3:{img:"img-reload","globalized-msg":"Viewer-NetworkError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},4:{img:"img-unloack","globalized-msg":"Viewer-AccessDenied","default-msg":"<title> No access </title><message>Sorry. You dont have the required privileges to access this item.</message><hint> Please contact the author</hint>"},5:{img:"img-item-not-found","globalized-msg":"Viewer-FileNotFound","default-msg":'<title> Sorry </title><message>We cant display the item you are looking for. It may not have been processed yet. It may have been moved, deleted, or you may be using a corrupt file or unsupported file format.</message><hint> Try loading the item again.</hint><hint> Please upload the file again to see if that fixes the issue.</hint><hint> <a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-488804D0-B0B0-4413-8741-4F5EE0FACC4A" target="_blank">See a list of supported formats.</a></hint>'},6:{img:"img-reload","globalized-msg":"Viewer-ServerError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},7:{img:"img-reload","globalized-msg":"Viewer-UnhandledResponseCode","default-msg":"<title> Network problem </title><message>Sorry. We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},8:{img:"img-unsupported","globalized-msg":"Viewer-WebGlNotSupported","default-msg":'<title>Sorry</title><message>We can\'t show this item because this browser doesn\'t support WebGL.</message><hint>Try Google Chrome, Mozilla Firefox, or another browser that supports WebGL 3D graphics.</hint><hint>For more information, see the <a href="WEBGL_HELP" target="_blank">A360 browser reqirements.</a></hint>'},9:{img:"img-item-not-found","globalized-msg":"Viewer-NoViewable","default-msg":"<title> No viewable content </title><message>Theres nothing to display for this item. It may not have been processed or it may not have content we can display.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},10:{img:"img-unsupported","globalized-msg":"Viewer-WebGlDisabled","default-msg":'<title>Sorry</title><message>We can\'t show this item because WebGL is disabled on this device.</message><hint> For more information see the <a href="WEBGL_HELP" target="_blank">A360 Help.</a></hint>'},11:{img:"img-item-not-found","globalized-msg":"Viewer-ModeIsEmpty","default-msg":"<title>Model is empty</title><message>Model is empty, there is no geometry for the viewer to show.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},12:{img:"img-unsupported","globalized-msg":"Viewer-RTCError","default-msg":"<title> Sorry </title><message>We couldnt connect to the Collaboration server.</message><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},13:{img:"img-unsupported","globalized-msg":"Viewer-FileExtNotSupported","default-msg":{title:"Sorry",message:"The file extension loaded into the Viewer is not supported",hints:["Try a different file"]}}},a.currentError=null,a.currentErrors=null,a.ErrorHandler=function(){},a.ErrorHandler.prototype.constructor=a.ErrorHandler,a.ErrorHandler.reportError=function(b,c,d,e,f,g){if(a.ErrorHandler.currentError=null,a.ErrorHandler.currentErrors=null,c){var h={category:"error",code:c,message:d,httpStatusCode:e,httpStatusText:f};a.logger.track(h,!0),a.ErrorHandler.currentError=[b,c,d,g];var i=a.ErrorInfoData[c];if(i){var j={defaultValue:""};j.defaultValue=i["default-msg"];var k=i.img,l=i["globalized-msg"],m=this.parseErrorString(l,j);if(c===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_DISABLED||c===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED)for(var n=a.WEBGL_HELP_LINK||"http://www.autodesk.com/a360-browsers",o=0;o<m.hints.length;o++){var p=m.hints[o].indexOf('href="WEBGL_HELP"');-1!==p&&(m.hints[o]=m.hints[o].replace('href="WEBGL_HELP"','href="'+n+'"'))}a.AlertBox.displayError(b,m.msg,m.header,k,m.hints)}else{var k="img-unsupported",j={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"};this.parseArguments(d,j);var m=this.parseErrorString(c,j);m.header||(m.header="warning"===g?Autodesk.Viewing.i18n.translate("header-warning"):""),a.AlertBox.displayError(b,m.msg,m.header,k,m.hints)}}},a.ErrorHandler.reportErrors=function(b,c){if(a.ErrorHandler.currentError=null,a.ErrorHandler.currentErrors=null,c){a.ErrorHandler.currentErrors=[b,c];for(var d={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"},e=[],f=0;f<c.length;f++)if(c[f].code){this.parseArguments(c[f].message,d);var g=this.parseErrorString(c[f].code,d);g.header||(g.header="warning"===c[0].type?Autodesk.Viewing.i18n.translate("header-warning",{defaultValue:"Warning"}):""),e.push(g);var h={category:"error",code:c[f].code,message:c[f].message};a.logger.track(h,!0)}if(e.length){a.AlertBox.displayErrors(b,"img-unsupported",e)}}},a.ErrorHandler.parseArguments=function(a,b){if(a)if("string"==typeof a)b.defaultValue=a;else{b.defaultValue=a[0];for(var c=1;c<a.length;c++){var d=c-1,e=d.toString();b[e]=a[c]}}},a.ErrorHandler.parseErrorString=function(a,b){var c={msg:null,msgList:null,header:null,hints:null};if(!a)return c;if("object"==typeof b.defaultValue){var d=b.defaultValue;return c.header=d.title,c.msg=d.message,c.hints=d.hints.concat(),c}var e=Autodesk.Viewing.i18n.translate(a,b);if(!e)return c;if(-1!=e.indexOf("<title>")){var f=e.split("<title>")[1].split("</title>");c.header=f[0],e=f[1]}if(e&&-1!=e.indexOf("<message>")){var f=e.split("<message>")[1].split("</message>");c.msg=f[0],e=f[1]}else c.msg=e;if(e&&-1!=e.indexOf("<hint>")){c.hints=[];for(var g=e.split("<hint>"),h=0;h<g.length;h++){var i=g[h].split("</hint")[0];c.hints.push(i)}}return c},a.ErrorHandler.localize=function(){if(a.AlertBox.instances.length>0)if(a.AlertBox.dismiss(),a.ErrorHandler.currentError){var b=a.ErrorHandler.currentError.shift(),c=a.ErrorHandler.currentError;a.ErrorHandler.reportError(b,c[0],c[1],c[2])}else{var b=a.ErrorHandler.currentErrors.shift(),d=a.ErrorHandler.currentErrors[0];a.ErrorHandler.reportErrors(b,d)}}}(),Autodesk.Viewing.Extensions.ViewerPanelMixin=function(){this.getContainerBoundingRect=function(){var a=this.parentContainer.getBoundingClientRect(),b={height:0,width:0,left:0,bottom:0,right:0,top:0},c=document.getElementsByClassName("toolbar-menu");return c&&c.length>0&&(b=c[0].getBoundingClientRect()),{height:a.height-b.height,width:a.width,left:a.left,bottom:a.bottom-b.height,right:a.right,top:a.top}}},function(){"use strict";function a(a){var b=this.tree,c=a.toLowerCase(),d=[];return b.forEachDelegate(function(a){var e=a.getRootId(),f=[];b.iterate(a,e,function(b){var d=a.instanceTree.getNodeName(b);return d&&-1!==d.toLowerCase().indexOf(c)&&f.push(b),!0}),d.push({ids:f,delegate:a})}),d}var b=Autodesk.Viewing,c=Autodesk.Viewing.Private,d=Autodesk.Viewing.UI,e=Autodesk.Viewing.Extensions,f={click:{onObject:["toggleOverlayedSelection"]},clickShift:{onObject:["toggleMultipleOverlayedSelection"]},clickCtrl:{onObject:["toggleMultipleOverlayedSelection"]}};e.ViewerModelStructurePanel=function(b,c,e){this.viewer=b,this.visible=!1,this._trackNodeClick=!0,e=e||{},e.defaultTitle="Model",e.excludeRoot=void 0===e.excludeRoot||e.excludeRoot,e.startCollapsed=void 0!==e.startCollapsed&&e.startCollapsed,e.scrollEaseCurve=e.scrollEaseCurve||[0,0,.29,1],e.scrollEaseSpeed=void 0!==e.scrollEaseSpeed?e.scrollEaseSpeed:.003,e.addFooter=void 0===e.addFooter||e.addFooter,this.clickConfig=e&&e.docStructureConfig?e.docStructureConfig:f,this.isMac=-1!==navigator.userAgent.search("Mac OS"),e.hideSearch?(e.heightAdjustment=70,d.ModelStructurePanel.call(this,b.container,b.container.id+"ViewerModelStructurePanel",c,e),this.scrollContainer.classList.add("no-search")):(e.heightAdjustment=104,d.ModelStructurePanel.call(this,b.container,b.container.id+"ViewerModelStructurePanel",c,e),this.searchbox=new d.Searchbox(b.container.id+"ViewerModelStructurePanel-Searchbox",b,{excludeRoot:e.excludeRoot,searchFunction:a.bind(this)}),this.searchbox.addEventListener(d.Searchbox.Events.ON_SEARCH_SELECTED,function(a){var b=a.id,c=this.viewer.impl.findModel(a.modelId);this.viewer.select(b,c),this.viewer.fitToView([b],c,!1)}.bind(this)),this.container.appendChild(this.searchbox.container)),this._ignoreScroll=!1,this.selectedNodes={},this.onViewerSelect=this.onViewerSelect.bind(this),
this.onViewerIsolate=this.onViewerIsolate.bind(this),this.onViewerHide=this.onViewerHide.bind(this),this.onViewerShow=this.onViewerShow.bind(this)},e.ViewerModelStructurePanel.prototype=Object.create(d.ModelStructurePanel.prototype),e.ViewerModelStructurePanel.prototype.constructor=e.ViewerModelStructurePanel,e.ViewerPanelMixin.call(e.ViewerModelStructurePanel.prototype),e.ViewerModelStructurePanel.prototype.uninitialize=function(){this.viewer&&(this.viewer.removeEventListener(b.AGGREGATE_SELECTION_CHANGED_EVENT,this.onViewerSelect),this.viewer.removeEventListener(b.AGGREGATE_ISOLATION_CHANGED_EVENT,this.onViewerIsolate),this.viewer.removeEventListener(b.HIDE_EVENT,this.onViewerHide),this.viewer.removeEventListener(b.SHOW_EVENT,this.onViewerShow),this.viewer=null),this.searchResults&&(this.searchResults.uninitialize(),this.searchResults=null),d.ModelStructurePanel.prototype.uninitialize.call(this)},e.ViewerModelStructurePanel.prototype.resizeToContent=function(){var a=this.scrollContainer,b=this.tree?this.tree.getRootContainer():null;if(a&&b){var c="calc(100% + "+a.scrollLeft+"px)";b.style.width=c}},e.ViewerModelStructurePanel.prototype.createUI=function(){if(!this.uiCreated){var a=this.viewer;d.ModelStructurePanel.prototype.createUI.call(this);var c=this.scrollContainer;c.classList.remove("left");var e=function(){this.visible&&this.resizeToContent(),requestAnimationFrame(e)}.bind(this);e();var f=this.options,g=0,h=a.container.getBoundingClientRect(),i=a.getToolbar(!1);f.maxHeight?f.maxHeight:h.height;if(i){var j=i.container.getBoundingClientRect();g=h.bottom-j.top}else g=0;this.container.style.top="10px",this.container.style.left="10px",this.container.style.height="calc(100% - "+(g+20)+"px)",this.container.style.maxHeight="calc(100% - "+(g+20)+"px)",c.addEventListener("contextmenu",function(a){this.viewer.contextMenu.show(a)}.bind(this)),this.viewer.addEventListener(b.AGGREGATE_SELECTION_CHANGED_EVENT,this.onViewerSelect),this.viewer.addEventListener(b.AGGREGATE_ISOLATION_CHANGED_EVENT,this.onViewerIsolate),this.viewer.addEventListener(b.HIDE_EVENT,this.onViewerHide),this.viewer.addEventListener(b.SHOW_EVENT,this.onViewerShow)}},e.ViewerModelStructurePanel.prototype.onViewerSelect=function(a){this.setSelection(a.selections),this._ignoreScroll||this.scrollToSelection(a.selections),this._ignoreScroll=!1},e.ViewerModelStructurePanel.prototype.onViewerIsolate=function(a){this.setIsolation(a.isolation)},e.ViewerModelStructurePanel.prototype.onViewerHide=function(a){this.setHidden(a.nodeIdArray.slice(),a.model,!0)},e.ViewerModelStructurePanel.prototype.onViewerShow=function(a){this.setHidden(a.nodeIdArray.slice(),a.model,!1)},e.ViewerModelStructurePanel.prototype.setVisible=function(a){d.ModelStructurePanel.prototype.setVisible.call(this,a),this.visible!==a&&(this.visible=a,this.visible&&this.sync())},e.ViewerModelStructurePanel.prototype.sync=function(){var a=this.viewer.getAggregateIsolation();if(this.setIsolation(a),0===a.length)for(var b=this.viewer.getAggregateHiddenNodes(),c=0;c<b.length;++c){var d=b[c].model,e=b[c].ids;this.setHidden(e,d,!0)}var f=this.viewer.getAggregateSelection();this.setSelection(f),this.scrollToSelection(f)},e.ViewerModelStructurePanel.prototype.removeTreeUI=function(a){delete this.selectedNodes[a.id],d.ModelStructurePanel.prototype.removeTreeUI.call(this,a)},e.ViewerModelStructurePanel.prototype.setHidden=function(a,b,c){for(var d=this.tree,e=d.getDelegate(b.id),f=c?function(a){return d.addClass(e,a,"dim",!1),d.removeClass(e,a,"visible",!1),!0}:function(a){return d.removeClass(e,a,"dim",!1),d.addClass(e,a,"visible",!1),!0},g=0;g<a.length;++g)d.iterate(e,a[g],f)},e.ViewerModelStructurePanel.prototype.setIsolation=function(a){if(0===a.length){var b=this.tree;return void b.forEachDelegate(function(a){var c=a.model,d=a.instanceTree;if(d){var e=d.getRootId();b.iterate(a,e,function(c){return b.removeClass(a,c,"dim",!1),b.removeClass(a,c,"visible",!1),!0}),this.setHidden([e],c,!1)}}.bind(this))}var c=[];a.length&&this.tree.forEachDelegate(function(b){for(var d=-1,e=0;e<a.length;e++)if(a[e].model===b.model){d=e;break}-1===d&&c.push(b)}.bind(this));for(var d=0;d<a.length;++d){var e=a[d].model,f=e.getData().instanceTree,g=f.getRootId(),b=this.tree,h=b.getDelegate(e.id);b.iterate(h,g,function(a){return b.removeClass(h,a,"dim",!1),b.removeClass(h,a,"visible",!1),!0});var i=a[d].ids;if(0!==i.length){if(1===i.length&&i[0]===g)return;this.setHidden([g],e,!0),this.setHidden(i,e,!1)}}for(var d=0;d<c.length;++d){var b=this.tree,h=c[d],e=h.model,g=h.instanceTree.getRootId();b.iterate(h,g,function(a){return b.removeClass(h,a,"dim",!1),b.removeClass(h,a,"visible",!1),!0}),this.setHidden([g],e,!0)}},e.ViewerModelStructurePanel.prototype.setSelection=function(a){var b,c,d,e,f,g,h,i=this.tree,j=this.viewer.impl.modelQueue();for(var k in this.selectedNodes)if(e=j.findModel(parseInt(k)),f=this.selectedNodes[k],g=i.getDelegate(k),h=g.instanceTree){for(c=0;c<f.length;++c)for(d=h.getNodeParentId(f[b]);d;)i.removeClass(g,d,"ancestor-selected"),d=h.getNodeParentId(d);i.clearSelection(g)}for(this.selectedNodes={},b=0;b<a.length;++b)if(e=a[b].model,f=a[b].dbIdArray||a[b].selection,g=i.getDelegate(e.id),h=g.instanceTree){for(c=0;c<f.length;++c)for(d=h.getNodeParentId(f[b]);d;)i.addClass(g,d,"ancestor-selected"),d=h.getNodeParentId(d);i.setSelection(g,f),this.selectedNodes[e.id]=f.concat()}},e.ViewerModelStructurePanel.prototype.scrollToSelection=function(a){var b=a[0];if(b){var c=b.model,d=b.dbIdArray||b.selection,e=this.tree.scrollTo(d[0],c),f=this.scrollContainer.scrollTop;this.scrollContainer.scrollTop=e;var g=this.scrollContainer.scrollTop;this.scrollContainer.scrollTop=f,this.options.scrollEaseSpeed>0?this.animateScroll(f,g,function(a){this.tree.setScroll(a)}.bind(this)):(this.scrollContainer.scrollTop=g,this.tree.setScroll(g))}},e.ViewerModelStructurePanel.prototype.onEyeIcon=function(a,b){this.viewer.toggleVisibility(a,b)},e.ViewerModelStructurePanel.prototype.onTreeNodeClick=function(a,b,d,e){if(this._trackNodeClick&&(c.logger.track({category:"node_selected",name:"model_browser_tool"}),this._trackNodeClick=!1),!this.isMac||!e.ctrlKey){var f="click";this.ctrlDown(e)&&(f+="Ctrl"),e.shiftKey&&(f+="Shift"),e.altKey&&(f+="Alt");var g=["toggleOverlayedSelection"],h=this.clickConfig[f];h&&(g=h.onObject),this.handleAction(g,b,d)}},e.ViewerModelStructurePanel.prototype.onTreeNodeRightClick=function(a,b,c,d){return this.isMac&&d.ctrlKey&&0===d.button?(this.clickConfig&&this.clickConfig.clickCtrl&&this.handleAction(this.clickConfig.clickCtrl.onObject,b,c),null):this.viewer.contextMenu.show(d)},e.ViewerModelStructurePanel.prototype.handleAction=function(a,b,c){for(var d in a)switch(a[d]){case"toggleOverlayedSelection":this.toggleOverlayedSelection(b,c);break;case"toggleMultipleOverlayedSelection":this.toggleMultipleOverlayedSelection(b,c);break;case"selectOnly":this.viewer.select(b,c);break;case"deselectAll":this.viewer.clearSelection();break;case"selectToggle":this.viewer.toggleSelect(b,c);break;case"isolate":this.viewer.isolate(b,c);break;case"showAll":this.viewer.showAll();break;case"focus":this.viewer.fitToView();break;case"hide":this.viewer.hide(b,c);break;case"show":this.viewer.show(b,c);break;case"toggleVisibility":this.viewer.toggleVisibility(b,c)}},e.ViewerModelStructurePanel.prototype.toggleOverlayedSelection=function(a,b){var c=this.selectedNodes[b.id],d=c?c.indexOf(a):-1;this._ignoreScroll=!0,-1===d?(this.viewer.select(a,b),this.viewer.fitToView([a],b,!1)):this.viewer.select([],void 0,b)},e.ViewerModelStructurePanel.prototype.toggleMultipleOverlayedSelection=function(a,b){var c=this.selectedNodes[b.id],d=c?c.indexOf(a):-1;-1===d?(c||(c=this.selectedNodes[b.id]=[]),c.push(a)):c.splice(d,1);var e=[];for(var f in this.selectedNodes)if(this.selectedNodes.hasOwnProperty(f)){var b=this.viewer.impl.findModel(parseInt(f)),g=this.selectedNodes[f];e.push({model:b,ids:g})}this._ignoreScroll=!0,this.viewer.impl.selector.setAggregateSelection(e);var h=this.viewer.getAggregateSelection();this.viewer.fitToView(h)},e.ViewerModelStructurePanel.prototype.ctrlDown=function(a){return this.isMac&&a.metaKey||!this.isMac&&a.ctrlKey}}(),function(){"use strict";function a(a){var b=a.getDocumentNode(),c=b&&b.findViewableParent();return!(!c||-1===c.name().toLocaleLowerCase().indexOf(".sld"))}function b(a,b,c){return new Promise(function(d,e){a.getBulkProperties(b,{ignoreHidden:!0},function(a){for(var b=0,e=a.length;b<e;++b)for(var f=a[b],g=0,h=f.properties.length;g<h;++g){for(var i=f.properties[g],j=!0,k=0,l=c.properties.length;k<l;++k)c.properties[k].displayName===i.displayName&&(j=!1,k=l);j&&c.properties.push(i)}d(c)})})}var c=Autodesk.Viewing,d=c.UI,e=function(a){this.viewer=a,this.currentNodeIds=[],this.currentModel=null,this.isDirty=!0,this.propertyNodeId=null,this.normalTitle="Properties",this.loadingTitle="Object Properties Loading...",d.PropertyPanel.call(this,a.container,"ViewerPropertyPanel",this.loadingTitle)};e.prototype=Object.create(d.PropertyPanel.prototype),e.prototype.constructor=e,c.Extensions.ViewerPanelMixin.call(e.prototype),e.prototype.initialize=function(){d.PropertyPanel.prototype.initialize.call(this);var a=this;a.addEventListener(a.viewer,c.AGGREGATE_SELECTION_CHANGED_EVENT,function(b){b.selections&&b.selections.length?(a.currentNodeIds=b.selections[0].dbIdArray,a.currentModel=b.selections[0].model):(a.currentNodeIds=[],a.currentModel=null),a.isDirty=!0,a.requestProperties()}),a.addEventListener(a.viewer,c.HIDE_EVENT,function(b){a.isDirty=!0,a.requestProperties()}),a.addEventListener(a.viewer,c.SHOW_EVENT,function(b){a.isDirty=!0,a.requestProperties()});var b=this.viewer.getAggregateSelection();b.length?(this.currentModel=b[0].model,this.currentNodeIds=b[0].selection):(this.currentModel=null,this.currentNodeIds=[])},e.prototype.setTitle=function(a,b){a||(a="Object Properties",b=b||{},b.localizeTitle=!0),d.PropertyPanel.prototype.setTitle.call(this,a,b)},e.prototype.setVisible=function(a){d.DockingPanel.prototype.setVisible.call(this,a),this.requestProperties()},e.prototype.visibilityChanged=function(){d.DockingPanel.prototype.visibilityChanged.call(this),this.isVisible()&&this.requestProperties()},e.prototype.requestProperties=function(){this.isVisible()&&this.isDirty&&(this.currentModel&&this.currentNodeIds.length>0?this.setNodeProperties(this.currentNodeIds[this.currentNodeIds.length-1]):this.showDefaultProperties(),this.isDirty=!1)},e.prototype.setNodeProperties=function(c){var d=this;this.propertyNodeId=c,d.currentModel.getProperties(c,function(c){if(d.viewer){for(var e=[],f=c.properties,g=0,h=f.length;g<h;++g){var i=f[g];"__internalref__"===i.displayCategory&&e.push(i.displayValue)}var j;j=a(d.currentModel)&&e.length>0?b(d.currentModel,e,c):Promise.resolve(c),j.then(function(a){d.setTitle(d.normalTitle,{localizeTitle:!0}),d.setProperties(a.properties),d.highlight(d.viewer.searchText),d.resizeToContent(),d.respositionPanel()}).catch(function(){d.setProperties([]),d.highlight(""),d.resizeToContent(),d.respositionPanel()})}})},e.prototype.respositionPanel=function(){if(this.isVisible()){var a=this.viewer.toolController,b=a.lastClickX,c=a.lastClickY,d=this.container.getBoundingClientRect(),e=d.left,f=d.top,g=d.width,h=d.height,i=this.viewer.impl.getCanvasBoundingClientRect(),j=i.left,k=i.top,l=i.width,m=i.height;e<=b&&b<e+g&&f<=c&&c<f+h&&(b<e+g/2&&b+g<j+l?(this.container.style.left=Math.round(b-j)+"px",this.container.dockRight=!1):j<=b-g?(this.container.style.left=Math.round(b-j-g)+"px",this.container.dockRight=!1):b+g<j+l?(this.container.style.left=Math.round(b-j)+"px",this.container.dockRight=!1):c+h<k+m?(this.container.style.top=Math.round(c-k)+"px",this.container.dockBottom=!1):k<=c-h&&(this.container.style.top=Math.round(c-k-h)+"px",this.container.dockBottom=!1))}},e.prototype.showDefaultProperties=function(){var a=this.currentModel?this.currentModel.getRootId():null;a?this.setNodeProperties(a):(this.propertyNodeId=null,this.setTitle(this.normalTitle,{localizeTitle:!0}),d.PropertyPanel.prototype.showDefaultProperties.call(this))},e.prototype.areDefaultPropertiesShown=function(){if(!this.currentModel)return!1;var a=this.currentModel.getRootId();return this.propertyNodeId===a},e.prototype.uninitialize=function(){d.PropertyPanel.prototype.uninitialize.call(this),this.viewer=null},e.prototype.onCategoryClick=function(a,b){d.PropertyPanel.prototype.onCategoryClick.call(this,a,b),this.resizeToContent()},e.prototype.onCategoryIconClick=function(a,b){d.PropertyPanel.prototype.onCategoryIconClick.call(this,a,b),this.resizeToContent()},Autodesk.Viewing.Extensions.ViewerPropertyPanel=e}(),function(){"use strict";var a=function(a){var b=a.container;Autodesk.Viewing.UI.LayersPanel.call(this,a,b,b.id+"ViewerLayersPanel",{heightAdjustment:55}),this.onRestoreStateBinded=this.onRestoreState.bind(this),this.viewer.addEventListener(Autodesk.Viewing.VIEWER_STATE_RESTORED_EVENT,this.onRestoreStateBinded)};a.prototype=Object.create(Autodesk.Viewing.UI.LayersPanel.prototype),a.prototype.constructor=a,Autodesk.Viewing.Extensions.ViewerPanelMixin.call(a.prototype),a.prototype.uninitialize=function(){this.onRestoreStateBinded&&(this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_STATE_RESTORED_EVENT,this.onRestoreStateBinded),this.onRestoreStateBinded=null),Autodesk.Viewing.UI.LayersPanel.prototype.uninitialize.call(this)},a.prototype.onRestoreState=function(){this.update()},a.prototype.onClick=function(a,b){if(!this.isMac||!b.ctrlKey){var c=!(b.shiftKey||b.metaKey||b.ctrlKey);this.setLayerVisible(a,c)}},a.prototype.onRightClick=function(a,b){var c=!(b.shiftKey||b.metaKey||b.ctrlKey);this.setLayerVisible(a,c)},a.prototype.onImageClick=function(a,b){this.isMac&&b.ctrlKey||this.setLayerVisible(a)},a.prototype.onTitleClick=function(a){this.viewer.setLayerVisible(null,!0)},a.prototype.onTitleDoubleClick=function(a){this.viewer.fitToView()},Autodesk.Viewing.Extensions.ViewerLayersPanel=a}(),function(){"use strict";var a=Autodesk.Viewing,b=a.Private,c=Autodesk.Viewing.Extensions,d=Autodesk.Viewing.UI;c.ViewerSettingTab={Navigation:"navigationtab",Performance:"performancetab",Appearance:"appearance",Environment:"environment"};var e=0,f=function(a,f){this.viewer=a,this.is3dMode=!f.is2d(),this.visible=!1;var g=this;this.modalBackground=document.createElement("div"),this.modalBackground.classList.add("docking-panel-modal-background"),this.modalBackground.addEventListener("click",function(){g.setVisible(!1)}),d.SettingsPanel.call(this,a.container,"ViewerSettingsPanel"+a.id+"-"+e++,"Settings",{width:400,addFooter:!1,heightAdjustment:90}),this.container.classList.add("viewer-settings-panel"),this.addTab(c.ViewerSettingTab.Performance,"Performance",{className:"performance"}),this.addTab(c.ViewerSettingTab.Navigation,"Navigation",{className:"navigation"}),this.addTab(c.ViewerSettingTab.Appearance,"Appearance",{className:"appearance"}),this.is3dMode&&this.addTab(c.ViewerSettingTab.Environment,"Environment",{className:"environment"}),this.is3dMode||this.container.classList.add("for-2d-model"),this.restoreDefaultSettings(),this.modelPreferenceCount=0,this.createNavigationPanel(),this.createPerformancePanel(),this.createAppearancePanel(),this.is3dMode&&this.createEnvironmentPanel(),this.modelPreferenceCount&&b.logger.log("Model locked ("+this.modelPreferenceCount+") render settings in UI."),this.selectTab(c.ViewerSettingTab.Performance)};f.prototype=Object.create(d.SettingsPanel.prototype),f.prototype.constructor=f,c.ViewerPanelMixin.call(f.prototype),f.prototype.uninitialize=function(){this.viewer=null,d.SettingsPanel.prototype.uninitialize.call(this),this.envSelect=null},f.prototype.setVisible=function(a){this.visible=a,a?this.viewer.container.appendChild(this.modalBackground):this.modalBackground.parentNode&&this.viewer.container.removeChild(this.modalBackground);var b=function(){if(this.visible){var a=this.container.querySelector(".environments-container"),c=this.container.querySelector(".settings-environment-cell");if(!a||!c)return;var d=a.parentNode.getBoundingClientRect().width,e=c.getBoundingClientRect().width,f=Math.floor((d-40)/e)*e;a.style.width=f+"px",a.style.left=Math.round((d-f)/2)+"px",requestAnimationFrame(b)}}.bind(this);b(),d.SettingsPanel.prototype.setVisible.call(this,a)},f.prototype.addCheckbox=function(a,b,c,e,f,g){function h(a){g&&i.prefs.set(g,a),f(a)}var i=this.viewer,j=i.prefs[g];e="boolean"==typeof j?j:e;var k=d.SettingsPanel.prototype.addCheckbox.call(this,a,b,e,h,c),l=this.getControl(k);return l.saveKey=g,g?i.prefs.addListeners(g,function(a){l.setValue(a)},function(a){l.setValue(a),f(a)}):l.sliderRow.classList.add("logical-group"),i.prefs.hasTag(g,"no-storage")&&(l.sliderRow.classList.add("no-storage"),this.modelPreferenceCount++),k},f.prototype.addGrid=function(a,b,c,d,e,f,g){function h(){for(var a=l.prefs.lightPreset,b=i.querySelectorAll(".settings-environment-cell"),c=0;c<b.length;c++)b[c].index===a?b[c].classList.add("border-select"):b[c].classList.remove("border-select")}var i=b,j=document.createElement("div");j.classList.add("environments-container"),i.appendChild(j);var k=document.createElement("div");k.classList.add("environments-lighting-table"),j.appendChild(k);var l=this.viewer;if(e)for(var m=0;m<c.length;m++){var n=document.createElement("div");n.classList.add("settings-environment-cell"),n.index=m;var o=document.createElement("div");o.classList.add((m<10?"img0":"img")+m),o.classList.add("settings-environment-image"),n.appendChild(o);var p=document.createElement("span");p.textContent=c[m],p.classList.add("settings-environment-name"),n.appendChild(p),n.addEventListener("click",function(){f(this.index),h()}),k.appendChild(n)}return g&&this.viewer.prefs.addListeners(g,function(){},function(){f(l.prefs.lightPreset),h()}),h(),k},f.prototype.addLabel=function(a,d){var e,f=function(){switch(a){case c.ViewerSettingTab.Performance:return 0;case c.ViewerSettingTab.Navigation:return 1;case c.ViewerSettingTab.Appearance:return 2;case c.ViewerSettingTab.Environment:return 3;default:return-1}}();if(-1===f)return!1;e=this.tablesContainer.childNodes[f],this.settingsLabel=new b.OptionLabel(d,e.tBodies[0]),this.settingsLabel.sliderRow.classList.add("logical-group")},f.prototype.removeCheckbox=function(a){return this.viewer.prefs.removeListeners(a.saveKey),this.removeEventListener(a,"change",a.changeListener),d.SettingsPanel.prototype.removeCheckbox.call(this,a)},f.prototype.createNavigationPanel=function(){var b=this.viewer,d=c.ViewerSettingTab.Navigation;this.tablesContainer.childNodes[1],this.addCheckbox(d,"Navigation and selection",!1,function(){});this.container.querySelector("[id='Navigation and selection_check']").style.display="none",this.is3dMode&&(this.addLabel(d,"ViewCube"),this.addCheckbox(d,"Show ViewCube","Toggles availability of the ViewCube navigation control",!0,function(a){b.displayViewCube(a)},"viewCube"),a.isMobileDevice()||this.addCheckbox(d,"ViewCube acts on pivot","When enabled, the ViewCube orbits the view around the active pivot point When disabled, it orbits around the center of the view",!1,function(a){b.setUsePivotAlways(a)},"alwaysUsePivot"),this.addLabel(d,"Orbit"),this.addCheckbox(d,"Fusion style orbit","Enables Fusion-style orbit overlay and gives the ability to lock orbit axis",!1,function(a){a?b.loadExtension("Autodesk.Viewing.FusionOrbit",null):b.unloadExtension("Autodesk.Viewing.FusionOrbit",null)},"fusionOrbit"),this.addCheckbox(d,"Orbit past world poles","Allows view rotation to continue past the models North Pole",!0,function(a){b.setOrbitPastWorldPoles(a)},"orbitPastWorldPoles"),a.isMobileDevice()||(this.addLabel(d,"Zoom"),this.addCheckbox(d,"Zoom towards pivot","When disabled, zooming operations are centered at the current cursor location",!1,function(a){b.setZoomTowardsPivot(a)},"zoomTowardsPivot"),this.addCheckbox(d,"Reverse mouse zoom direction","Toggles direction of zooming in and out",!1,function(a){b.setReverseZoomDirection(a)},"reverseMouseZoomDir"),this.addLabel(d,"Mouse"),this.addCheckbox(d,"Left handed mouse setup","Swaps the buttons on the mouse",!1,function(a){b.setUseLeftHandedInput(a)},"leftHandedMouseSetup"),this.addCheckbox(d,"Set pivot with left mouse button","Change left-click behavior to set new pivot point (overrides select object)",!1,function(a){b.setClickToSetCOI(a)},"clickToSetCOI")),this.addCheckbox(d,"Open properties on select","Always show properties upon selecting object",!0,function(a){b.setPropertiesOnSelect(a)},"openPropertiesOnSelect")),this.is3dMode&&(this.addLabel(d,"Prototypes"),this.addCheckbox(d,"New First Person Tool","Enable new walkthrough mode.",b.prefs.get("useFirstPersonPrototype"),function(a){a?(b.unloadExtension("Autodesk.FirstPerson",b.config),b.loadExtension("Autodesk.BimWalk",b.config)):(b.unloadExtension("Autodesk.BimWalk",b.config),b.loadExtension("Autodesk.FirstPerson",b.config))},"useFirstPersonPrototype")),this.is3dMode||(this.addLabel(d,"Zoom"),this.addCheckbox(d,"Reverse mouse zoom direction","Toggles direction of zooming in and out",!1,function(a){b.setReverseZoomDirection(a)},"reverseMouseZoomDir"),this.addLabel(d,"Mouse"),this.addCheckbox(d,"Open properties on select","Always show properties upon selecting object",!0,function(a){b.setPropertiesOnSelect(a)},"openPropertiesOnSelect"),this.addCheckbox(d,"Left handed mouse setup","Swaps the buttons on the mouse",!1,function(a){b.setUseLeftHandedInput(a)},"leftHandedMouseSetup"))},f.prototype.createPerformancePanel=function(){var b=this.viewer,d=c.ViewerSettingTab.Performance;this.tablesContainer.childNodes[0];this.is3dMode&&(this.addLabel(d,"Performance Optimization"),this.optimizeNavigationhkBoxId=this.addCheckbox(d,"Smooth navigation","Provides faster response(but degrades quality) while navigating",a.isMobileDevice(),function(a){b.setOptimizeNavigation(a)},"optimizeNavigation"),this.progressiveRenderChkBoxId=this.addCheckbox(d,"Progressive display","Shows incremental updates of the view and allows for more responsive interaction with the model (some elements may flicker) This improves perceived waiting time",!0,function(a){b.setProgressiveRendering(a)},"progressiveRendering"),this.addLabel(d,"Display"),this.ghosthiddenChkBoxId=this.addCheckbox(d,"Ghost hidden objects","Leave hidden objects slightly visible",!0,function(a){b.setGhosting(a)},"ghosting"),this.displayLinesId=this.addCheckbox(d,"Display Lines","Toggles display of line objects",!0,function(a){b.hideLines(!a)},"lineRendering"),this.displayPointsId=this.addCheckbox(d,"Display Points","Toggles display of point objects",!0,function(a){b.hidePoints(!a)},"pointRendering"),this.displayEdgesId=this.addCheckbox(d,"Display edges","Shows outline of model surfaces",!1,function(a){b.setDisplayEdges(a)},"edgeRendering")),this.is3dMode||(this.addLabel(d,"Performance Optimization"),this.progressiveRenderChkBoxId=this.addCheckbox(d,"Progressive display","Shows incremental updates of the view and allows for more responsive interaction with the model (some elements may flicker) This improves perceived waiting time",!0,function(a){b.setProgressiveRendering(a)},"progressiveRendering"))},f.prototype.createAppearancePanel=function(){var a=this.viewer,b=c.ViewerSettingTab.Appearance;this.tablesContainer.childNodes[2];this.is3dMode&&(this.addLabel(b,"Visual Quality Optimization"),this.antialiasingChkBoxId=this.addCheckbox(b,"Anti-aliasing","Remove jagged edges from lines",!0,function(b){a.setQualityLevel(a.prefs.ambientShadows,b)},"antialiasing"),this.ambientshadowsChkBoxId=this.addCheckbox(b,"Ambient shadows","Improve shading of occluded surfaces",!0,function(b){a.setQualityLevel(b,a.prefs.antialiasing)},"ambientShadows"),this.groundShadowChkBoxId=this.addCheckbox(b,"Ground shadow","Add simulated ground surface shadows",!0,function(b){a.setGroundShadow(b)},"groundShadow"),this.groundReflectionChkBoxId=this.addCheckbox(b,"Ground reflection","Add simulated ground surface reflections",!1,function(b){a.setGroundReflection(b)},"groundReflection")),this.is3dMode||(this.addLabel(b,"Existing behavior"),this.swapBlackAndWhiteChkBoxId=this.addCheckbox(b,"2D Sheet Color","Switch sheet color white to black",!0,function(b){a.setSwapBlackAndWhite(b)},"swapBlackAndWhite"))},f.prototype.createEnvironmentPanel=function(){var d=this.viewer,e=c.ViewerSettingTab.Environment,f=this.tablesContainer.childNodes[3];if(this.is3dMode){this.addLabel(e,"Environment"),this.envMapBackgroundChkBoxId=this.addCheckbox(e,"Environment Image Visible","Shows lighting environment as background",!0,function(a){d.setEnvMapBackground(a),a?this.envSelect.classList.add("with-environment"):this.envSelect.classList.remove("with-environment")}.bind(this),"envMapBackground");var g=f.tBodies[0].insertRow(-1),h=g.insertCell(0);this.caption=document.createElement("div"),this.caption.setAttribute("data-i18n","Environments and Lighting Selection"),this.caption.textContent=a.i18n.translate("Environments and Lighting Selection"),this.caption.classList.add("settings-row-title"),h.appendChild(this.caption),h.colSpan="3";for(var i=[],j=0;j<b.LightPresets.length;j++)i.push(b.LightPresets[j].name);this.envSelect=this.addGrid("Environments and Lighting Selection",f,i,d.impl.currentLightPreset(),!0,function(a){d.setLightPreset(a)},"lightPreset")}},f.prototype.restoreDefaultSettings=function(){var b=this.viewer;this.restoreDiv=document.createElement("div"),this.restoreDiv.classList.add("docking-panel-container-solid-color-b"),this.restoreDiv.classList.add("restore-defaults-container"),this.restoreButton=document.createElement("div"),this.restoreButton.className="docking-panel-tertiary-button",this.restoreButton.setAttribute("data-i18n","Restore all default settings"),this.restoreButton.textContent=Autodesk.Viewing.i18n.translate("Restore all default settings"),this.restoreDiv.appendChild(this.restoreButton),this.addEventListener(this.restoreDiv,"touchstart",a.touchStartToClick),this.addEventListener(this.restoreDiv,"click",function(){b.dispatchEvent({type:a.RESTORE_DEFAULT_SETTINGS_EVENT})},!1),this.scrollContainer.appendChild(this.restoreDiv)},f.prototype.syncUI=function(){var a=this.viewer,b=this.getControl(this.antialiasingChkBoxId);b&&b.setValue(a.prefs.antialiasing);var c=this.getControl(this.ambientshadowsChkBoxId);c&&c.setValue(a.prefs.ambientShadows);var d=this.getControl(this.groundShadowChkBoxId);d&&d.setValue(a.prefs.groundShadow);var e=this.getControl(this.groundReflectionChkBoxId);e&&e.setValue(a.prefs.groundReflection);var f=this.getControl(this.envMapBackgroundChkBoxId);f&&f.setValue(a.impl.isEnvMapBackground());var g=this.getControl(this.progressiveRenderChkBoxId);g&&g.setValue(a.prefs.progressiveRendering);var h=this.getControl(this.swapBlackAndWhiteChkBoxId);h&&h.setValue(a.prefs.swapBlackAndWhite);var i=this.getControl(this.ghosthiddenChkBoxId);if(i&&i.setValue(a.prefs.ghosting),this.is3dMode){var j=this.getControl(this.displayLinesId);j&&j.setValue(a.prefs.lineRendering);var k=this.getControl(this.displayPointsId);k&&k.setValue(a.prefs.pointRendering);var l=this.getControl(this.displayEdgesId);l&&l.setValue(a.prefs.edgeRendering)}},c.ViewerSettingsPanel=f}(),function(){"use strict";function a(a){b.ObjectContextMenu.call(this,a)}var b=Autodesk.Viewing.UI,c=Autodesk.Viewing.Private;a.prototype=Object.create(b.ObjectContextMenu.prototype),a.prototype.constructor=a,a.prototype.buildMenu=function(a,b){var d=this,e=[],f=this.viewer.navigation,g=this.viewer.model.is2d();b.hasSelected&&(e.push({title:"Isolate",target:function(){var a=d.viewer.getAggregateSelection();d.viewer.impl.visibilityManager.aggregateIsolate(a),d.viewer.clearSelection(),c.logger.track({name:"isolate_count",aggregate:"count"})}}),b.hasVisible&&e.push({title:"Hide Selected",target:function(){var a=d.viewer.impl.visibilityManager;d.viewer.getAggregateSelection(function(b,c){a.hide(c,b)}),d.viewer.clearSelection()}}),b.hasHidden&&e.push({title:"Show Selected",target:function(){var a=d.viewer.getSelection();d.viewer.clearSelection(),d.viewer.show(a)}})),g&&e.push({title:"Show All Layers",target:function(){d.viewer.setLayerVisible(null,!0)}}),e.push({title:"Show All Objects",target:function(){d.viewer.showAll(),c.logger.track({name:"showall",aggregate:"count"})}});var h=d.viewer.getAggregateSelection();return!g&&1===h.length&&f.isActionEnabled("gotoview")&&e.push({title:"Focus",target:function(){if(h=d.viewer.getAggregateSelection(),h.length>0){var a=h[0];d.viewer.fitToView(a.selection,a.model)}else 0===h.length&&d.viewer.fitToView();c.logger.track({name:"fittoview",aggregate:"count"})}}),b.hasSelected&&e.push({title:"Clear Selection",target:function(){d.viewer.clearSelection(),c.logger.track({name:"clearselection",aggregate:"count"})}}),e},Autodesk.Viewing.Extensions.ViewerObjectContextMenu=a}(),function(){"use strict";var a=function(a,b){this.viewer=a,this.options=b,this.id="",this.modes=[],this.mode="",this.name="",this.activeStatus=!1};a.prototype.load=function(){return!0},a.prototype.unload=function(){return!0},a.prototype.activate=function(a){return!0},a.prototype.deactivate=function(){return!0},a.prototype.getName=function(){return this.name},a.prototype.getModes=function(){return this.modes},a.prototype.isActive=function(a){return a?this.activeStatus&&this.mode===a:this.activeStatus},a.prototype.getState=function(a){},a.prototype.restoreState=function(a,b){return!0},a.prototype.extendLocalization=function(a){return Autodesk.Viewing.Private.extendLocalization(a)},a.prototype.getCache=function(){this.viewer.extensionCache||(this.viewer.extensionCache={},Autodesk.Viewing.Private.logger.warn("Extension cache runtime creation; missing ViewingApplication context."));var a=this.viewer.extensionCache[this.id];return a||(a=this.viewer.extensionCache[this.id]={}),a},Autodesk.Viewing.Extension=a}(),function(){"use strict";var a=Autodesk.Viewing,b=a.Private,c=function(){function a(a,b){return!i[a]&&(i[a]=b,!0)}function b(a){return i.hasOwnProperty(a)?i[a]:null}function c(a){return!!i.hasOwnProperty(a)&&(delete i[a],!0)}function d(a,b){return!j[a]&&(j[a]=b,!0)}function e(a){return j.hasOwnProperty(a)?j[a]:null}function f(a){return!!j.hasOwnProperty(a)&&(delete j[a],!0)}function g(){var a,b=[];for(a in i)i.hasOwnProperty(a)&&b.push({id:a,inMemory:!0,isAsync:a in j});for(a in j)!j.hasOwnProperty(a)||a in i||b.push({id:a,inMemory:!1,isAsync:!0});return b}function h(a){for(var b in i)i.hasOwnProperty(b)&&i[b].hasOwnProperty("populateDefaultOptions")&&i[b].populateDefaultOptions(a)}var i={},j={};return{registerExtension:a,getExtension:b,unregisterExtension:c,registerExternalExtension:d,getExternalPath:e,unregisterExternalExtension:f,getRegisteredExtensions:g,popuplateOptions:h}},d=new c,e=function(){};e.prototype={loadExtension:function(a,b){this.loadedExtensions||(this.loadedExtensions={});var c=this.getExtension(a);if(c)return Promise.resolve(c);if(!d.getExtension(a)){var e=d.getExternalPath(a);return e?this.loadExtensionAsync(a,e,b):Promise.reject("Extension not found: "+a+". Has it been registered(1)?")}return this.loadExtensionLocal(a,b)},getExtension:function(a){return this.loadedExtensions&&a in this.loadedExtensions?this.loadedExtensions[a]:null},unloadExtension:function(c){var d=!1,e=this.getExtension(c);return e?(d=e.unload(),b.logger.info("Extension unloaded: "+c),delete this.loadedExtensions[c],this.dispatchEvent({type:a.EXTENSION_UNLOADED_EVENT,extensionId:c})):b.logger.warn("Extension not found: "+c),d},loadExtensionLocal:function(c,e){var f=d.getExtension(c);if(!f)return Promise.reject("Extension not found: "+c+". Has it been registered(2)?");var g=new f(this,e);return g.id=c,g.load()?(this.loadedExtensions[c]=g,b.logger.info("Extension loaded: "+c),this.dispatchEvent({type:a.EXTENSION_LOADED_EVENT,extensionId:c}),Promise.resolve(g)):Promise.reject("Extension failed to .load() : "+c)},loadExtensionAsync:function(a,c,d){var e=this;return new Promise(function(f,g){b.loadDependency(a,c,function(){e.loadExtension(a,d);var b=e.getExtension(a);b?f(b):g("Failed to getExtension("+a+")")
},function(){g("Failed to loadExtensionAsync: ("+a+") from: ("+c+")")})})},apply:function(a){var b=e.prototype;a.loadExtension=b.loadExtension,a.getExtension=b.getExtension,a.unloadExtension=b.unloadExtension,a.loadExtensionLocal=b.loadExtensionLocal,a.loadExtensionAsync=b.loadExtensionAsync}},Autodesk.Viewing.theExtensionManager=d,Autodesk.Viewing.ExtensionMixin=e}(),function(){"use strict";var a=Autodesk.Viewing;a.Private.init_UnifiedCamera=function(b){if(void 0===a.UnifiedCamera){var c=function(a,c){b.Camera.call(this),this.fov=45,this.near=.1,this.far=1e5,this.aspect=a/c,this.left=-a/2,this.right=a/2,this.top=c/2,this.bottom=-c/2,this.clientWidth=a,this.clientHeight=c,this.target=new b.Vector3(0,0,-1),this.worldup=new b.Vector3(0,1,0),this.orthographicCamera=new b.OrthographicCamera(this.left,this.right,this.top,this.bottom,this.near,this.far),this.perspectiveCamera=new b.PerspectiveCamera(this.fov,this.aspect,this.near,this.far),this.zoom=1,this.toPerspective()};c.ORTHO_FOV=2*Math.atan(.5)*180/Math.PI,c.prototype=Object.create(b.Camera.prototype),c.prototype.clone=function(){var a=new c(2*this.right,2*this.top);return b.Camera.prototype.clone.call(this,a),a.position.copy(this.position),a.up.copy(this.up),this.target&&(a.target=this.target.clone()),this.worldup&&(a.worldup=this.worldup.clone()),this.worldUpTransform&&(a.worldUpTransform=this.worldUpTransform.clone()),a.left=this.left,a.right=this.right,a.top=this.top,a.bottom=this.bottom,a.near=this.near,a.far=this.far,a.fov=this.fov,a.aspect=this.aspect,a.zoom=this.zoom,a.isPerspective=this.isPerspective,this.updateProjectionMatrix(),a},c.prototype.__computeFovPosition=function(a){if(Math.abs(this.fov-a)<=1e-4)return this.position.clone();var c=this.target.clone().sub(this.position),d=b.Math.degToRad(this.fov),e=b.Math.degToRad(a),f=c.length()*Math.tan(.5*d)/Math.tan(.5*e),g=c.normalize().multiplyScalar(-f);return this.target.clone().add(g)},c.prototype.toPerspective=function(){!this.isPerspective&&this.saveFov&&(this.position.copy(this.__computeFovPosition(this.saveFov)),this.fov=this.saveFov),this.perspectiveCamera.aspect=this.aspect,this.perspectiveCamera.near=this.near,this.perspectiveCamera.far=this.far,this.perspectiveCamera.fov=this.fov/this.zoom,this.perspectiveCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspectiveCamera.projectionMatrix,this.isPerspective=!0},c.prototype.toOrthographic=function(){if(this.isPerspective){this.saveFov=this.fov;var a=c.ORTHO_FOV;this.position.copy(this.__computeFovPosition(a)),this.fov=a}this.orthoScale=this.target.clone().sub(this.position).length();var b=.5*this.orthoScale,d=b*this.aspect;this.left=this.orthographicCamera.left=-d,this.right=this.orthographicCamera.right=d,this.top=this.orthographicCamera.top=b,this.bottom=this.orthographicCamera.bottom=-b,this.orthographicCamera.near=this.near,this.orthographicCamera.far=this.far,this.orthographicCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthographicCamera.projectionMatrix,this.isPerspective=!1},c.prototype.updateProjectionMatrix=function(){this.isPerspective?this.toPerspective():this.toOrthographic()},c.prototype.setSize=function(a,b){this.aspect=a/b,this.left=-a/2,this.right=a/2,this.top=b/2,this.bottom=-b/2},c.prototype.setFov=function(a){this.fov=a,this.updateProjectionMatrix()},c.prototype.setLens=function(a,c){void 0===c&&(c=24);var d=2*b.Math.radToDeg(Math.atan(c/(2*a)));return this.setFov(d),d},a.UnifiedCamera=c}}}(),function(){"use strict";var a=Autodesk.Viewing;a.ESCAPE_EVENT="escape",a.PROGRESS_UPDATE_EVENT="progress",a.FULLSCREEN_MODE_EVENT="fullScreenMode",a.NAVIGATION_MODE_CHANGED_EVENT="navmode",a.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored",a.VIEWER_RESIZE_EVENT="viewerResize",a.VIEWER_INITIALIZED="viewerInitialized",a.VIEWER_UNINITIALIZED="viewerUninitialized",a.GEOMETRY_LOADED_EVENT="geometryLoaded",a.MODEL_LAYERS_LOADED_EVENT="modelLayersLoaded",a.EXTENSION_LOADED_EVENT="extensionLoaded",a.EXTENSION_UNLOADED_EVENT="extensionUnloaded",a.SELECTION_CHANGED_EVENT="selection",a.AGGREGATE_SELECTION_CHANGED_EVENT="aggregateSelection",a.ISOLATE_EVENT="isolate",a.AGGREGATE_ISOLATION_CHANGED_EVENT="aggregateIsolation",a.HIDE_EVENT="hide",a.SHOW_EVENT="show",a.CAMERA_CHANGE_EVENT="cameraChanged",a.EXPLODE_CHANGE_EVENT="explodeChanged",a.FIT_TO_VIEW_EVENT="fitToView",a.AGGREGATE_FIT_TO_VIEW_EVENT="aggregateFitToView",a.CUTPLANES_CHANGE_EVENT="cutplanesChanged",a.TOOL_CHANGE_EVENT="toolChanged",a.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged",a.FINAL_FRAME_RENDERED_CHANGED_EVENT="finalFrameRenderedChanged",a.RENDER_PRESENTED_EVENT="renderPresented",a.LAYER_VISIBILITY_CHANGED_EVENT="layerVisibility",a.RESET_EVENT="reset",a.PREF_CHANGED_EVENT="PrefChanged",a.PREF_RESET_EVENT="PrefReset",a.RESTORE_DEFAULT_SETTINGS_EVENT="restoreDefaultSettings",a.ANIMATION_READY_EVENT="animationReady",a.CAMERA_TRANSITION_COMPLETED="cameraTransitionCompleted",a.HYPERLINK_EVENT="hyperlink",a.LOAD_GEOMETRY_EVENT="load_geometry"}(),function(){"use strict";var a=Autodesk.Viewing,b=a.Private;a.NAVIGATION_MODE={ORBIT:0,PAN:1,DOLLY:2,ROLL:3,FOV:4,TOUCH_PAN_DOLLY:5,TOUCH_ROLL:6,OTHER:7};var c=a.isMobileDevice(),d=0;a.DefaultSettings={ambientShadows:!0,antialiasing:!c,groundShadow:!0,groundReflection:!1,progressiveRendering:!0,renderCache:!1,swapBlackAndWhite:!1,openPropertiesOnSelect:!1,ghosting:!0,viewCube:!c,lineRendering:!0,pointRendering:!0,edgeRendering:!1,lightPreset:b.DefaultLightPreset,backgroundColorPreset:null,reverseMouseZoomDir:!1,reverseHorizontalLookDirection:!1,reverseVerticalLookDirection:!1,alwaysUsePivot:!1,zoomTowardsPivot:!1,orbitPastWorldPoles:!0,leftHandedMouseSetup:!1,clickToSetCOI:!1,optimizeNavigation:c,fusionOrbit:!0,fusionOrbitConstrained:!0,envMapBackground:!1,useFirstPersonPrototype:!1,firstPersonToolPopup:!0,bimWalkToolPopup:!0},b.isRightClick=function(a,c){if(!(a instanceof MouseEvent))return!1;var d=a.button;return"buttons"in a&&(!b.__firefoxLMBfix||1&a.buttons?2===d&&1&a.buttons&&(d=0,b.__firefoxLMBfix=!0):(b.__firefoxLMBfix=!1,d=0)),d===(!!c&&c.getUseLeftHandedInput()?0:2)};var e=function(c,e){if("undefined"==typeof THREE&&b.logger.warn("Initializing LMV without the THREE.js dependency is not supported.","Call Autodesk.Viewing.Initializer() first or preload the dependencies manually."),c){if(this.clientContainer=c,this.container=document.createElement("div"),this.container.classList.add("adsk-viewing-viewer"),this.container.style.height="100%",this.container.style.width="100%",this.container.style.overflow="hidden",this.container.classList.add(a.isTouchDevice()?"touch":"notouch"),this.clientContainer.appendChild(this.container),this.config=e||a.createViewerConfig(),this.contextMenu=null,this.contextMenuCallbacks={},this.__firefoxLMBfix=!1,this.started=!1,this.theme=this.config.theme||"dark-theme",this.container.classList.add(this.theme),a.isChrome()&&this.container.classList.add("quality-text"),"CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";this.canvasWrap=document.createElement("div"),this.canvasWrap.classList.add("canvas-wrap"),this.canvas=document.createElement("canvas"),this.canvas.tabIndex=0,this.canvas.setAttribute("data-viewer-canvas","true"),this.canvasWrap.appendChild(this.canvas),this.container.appendChild(this.canvasWrap),this.canvas.viewer=this;var f={prefix:"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.",localStorage:!0};this.prefs=new b.Preferences(this,f)}this.extensionCache=null,this.running=!1,this._pushedTool="",this._defaultNavigationTool="",this.id=d++,this.impl=new b.Viewer3DImpl(this.canvas,this),this.onResetEvent=this.onResetEvent.bind(this),this.trackADPTimer=[]};e.populateConfigOptions=function(){},e.prototype.constructor=e,a.EventDispatcher.prototype.apply(e.prototype),a.ScreenModeMixin.prototype.apply(e.prototype),a.ExtensionMixin.prototype.apply(e.prototype),e.ScreenMode=a.ScreenMode,e.ViewerCount=0,e.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"]},clickShift:{onObject:["selectToggle"]},disableSpinner:!1,disableMouseWheel:!1,disableTwoFingerSwipe:!1},e.prototype.start=function(a,b,c,d){if(this.started)return 0;this.started=!0;var e=this,f=e.initialize();return 0!==f?(d&&setTimeout(function(){d(f)},1),f):(setTimeout(function(){e.setUp(e.config)},1),a&&this.loadModel(a,b,c,d),0)},e.prototype.startWithDocumentNode=function(a,b,c){var d=this;return new Promise(function(e,f){if(d.started)return 0;d.started=!0;var g=d.initialize();if(0!==g)return void setTimeout(function(){f(g)},1);setTimeout(function(){d.setUp(d.config)},1),d.loadDocumentNode(a,b,c).then(e).catch(f)})},e.prototype.registerUniversalHotkeys=function(){var b,c,d,e=this,f=a.theHotkeyManager.KEYCODES;b=function(){return e.navigation.setRequestFitToView(!0),!0},a.theHotkeyManager.pushHotkeys("Autodesk.FitToView",[{keycodes:[f.f],onPress:b}]),b=function(){return e.navigation.setRequestHomeView(!0),!0},a.theHotkeyManager.pushHotkeys("Autodesk.Home",[{keycodes:[f.h],onPress:b},{keycodes:[f.HOME],onPress:b}]),c=function(){return!(!e.objectContextMenu||!e.objectContextMenu.hide())||(e.dispatchEvent({type:a.ESCAPE_EVENT}),!0)},a.theHotkeyManager.pushHotkeys("Autodesk.Escape",[{keycodes:[f.ESCAPE],onRelease:c}]),b=function(){return d=e.getActiveNavigationTool(),e.setActiveNavigationTool("pan")},c=function(){return e.setActiveNavigationTool(d)};var g=[{keycodes:[f.SHIFT],onPress:b,onRelease:c},{keycodes:[f.SPACE],onPress:b,onRelease:c}];a.theHotkeyManager.pushHotkeys("Autodesk.Pan",g,{tryUntilSuccess:!0})},e.prototype.createControls=function(){var b=this,c=b.impl;return b.navigation=new a.Navigation(c.camera),b.__initAutoCam(c),b.utilities=new a.ViewingUtilities(c,b.autocam,b.navigation),b.clickHandler=new a.DefaultHandler(c,b.navigation,b.utilities),b.toolController=new a.ToolController(c,b,b.autocam,b.utilities,b.clickHandler),b.toolController.registerTool(new a.GestureHandler(b)),b.toolController.registerTool(a.theHotkeyManager),b.toolController.activateTool(a.theHotkeyManager.getName()),b.registerUniversalHotkeys(),b.toolController.registerTool(new a.OrbitDollyPanTool(c,b)),b.toolController},e.prototype.initialize=function(){this.setScreenModeDelegate(this.config?this.config.screenModeDelegate:void 0);var c=this.getDimensions();if(this.canvas.width=c.width,this.canvas.height=c.height,a.isIOSDevice()&&window.devicePixelRatio&&(this.canvas.width/=window.devicePixelRatio,this.canvas.height/=window.devicePixelRatio),this.impl.initialize(),!this.impl.glrenderer()){var d=a.detectWebGL();if(d<=0)return-1===d?a.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED:a.ErrorCodes.BROWSER_WEBGL_DISABLED}var f=this;if(a.isIOSDevice()){var g;this.onResizeCallback=function(a){clearTimeout(g),g=setTimeout(f.resize.bind(f),500)}}else this.onResizeCallback=function(a){var b=f.impl.camera.clientWidth,c=f.impl.camera.clientHeight,d=f.container.clientWidth,e=f.container.clientHeight;b===d&&c===e||f.resize()};window.addEventListener("resize",this.onResizeCallback,!1),this.onScrollCallback=function(a){f.impl.canvasBoundingclientRectDirty=!0},window.addEventListener("scroll",this.onScrollCallback),this.initContextMenu(),this.localize(),this.impl.controls=this.createControls(),this.setDefaultNavigationTool("orbit"),this.model=null,this.impl.controls&&this.impl.controls.setAutocam(this.autocam);var h=this.config&&this.config.canvasConfig?this.config.canvasConfig:e.kDefaultCanvasConfig;if(this.setCanvasClickBehavior(h),!h.disableSpinner){this.loadSpinner=document.createElement("div"),this.loadSpinner.className="spinner",this.container.appendChild(this.loadSpinner);for(var i=1;i<=3;i++){var j=document.createElement("div");j.className="bounce"+i,this.loadSpinner.appendChild(j)}}return this.initSettings(),this.viewerState=new b.ViewerState(this),this.config&&this.config.hasOwnProperty("startOnInitialize")&&!this.config.startOnInitialize||this.run(),window.NOP_VIEWER=this,this.addEventListener(a.RESTORE_DEFAULT_SETTINGS_EVENT,this.onResetEvent),this.dispatchEvent(a.VIEWER_INITIALIZED),this.trackADPSettingsOptions(),this.trackADPExtensionsLoaded(),e.ViewerCount++,0},e.prototype.setUp=function(a){if(this.config=a,this.config&&this.config.hasOwnProperty("extensions"))for(var c=this.config.extensions,d=0;d<c.length;++d)this.loadExtension(c[d],this.config);"true"==b.getParameterByName("lmv_viewer_debug")&&this.loadExtension("Autodesk.Debug",this.config);var f=this.config&&this.config.canvasConfig?this.config.canvasConfig:e.kDefaultCanvasConfig;this.setCanvasClickBehavior(f)},e.prototype.tearDown=function(){if(this.clearSelection(),this.loadedExtensions){for(var c in this.loadedExtensions)try{this.unloadExtension(c)}catch(d){b.logger.error("Failed to unload extension: "+c,d,a.errorCodeString(a.ErrorCodes.VIEWER_INTERNAL_ERROR)),b.logger.track({category:"error_unload_extension",extensionId:c,error_message:d.message,call_stack:d.stack})}this.loadedExtensions=null}for(this.toolController&&(this.toolController.enableMouseButtons(!1),this.toolController.deactivateTool("gestures")),b.logger.reportRuntimeStats(!0),this.loadSpinner&&(this.loadSpinner.style.display="block"),this.model=null,this.liveReviewClient&&(this.liveReviewClient.destroy(),this.liveReviewClient=null);this.trackADPTimer.length>0;)clearTimeout(this.trackADPTimer.pop());this.impl.unloadCurrentModel()},e.prototype.run=function(){this.running||(this.resize(),this.running=!0,this.impl.run())},e.prototype.localize=function(){a.i18n.localize()},e.prototype.__initAutoCam=function(c){function d(a){g.autocamCamera.isPerspective!==h.isPerspective&&(g.autocamCamera.isPerspective?g.navigation.toPerspective():g.navigation.toOrthographic()),g.navigation.setVerticalFov(g.autocamCamera.fov,!1),g.navigation.setView(g.autocamCamera.position,g.autocamCamera.target),g.navigation.setPivotPoint(g.autocamCamera.pivot),g.navigation.setCameraUpVector(g.autocamCamera.up),a&&g.navigation.setWorldUpVector(g.autocamCamera.worldup),g.impl.syncCamera(a)}function e(a){g.utilities?g.utilities.pivotActive(a,!1):g.impl.controls.pivotActive(a,!1)}function f(){g.fireEvent({type:a.CAMERA_TRANSITION_COMPLETED})}var g=this,h=c.camera;h.pivot||(h.pivot=new THREE.Vector3(0,0,0)),h.target||(h.target=new THREE.Vector3(0,0,0)),h.worldup||(h.worldup=h.up.clone()),g.autocamCamera=h.clone(),g.autocamCamera.target=h.target.clone(),g.autocamCamera.pivot=h.pivot.clone(),g.autocamCamera.worldup=h.worldup.clone(),g.autocam=new b.Autocam(g.autocamCamera,g.navigation,g.canvas),g.autocam.registerCallbackCameraChanged(d),g.autocam.registerCallbackPivotDisplay(e),g.autocam.registerCallbackTransitionCompleted(f),g.addEventListener("cameraChanged",function(a){var b=a.camera;g.autocam.sync(b)}),g.autocam.sync(h)},e.prototype.uninitialize=function(){window.removeEventListener("resize",this.onResizeCallback,!1),this.onResizeCallback=null,window.removeEventListener("scroll",this.onScrollCallback),this.onScrollCallback=null,this.canvas.parentNode.removeChild(this.canvas),this.canvas.viewer=null,this.canvas=null,this.canvasWrap=null,this.viewerState=null,b.logger.reportRuntimeStats(),b.logger.track({category:"viewer_destroy"},!0),this.toolController&&(this.toolController.uninitialize(),this.toolController=null,this.clickHandler=null,this.utilities=null),this.navigation&&(this.navigation.uninitialize(),this.navigation=null),this.impl&&(this.impl.dtor(),this.impl=null),this.loadSpinner=null,this.model=null,this.prefs=null,this.autocam.dtor(),this.autocam=null,this.autocamCamera=null,a.theHotkeyManager.popHotkeys("Autodesk.FitToView"),a.theHotkeyManager.popHotkeys("Autodesk.Home"),a.theHotkeyManager.popHotkeys("Autodesk.Escape"),a.theHotkeyManager.popHotkeys("Autodesk.Pan"),a.theHotkeyManager.popHotkeys("Autodesk.Orbit"),e.ViewerCount--,0===e.ViewerCount&&WGS.clearPropertyWorkerCache(),this.onDefaultContextMenu&&(this.container.removeEventListener("contextmenu",this.onDefaultContextMenu,!1),this.onDefaultContextMenu=null),this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this.extensionCache=null,this.clientContainer=null,this.config=null,this.listeners={},this.contextMenu=null,this.contextMenuCallbacks=null,this.viewCubeUi&&(this.viewCubeUi.uninitialize(),this.viewCubeUi=null),this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.dispatchEvent(a.VIEWER_UNINITIALIZED),this.listeners={},b.logger.log("viewer destroy")},e.prototype.finish=function(){this.tearDown(),this.uninitialize()},e.prototype.load=function(a,c,d,e,f,g){b.logger.warn("viewer.load() is deprecated. Please use viewer.loadModel() instead.");var h={ids:null,sharedPropertyDbPath:c,acmSessionId:f,loadOptions:g};return this.loadModel(a,h,d,e)},e.prototype.setLoadHeuristics=function(c){var d=c.bubbleNode;if(d&&!c.hasOwnProperty("isAEC")){var e=d.findViewableParent();if(e){var f=e.name(),g=f.slice(f.length-3).toLowerCase();"rvt"!==g&&"nwd"!==g&&"nwc"!==g||(c.isAEC=!0)}}c.isAEC&&(void 0===c.useConsolidation&&(c.useConsolidation=!a.isMobileDevice()),void 0===c.createWireframe&&(c.createWireframe=!a.isMobileDevice())),c.useConsolidation&&WGS.ConsolidationUtils.registerWorkerSupport(b.createWorkerWithIntercept),c.useConsolidation&&!c.bvhOptions&&(c.bvhOptions={frags_per_leaf_node:256,max_polys_per_node:5e4})},e.prototype.trackADPSettingsOptions=function(){var a=this;this.trackADPTimer.push(setTimeout(function(){var c={category:"settingOptionsStatus",switchSheetColorWhiteToBlack:a.prefs.swapBlackAndWhite,newFirstPersonToolPrototype:a.prefs.useFirstPersonPrototype,leftHandedMouseSetup:a.prefs.leftHandedMouseSetup,openPropertiesOnSelect:a.prefs.openPropertiesOnSelect,orbitPastWorldPoles:a.prefs.orbitPastWorldPoles,reverseMouseZoomDirection:a.prefs.reverseMouseZoomDir,fusionStyleOrbit:a.prefs.fusionOrbit,setPivotWithLeftMouseButton:a.prefs.clickToSetCOI,zoomTowardPivot:a.prefs.zoomTowardsPivot,viewCubeActsOnPivot:a.prefs.alwaysUsePivot,showViewCube:a.prefs.viewCube,environmentImageVisible:a.prefs.envMapBackground,displayEdges:a.prefs.edgeRendering,displayPoints:a.prefs.pointRendering,displayLines:a.prefs.lineRendering,ghostHiddenObjects:a.prefs.ghosting,groundReflection:a.prefs.groundReflection,groundShadow:a.prefs.groundShadow,ambientShadows:a.prefs.ambientShadows,antiAliasing:a.prefs.antialiasing,progressiveModelDisplay:a.prefs.progressiveRendering,smoothNavigation:a.prefs.optimizeNavigation};b.logger.track(c)},3e4))},e.prototype.trackADPExtensionsLoaded=function(){var a=this,c={};c.category="loaded_extensions",this.trackADPTimer.push(setTimeout(function(){if(a.loadedExtensions)for(var d in a.loadedExtensions)c[d]=d;b.logger.track(c)},3e4))},e.prototype.loadModel=function(c,d,e,f,g){function h(){if(a.theHotkeyManager)if(m.model.is2d())a.theHotkeyManager.popHotkeys("Autodesk.Orbit");else{var b,c=function(){return b=m.getActiveNavigationTool(),m.setActiveNavigationTool("orbit")},d=function(){return m.setActiveNavigationTool(b)},e=[{keycodes:[a.theHotkeyManager.KEYCODES.ALT],onPress:c,onRelease:d}];a.theHotkeyManager.pushHotkeys("Autodesk.Orbit",e,{tryUntilSuccess:!0})}}function i(){if(!a.isNodeJS){var b=m.model.is2d()?"pan":"orbit";m.setActiveNavigationTool(b),m.setDefaultNavigationTool(b),m.toolController&&(m.toolController.enableMouseButtons(!0),m.toolController.activateTool("gestures"))}}function j(a,b){if(m.impl._removeLoadingFile(n),a)return void k(a.code,a.msg,a.args);var c=!1;m.model||(m.model=b,c=!0),m.impl.addModel(b),m.loadSpinner&&(m.loadSpinner.style.display="None"),c&&(b.is2d()&&(m.activateLayerState("Initial"),m.impl.setSelectionColor(255)),h(),i()),e&&e(b)}function k(a,b,c){m.loadSpinner&&(m.loadSpinner.style.display="None"),f&&f(a,b,c)}function l(){m.impl.needsRender=!0,m.removeEventListener(a.GEOMETRY_LOADED_EVENT,l)}var m=this;d=d||{};var n;this.addEventListener(a.GEOMETRY_LOADED_EVENT,l);var o,p=c.toLowerCase().match(/\.([a-z0-9]+)(\?|$)/),q=p?p[1]:null;if(!(o=d&&d.fileLoader?d.fileLoader:a.FileLoaderManager.getFileLoaderForExtension(q)))return b.logger.error("File extension not supported:"+q,a.errorCodeString(a.ErrorCodes.UNSUPORTED_FILE_EXTENSION)),k(a.ErrorCodes.UNSUPORTED_FILE_EXTENSION,"File extension not supported",0),!1;this.setLoadHeuristics(d),b.processMemoryOptions(this.config),n=new o(this.impl._loaderDelegate,this.config);var r=n.loadFile(c,d,j,g);return d.isAEC&&n.is3d()&&this.impl.setLightPresetForAec(),this.impl.setRenderingPrefsFor2D(!n.is3d()),r},e.prototype.loadDocumentNode=function(b,c,d){var e=c instanceof a.BubbleNode?c:b.getRoot().search({guid:c.guid})[0],f=e.findViewableParent().parent,g=f.urn(),h={},i=b.getViewableUrn(e,h),j=e.findPropertyDbPath(),k=!1;0===i.indexOf("$file$")&&(i=b.getFullPath(i),j=b.getFullPath(j),k=!0);var l=e.getOtgGraphicsNode();if(!k)if(l&&!l.error)i=a.endpoint.getItemApi(null,i),j=a.endpoint.getItemApi(null,j);else if(a.endpoint.getApiFlavor()===a.endpoint.ENDPOINT_API_FLUENT)i=a.endpoint.getItemApi(a.endpoint.getApiEndpoint(),i,"derivativeV2"),j=a.endpoint.getItemApi(a.endpoint.getApiEndpoint(),j,"derivativeV2");else{for(var m=e;m.parent;)m=m.parent;g=m.acmSessionId}var n={sharedPropertyDbPath:j,acmSessionId:g,isAEC:!0,bubbleNode:e,globalOffset:{x:0,y:0,z:0},applyRefPoint:!0,loadOptions:h};d=d||{};for(var o in n)d.hasOwnProperty(o)||(d[o]=n[o]);d.keepCurrentModels||(this.impl.unloadCurrentModel(),this.impl.model=null,this.model=null);var p=this;return new Promise(function(a,b){p.loadModel(i,d,function(b){a(b)},function(a){b(a)})})},e.prototype.getDimensions=function(){if(this.container){var b={};return this.getScreenMode()===a.ScreenMode.kFullScreen?(b.width=screen.width,b.height=screen.height):b=this.container.getBoundingClientRect(),{width:b.width,height:b.height}}return null},e.prototype.resize=function(){this.impl.resize(this.container.clientWidth,this.container.clientHeight)},e.prototype.getCamera=function(){return this.impl.camera},e.prototype.getState=function(a){return this.viewerState.getState(a)},e.prototype.restoreState=function(b,c,d){var e=this.viewerState.restoreState(b,c,d);return e&&this.dispatchEvent({type:a.VIEWER_STATE_RESTORED_EVENT,value:e}),e},e.prototype.setViewFromArray=function(a,b){var c=this.model?this.model.getData().globalOffset:{x:0,y:0,z:0},d={position:new THREE.Vector3(a[0]-c.x,a[1]-c.y,a[2]-c.z),target:new THREE.Vector3(a[3]-c.x,a[4]-c.y,a[5]-c.z),up:new THREE.Vector3(a[6],a[7],a[8]),aspect:a[9],fov:THREE.Math.radToDeg(a[10]),orthoScale:a[11],isPerspective:!a[12]};this.impl.setViewFromCamera(d)},e.prototype.setViewFromViewBox=function(a,c){var d=this.model;if(d&&!d.is2d())return void b.logger.warn("Viewer3D.setViewFromViewBox is not applicable to 3D");if(c&&c.length){var e,f=d.getData().metadata,g=f.views;for(e=0;e<g.length&&g[e].name!=c;e++);if(e<g.length){var h=g[e].layer_state;h&&this.activateLayerState(h)}}this.impl.setViewFromViewBox(this.model,a,c,!1)},e.prototype.activateLayerState=function(b){this.impl.layers.activateLayerState(b),this.dispatchEvent({type:a.LAYER_VISIBILITY_CHANGED_EVENT})},e.prototype.getLayerStates=function(){return this.impl.layers.getLayerStates()},e.prototype.setViewFromFile=function(){this.setActiveNavigationTool(),this.impl.setViewFromFile(this.model)},e.prototype.getProperties=function(b,c,d){this.model?this.model.getProperties(b,c,d):d&&d(a.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist")},e.prototype.getObjectTree=function(b,c){this.model?this.model.getObjectTree(b,c):c&&c(a.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist")},e.prototype.setCanvasClickBehavior=function(a){if(this.impl.controls.hasOwnProperty("setClickBehavior")&&this.impl.controls.setClickBehavior(a),this.clickHandler&&this.clickHandler.setClickBehavior(a),a&&a.disableMouseWheel&&this.toolController.setMouseWheelInputEnabled(!1),a&&a.disableTwoFingerSwipe){var b=this.toolController.getTool("gestures");b&&b.disableTwoFingerSwipe()}},e.prototype.search=function(b,c,d,e,f){this.searchText=b,this.model?this.model.search(b,c,d,e,f):d&&d(a.ErrorCodes.BAD_DATA,"Search failed since model does not exist")},e.prototype.getHiddenNodes=function(){return this.impl.visibilityManager.getHiddenNodes()},e.prototype.getIsolatedNodes=function(){return this.model&&this.model.is2d()?(b.logger.warn("Viewer3D.getIsolatedNodes is not yet implemented for 2D"),[]):this.impl.visibilityManager.getIsolatedNodes()},e.prototype.isolate=function(a,b){if(b=b||this.model){b.getData();this.impl.visibilityManager.isolate(a,b)}},e.prototype.isolateById=function(a){return b.logger.warn("isolateById() is deprecated. Use isolate() instead."),this.isolate(a)},e.prototype.setBackgroundColor=function(a,b,c,d,e,f){this.impl.setClearColors(a,b,c,d,e,f)},e.prototype.toggleSelect=function(a,c){if((c=c||this.model)&&c.is2d())return void b.logger.warn("Viewer3D.toggleSelect is not yet implemented for 2D");this.impl.selector.toggleSelection(a,c)},e.prototype.select=function(a,b){"number"==typeof a&&(a=[a]),b=b||this.model,this.impl.selector.setSelection(a,b)},e.prototype.clearSelection=function(){this.impl.selector.clearSelection()},e.prototype.getSelectionVisibility=function(){return this.impl.selector.getSelectionVisibility()},e.prototype.getSelectionCount=function(){return this.impl.selector.getSelectionLength()},e.prototype.setSelectionMode=function(a){this.impl.selector.setSelectionMode(a)},e.prototype.getSelection=function(){return this.impl.selector.getSelection()},e.prototype.getAggregateSelection=function(a){var b=this.impl.selector.getAggregateSelection();if(a)for(var c=0;c<b.length;c++)for(var d=0;d<b[c].selection.length;d++)a(b[c].model,b[c].selection[d]);return b},e.prototype.getAggregateIsolation=function(){return this.impl.visibilityManager.getAggregateIsolatedNodes()},e.prototype.getAggregateHiddenNodes=function(){return this.impl.visibilityManager.getAggregateHiddenNodes()},e.prototype.hide=function(a,b){b=b||this.model,this.impl.visibilityManager.hide(a,b)},e.prototype.show=function(a,b){b=b||this.model,this.impl.visibilityManager.show(a,b)},e.prototype.showAll=function(){this.impl.visibilityManager.aggregateIsolate([]),this.impl.layers.showAllLayers()},e.prototype.toggleVisibility=function(a,b){this.impl.visibilityManager.toggleVisibility(a,b)},e.prototype.areAllVisible=function(){return this.impl.isWholeModelVisible(this.model)},e.prototype.isNodeVisible=function(a,b){return b=b||this.model,this.impl.isNodeVisible(a,b)},e.prototype.explode=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.explode is not applicable to 2D");b.logger.track({name:"explode_count",aggregate:"count"}),this.impl.explode(a)},e.prototype.getExplodeScale=function(){return this.model&&this.model.is2d()?(b.logger.warn("Viewer3D.getExplodeScale is not applicable to 2D"),0):this.impl.getExplodeScale()},e.prototype.setQualityLevel=function(a,c){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setQualityLevel is not applicable to 2D");this.prefs.set("ambientShadows",a),this.prefs.set("antialiasing",c),this.impl.togglePostProcess(a,c)},e.prototype.setGhosting=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setGhosting is not applicable to 2D");this.prefs.set("ghosting",a),this.impl.toggleGhosting(a)},e.prototype.setGroundShadow=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setGroundShadow is not applicable to 2D"):this.getMemoryInfo()?void b.logger.warn("Viewer3D.setGroundShadow is not available when memory is limited"):(this.prefs.set("groundShadow",a),void this.impl.toggleGroundShadow(a))},e.prototype.setGroundReflection=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setGroundReflection is not applicable to 2D"):this.getMemoryInfo()?void b.logger.warn("Viewer3D.setGroundReflection is not available when memory is limited"):(this.prefs.set("groundReflection",a),void this.impl.toggleGroundReflection(a))},e.prototype.setEnvMapBackground=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setEnvMapBackground is not applicable to 2D");this.prefs.set("envMapBackground",a),this.impl.toggleEnvMapBackground(a)},e.prototype.setFirstPersonToolPopup=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setFirstPersonToolPopup is not applicable to 2D");this.prefs.set("firstPersonToolPopup",a)},e.prototype.getFirstPersonToolPopup=function(){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.getFirstPersonToolPopup is not applicable to 2D"):this.prefs.firstPersonToolPopup},e.prototype.setBimWalkToolPopup=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setBimWalkToolPopup is not applicable to 2D");this.prefs.set("bimWalkToolPopup",a)},e.prototype.setRenderCache=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setRenderCache is not applicable to 2D");this.impl.toggleVizBuffer(a),this.prefs.set("renderCache",a)},e.prototype.getBimWalkToolPopup=function(){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.getBimWalkToolPopup is not applicable to 2D"):this.prefs.bimWalkToolPopup},e.prototype.setProgressiveRendering=function(a){this.prefs.set("progressiveRendering",a),this.impl.toggleProgressive(a)},e.prototype.setSwapBlackAndWhite=function(a){this.prefs.set("swapBlackAndWhite",a),this.impl.toggleSwapBlackAndWhite(a)},e.prototype.setOptimizeNavigation=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setOptimizeNaviation is not applicable to 2D");this.prefs.set("optimizeNavigation",a),this.impl.setOptimizeNavigation(a)},e.prototype.setNavigationLock=function(b){this.navigation.getIsLocked()!==b&&(this.navigation.setIsLocked(b),this.dispatchEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()}))},e.prototype.getNavigationLock=function(){return this.navigation.getIsLocked()},e.prototype.setNavigationLockSettings=function(b){this.navigation.setLockSettings(b),this.dispatchEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()})},e.prototype.getNavigationLockSettings=function(){return this.navigation.getLockSettings()},e.prototype.setActiveNavigationTool=function(b){if(b===this._pushedTool||!b&&!this._pushedTool)return!0;if(this._pushedTool){if(!this.impl.controls.deactivateTool(this._pushedTool))return!1;this.impl.controls.setToolActiveName(this.getDefaultNavigationToolName()),this._pushedTool=null}return b&&b!==this.getDefaultNavigationToolName()||null!==this._pushedTool?!!this.impl.controls.activateTool(b)&&(this._pushedTool=b,this.dispatchEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this._pushedTool}),!0):(this.dispatchEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this.getDefaultNavigationToolName()}),!0)},e.prototype.getActiveNavigationTool=function(){return this._pushedTool?this._pushedTool:this._defaultNavigationTool},e.prototype.setDefaultNavigationTool=function(a){this._defaultNavigationTool&&this.impl.controls.deactivateTool(this._defaultNavigationTool),this._pushedTool&&this.impl.controls.deactivateTool(this._pushedTool),this.impl.controls.activateTool(a),this._defaultNavigationTool=a,this._pushedTool&&this.impl.controls.activateTool(this._pushedTool)},e.prototype.getDefaultNavigationToolName=function(){return this._defaultNavigationTool},e.prototype.getFOV=function(){return this.navigation.getVerticalFov()},e.prototype.setFOV=function(a){this.navigation.setVerticalFov(a,!0)},e.prototype.getFocalLength=function(){return this.navigation.getFocalLength()},e.prototype.setFocalLength=function(a){this.navigation.setFocalLength(a,!0)},e.prototype.hideLines=function(b){function c(e){b&&e.model.hideLines(b),d.removeEventListener(a.GEOMETRY_LOADED_EVENT,c)}this.prefs.set("lineRendering",!b);var d=this;this.impl.hideLines(b)||this.addEventListener(a.GEOMETRY_LOADED_EVENT,c)},
e.prototype.hidePoints=function(b){function c(e){b&&e.model.hidePoints(b),d.removeEventListener(a.GEOMETRY_LOADED_EVENT,c)}this.prefs.set("pointRendering",!b);var d=this;this.impl.hidePoints(b)||this.addEventListener(a.GEOMETRY_LOADED_EVENT,c)},e.prototype.setDisplayEdges=function(a){this.prefs.set("edgeRendering",a),this.impl.setDisplayEdges(a)},e.prototype.applyCamera=function(a,b){this.impl.setViewFromCamera(a,!0),b&&this.fitToView()},e.prototype.fitToView=function(a,b,c){var d=[];a&&(a.length>0&&a[0].model?d=a:a.length>0&&d.push({model:b||this.model,selection:a})),this.impl.fitToView(d,c)},e.prototype.setClickConfig=function(a,b,c){var d=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(a in d){var e=d[a];if(b in e)return e[b]=c,!0}return!1},e.prototype.getClickConfig=function(a,b){var c=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(a in c){var d=c[a];if(b in d)return d[b]}return null},e.prototype.setClickToSetCOI=function(a,b){!1!==b&&this.prefs.set("clickToSetCOI",a);var c=this.getClickConfig("click","onObject");a?-1===c.indexOf("setCOI")&&this.setClickConfig("click","onObject",["setCOI"]):c.indexOf("setCOI")>=0&&this.setClickConfig("click","onObject",["selectOnly"])},e.prototype.initSettings=function(){this.prefs.load(a.DefaultSettings),this.prefs.tag("3d"),this.prefs.tag("2d"),this.prefs.untag("2d",["viewCube","alwaysUsePivot","zoomTowardsPivot","reverseHorizontalLookDirection","reverseVerticalLookDirection","orbitPastWorldPoles","clickToSetCOI","ghosting","optimizeNavigation","renderCache","ambientShadows","antialiasing","groundShadow","groundReflection","lineRendering","edgeRendering","lightPreset","envMapBackground","firstPersonToolPopup","bimWalkToolPopup"]),this.prefs.untag("3d",["swapBlackAndWhite"]),this.setQualityLevel(this.prefs.ambientShadows,this.prefs.antialiasing),this.setGroundShadow(this.prefs.groundShadow),this.setGroundReflection(this.prefs.groundReflection),this.setGhosting(this.prefs.ghosting),this.setProgressiveRendering(this.prefs.progressiveRendering),this.setSwapBlackAndWhite(this.prefs.swapBlackAndWhite),this.setClickToSetCOI(this.prefs.clickToSetCOI),this.setOptimizeNavigation(this.prefs.optimizeNavigation),this.hideLines(!this.prefs.lineRendering),this.hidePoints(!this.prefs.pointRendering),this.setDisplayEdges(this.prefs.edgeRendering),this.setEnvMapBackground(this.prefs.envMapBackground),this.setFirstPersonToolPopup(this.prefs.firstPersonToolPopup),this.setBimWalkToolPopup(this.prefs.bimWalkToolPopup),this.setRenderCache(this.prefs.renderCache),this.navigation.setUsePivotAlways(this.prefs.alwaysUsePivot),this.navigation.setReverseZoomDirection(this.prefs.reverseMouseZoomDir),this.navigation.setReverseHorizontalLookDirection(this.prefs.reverseHorizontalLookDirection),this.navigation.setReverseVerticalLookDirection(this.prefs.reverseVerticalLookDirection),this.navigation.setZoomTowardsPivot(this.prefs.zoomTowardsPivot),this.navigation.setOrbitPastWorldPoles(this.prefs.orbitPastWorldPoles),this.navigation.setUseLeftHandedInput(this.prefs.leftHandedMouseSetup);var b=this.prefs.backgroundColorPreset;if(b)try{var c=JSON.parse(b);this.impl.setClearColors(c[0],c[1],c[2],c[3],c[4],c[5])}catch(a){this.prefs.set("backgroundColorPreset",null)}var d=this.prefs.lightPreset;this.impl.setLightPreset(d)},e.prototype.setLightPreset=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setLightPreset is not applicable to 2D");this.prefs.set("lightPreset",a),this.impl.setLightPreset(a)},e.prototype.setUsePivotAlways=function(a){this.prefs.set("alwaysUsePivot",a),this.navigation.setUsePivotAlways(a)},e.prototype.setReverseZoomDirection=function(a){this.prefs.set("reverseMouseZoomDir",a),this.navigation.setReverseZoomDirection(a)},e.prototype.setReverseHorizontalLookDirection=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setReverseHorizontalLookDirection is not applicable to 2D");this.prefs.set("reverseHorizontalLookDirection",a),this.navigation.setReverseHorizontalLookDirection(a)},e.prototype.setReverseVerticalLookDirection=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setReverseVerticalLookDirection is not applicable to 2D");this.prefs.set("reverseVerticalLookDirection",a),this.navigation.setReverseVerticalLookDirection(a)},e.prototype.setZoomTowardsPivot=function(a){this.prefs.set("zoomTowardsPivot",a),this.navigation.setZoomTowardsPivot(a)},e.prototype.setOrbitPastWorldPoles=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setOrbitPastWorldPoles is not applicable to 2D");this.prefs.set("orbitPastWorldPoles",a),this.navigation.setOrbitPastWorldPoles(a)},e.prototype.setUseLeftHandedInput=function(a){this.prefs.set("leftHandedMouseSetup",a),this.navigation.setUseLeftHandedInput(a)},e.prototype.setLayerVisible=function(b,c,d){var e=this.impl.layers;null===b?c?e.showAllLayers():e.hideAllLayers():(Array.isArray(b)||(b=[b]),d&&e.hideAllLayers(),this.impl.setLayerVisible(b,c)),this.dispatchEvent({type:a.LAYER_VISIBILITY_CHANGED_EVENT})},e.prototype.isLayerVisible=function(a){return!!(a&&a.isLayer&&this.impl.isLayerVisible(a))},e.prototype.anyLayerHidden=function(){for(var a=this.impl.getLayersRoot().children,b=a.length,c=0;c<b;++c)if(!this.impl.layers.isLayerVisible(a[c]))return!0;return!1},e.prototype.allLayersHidden=function(){for(var a=this.impl.getLayersRoot().children,b=a.length,c=0;c<b;++c)if(this.impl.layers.isLayerVisible(a[c]))return!1;return!0},e.prototype.setGroundShadowColor=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setGroundShadowColor is not applicable to 2D");this.impl.setGroundShadowColor(a)},e.prototype.setGroundShadowAlpha=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setGroundShadowAlpha is not applicable to 2D");this.impl.setGroundShadowAlpha(a)},e.prototype.setGroundReflectionColor=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setGroundReflectionColor is not applicable to 2D");this.impl.setGroundReflectionColor(a)},e.prototype.setGroundReflectionAlpha=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.setGroundReflectionAlpha is not applicable to 2D");this.impl.setGroundReflectionAlpha(a)},e.prototype.getCutPlanes=function(){return this.model&&this.model.is2d()?(b.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"),[]):this.impl.getCutPlanes()},e.prototype.setCutPlanes=function(a){if(this.model&&this.model.is2d())return void b.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D");this.impl.setCutPlanes(a)},e.prototype.getScreenShot=function(a,b,c){return this.impl.getScreenShot(a,b,c)},e.prototype.getScreenShotBuffer=function(a,b,c){return this.impl.getScreenShotBuffer(a,b,c)},e.prototype.setContextMenu=function(a){this.contextMenu&&this.contextMenu.hide(),this.contextMenu=a||null},e.prototype.setDefaultContextMenu=function(){var a=Autodesk.Viewing.Extensions;return!(!a||!a.ViewerObjectContextMenu)&&(this.setContextMenu(new a.ViewerObjectContextMenu(this)),!0)},e.prototype.triggerContextMenu=function(a){return this.config&&this.config.onTriggerContextMenuCallback&&this.config.onTriggerContextMenuCallback(a),!!this.contextMenu&&(this.contextMenu.show(a),!0)},e.prototype.triggerSelectionChanged=function(a){this.config&&this.config.onTriggerSelectionChangedCallback&&this.config.onTriggerSelectionChangedCallback(a)},e.prototype.triggerDoubleTapCallback=function(a){this.config&&this.config.onTriggerDoubleTapCallback&&this.config.onTriggerDoubleTapCallback(a)},e.prototype.triggerSingleTapCallback=function(a){this.config&&this.config.onTriggerSingleTapCallback&&this.config.onTriggerSingleTapCallback(a)},e.prototype.initContextMenu=function(){(!this.config||!this.config.hasOwnProperty("disableBrowserContextMenu")||this.config.disableBrowserContextMenu)&&(this.onDefaultContextMenu=function(a){a.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1));var a=this,c=this.canvas||this.container;c.addEventListener("mousedown",function(c){b.isRightClick(c,a.navigation)&&(a.startX=c.clientX,a.startY=c.clientY)}),c.addEventListener("mouseup",function(c){return b.isRightClick(c,a.navigation)&&c.clientX===a.startX&&c.clientY===a.startY&&a.triggerContextMenu(c),!0},!1)},e.prototype.registerContextMenuCallback=function(a,b){this.contextMenuCallbacks[a]=b},e.prototype.unregisterContextMenuCallback=function(a){return a in this.contextMenuCallbacks&&(delete this.contextMenuCallbacks[a],!0)},e.prototype.runContextMenuCallbacks=function(a,b){for(var c in this.contextMenuCallbacks)this.contextMenuCallbacks.hasOwnProperty(c)&&this.contextMenuCallbacks[c](a,b)},e.prototype.playAnimation=function(a){var b=this.impl.keyFrameAnimator;b&&b.play(0,a)},e.prototype.joinLiveReview=function(a){this.liveReviewClient||(this.liveReviewClient=new b.LiveReviewClient(this));var c=this.liveReviewClient;b.loadDependency("lmv_io","socket.io-1.3.5.js",function(){c.joinLiveReviewSession(a)})},e.prototype.leaveLiveReview=function(){this.liveReviewClient&&this.liveReviewClient.leaveLiveReviewSession()},e.prototype.setModelUnits=function(a){this.model&&(this.model.getData().overriddenUnits=a)},e.prototype.worldToClient=function(a){return this.impl.worldToClient(a)},e.prototype.clientToWorld=function(a,b,c){return this.impl.clientToWorld(a,b,c)},e.prototype.modelHasTopology=function(){return!(!this.model||!this.model.hasTopology())},e.prototype.setSelectionColor=function(a,b){this.impl.setSelectionColor(a,b)},e.prototype.createViewCube=function(){this.viewCubeUi||(this.viewCubeUi=new b.ViewCubeUi(this),this.viewCubeUi.create())},e.prototype.displayViewCube=function(a){this.viewCubeUi&&this.viewCubeUi.displayViewCube(a,!1)},e.prototype.displayViewCubeUI=function(a){this.viewCubeUi&&this.viewCubeUi.setVisible(a)},e.prototype.setViewCube=function(a){this.viewCubeUi&&this.viewCubeUi.cube&&this.viewCubeUi.cube.cubeRotateTo(a)},e.prototype.setTheme=function(a){for(var b=this.container.classList,c=0;c<b.length;++c){-1!==b[c].indexOf("-theme")&&b.remove(b[c--])}b.add(a)},e.prototype.setThemingColor=function(a,b,c){c=c||this.model,c.setThemingColor(a,b),this.impl.invalidate(!0)},e.prototype.clearThemingColors=function(a){a=a||this.model,a.clearThemingColors(),this.impl.invalidate(!0)},e.prototype.transferModel=function(a,b){var c=this.impl.findModel(a);if(c){var d=[];this.getAggregateSelection(function(b,c){b.id==a&&d.push(c)});var e=this.impl.visibilityManager.getIsolatedNodes(c),f=this.impl.visibilityManager.getHiddenNodes(c),g=this.impl.matman().exportModelMaterials(c),h=c.loader;c.loader=null,this.impl.unloadModel(c),c.loader=h,b.model=c,b.impl.addModel(c),b.impl.matman().importModelMaterials(g),b.loadSpinner&&(b.loadSpinner.style.display="None"),h&&(h.delegate&&h.delegate.eventTarget===this?h.transferToDelegate(b.impl._loaderDelegate):h.viewer3DImpl===this.impl&&(h.viewer3DImpl=b.impl)),c.getData().loadDone&&b.impl.onLoadComplete(c),b.impl.selector.setSelection(d,c),0!=e.length?b.impl.visibilityManager.isolate(e,c):0!=f.length&&b.impl.visibilityManager.hide(f,c)}},e.prototype.hideModel=function(a){var b=this.impl.modelQueue(),c=b.findModel(a);return!!c&&(this.impl.removeModel(c),b.addHiddenModel(c),this.model=this.impl.model,!0)},e.prototype.showModel=function(a){var b=this.impl.modelQueue(),c=b.findHiddenModel(a);return!!c&&(b.removeHiddenModel(c),this.impl.addModel(c),this.model=this.impl.model,!0)},e.prototype.getHiddenModels=function(){return this.impl.modelQueue().getHiddenModels()},e.prototype.getMemoryInfo=function(){var a=this.impl.modelQueue();return a?a.getMemoryInfo():null},e.prototype.onResetEvent=function(){var a=this.model;this.impl.setupLighting(a),a.isAEC()&&a.is3d()&&this.impl.setLightPresetForAec(),this.impl.setRenderingPrefsFor2D(!a.is3d())},e.prototype.disableHighlight=function(a){this.impl.disableHighlight(a)},e.prototype.disableSelection=function(a){a&&this.clearSelection(),this.impl.disableSelection(a)},e.prototype.isHighlightDisabled=function(){return this.impl.selector.highlightDisabled},e.prototype.isHighlightPaused=function(){return this.impl.selector.highlightPaused},e.prototype.isHighlightActive=function(){return!(this.impl.selector.highlightDisabled||this.impl.selector.highlightPaused)},e.prototype.isSelectionDisabled=function(){return this.impl.selector.selectionDisabled},e.prototype.editModel=function(a){if(a||(a=this.model))return a._modelEditor||(a._modelEditor=new WGS.ModelEditor(a,this,this.impl.matman(),b.initLoadContext,this.impl.glrenderer())),a._modelEditor},e.prototype.activateExtension=function(a,c){if(this.loadedExtensions&&a in this.loadedExtensions){return this.loadedExtensions[a].activate(c)}return b.logger.warn("Extension is not loaded or doesn't exist"),!1},e.prototype.deactivateExtension=function(a){if(this.loadedExtensions&&a in this.loadedExtensions){return this.loadedExtensions[a].deactivate()}return b.logger.warn("Extension is not loaded or doesn't exist"),!1},e.prototype.isExtensionActive=function(a,c){if(this.loadedExtensions&&a in this.loadedExtensions){return this.loadedExtensions[a].isActive(c)}return b.logger.warn("Extension is not loaded or doesn't exist"),!1},e.prototype.isExtensionLoaded=function(a){return this.loadedExtensions&&a in this.loadedExtensions},e.prototype.getLoadedExtensions=function(){return this.loadedExtensions||[]},e.prototype.getExtensionModes=function(a){if(this.loadedExtensions&&a in this.loadedExtensions){return this.loadedExtensions[a].getModes()}return console.warn("Extension is not loaded or doesn't exist"),[]},Autodesk.Viewing.Viewer3D=e}(),function(){"use strict";var a=Autodesk.Viewing,b=Autodesk.Viewing.Private,c=function(c,d,e){function f(a){if(a){var c,d=a.children||a.derivatives,e=d?d.length:0;if("geometry"===a.type&&e){var g=0;for(c=0;c<e;c++){var i=d[c];i&&"view"===i.type&&(h.myViewGeometry[i.guid]=a,g++)}h.myNumViews[a.guid]=g}else if("application/autodesk-db"==a.mime&&a.urn)0===a.urn.indexOf(b.ViewingService.OSS_PREFIX)?h.myPropertyDb=a.urn.substr(0,a.urn.lastIndexOf("%2F")+3):h.myPropertyDb=a.urn.substr(0,a.urn.lastIndexOf("/")+1);else if(0<e)for(c=0;c<e;c++)f(d[c])}}function g(a){if(a)for(var b=a.children||a.derivatives,c=b?b.length:0,d=0;d<c;d++)b[d].parent=a,g(b[d])}this.myPath=d,this.myData=c,c&&(this.docRoot=new a.BubbleNode(c)),this.myViewGeometry={},this.myNumViews={},this.myPropertyDb=null,this.acmSessionId=e;var h=this;f(c),g(this.myData)};c.prototype.constructor=c,c.load=function(d,e,f,g){function h(a){var b=c.getViewableItems(a),d=b[0];return c.getSubItemsWithProperties(d,{type:"geometry"},!0).length}function i(a,b){var c=[],d=0,e=0;b=b||"children";var f=function(a){var g=a[b]||[],h=a.messages||[];h.filter(function(a){return"error"===a.type}).length>0&&(d+=1),"inprogress"===a.status&&(e+=1),Array.prototype.push.apply(c,h.slice(0));for(var i=g.length;i--;f(g[i]));};f(a);var g="translated";g=d>0?"failed":g,g=e>0?"processing":g;for(var h=c.length;h--;c[h].$translation=g);return c}function j(g){function j(b){if(/<[^>]*script/.test(b))return void(f&&f(a.ErrorCodes.BAD_DATA,"Malicious document content detected Abort loading"));var d="string"==typeof b?JSON.parse(b):b;a.endpoint.getApiFlavor()===a.endpoint.ENDPOINT_API_FLUENT&&(g=d.urn);var j=new c(d,m,g);if(h(j)>0)l=i(j.getRootItem()),e&&e(j,l);else if(f){l=i(j.getRootItem());var k=a.ErrorCodes.BAD_DATA_NO_VIEWABLE_CONTENT;f(k,"No viewable content",l)}}function k(b,c,d){var e=i(d);if(f){var g="Error: "+b+" ("+c+")",h=a.getErrorCode(b);f(h,g,b,c,e)}}var l,m=c.getDocumentPath(d),n={queryParams:g?"acmsession="+g:""};b.ViewingService.getManifest(b.initLoadContext(n),m,j,k)}g?b.ViewingService.getACMSession(a.endpoint.getApiEndpoint(),g,j,f):j()},c.getDocumentPath=function(a){if(-1===a.indexOf("urn:")){if(-1!==a.indexOf("://"))return a;var b=a;return"undefined"!=typeof window?(0!==b.indexOf("/")&&(b="/"+b),window.location.protocol+"//"+window.location.host+b):b}return a},c.requestThumbnailWithSecurity=function(a,c){var d=function(a){c(null,a)},e=function(){c("error",null)},f={responseType:"blob",skipAssetCallback:!0,size:a.width,guid:a.guid},g="urn:"+a.urn;b.ViewingService.getThumbnail(b.initLoadContext(),g,d,e,f)},c.prototype.getFullPath=function(c){if(!c)return c;var d=c;if(b.offline){if(-1==d.indexOf(a.Private.offlineResourcePrefix)){var e=d.indexOf(a.Private.ViewingService.OSS_PREFIX);if(-1!==e){var f=d.substr(d.indexOf("/")+1),g=decodeURIComponent(f),h=g.substr(g.indexOf("/"));d=decodeURIComponent(a.Private.offlineResourcePrefix)+h}else d=decodeURIComponent(a.Private.offlineResourcePrefix)+d.substr(d.indexOf("/"))}}else 0===c.indexOf("urn")?d=a.endpoint.getItemApi(null,c):0===c.indexOf("$file$")&&(d=this.myPath.replace("/bubble.json","")+c.replace("$file$",""));return d},c.prototype.getThumbnailOptions=function(a,b,c){var d=b||200,e=c||200;return{urn:this.myData.urn,width:d,height:e,guid:a.guid,acmsession:this.acmSessionId}},c.prototype.getThumbnailPath=function(b,c,d){var e=this.getThumbnailOptions(b,c,d),f=a.endpoint.getThumbnailApi(null,e.urn)+"?guid="+e.guid+"&width="+e.width+"&height="+e.height;return e.acmsession&&(f+="&acmsession="+e.acmsession),f},c.prototype.getLeafletZipParams=function(a,b){for(var d,e,f=c.getSubItemsWithProperties(b,{role:"leaflet-zip"},!1),g=0;g<f.length;g++)e={},d=f[g],e.urnZip=this.getFullPath(d.urn),e.centralDirOffset=d.central_dir_offset,e.centralDirLength=d.central_dir_length,e.centralDirEntries=d.central_dir_entries,e.zipMaxLevel=d.max_level-a.levelOffset,e.loadFromZip=!!(e.urnZip&&e.centralDirOffset&&e.centralDirLength&&e.centralDirEntries),a.zips||(a.zips=[]),a.zips.push(e);a.zips.sort(function(a,b){return a.zipMaxLevel-b.zipMaxLevel})},c.prototype.getLeafletParams=function(c,d,e){c.tileSize=e.tileSize?e.tileSize:512,c.texWidth=e.resolution[0],c.texHeight=e.resolution[1],c.paperWidth=e.paperWidth,c.paperHeight=e.paperHeight,c.paperUnits=e.paperUnits,c.urlPattern=e.urn,c.levelOffset=b.LeafletLoader.computeLevelOffset(c.tileSize),this.getLeafletZipParams(c,d),c.loadFromZip=c.zips&&c.zips[0].loadFromZip,c.zips&&b.offline&&a.isMobileDevice()&&(c.zips=c.zips.slice(0,1),c.maxLevel=c.zips[0].zipMaxLevel)},c.prototype.getViewableUrn=function(b,c){var d=b instanceof a.BubbleNode?b:new a.BubbleNode(b);if(d.isGeometry()){var e=[];if(d.is3D())return d.getViewableRootPath();if(d.is2D()&&(e=d.search(a.BubbleNode.LEAFLET_NODE),e.length>0&&c&&this.getLeafletParams(c,d.data,e[0].data),0===e.length&&(e=d.search(a.BubbleNode.IMAGE_NODE)),0===e.length&&(e=d.search(a.BubbleNode.GEOMETRY_F2D_NODE))),e.length>0)return e[0].urn()}else if(d.isViewPreset()){var f=this.getViewGeometry(d.data);if(f)return this.getViewableUrn(f,c)}return""},c.prototype.getViewablePath=function(a,b){var c=this.getViewableUrn(a,b);return c?this.getFullPath(c):""},c.prototype.getPropertyDbPath=function(){return this.getFullPath(this.myPropertyDb)},c.prototype.getRootItem=function(){return this.myData},c.prototype.getRoot=function(){return this.docRoot},c.prototype.getPath=function(){return this.myPath},c.prototype.getItemById=function(a){function b(c){if(!c)return null;for(var d in c){var e=c[d];if("guid"===d&&e===a)return c;if(null!==e&&"object"==typeof e&&"parent"!==d){var f=b(e);if(f)return f}}return null}return b(this.myData)},c.getSubItemsWithProperties=function(a,b,d){var e=[];if(!a)return[];for(var f=a.children||a.derivatives,g=f?f.length:0,h=0;h<g;h++){var i=f[h];(function(a,b){for(var c in b)if(!(c in a)||b[c]!==a[c])return!1;return!0})(i,b)&&e.push(i),d&&e.push.apply(e,c.getSubItemsWithProperties(i,b,d))}return e},c.getViewableItems=function(a){return c.getSubItemsWithProperties(a.getRootItem(),{type:"folder",role:"viewable"},!0).concat(c.getSubItemsWithProperties(a.getRootItem(),{outputType:"svf"},!0))},c.prototype.getViewGeometry=function(a){return this.myViewGeometry[a.guid]},c.prototype.getNumViews=function(a){return this.myNumViews[a.guid]||0},c.prototype.getParentId=function(a){var b=this.getItemById(a);if(!b)return null;var c=b.parent;return c?c.guid:null},c.prototype.getMessages=function(a,b){var c=[];if(!a)return c;var d=null;b&&(d=this.getRootItem());for(var e=a;e&&(!b||parent!==d);){if(e.messages)for(var f=0;f<e.messages.length;f++)c.push(e.messages[f]);e=e.parent}return c},a.Document=c}(),function(){"use strict";function a(a){this.__options={dollyToPivot:!1,orbitPastPoles:!0,reverseDolly:!1,reverseHorizontalLook:!1,reverseVerticalLook:!1,useLeftHandedInput:!1,usePivotAlways:!1,lockNavigation:!1},this.__lockSettings={orbit:!1,pan:!1,zoom:!1,roll:!1,fov:!1,gotoview:!1,walk:!1},this.FIT_TO_VIEW_VERTICAL_MARGIN=.05,this.FIT_TO_VIEW_VERTICAL_OFFSET=0,this.FIT_TO_VIEW_HORIZONTAL_MARGIN=.05,this.FIT_TO_VIEW_HORIZONTAL_OFFSET=0,this.__pivotIsSetFlag=!1,this.__fitToViewRequested=!1,this.__homeViewRequested=!1,this.__transitionActive=!1,this.__destinationView=null,this.__is2D=!1,this.__isTouchDevice=!1,this.__kEpsilon=1e-6,this.__minDistance=1e-5;var b=void 0,c=void 0,d=2,e=200,f=null,g={left:0,top:0,width:1,height:1};this.uninitialize=function(){this.setCamera(null)},this.setCamera=function(a){a!==f&&(f=a,a&&(a.hasOwnProperty("target")||(a.target=new THREE.Vector3(0,0,0)),a.hasOwnProperty("pivot")||(a.pivot=new THREE.Vector3(0,0,0)),a.worldup=a.up.clone(),a.dirty=!0))},this.getCamera=function(){return f},this.setScreenViewport=function(a){g=a},this.getScreenViewport=function(){return g},this.__setUp=function(a){if(a&&f){if(0!==a.clone().normalize().sub(f.worldup).lengthSq())return f.worldup.copy(a).normalize(),f.dirty=!0,!0}return!1},this.__getUp=function(){return f?f.worldup:new THREE.Vector3(0,1,0)},this.setView=function(a,b){f&&a&&b&&(f.position.copy(a),f.target.copy(b),f.dirty=!0)},this.orientCameraUp=function(){f&&this.isActionEnabled("roll")&&(f.up.copy(this.getAlignedUpVector()),f.dirty=!0)},this.getPivotPoint=function(){return f?f.pivot.clone():new THREE.Vector3(0,0,0)},this.setPivotPoint=function(a){f&&a&&(f.pivot.copy(a),f.dirty=!0)},this.getPosition=function(){return f?f.position.clone():new THREE.Vector3(0,0,1)},this.setPosition=function(a){f&&a&&(f.position.copy(a),f.dirty=!0)},this.setTarget=function(a){f&&a&&(f.target.copy(a),f.dirty=!0)},this.getTarget=function(){return f?f.target.clone():new THREE.Vector3(0,0,0)},this.getEyeVector=function(){return f?f.target.clone().sub(f.position):new THREE.Vector3(0,0,-1)},this.getEyeToCenterOfBoundsVec=function(a){return f?a.center().sub(f.position):new THREE.Vector3(0,0,-1)},this.getFovMin=function(){return 6.88},this.getFovMax=function(){return 100},this.setZoomInLimitFactor=function(a){e=a},this.getZoomInLimitFactor=function(){return e},this.setZoomOutLimitFactor=function(a){d=a},this.getZoomOutLimitFactor=function(){return d},this.isPointVisible=function(a){return(new THREE.Frustum).setFromMatrix(f.projectionMatrix.clone().multiply(f.matrixWorldInverse)).containsPoint(a)},this.setVerticalFov=function(a,b){if((!f||f.isPerspective)&&(a<6.88?a=6.88:a>100&&(a=100),f&&this.isActionEnabled("fov"))){if(Math.abs(f.fov-a)<=1e-6)return;if(b){var c=this.__pivotIsSetFlag&&this.isPointVisible(this.getPivotPoint()),d=this.getPosition(),e=this.getEyeVector(),g=THREE.Math.degToRad(f.fov),h=THREE.Math.degToRad(a),i=c?this.getPivotPlaneDistance():e.length(),j=i*Math.tan(.5*g)/Math.tan(.5*h),k=e.normalize().multiplyScalar(i-j);this.setPosition(d.add(k)),c&&this.setTarget(this.getTarget().add(k))}f.setFov(a),f.dirty=!0}},this.computeFit=function(b,c,d,e,f){if(!e||e.empty())return{position:b,target:c};f=void 0===f?1:f;for(var g=e.center(),h=e.size(),i=b.clone().sub(c).normalize(),j=Math.tan(THREE.Math.degToRad(.5*d)),k=0,l=this.computeOrthogonalUp(b,c),m=i.clone().cross(l).normalize(),n=new THREE.Vector3,o=0===h.z?4:8,p=0;p<o;p++){n.set(0==(1&p)?-.5*h.x:.5*h.x,0==(2&p)?-.5*h.y:.5*h.y,0==(4&p)?-.5*h.z:.5*h.z);var q=0;a.isPerspective&&(q=n.dot(i));var r=Math.abs(n.dot(l)),s=Math.abs(n.dot(m)),t=q+(1+2*this.FIT_TO_VIEW_VERTICAL_MARGIN/(1-2*this.FIT_TO_VIEW_VERTICAL_MARGIN))*r/j;k<t&&(k=t),t=q+(1+2*this.FIT_TO_VIEW_HORIZONTAL_MARGIN/(1-2*this.FIT_TO_VIEW_HORIZONTAL_MARGIN))*s/(f*j),k<t&&(k=t)}return g.add(l.multiplyScalar(-k*this.FIT_TO_VIEW_VERTICAL_OFFSET)),g.add(m.multiplyScalar(k*this.FIT_TO_VIEW_HORIZONTAL_OFFSET)),i.multiplyScalar(k),{position:g.clone().add(i),target:g}},this.computeOrthogonalUp=function(a,b){var c=this.__getUp(),d=b.clone().sub(a);if(0===d.lengthSq())return d.copy(c);var e=d.clone().cross(c);return 0===e.lengthSq()&&(c.z>c.y?d.y-=1e-4:d.z-=1e-4,e.crossVectors(d,c)),e.cross(d).normalize()},this.fitBounds=function(a,b,c){var d=this.getTarget(),e=this.getPosition();if(!this.isActionEnabled("gotoview")||!b||b.empty())return{position:e,target:d};var g=this.getVerticalFov(),h=this.computeFit(e,d,g,b,f.aspect),i=c?this.computeOrthogonalUp(e,d):f.up;return a?(f.up.copy(i),this.setView(h.position,h.target)):this.setRequestTransitionWithUp(!0,h.position,h.target,g,i),this.setPivotPoint(h.target),this.setPivotSetFlag(!0),h},this.computeOverviewDistance=function(a){if(this.__is2D){var b=a.size(),c=f.aspect,d=b.x/c,e=b.y;return Math.max(d,e)}var g=this.getVerticalFov(),b=a.size(),h=b.length();return 0===h&&(h=2),f.isPerspective?.5*h/Math.tan(THREE.Math.degToRad(.5*g)):h},this.applyDollyConstraint=function(a,g){if(!(b||c||d))return a;var h=a;if((b||d&&g)&&a>1){var i,j=f.isPerspective?this.getEyeToCenterOfBoundsVec(g):this.getEyeVector();i=b?d*this.computeOverviewDistance(b):d*this.computeOverviewDistance(g);var k=Math.abs(i/j.length());k=Math.max(k,1),h=Math.min(h,k)}if((c||e&&g)&&this.__is2D){var l;l=c?f.clientHeight/c:this.computeOverviewDistance(g)/e;var j=this.getEyeVector(),m=l/-j.z;m=Math.min(m,1),h=Math.max(h,m)}return h},this.applyPanningConstraint2D=function(a){if(this.__is2D&&b){var c=f.position.x+a.x,d=f.position.y+a.y;c=THREE.Math.clamp(c,b.min.x,b.max.x),d=THREE.Math.clamp(d,b.min.y,b.max.y);var e=c-f.position.x,g=d-f.position.y,h=Math.min(a.x,0),i=Math.min(a.y,0),j=Math.max(a.x,0),k=Math.max(a.y,0);e=THREE.Math.clamp(e,h,j),g=THREE.Math.clamp(g,i,k),a.x=e,a.y=g}},this.updateCamera=function(){f&&(f.updateProjectionMatrix(),this.orient(f,f.target,f.position,f.up),f.dirty=!1)},this.setCamera(a),this.setConstraints2D=function(a,d){b=a,c=d}}var b=Autodesk.Viewing,c=b.Private;a.prototype.constructor=a,a.prototype.setIs2D=function(a){this.__is2D=!!a},a.prototype.getIs2D=function(){return this.__is2D},a.prototype.setIsTouchDevice=function(a){this.__isTouchDevice=!!a},a.prototype.getIsTouchDevice=function(){return this.__isTouchDevice},a.prototype.orient=function(){function a(){b||(b=new THREE.Matrix4,c=new THREE.Vector3,d=new THREE.Vector3,e=new THREE.Vector3)}var b,c,d,e;return function(f,g,h,i){a();var j=b.elements;e.subVectors(h,g).normalize(),0===e.lengthSq()&&(e.z=1),c.crossVectors(i,e).normalize(),0===c.lengthSq()&&(i.z>i.y?e.y-=1e-4:e.z+=1e-4,c.crossVectors(i,e).normalize()),d.crossVectors(e,c),j[0]=c.x,j[4]=d.x,j[8]=e.x,j[1]=c.y,j[5]=d.y,j[9]=e.y,j[2]=c.z,j[6]=d.z,j[10]=e.z,f.setRotationFromMatrix(b)}}(),a.prototype.fov2fl=function(a){var b=THREE.Math.degToRad(a);return b<=0&&(b=1e-4),Math.round(12/Math.tan(.5*b))},a.prototype.fl2fov=function(a){a<=0&&(a=1e-4);var b=2*Math.atan(12/a);return THREE.Math.radToDeg(b)},a.prototype.setCameraUpVector=function(a){if(this.isActionEnabled("roll")){var b=this.getCamera();b.up.copy(a),b.dirty=!0}},a.prototype.getCameraUpVector=function(){var a=this.getCameraRightVector(!1),b=this.getEyeVector();return a.cross(b).normalize()},a.prototype.getAlignedUpVector=function(){var a=this.getCameraRightVector(!0),b=this.getEyeVector();return a.cross(b).normalize()},a.prototype.getCameraRightVector=function(a){var b=new THREE.Vector3,c=a?this.getWorldUpVector():this.getCamera().up,d=this.getEyeVector();return b.crossVectors(d,c),0===b.lengthSq()&&(Math.abs(d.z)>=Math.abs(d.y)?c.set(0,1,0):c.set(0,0,1),b.crossVectors(d,c)),b.normalize()},a.prototype.setWorldUpVector=function(a,b){this.isActionEnabled("roll")&&(this.__setUp(a),b&&this.orientCameraUp())},a.prototype.getWorldUpVector=function(){return this.__getUp().clone()},a.prototype.getWorldRightVector=function(){var a=new THREE.Vector3;return a.copy(this.__getUp()),Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):a.z>=0?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x),a.normalize()},a.prototype.getVerticalFov=function(){return this.getCamera().fov},a.prototype.getHorizontalFov=function(){var a=this.getScreenViewport();return this.getCamera().fov*(a.width/a.height)},a.prototype.getFocalLength=function(){return this.fov2fl(this.getVerticalFov())},a.prototype.setFocalLength=function(a,b){this.setVerticalFov(this.fl2fov(a),b)},a.prototype.setReverseZoomDirection=function(a){this.__options.reverseDolly=!!a},a.prototype.setReverseHorizontalLookDirection=function(a){if(this.getIs2D())return void c.logger.warn("Autodesk.Viewing.Navigation.setReverseHorizontalLookDirection is not applicable to 2D");this.__options.reverseHorizontalLookDirection=!!a},a.prototype.setReverseVerticalLookDirection=function(a){if(this.getIs2D())return void c.logger.warn("Autodesk.Viewing.Navigation.setReverseVerticalLookDirection is not applicable to 2D");this.__options.reverseVerticalLookDirection=!!a},a.prototype.getReverseZoomDirection=function(){return this.__options.reverseDolly},a.prototype.getReverseHorizontalLookDirection=function(){return this.getIs2D()?(c.logger.warn("Autodesk.Viewing.Navigation.getReverseHorizontalLookDirection is not applicable to 2D"),!1):this.__options.reverseHorizontalLookDirection},a.prototype.getReverseVerticalLookDirection=function(){return this.getIs2D()?(c.logger.warn("Autodesk.Viewing.Navigation.getReverseVerticalLookDirection is not applicable to 2D"),!1):this.__options.reverseVerticalLookDirection},a.prototype.setZoomTowardsPivot=function(a){this.__options.dollyToPivot=!!a},a.prototype.getZoomTowardsPivot=function(){return this.__options.dollyToPivot},a.prototype.setOrbitPastWorldPoles=function(a){if(this.getIs2D())return void c.logger.warn("Autodesk.Viewing.Navigation.setOrbitPastWorldPoles is not applicable to 2D");this.__options.orbitPastPoles=!!a},a.prototype.getOrbitPastWorldPoles=function(){return this.getIs2D()?(c.logger.warn("Autodesk.Viewing.Navigation.orbitPastWorldPoles is not applicable to 2D"),!1):this.__options.orbitPastPoles},a.prototype.setUsePivotAlways=function(a){this.__options.usePivotAlways=!!a},a.prototype.getUsePivotAlways=function(){return this.__options.usePivotAlways},a.prototype.setUseLeftHandedInput=function(a){this.__options.useLeftHandedInput=!!a},a.prototype.getUseLeftHandedInput=function(){return this.__options.useLeftHandedInput},a.prototype.setIsLocked=function(a){this.__options.lockNavigation=!!a},a.prototype.getIsLocked=function(){return this.__options.lockNavigation},a.prototype.setLockSettings=function(a){for(var b in this.__lockSettings)a.hasOwnProperty(b)&&(this.__lockSettings[b]=a[b])},a.prototype.getLockSettings=function(){var a={};for(var b in this.__lockSettings)a[b]=this.__lockSettings[b];return a},a.prototype.isActionEnabled=function(a){return!this.__options.lockNavigation||!0===this.__lockSettings[a]},a.prototype.setPivotSetFlag=function(a){this.__pivotIsSetFlag=!!a},a.prototype.getPivotSetFlag=function(){return this.__pivotIsSetFlag},a.prototype.setRequestFitToView=function(a){this.isActionEnabled("gotoview")&&(this.__fitToViewRequested=!!a)},a.prototype.getRequestFitToView=function(){return this.__fitToViewRequested},a.prototype.setRequestHomeView=function(a){this.isActionEnabled("gotoview")&&(this.__homeViewRequested=!!a)},a.prototype.getRequestHomeView=function(){return this.__homeViewRequested},a.prototype.setRequestTransition=function(a,b,c,d,e,f){this.__destinationView=a?{position:b.clone(),coi:c.clone(),fov:d,up:this.getCamera().up.clone(),worldUp:this.getWorldUpVector(),reorient:e,pivot:f?f.clone():c.clone()}:null},
a.prototype.setRequestTransitionWithUp=function(a,b,c,d,e,f,g){this.__destinationView=a?{position:b.clone(),coi:c.clone(),fov:d,up:e.clone(),worldUp:f||this.getWorldUpVector(),reorient:!1,pivot:g?g.clone():c.clone()}:null},a.prototype.getRequestTransition=function(){return this.__destinationView},a.prototype.setTransitionActive=function(a){this.__transitionActive=!!a},a.prototype.getTransitionActive=function(){return this.__transitionActive},a.prototype.getWorldSize=function(a){var b=this.getScreenViewport(),c=b.width/b.height,d=2*a*Math.tan(THREE.Math.degToRad(.5*this.getCamera().fov)),e=d*c;return new THREE.Vector2(e,d)},a.prototype.getWorldPoint=function(a,b){b=1-b,a=2*a-1,b=2*b-1;var c,d=this.getCamera();d.isPerspective&&(c=new THREE.Vector3(a,b,1),c=c.unproject(d));var e,f,g=this.getEyeVector(),h=this.getPosition();if(!d.isPerspective||isNaN(c.x)){var i=this.getWorldSize(g.length()),j=this.getCameraRightVector(!1).multiplyScalar(.5*a*i.x),k=this.getCameraUpVector().multiplyScalar(.5*b*i.y);e=g.clone().add(j).add(k).normalize()}else e=c.sub(h).normalize();var l=this.getPivotPoint(),m=e.dot(g);return f=this.__pivotIsSetFlag&&(this.getIs2D()||d.isPerspective&&m>0)?0!==m?Math.abs(l.sub(h).dot(g))/m:l.sub(h).length():d.isPerspective?.5*(d.near+d.far):d.orthoScale,e.multiplyScalar(f).add(h)},a.prototype.getPivotPlaneDistance=function(){var a=this.getPivotPoint(),b=this.getEyeVector(),c=this.getPosition();return a.sub(c).dot(b.normalize())},a.prototype.panRelative=function(a,b,c){if(this.isActionEnabled("pan")){var d=this.getWorldSize(c),e=a*d.x,f=b*d.y,g=this.getCameraRightVector(!1).multiplyScalar(e),h=this.getCameraUpVector().multiplyScalar(f),i=g.add(h);this.applyPanningConstraint2D(i),this.setView(this.getPosition().add(i),this.getTarget().add(i))}},a.prototype.dollyFromPoint=function(a,b,c){if(this.isActionEnabled("zoom")&&!(Math.abs(a)<=this.__kEpsilon)){var d=this.getPosition(),e=this.getEyeVector();if(!this.getCamera().isPerspective){var f=e.lengthSq(),g=e.dot(this.getTarget().sub(b));b=e.clone().multiplyScalar(g/f).add(b)}var h=b.clone().sub(d),i=h.length(),j=i+a;j<this.__minDistance&&(j=this.__minDistance);var k=j/i;if(k=this.applyDollyConstraint(k,c),Math.abs(k-1)>this.__kEpsilon){h.multiplyScalar(k),h.set(-h.x,-h.y,-h.z);var l=h.add(b),e=this.getEyeVector();this.getCamera().isPerspective||e.multiplyScalar(k),this.setView(l,e.add(l))}}},a.prototype.toPerspective=function(){if(this.getIs2D())return void c.logger.warn("Autodesk.Viewing.Navigation.toPerspective is not applicable to 2D");var a=this.getCamera();a.isPerspective||(a.toPerspective(),a.dirty=!0)},a.prototype.toOrthographic=function(){var a=this.getCamera();a.isPerspective&&(a.toOrthographic(),a.dirty=!0)},a.snapToAxis=function(a){var b=new THREE.Vector3(Math.abs(a.x),Math.abs(a.y),Math.abs(a.z));return b.x>b.y&&b.x>b.z?a.set(a.x>0?1:-1,0,0):b.y>b.x&&b.y>b.z?a.set(0,a.y>0?1:-1,0):a.set(0,0,a.z>0?1:-1),a},Autodesk.Viewing.Navigation=a}(),function(){"use strict";function a(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d=b[c],e=Array.isArray(d),f=a[c],g=Array.isArray(f);e&&g?(d?e||(d=[d]):d=[],f?g||(f=[f]):f=[],a[c]=f.concat(d)):a[c]=d}}var b=Autodesk.Viewing,c=Autodesk.Viewing.Private,d=function(a,b){this.appContainerId=a,this.container=document.getElementById(a),this.options=b||{},this.myRegisteredViewers={},this.myDocument=null,this.bubble=null,this.myCurrentViewer=null,this.urn=null,this.selectedItem=null,this.extensionCache={};var c=this;this.onHyperlinkHit=function(a){var b=a.data.item;b&&c.selectItem(b)},this.onLoadGeometry=function(a){var b=a.data;c.selectItem(b.item,b.onSuccessCb,b.onErrorCb)}};d.prototype.k3D="3D",d.prototype.finish=function(){this.myCurrentViewer&&(this.myCurrentViewer.finish(),this.myCurrentViewer=null)},d.prototype.registerViewer=function(a,d,e){if(a!==this.k3D)return void c.logger.error("The only acceptable viewer type is k3D.",b.errorCodeString(b.ErrorCodes.VIEWER_INTERNAL_ERROR));e=e||{},this.options&&this.options.hasOwnProperty("disableBrowserContextMenu")&&(e.hasOwnProperty("disableBrowserContextMenu")||(e.disableBrowserContextMenu=this.options.disableBrowserContextMenu)),this.myRegisteredViewers[a]={},this.myRegisteredViewers[a].class=d,this.myRegisteredViewers[a].config=e},d.prototype.getViewerClass=function(a){return this.myRegisteredViewers.hasOwnProperty(a)?this.myRegisteredViewers[a].class:null},d.prototype.getViewerContainer=function(){return document.getElementById(this.appContainerId)},d.prototype.getViewer=function(b){var c=this.myRegisteredViewers[this.k3D];if(!c)return null;var d={};a(d,c.config),a(d,b);var e=c.class;if(this.myCurrentViewer&&this.myCurrentViewer.__proto__.constructor===e)return this.myCurrentViewer.tearDown(),this.myCurrentViewer.setUp(d),this.myCurrentViewer;this.setCurrentViewer(null);for(var f=this.getViewerContainer();f.hasChildNodes();)f.removeChild(f.lastChild);var g=new e(f,d);return this.setCurrentViewer(g),g},d.prototype.setCurrentViewer=function(a){this.myCurrentViewer&&(this.myCurrentViewer.removeEventListener(b.HYPERLINK_EVENT,this.onHyperlinkHit),this.myCurrentViewer.removeEventListener(b.LOAD_GEOMETRY_EVENT,this.onLoadGeometry),this.myCurrentViewer.finish()),this.myCurrentViewer=a,this.myCurrentViewer&&(a.addEventListener(b.HYPERLINK_EVENT,this.onHyperlinkHit),a.addEventListener(b.LOAD_GEOMETRY_EVENT,this.onLoadGeometry),a.extensionCache=this.extensionCache)},d.prototype.getCurrentViewer=function(){return this.myCurrentViewer},d.prototype.setDocument=function(a){if(!a.urn||"$file$"===a.urn)return c.logger.error("Unsupported Manifest urn: "+a.urn),!1;var d=b.Document.getDocumentPath(a.urn);return this.myDocument=new b.Document(a,d),this.bubble=this.myDocument.getRoot(),this.onDocumentLoaded(this.myDocument),!0},d.prototype.loadDocument=function(a,d,e,f){c.logger.track({category:"load_document",urn:0==a.indexOf("urn:")?a.substring(4):a}),b.Document.load(a,function(a,b){this.myDocument=a,this.bubble=a.getRoot(),this.onDocumentLoaded(a,b),d&&d(a,b)}.bind(this),function(a,b,c,d,f){this.onDocumentFailedToLoad(a,b,f),e&&e(a,b,c,d,f)}.bind(this),f)},d.prototype.onDocumentLoaded=function(a,b){c.logger.log(a,b)},d.prototype.onDocumentFailedToLoad=function(a,d,e){c.logger.error(b.errorCodeString(a),d,e)},d.prototype.getDefaultGeometry=function(a){for(var b=0,c=a.length;b<c;++b){var d=a[b].useAsDefault;if(!0===d||"true"===d)return a[b]}return a[0]},d.prototype.selectItem=function(a,b,d){var e={};a instanceof Autodesk.Viewing.BubbleNode&&(a=a.data);var f=this.myDocument.getViewablePath(a,e);if(f||"view"!==a.type||(f=this.urn),!f)return!1;var g,h,i,j=!1;if("geometry"===a.type&&"3d"===a.role)j=!0,h=a.name,i=a;else if("view"===a.type&&"3d"===a.role)g=a,j=!0,(i=this.myDocument.getViewGeometry(a))&&(h=i.name);else if("geometry"===a.type&&"2d"===a.role){var k=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{mime:"application/autodesk-f2d"},!1),l=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{role:"leaflet"},!1),m=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{role:"image"},!1);(k.length>0||l.length>0||m.length>0)&&(j=!0),h=a.name,i=a}else"view"===a.type&&"2d"===a.role&&(g=a,j=!0,(i=this.myDocument.getViewGeometry(a))&&(h=i.name));if(!j)return!1;var n=f.indexOf("urn:");c.logger.track({category:"load_viewable",role:a.role,type:a.type,urn:-1!==n?f.substring(n+4):f});var o=this.myDocument.getMessages(a,!0),p=this,q=this.myCurrentViewer&&this.urn===f,r=function(){var c=p.myCurrentViewer;g&&g.camera?c.setViewFromArray(g.camera,g.name):g&&g.viewbox?c.setViewFromViewBox(g.viewbox,g.name):q&&c.setViewFromFile(),b&&b(p.myCurrentViewer,a,o)},s=function(a,b,c,e){d&&d(a,b,c,e,o)},t=!1;if(q)r&&r(),t=!0;else{this.urn=null;var u={defaultModelStructureTitle:h,viewableName:h};a.hasOwnProperty("extensions")&&(u.extensions=Array.isArray(a.extensions)?a.extensions:[a.extensions]);var v=this.getViewer(u);if(v){var w={ids:null,bubbleNode:this.bubble?this.bubble.findByGuid(a.guid):null,sharedPropertyDbPath:this.myDocument.getPropertyDbPath(),acmSessionId:this.myDocument.acmSessionId,loadOptions:e,useConsolidation:this.options.useConsolidation,consolidationMemoryLimit:this.options.consolidationMemoryLimit||104857600};v.started?(v.loadDocumentNode(this.myDocument,a,w).then(r).catch(s),t=!0):(v.startWithDocumentNode(this.myDocument,a,w).then(r).catch(s),t=!0),this.urn=f}}return!!t&&(this.selectedItem=a,this.onItemSelected(a,i),!0)},d.prototype.onItemSelected=function(a,b){if(c.logger.log("Selected URL: http://"+location.host+location.pathname+"?document=urn:"+this.myDocument.getRootItem().guid+"&item="+encodeURIComponent(a.guid)),this.itemSelectedObservers)for(var d=this.getCurrentViewer(),e=0;e<this.itemSelectedObservers.length;++e){var f=this.itemSelectedObservers[e];f.onItemSelected&&f.onItemSelected(d,a,b)}},d.prototype.addItemSelectedObserver=function(a){this.itemSelectedObservers||(this.itemSelectedObservers=[]),this.itemSelectedObservers.push(a)},d.prototype.selectItemById=function(a,b,c){var d=this.myDocument.getItemById(a);return!!d&&this.selectItem(d,b,c)},d.prototype.getSelectedItem=function(){return this.selectedItem},d.prototype.getNamedViews=function(a){if(!(a=a||this.selectedItem)||!a.guid)return[];var b=this.bubble.findByGuid(a.guid);return a===this.selectedItem&&(b=b.findParentGeom2Dor3D()),b.getNamedViews()},b.ViewingApplication=d}(),AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.Private.ViewCubeUi=function(a){this.viewer=a,this.container=null,this.cube=null,this.viewcube=null,this.homeViewContainer=null};var avp=Autodesk.Viewing.Private;Autodesk.Viewing.Private.ViewCubeUi.prototype={constructor:Autodesk.Viewing.UI.ViewCube,create:function(){this.viewer.config;this.initContainer(),this.initHomeButton()},initContainer:function(){this.container=document.createElement("div"),this.container.className="viewcube",this.viewer.container.appendChild(this.container)},initHomeButton:function(){if(!this.homeViewContainer){var a=document.createElement("div");a.className="homeViewWrapper",this.container.appendChild(a),this.homeViewContainer=a;var b=this;a.addEventListener("click",function(a){b.viewer.navigation.setRequestHomeView(!0)})}},setVisible:function(a){this.container.style.display=a?"block":"none"},showTriad:function(a){this.cube&&this.cube.showTriad(a)},displayViewCube:function(a,b){if(b&&this.viewer.prefs.set("viewCube",a),a&&!this.cube)this.viewcube=document.createElement("div"),this.viewcube.className="viewcube",this.container.appendChild(this.viewcube),this.cube=new avp.Autocam.ViewCube("cube",this.viewer.autocam,this.viewcube,LOCALIZATION_REL_PATH),this.container.appendChild(this.homeViewContainer);else if(!this.cube)return void this._positionHomeButton();this.viewcube.style.display=a?"block":"none",this._positionHomeButton(),a&&this.viewer.autocam.refresh()},_positionHomeButton:function(){if(this.homeViewContainer){this.cube&&this.viewcube&&"block"===this.viewcube.style.display?this.homeViewContainer.classList.remove("no-viewcube"):this.homeViewContainer.classList.add("no-viewcube")}},uninitialize:function(){this.container&&(this.viewer.container.removeChild(this.container),this.viewcube=null),this.cube&&(this.cube.dtor(),this.cube=null),this.homeViewContainer=null,this.hideHomeViewMenu=null,this.viewer=null}};var av=Autodesk.Viewing,avp=Autodesk.Viewing.Private,avu=Autodesk.Viewing.UI,ave=Autodesk.Viewing.Extensions,stringToDOM=avp.stringToDOM=function(a){var b=document.createElement("div");return b.innerHTML=a,b.firstChild};!function(){"use strict";av.TOOLBAR_CREATED_EVENT="toolbarCreated",av.VIEW_CUBE_CREATED_EVENT="viewCubeCreated",av.TOOLBAR={NAVTOOLSID:"navTools",MODELTOOLSID:"modelTools",SETTINGSTOOLSID:"settingsTools",MEASURETOOLSID:"measureTools"};var a=function(a,b){b||(b={}),b.startOnInitialize=!1,av.Viewer3D.call(this,a,b),this.toolbar=null,this.dockingPanels=[],this.modelstructure=null,this.layersPanel=null};a.populateConfigOptions=function(a){a.hasOwnProperty("disabledExtensions")||(a.disabledExtensions={}),["measure","hyperlink","section"].forEach(function(b){a.disabledExtensions.hasOwnProperty(b)||(a.disabledExtensions[b]=!1)})},a.prototype=Object.create(av.Viewer3D.prototype),a.prototype.constructor=a,a.prototype.initialize=function(){var a=av.Viewer3D.prototype.initialize.call(this);if(a>0)return avp.ErrorHandler.reportError(this.container,a),a;var b=this;if(this.toolController){var c=new av.HotGestureTool(this);this.toolController.registerTool(c),this.toolController.activateTool(c.getName())}return this.getToolbar(!0),this.addEventListener(av.FULLSCREEN_MODE_EVENT,function(a){b.resizePanels({viewer:b}),b.updateFullscreenButton(a.mode)}),this.contextMenu||this.setDefaultContextMenu(),this.progressbar=new avp.ProgressBar(this.container),this.addEventListener(av.PROGRESS_UPDATE_EVENT,function(a){void 0!==a.percent&&b.progressbar.setPercent(a.percent)},!1),this.selectionActive=!1,this.addEventListener(av.SELECTION_CHANGED_EVENT,function(a){if(b.selectionActive=a.dbIdArray.length>0,b.prefs.openPropertiesOnSelect){b.getPropertyPanel(!0).setVisible(b.selectionActive)}}),this.addEventListener(av.ISOLATE_EVENT,function(a){(b.prefs.openPropertiesOnSelect||a.nodeIdArray[0]===a.model.getRootId())&&b.propertygrid&&b.propertygrid.setVisible(a.nodeIdArray.length>0||b.selectionActive)}),this.addEventListener(av.VIEWER_STATE_RESTORED_EVENT,function(a){b.renderoptions&&b.renderoptions.syncUI();var c=b.getSettingsPanel(!0);c&&c.syncUI()}),this.addEventListener(av.VIEWER_RESIZE_EVENT,function(a){b.resizePanels(),b.viewCubeUi&&b.viewCubeUi.cube&&b.viewCubeUi.cube.refreshCube(),b.updateToolbarButtons(a.width,a.height)}),this.addEventListener(av.NAVIGATION_MODE_CHANGED_EVENT,function(a){b.updateToolbarButtons(b.container.clientWidth,b.container.clientHeight)}),this.addEventListener(av.MODEL_UNLOADED_EVENT,function(a){b._onUnloadModel(a.model)}),this.initEscapeHandlers(),this.localize(),this.run(),0},a.prototype.uninitialize=function(){this.viewerSettingsPanel&&(this.viewerSettingsPanel.uninitialize(),this.viewerSettingsPanel=null),this.modelstructure&&(this.modelstructure.uninitialize(),this.modelstructure=null),this.layersPanel&&(this.layersPanel.uninitialize(),this.layersPanel=null),this.propertygrid&&(this.propertygrid.uninitialize(),this.propertygrid=null),this.renderoptions&&(this.renderoptions.uninitialize(),this.renderoptions=null),this.viewerOptionButton&&(this.viewerOptionButton=null),av.theHotkeyManager.popHotkeys("Autodesk.ROLL"),av.theHotkeyManager.popHotkeys("Autodesk.FOV"),this.removeEventListener(av.RENDER_OPTION_CHANGED_EVENT,this.onRenderOptionChanged),this.onRenderOptionChanged=null,this.removeEventListener(av.VIEWER_STATE_RESTORED_EVENT,this.onRestoreState),this.onRestoreState=null,this.progressbar=null,this.modelTools=null,this.navTools=null,this.settingsTools=null,this.debugMenu=null,this.modelStats=null,this.explodeSlider=null,this.explodeSubmenu=null,this.toolbar=null,av.Viewer3D.prototype.uninitialize.call(this)},a.prototype.setUp=function(a){a||(a={}),a.startOnInitialize=!1,this.getToolbar(!0),av.Viewer3D.prototype.setUp.call(this,a)},a.prototype.tearDown=function(){av.Viewer3D.prototype.tearDown.call(this),this.toolbar&&(this.toolbar.container.parentNode.removeChild(this.toolbar.container),this.toolbar=null),this.modelstructure&&this.setModelStructurePanel(null),this.propertygrid&&this.setPropertyPanel(null),this.viewerSettingsPanel&&this.setSettingsPanel(null),this.layersPanel&&this.setLayersPanel(null),this.renderoptions&&(this.removePanel(this.renderoptions),this.renderoptions.uninitialize(),this.renderoptions=null),this.removeEventListener(av.GEOMETRY_LOADED_EVENT,this.initViewCube)},a.prototype.loadModel=function(a,b,c,d,e){function f(a){if(!i.running)return void avp.logger.error("createUI expects the viewer to be running.",av.errorCodeString(av.ErrorCodes.VIEWER_INTERNAL_ERROR));i.createUI(a)}function g(a){setTimeout(function(){f(a),i._onLoadModel(a),c&&c.call(c,a)},1)}function h(a){avp.ErrorHandler.reportError(i.container,a),d&&d.apply(d,arguments)}var i=this;return av.Viewer3D.prototype.loadModel.call(this,a,b,g,h,e)},a.prototype.createUI=function(a){if(this.model===a){var b=this;this.initViewCube=function(){setTimeout(function(){b.displayViewCube(b.prefs.viewCube),b.removeEventListener(av.GEOMETRY_LOADED_EVENT,b.initViewCube)},1)};var c=this.config.disabledExtensions||{};this.initHotkeys(a),this.loadExtension("Autodesk.DefaultTools.NavTools",b.config),this.initModelTools(a),avp.ENABLE_DEBUG&&this.initDebugTools(),this.toolbar.container.style.display="block",this.dispatchEvent({type:av.TOOLBAR_CREATED_EVENT}),this.createViewCube(),this.dispatchEvent({type:av.VIEW_CUBE_CREATED_EVENT}),this.initModality(),this.resize(),a.is2d()?(this.unloadExtension("Autodesk.BimWalk"),this.unloadExtension("Autodesk.FirstPerson"),this.setDefaultNavigationTool("pan"),this.setClickToSetCOI(!1,!1),this.displayViewCube(!1,!1),setTimeout(function(){c.measure||b.loadExtension("Autodesk.Measure",b.config),c.hyperlink||b.loadExtension("Autodesk.Hyperlink",b.config)},1)):(-1===this.getDefaultNavigationToolName().indexOf("orbit")&&this.setDefaultNavigationTool("orbit"),setTimeout(function(){b.prefs.useFirstPersonPrototype?b.loadExtension("Autodesk.BimWalk",b.config):b.loadExtension("Autodesk.FirstPerson",b.config),b.prefs.fusionOrbit&&b.loadExtension("Autodesk.Viewing.FusionOrbit",b.config),c.measure||b.loadExtension("Autodesk.Measure",b.config),c.section||b.loadExtension("Autodesk.Section",b.config),c.hyperlink||b.loadExtension("Autodesk.Hyperlink",b.config),c.scalarisSimulation||b.model.loader instanceof av.ScalarisLoader&&b.loadExtension("Autodesk.Viewing.ScalarisSimulation",b.config),avp.isExperimentalFlagEnabled("billboards",b.config)&&(b.loadExtension("Autodesk.Comments",b.config),b.loadExtension("Autodesk.BillboardGui",b.config))},1),this.addEventListener(av.GEOMETRY_LOADED_EVENT,this.initViewCube))}},a.prototype._onLoadModel=function(a){this.modelstructure&&this.modelstructure.addModel(a)},a.prototype._onUnloadModel=function(a){this.modelstructure&&this.modelstructure.unloadModel(a)},a.prototype.addOptionToggle=function(a,b,c,d,e){var f=e?this.prefs[e]:null;c="boolean"==typeof f?f:c;var g=document.createElement("li");g.className="toolbar-submenu-listitem";var h=document.createElement("input");h.className="toolbar-submenu-checkbox",h.type="checkbox",h.id=b,g.appendChild(h);var i=document.createElement("label");return i.setAttribute("for",b),i.setAttribute("data-i18n",b),i.textContent=av.i18n.translate(b),g.appendChild(i),a.appendChild(g),h.checked=c,h.addEventListener("touchstart",av.touchStartToClick),i.addEventListener("touchstart",av.touchStartToClick),g.addEventListener("touchstart",av.touchStartToClick),h.addEventListener("click",function(a){d(h.checked),a.stopPropagation()}),i.addEventListener("click",function(a){a.stopPropagation()}),g.addEventListener("click",function(a){d(!h.checked),a.stopPropagation()}),e&&this.prefs.addListeners(e,function(a){h.checked=a},function(a){h.checked=a,d(a)}),h},a.prototype.addOptionList=function(a,b,c,d,e,f){var g=this.prefs[f];d="number"==typeof g?g:d;var h=function(a){var b=a.target.selectedIndex;e(b),a.stopPropagation()},i=document.createElement("select");i.className="option-drop-down",i.id="selectMenu_"+b;for(var j=0;j<c.length;j++){var k=document.createElement("option");k.value=j,k.setAttribute("data-i18n",c[j]),k.textContent=Autodesk.Viewing.i18n.translate(c[j]),i.add(k)}var l=document.createElement("li");l.className="toolbar-submenu-select";var m=document.createElement("div");return m.className="toolbar-submenu-selectlabel",m.setAttribute("for",b),m.setAttribute("data-i18n",b),m.textContent=av.i18n.translate(b),l.appendChild(m),l.appendChild(i),a.appendChild(l),i.selectedIndex=d,i.onchange=h,i.addEventListener("touchstart",function(a){a.stopPropagation()}),i.addEventListener("click",function(a){a.stopPropagation()}),f&&this.prefs.addListeners(f,function(a){i.selectedIndex=a},function(a){i.selectedIndex=a,e(a)}),i},a.prototype.showViewer3dOptions=function(a){var b=this.getSettingsPanel(!0);a&&b.isVisible()&&b.setVisible(!1),b.setVisible(a)},a.prototype.showRenderingOptions=function(a){this.renderoptions.setVisible(a)},a.prototype.showLayerManager=function(a){this.layersPanel.setVisible(a)},a.prototype.initHotkeys=function(a){var b,c,d=this,e=av.theHotkeyManager.KEYCODES;if(!a.is2d()){var f;b=function(){return!(d.toolController.getIsLocked()||!d.navigation.isActionEnabled("fov"))&&(f=d.getActiveNavigationTool(),d.setActiveNavigationTool("fov"),!0)},c=function(){return!(d.toolController.getIsLocked()||!d.navigation.isActionEnabled("fov"))&&(d.setActiveNavigationTool(f),!0)},av.theHotkeyManager.pushHotkeys("Autodesk.FOV",[{keycodes:[e.CONTROL,e.SHIFT],onPress:b,onRelease:c}],{tryUntilSuccess:!0})}var g;b=function(){return!(d.toolController.getIsLocked()||!d.navigation.isActionEnabled("roll"))&&(g=d.getActiveNavigationTool(),d.setActiveNavigationTool("worldup"),!0)},c=function(){return!(d.toolController.getIsLocked()||!d.navigation.isActionEnabled("roll"))&&(d.setActiveNavigationTool(g),!0)},av.theHotkeyManager.pushHotkeys("Autodesk.ROLL",[{keycodes:[e.ALT,e.SHIFT],onPress:b,onRelease:c}],{tryUntilSuccess:!0})},a.prototype.setModelStructurePanel=function(a){if(a===this.modelstructure)return!1;var b=!1;if(this.modelstructure&&(b=!0,this.modelstructure.setVisible(!1),this.removePanel(this.modelstructure),this.modelstructure.uninitialize()),this.modelstructure=a,!a)return!0;if(this.addPanel(this.modelstructure),b)for(var c=this.impl.modelQueue().getModels(),d=0;d<c.length;++d)this.modelstructure.addModel(c[d]);var e=this;return a.addVisibilityListener(function(b){b&&e.onPanelVisible(a,e),e.settingsTools.structurebutton.setState(b?avu.Button.State.ACTIVE:avu.Button.State.INACTIVE)}),!0},a.prototype.setLayersPanel=function(a){var b=this;return!(this.model&&!this.impl.getLayersRoot())&&((a instanceof av.UI.LayersPanel||!a)&&(this.layersPanel&&(this.layersPanel.setVisible(!1),this.removePanel(this.layersPanel),this.layersPanel.uninitialize()),this.layersPanel=a,a&&(this.addPanel(a),a.addVisibilityListener(function(c){c&&b.onPanelVisible(a,b),b.settingsTools.layerButton.setState(c?avu.Button.State.ACTIVE:avu.Button.State.INACTIVE)})),!0))},a.prototype.setPropertyPanel=function(a){var b=this;return(a instanceof av.UI.PropertyPanel||!a)&&(this.propertygrid&&(this.propertygrid.setVisible(!1),this.removePanel(this.propertygrid),this.propertygrid.uninitialize()),this.propertygrid=a,a&&(this.addPanel(a),a.addVisibilityListener(function(c){c&&b.onPanelVisible(a,b),b.settingsTools.propertiesbutton.setState(c?avu.Button.State.ACTIVE:avu.Button.State.INACTIVE)})),!0)},a.prototype.getPropertyPanel=function(a){return!this.propertygrid&&a&&this.setPropertyPanel(new ave.ViewerPropertyPanel(this)),this.propertygrid},a.prototype.setSettingsPanel=function(a){var b=this;return(a instanceof av.UI.SettingsPanel||!a)&&(this.viewerSettingsPanel&&(this.viewerSettingsPanel.setVisible(!1),this.removePanel(this.viewerSettingsPanel),this.viewerSettingsPanel.uninitialize()),this.viewerSettingsPanel=a,a&&(this.addPanel(a),a.addVisibilityListener(function(c){c&&b.onPanelVisible(a,b),b.viewerOptionButton.setState(c?avu.Button.State.ACTIVE:avu.Button.State.INACTIVE)})),!0)},a.prototype.getSettingsPanel=function(a){return!this.viewerSettingsPanel&&a&&this.setSettingsPanel(new ave.ViewerSettingsPanel(this,this.model)),this.viewerSettingsPanel},a.prototype.createSettingsPanel=function(a){var b=new ave.ViewerSettingsPanel(this,a);this.setSettingsPanel(b),b.syncUI();var c=new avu.Button("toolbar-settingsTool");this.viewerOptionButton=c,c.setIcon("adsk-icon-settings"),c.setToolTip("Settings"),this.settingsTools.addControl(c),this.createViewerOptionsMenu(a)},a.prototype.initModelTools=function(a){var b=this;if(!a.is2d()){if(!b.modelstructure){var c={docStructureConfig:b.config.docStructureConfig,hideSearch:av.isMobileDevice()},d=this.config.defaultModelStructureTitle?this.config.defaultModelStructureTitle:"Browser";b.setModelStructurePanel(new ave.ViewerModelStructurePanel(b,d,c))}var e=new avu.Button("toolbar-modelStructureTool");e.setToolTip("Model browser"),e.setIcon("adsk-icon-structure"),e.onClick=function(a){b.showModelStructurePanel(!b.modelstructure.isVisible())},this.settingsTools.addControl(e),this.settingsTools.structurebutton=e,this.initExplodeSlider()}var f=function(){if(b.impl.layers.getRoot().childCount>0){var a=new ave.ViewerLayersPanel(this);this.setLayersPanel(a);var c=new avu.Button("toolbar-layers-tool");c.setToolTip("Layer Manager"),c.setIcon("adsk-icon-layers"),c.onClick=function(a){b.layersPanel||b.setLayersPanel(new ave.ViewerLayersPanel(b)),b.showLayerManager(!b.layersPanel.isVisible())};var d=this.settingsTools.indexOf("toolbar-modelStructureTool");d=-1!==d?d:0,this.settingsTools.addControl(c,{index:d+1}),this.settingsTools.layerButton=c}b.removeEventListener(av.MODEL_LAYERS_LOADED_EVENT,f)}.bind(this);b.impl.layers.initialized?f():this.addEventListener(av.MODEL_LAYERS_LOADED_EVENT,f),b.addEventListener(av.RESET_EVENT,function(){b.model&&!b.model.is2d()&&(b.explode(0),b.explodeSlider.value=0),b.showAll()});var g=new avu.Button("toolbar-propertiesTool");if(g.setToolTip("Properties"),g.setIcon("adsk-icon-properties"),g.onClick=function(a){var c=b.getPropertyPanel(!0);c.setVisible(!c.isVisible())},g.setVisible(!b.prefs.openPropertiesOnSelect),this.settingsTools.addControl(g),this.settingsTools.propertiesbutton=g,this.createSettingsPanel(a),avp.ENABLE_DEBUG&&!a.is2d()){this.renderoptions=new avp.RenderOptionsPanel(this),this.addPanel(this.renderoptions);var h=new avu.Button("toolbar-renderOptionsTool");h.setToolTip("Rendering options"),h.setIcon("adsk-icon-settings-render"),h.onClick=function(a){b.showRenderingOptions(!b.renderoptions.isVisible())},this.settingsTools.addControl(h)}if(this.canChangeScreenMode()){var i=new avu.Button("toolbar-fullscreenTool",{collapsible:!1});i.setToolTip("Full screen"),i.setIcon("adsk-icon-fullscreen"),i.onClick=function(a){b.nextScreenMode()},this.settingsTools.addControl(i),this.settingsTools.fullscreenbutton=i,this.updateFullscreenButton(this.getScreenMode())}},a.prototype.setPropertiesOnSelect=function(a){this.prefs.set("openPropertiesOnSelect",a),this.settingsTools.propertiesbutton.setVisible(!a)},a.prototype.addDivider=function(a){var b=document.createElement("li");return b.className="toolbar-submenu-horizontal-divider",a.appendChild(b),b},a.prototype.createViewerOptionsMenu=function(a){function b(a){var b=c.getSettingsPanel(!0);b.isVisible()?c.showViewer3dOptions(!1):(c.showViewer3dOptions(!0),b.selectTab(a))}var c=this;this.viewerOptionButton.onClick=function(){b(ave.ViewerSettingTab.Performance)}},a.prototype.initDebugTools=function(){var a=new avu.ControlGroup("debugTools");this.debugMenu=a;var b=new avu.Button("toolbar-debugTool");b.setIcon("adsk-icon-bug"),a.addControl(b),this.debugMenu.debugSubMenuButton=b,this.createDebugSubmenu(this.debugMenu.debugSubMenuButton),this.toolbar.addControl(a)},a.prototype.createDebugSubmenu=function(a){function b(){c.localize()}var c=this,d=document.createElement("div");d.id="toolbar-debugToolSubmenu",d.classList.add("toolbar-submenu"),d.classList.add("toolbar-settings-sub-menu"),d.classList.add("adsk-hidden"),this.debugMenu.subMenu=d,this.debugMenu.subMenu.style.minWidth="180px",this.container.appendChild(d),this.initModelStats(),this.addDivider(d),this.addDivider(d);var e=avp.Lang.getLanguages(),f=e.map(function(a){return a.label}),g=e.map(function(a){return a.symbol}),h=c.selectedLanguage?c.selectedLanguage:0;this.addOptionList(d,"Language",f,h,function(a){var d=g[a];c.selectedLanguage=a,avp.setLanguage(d,b)},null).parentNode.style.paddingBottom="15px",this.addDivider(this.debugMenu.subMenu);var i=["UNKNOWN FAILURE","BAD DATA","NETWORK ERROR","NETWORK ACCESS DENIED","NETWORK FILE NOT FOUND","NETWORK SERVER ERROR","NETWORK UNHANDLED RESPONSE CODE","BROWSER WEBGL NOT SUPPORTED","BAD DATA NO VIEWABLE CONTENT"];this.addOptionList(d,"Error",i,0,function(a){var b=a+1;avp.ErrorHandler.reportError(c.container,b,"")},null).parentNode.style.paddingBottom="15px";var j=d.getBoundingClientRect();this.debugMenu.subMenu.style.width=j.width+"px",this.container.removeChild(d),a.container.appendChild(d);var k=j.left+j.width,l=this.container.getBoundingClientRect().right;if(k>l){var m=-(k-l+10)+"px";this.debugMenu.subMenu.style.left=m}a.onMouseOver=function(a){d.classList.remove("adsk-hidden")},a.onMouseOut=function(a){d.classList.add("adsk-hidden")},av.isTouchDevice()&&(a.onClick=function(a){d.classList.toggle("adsk-hidden")})},a.prototype.initModelStats=function(){function a(a){var b=c.impl,d="";c.model&&(d+="Geom&nbsp;polys:&nbsp;"+b.modelQueue().getGeometryList().geomPolyCount+"<br>",d+="Instance&nbsp;polys:&nbsp;"+b.modelQueue().getGeometryList().instancePolyCount+"<br>",d+="Fragments:&nbsp;"+b.modelQueue().getFragmentList().getCount()+"<br>",d+="Geoms:&nbsp;"+b.modelQueue().getGeometryList().geoms.length+"<br>",d+="Loading&nbsp;time:&nbsp;"+(b.model.loader.loadTime/1e3).toFixed(2)+" s<br>"),d+="# "+(a||""),c.modelStats.innerHTML=d}function b(){c.modelStats=document.createElement("div"),c.modelStats.className="statspanel",c.container.appendChild(c.modelStats),c.addEventListener(av.PROGRESS_UPDATE_EVENT,function(b){b.message&&a(b.message)}),c.fpsDisplay=document.createElement("div"),c.fpsDisplay.className="fps",c.container.appendChild(c.fpsDisplay)}var c=this;this.addOptionToggle(this.debugMenu.subMenu,"Model statistics",!1,function(d){d&&!c.modelStats&&(b(),a("")),c.modelStats.style.visibility=d?"visible":"hidden",c.fpsDisplay.style.visibility=d?"visible":"hidden",c.impl.fpsCallback=d?function(a){c.fpsDisplay.textContent=""+(0|a)}:null})},a.prototype.initEscapeHandlers=function(){var a=this;this.addEventListener(av.ESCAPE_EVENT,function(b){if(!a.contextMenu||!a.contextMenu.hide()){if(a.renderoptions&&a.renderoptions.isVisible())return void a.renderoptions.setVisible(!1);if(a.getActiveNavigationTool()!==a.getDefaultNavigationToolName())return a.toolController&&a.toolController.setIsLocked(!1),a.setActiveNavigationTool(),void avp.HudMessage.dismiss();if(a.selectionActive)return void a.clearSelection();if(!a.areAllVisible())return void a.showAll();if(!avp.AlertBox.dismiss()){for(var c=0;c<a.dockingPanels.length;++c){var d=a.dockingPanels[c];if("none"!==d.container.style.display&&""!==d.container.style.display)return void(d.container===a.modelstructure?a.showModelStructurePanel(!1):d.setVisible(!1))}a.escapeScreenMode()}}})},a.prototype.showViewCubeUI=function(a){this.viewCubeUi.setVisible(a)},a.prototype.showViewCubeTriad=function(a){this.viewCubeUi.showTriad(a)},a.prototype.displayViewCube=function(a,b){this.viewCubeUi.displayViewCube(a,b)},a.prototype.displayHomeandInfoButton=function(a){avp.logger.info("viewer.displayHomeandInfoButton() is deprecated. Use viewer.displayHomeButton() instead."),this.displayHomeButton(a)},a.prototype.displayHomeButton=function(a){var b=this.container.querySelector(".homeViewWrapper");b&&(b.style.display=a?"":"none")},a.prototype.getToolbar=function(a){if(!this.toolbar&&a){var b=av.UI;this.toolbar=new b.ToolBar("guiviewer3d-toolbar"),this.navTools=new b.RadioButtonGroup(av.TOOLBAR.NAVTOOLSID),this.modelTools=new b.ControlGroup(av.TOOLBAR.MODELTOOLSID),this.settingsTools=new b.ControlGroup(av.TOOLBAR.SETTINGSTOOLSID),this.toolbar.addControl(this.navTools),this.toolbar.addControl(this.modelTools),this.toolbar.addControl(this.settingsTools),this.container.appendChild(this.toolbar.container),this.toolbar.container.style.display="none"}return this.toolbar},a.prototype.showModelStructurePanel=function(a){this.modelstructure.setVisible(a)},a.prototype.onPanelVisible=function(a){this.dockingPanels.splice(this.dockingPanels.indexOf(a),1),this.dockingPanels.splice(0,0,a)},a.prototype.updateFullscreenButton=function(a){var b="adsk-icon-fullscreen";switch(a){case av.ScreenMode.kNormal:
this.isScreenModeSupported(av.ScreenMode.kFullBrowser)||(b="adsk-icon-fullscreen");break;case av.ScreenMode.kFullBrowser:b=this.isScreenModeSupported(av.ScreenMode.kFullScreen)?"adsk-icon-fullscreen":"adsk-icon-fullscreen-exit";break;case av.ScreenMode.kFullScreen:b="adsk-icon-fullscreen-exit"}this.settingsTools.fullscreenbutton.setIcon(b)},a.prototype.localize=function(){av.i18n.localize(),this.debugMenu&&this.debugMenu.debugSubMenuButton&&(this.debugMenu.debugSubMenuButton.container.removeChild(this.debugMenu.subMenu),this.createDebugSubmenu(this.debugMenu.debugSubMenuButton)),avp.ErrorHandler.localize()},a.prototype.addPanel=function(a){return-1===this.dockingPanels.indexOf(a)&&(this.dockingPanels.push(a),!0)},a.prototype.removePanel=function(a){var b=this.dockingPanels.indexOf(a);return b>-1&&(this.dockingPanels.splice(b,1),!0)},a.prototype.resizePanels=function(a){a=a||{};var b=this.toolbar.getDimensions().height,c=this.getDimensions(),d=c.height;a.dimensions&&a.dimensions.height?d=a.dimensions.height:a.dimensions={height:c.height,width:c.width},a.dimensions.height=d-b;var e=a?a.viewer:null;e||(e=this);var f=a?a.dockingPanels:null;f||(f=e.dockingPanels);var g,h,i=e.container.getBoundingClientRect(),j=i.top,k=i.bottom,l=i.left,m=i.right;a&&a.dimensions?(g=a.dimensions.width,h=a.dimensions.height,k=a.dimensions.height):(g=i.width,h=i.height);for(var n=0;n<f.length;++n){var o=f[n].container,p=o.getBoundingClientRect(),q=p.top,r=p.bottom,s=p.left,t=p.right,u=p.width,v=p.height;u&&v&&(g<u&&(u=Math.round(g),o.style.width=u+"px"),h<v&&(v=Math.round(h),o.style.height=v+"px"),(m<t||o.dockRight)&&(s=Math.round(m-u-l),o.style.left=s+"px"),(k<r||o.dockBottom)&&(q=Math.round(k-v-j),q<0&&(q=0),o.style.top=q+"px"),o.style.maxWidth=Math.round(g)+"px",o.style.maxHeight=Math.round(h)+"px")}},a.prototype.initExplodeSlider=function(){var a=this,b=new avu.Button("toolbar-explodeTool");b.setIcon("adsk-icon-explode"),b.setToolTip("Explode model"),a.modelTools.addControl(b,{index:0});this.explodeSubmenu=avp.stringToDOM('<div class="docking-panel docking-panel-container-solid-color-b explode-submenu" style="display:none"><input class="explode-slider" type="range" min="0" max="1" step="0.01" value="0"/></div>');var c;Autodesk.Viewing.isIOSDevice()?(c=document.querySelector("#toolbar-explodeTool").parentNode,this.explodeSubmenu.classList.add("ios")):c=b.container,c.appendChild(this.explodeSubmenu);var d=this.explodeSubmenu.querySelector(".explode-slider");a.explodeSlider=d,d.oninput=function(b){a.explode(d.value)},d.onchange=function(b){a.explode(d.value)},this.explodeSubmenu.onclick=function(a){a.stopPropagation()};var e=b.container.querySelector(".adsk-control-tooltip");b.onClick=function(c){var f=b.getState();f===avu.Button.State.INACTIVE?(b.setState(avu.Button.State.ACTIVE),e.style.display="none",a.explodeSubmenu.style.display="",avp.logger.track({category:"tool_changed",name:"explode"})):f===avu.Button.State.ACTIVE&&(b.setState(avu.Button.State.INACTIVE),e.style.display="",d.parentNode.style.display="none",a.explode(0),a.explodeSlider.value=0)}},a.prototype.initInspectTools=function(){var a=new avu.Button("toolbar-inspectTools");a.setToolTip("Inspect"),a.setIcon("measure"),a.setVisible(!1),this.modelTools.addControl(a);var b=new avu.RadioButtonGroup("toolbar-inspectSubMenu");b.addClass("toolbar-vertical-group"),b.setVisible(!1),this.modelTools.addControl(b),a.container.insertBefore(b.container,a.container.firstChild),a.onMouseOver=function(){b.setVisible(!0)},a.onMouseOut=function(){b.setVisible(!1)},av.isTouchDevice()&&(a.onClick=function(a){b.setVisible(!b.isVisible())})},a.prototype.initModality=function(){function a(b){for(var c=0;c<2&&b.parentElement;){var d=b.id;if(0===d.indexOf("toolbar-")){if(d.indexOf("arrow")===d.length-5)return;return a(b.parentElement)||b}b=b.parentElement,c++}}function b(a){return a.id.substring(8,a.id.length)}function c(a){return a.classList.contains("active")}function d(a){var b=document.createEvent("Event");b.initEvent("click",!0,!0),a.dispatchEvent(b)}function e(a,b,c){h[a]=c?b:void 0}function f(f){var i=(f.target.getAttribute("class")||"").split(/\s+/);if(-1===i.indexOf("clickoff")){var j=a(f.target);if(j){var k=b(j);if(g[k]&&("sectionTool"!==k||-1===i.indexOf("adsk-icon-section-analysis")&&!f.target.querySelector(".adsk-icon-section-analysis"))&&("measureTool"!==k||-1===i.indexOf("adsk-icon-measure-menu")&&!f.target.querySelector(".adsk-icon-measure-menu"))){h[k]&&e(k,j,!1);for(var l in h){var m=h[l];if(m){var n=b(m);c(m)?g[k][n]||d(m):e(n,m,!1)}}e(k,j,!0)}}}}var g={orbitTools:{explodeTool:1},panTool:{explodeTool:1},zoomTool:{explodeTool:1},beelineTool:{},sectionTool:{measureTool:0,calibrateTool:0},explodeTool:{measureTool:0,calibrateTool:0,firstPersonTool:1,bimWalkTool:1},measureTool:{section:0},billboardTool:{},firstPersonTool:{explodeTool:1},bimWalkTool:{explodeTool:1}},h={};this.toolbar.container.addEventListener("click",f,!0)},a.prototype.updateToolbarButtons=function(a,b){if(this.getToolbar(!1)){var c,d;d=a>310?"block":"none",c=this.modelTools.getControl("toolbar-explodeTool"),c&&c.setDisplay(d),d=a>380?"block":"none",c=this.modelTools.getControl("toolbar-collaborateTool"),c&&c.setDisplay(d),d=a>515?"block":"none";var e=this.navTools.getControl("toolbar-cameraSubmenuTool");e&&(e.setDisplay(d),c=e.subMenu.getControl("toolbar-homeTool"),c&&c.setDisplay(this.navigation.isActionEnabled("gotoview")?"block":"none"),c=e.subMenu.getControl("toolbar-fitToViewTool"),c&&c.setDisplay(this.navigation.isActionEnabled("gotoview")?"block":"none"),c=e.subMenu.getControl("toolbar-focalLengthTool"),c&&c.setDisplay(this.navigation.isActionEnabled("fov")?"block":"none"),(c=e.subMenu.getControl("toolbar-rollTool"))&&c.setDisplay(this.navigation.isActionEnabled("roll")?"block":"none")),d=a>700?"block":"none",c=this.modelTools.getControl("toolbar-measureTool"),c&&c.setDisplay(d),c=this.modelTools.getControl("toolbar-sectionTool"),c&&c.setDisplay(d),d=a>740?"block":"none",c=this.navTools.getControl("toolbar-beelineTool"),c&&c.setDisplay(this.navigation.isActionEnabled("walk")?d:"none"),c=this.navTools.getControl("toolbar-firstPersonTool"),c&&c.setDisplay(this.navigation.isActionEnabled("walk")?d:"none"),c=this.navTools.getControl("toolbar-zoomTool"),c&&c.setDisplay(this.navigation.isActionEnabled("zoom")?d:"none"),c=this.navTools.getControl("toolbar-panTool"),c&&c.setDisplay(this.navigation.isActionEnabled("pan")?d:"none"),(c=this.navTools.getControl("toolbar-orbitTools"))&&c.setDisplay(this.navigation.isActionEnabled("orbit")?d:"none")}},avp.GuiViewer3D=a}(),function(){"use strict";function a(a,b){this._id=a,this._isCollapsible=!b||b.collapsible,this._toolTipElement=null,this._listeners={},this.container=document.createElement("div"),this.container.id=a,this.addClass("adsk-control")}var b=Autodesk.Viewing;Autodesk.Viewing.UI;a.Event={VISIBILITY_CHANGED:"Control.VisibilityChanged",COLLAPSED_CHANGED:"Control.CollapsedChanged"},b.EventDispatcher.prototype.apply(a.prototype),a.prototype.constructor=a,a.prototype.container=null,a.prototype.getId=function(){return this._id},a.prototype.setVisible=function(b){if(!this.container.classList.contains("adsk-hidden")===b)return!1;b?this.container.classList.remove("adsk-hidden"):this.container.classList.add("adsk-hidden");var c={type:a.Event.VISIBILITY_CHANGED,target:this,controlId:this._id,isVisible:b};return this.dispatchEvent(c),!0},a.prototype.isVisible=function(){return!this.container.classList.contains("adsk-hidden")},a.prototype.setToolTip=function(a){return(!this._toolTipElement||this._toolTipElement.getAttribute("tooltipText")!==a)&&(this._toolTipElement||(this._toolTipElement=document.createElement("div"),this._toolTipElement.id=this._id+"-tooltip",this._toolTipElement.classList.add("adsk-control-tooltip"),this.container.appendChild(this._toolTipElement)),this._toolTipElement.setAttribute("data-i18n",a),this._toolTipElement.setAttribute("tooltipText",a),this._toolTipElement.textContent=Autodesk.Viewing.i18n.translate(a,{defaultValue:a}),!0)},a.prototype.getToolTip=function(){return this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")},a.prototype.setCollapsed=function(b){if(!this._isCollapsible||this.isCollapsed()===b)return!1;b?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed");var c={type:a.Event.COLLAPSED_CHANGED,isCollapsed:b};return this.dispatchEvent(c),!0},a.prototype.isCollapsed=function(){return!!this.container.classList.contains("collapsed")},a.prototype.isCollapsible=function(){return this._isCollapsible},a.prototype.addClass=function(a){this.container.classList.add(a)},a.prototype.removeClass=function(a){this.container.classList.remove(a)},a.prototype.getPosition=function(){var a=this.container.getBoundingClientRect();return{top:a.top,left:a.left}},a.prototype.getDimensions=function(){var a=this.container.getBoundingClientRect();return{width:a.width,height:a.height}},a.prototype.setDisplay=function(a){this.container.style.display=a},Autodesk.Viewing.UI.Control=a}(),function(){"use strict";function a(c,d){b.Control.call(this,c,d);var e=this;this._controls=[],this.addClass("adsk-control-group"),this.handleChildSizeChanged=function(b){var c={type:a.Event.SIZE_CHANGED,childEvent:b};e.dispatchEvent(c)}}var b=Autodesk.Viewing.UI;a.Event={VISIBILITY_CHANGED:b.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:b.Control.Event.COLLAPSED_CHANGED,SIZE_CHANGED:"ControlGroup.SizeChanged",CONTROL_ADDED:"ControlGroup.ControlAdded",CONTROL_REMOVED:"ControlGroup.ControlRemoved"},a.prototype=Object.create(b.Control.prototype),a.prototype.constructor=a,a.prototype.addControl=function(c,d){var e=d&&void 0!==d.index?d.index:this._controls.length;if(null!==this.getControl(c.getId()))return!1;var f={type:a.Event.CONTROL_ADDED,control:c,index:e};return e<this._controls.length?(this.container.insertBefore(c.container,this._controls[e].container),this._controls.splice(e,0,c)):(this.container.appendChild(c.container),this._controls.push(c)),c.addEventListener(b.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),c.addEventListener(b.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),c instanceof a&&c.addEventListener(a.Event.SIZE_CHANGED,this.handleChildSizeChanged),this.dispatchEvent(f),this.dispatchEvent(a.Event.SIZE_CHANGED),!0},a.prototype.indexOf=function(a){for(var b=0;b<this._controls.length;b++){var c=this._controls[b];if(c===a||"string"==typeof a&&a===c.getId())return b}return-1},a.prototype.removeControl=function(c){var d="string"==typeof c?this.getControl(c):c;if(!d)return!1;var e=this._controls.indexOf(d);if(-1===e)return!1;this._controls.splice(e,1),this.container.removeChild(d.container);var f={type:a.Event.CONTROL_REMOVED,control:d,index:e};return d.removeEventListener(b.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),d.removeEventListener(b.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),d instanceof a&&d.removeEventListener(a.Event.SIZE_CHANGED,this.handleChildSizeChanged),this.dispatchEvent(f),this.dispatchEvent(a.Event.SIZE_CHANGED),!0},a.prototype.getControl=function(a){for(var b=0;b<this._controls.length;b++)if(a===this._controls[b].getId())return this._controls[b];return null},a.prototype.getControlId=function(a){return a<0||a>=this._controls.length?null:this._controls[a].getId()},a.prototype.getNumberOfControls=function(){return this._controls.length},a.prototype.setCollapsed=function(b){if(!this._isCollapsible)return!1;var c=!1;return this._controls.forEach(function(a){a.isCollapsible()&&a.setCollapsed(b)&&(c=!0)}),c&&(b?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this.dispatchEvent({type:a.Event.COLLAPSED_CHANGED,isCollapsed:b})),c},Autodesk.Viewing.UI.ControlGroup=a}(),function(){"use strict";function a(a,c){b.ControlGroup.call(this,a,c),this.removeClass("adsk-control-group"),this.addClass("adsk-toolbar")}var b=Autodesk.Viewing.UI;a.Event={VISIBILITY_CHANGED:b.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:b.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:b.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:b.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:b.ControlGroup.Event.SIZE_CHANGED},a.prototype=Object.create(b.ControlGroup.prototype),a.prototype.constructor=a,Autodesk.Viewing.UI.ToolBar=a}(),function(){"use strict";function a(d,e){c.Control.call(this,d,e);var f=this;this._state=a.State.INACTIVE,this.icon=document.createElement("div"),this.icon.classList.add("adsk-button-icon"),this.container.appendChild(this.icon),this.container.addEventListener("click",function(b){f.getState()!==a.State.DISABLED&&(f.dispatchEvent(a.Event.CLICK),f.onClick&&f.onClick(b)),b.stopPropagation()}),b.isTouchDevice()?this.container.addEventListener("touchstart",b.touchStartToClick):(this.container.addEventListener("mouseover",function(a){f.onMouseOver(a)}),this.container.addEventListener("mouseout",function(a){f.onMouseOut(a)})),this.addClass("adsk-button"),this.addClass(a.StateToClassMap[this._state])}var b=Autodesk.Viewing,c=Autodesk.Viewing.UI;a.Event={VISIBILITY_CHANGED:c.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:c.Control.Event.COLLAPSED_CHANGED,STATE_CHANGED:"Button.StateChanged",CLICK:"click"},a.State={ACTIVE:0,INACTIVE:1,DISABLED:2},a.StateToClassMap=function(){var b=a.State,c={};return c[b.ACTIVE]="active",c[b.INACTIVE]="inactive",c[b.DISABLED]="disabled",c}(),a.prototype=Object.create(c.Control.prototype),a.prototype.constructor=a,a.prototype.setState=function(b){if(b===this._state)return!1;this.removeClass(a.StateToClassMap[this._state]),this.addClass(a.StateToClassMap[b]),this._state=b;var c={type:a.Event.STATE_CHANGED,state:b};return this.dispatchEvent(c),!0},a.prototype.setIcon=function(a){this.iconClass&&this.icon.classList.remove(this.iconClass),this.iconClass=a,this.icon.classList.add(a)},a.prototype.getState=function(){return this._state},a.prototype.onClick=function(a){},a.prototype.onMouseOver=function(a){},a.prototype.onMouseOut=function(a){},Autodesk.Viewing.UI.Button=a}(),function(){"use strict";function a(a,d){b.Button.call(this,a,d),this.arrowButton=new b.Button(a+"arrow"),this.arrowButton.addClass("adsk-button-arrow"),this.arrowButton.removeClass("adsk-button"),this.subMenu=new b.RadioButtonGroup(a+"SubMenu"),this.subMenu.addClass("toolbar-vertical-group"),this.subMenu.setVisible(!1),this.container.insertBefore(this.subMenu.container,this.container.firstChild),this.container.insertBefore(this.arrowButton.container,this.container.firstChild);var e=this;this.arrowButton.onClick=function(a){e.subMenu.setVisible(!e.subMenu.isVisible())},this.toggleFlyoutVisible=function(){e.subMenu.setVisible(!e.subMenu.isVisible())},this.onClick=function(a){e.subMenu.setVisible(!e.subMenu.isVisible())},this.subMenuActiveButtonChangedHandler=function(a){a.isActiveButton?(e.setIcon(a.target.getActiveButton().iconClass),e.setToolTip(a.target.getActiveButton().getToolTip()),e.setState(b.Button.State.ACTIVE),e.onClick=a.button.onClick):e.setState(b.Button.State.INACTIVE)},this.subMenu.addEventListener(b.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,this.subMenuActiveButtonChangedHandler);var f=c.stringToDOM('<div class="clickoff" style="position:fixed; top:0; left:0; width:100vw; height:100vh;"></div>');this.subMenu.container.insertBefore(f,this.subMenu.container.firstChild),f.addEventListener("click",function(a){e.subMenu.setVisible(!1),a.stopPropagation()})}var b=Autodesk.Viewing.UI,c=Autodesk.Viewing.Private;a.prototype=Object.create(b.Button.prototype),a.prototype.constructor=a,a.prototype.addControl=function(a){this.subMenu.addControl(a),a.addEventListener(b.Button.Event.CLICK,this.toggleFlyoutVisible)},a.prototype.removeControl=function(a){a.removeEventListener(b.Button.Event.CLICK,this.toggleFlyoutVisible)},a.prototype.setState=function(a){if(a===b.Button.State.INACTIVE){var c=this.subMenu.getActiveButton();c&&c.setState(b.Button.State.INACTIVE)}b.Button.prototype.setState.call(this,a)},a.prototype.saveAsDefault=function(){this.defaultState={},this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")&&(this.defaultState.tooltip=this._toolTipElement.getAttribute("tooltipText")),this.defaultState.icon=this.iconClass,this.defaultState.onClick=this.onClick},a.prototype.restoreDefault=function(){this.defaultState&&(this.defaultState.tooltip&&this.setToolTip(this.defaultState.tooltip),this.defaultState.icon&&this.setIcon(this.defaultState.icon),this.onClick=this.defaultState.onClick,this.setState(b.Button.State.INACTIVE))},Autodesk.Viewing.UI.ComboButton=a}(),function(){"use strict";function a(c,d){b.ControlGroup.call(this,c,d);var e=this;this._activeButton=null,this._handleButtonStateChange=function(c){var d=b.Button.State;if(c.state!==d.ACTIVE)return void(c.target===e._activeButton&&(e._activeButton=null,e.dispatchEvent({type:a.Event.ACTIVE_BUTTON_CHANGED,button:c.target,isActiveButton:!1})));e._activeButton=c.target,e.dispatchEvent({type:a.Event.ACTIVE_BUTTON_CHANGED,button:c.target,isActiveButton:!0}),e._controls.forEach(function(a){a!==c.target&&a.getState()!==d.DISABLED&&a.setState(d.INACTIVE)})}}var b=Autodesk.Viewing.UI;a.Event={ACTIVE_BUTTON_CHANGED:"RadioButtonGroup.ActiveButtonChanged",VISIBILITY_CHANGED:b.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:b.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:b.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:b.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:b.ControlGroup.Event.SIZE_CHANGED},a.prototype=Object.create(b.ControlGroup.prototype),a.prototype.constructor=a,a.prototype.addControl=function(a,c){return a instanceof b.Button&&(!!b.ControlGroup.prototype.addControl.call(this,a,c)&&(a.addEventListener(b.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0))},a.prototype.removeControl=function(a){var c="string"==typeof a?this.getControl(a):a;return!(null===c||!b.ControlGroup.prototype.removeControl.call(this,c))&&(c.removeEventListener(b.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0)},a.prototype.getActiveButton=function(){return this._activeButton},Autodesk.Viewing.UI.RadioButtonGroup=a}(),function(){"use strict";function a(a,d,e){function f(){var a=g.value.trim();if(0===a.length)return void i();n&&(avp.logger.track({category:"search_node",name:"model_browser_tool"}),n=!1),g.classList.add("searching");var b=m._searchFunction(a);m.searchResults.setResults(a,b),m.searchResults.setVisible(!0)}this._id=a,this._listeners={},this._options=e||{},this._searchFunction=this._options.searchFunction||function(){},this.container=document.createElement("div"),this.container.id=a,this.addClass("adsk-control"),this.addClass("adsk-searchbox"),this.addClass("empty");var g=document.createElement("input");g.classList.add("search-box"),g.classList.add("docking-panel-delimiter-shadow"),g.type="search",g.results=[],g.placeholder=b.i18n.translate("Search"),g.setAttribute("data-i18n","Search"),g.incremental="incremental",g.autosave=this.container.id+"search_autosave",this.container.insertBefore(g,this.scrollContainer),this.searchbox=g;var h=function(){m.searchbox.value="",m.addClass("empty")},i=function(){m.searchbox.classList.remove("searching"),m.searchResults.setVisible(!1)},j=document.createElement("div");j.className="search-box-icon",this.container.insertBefore(j,g.nextSibling);var k=document.createElement("div");k.className="search-box-close",k.addEventListener("click",function(){h(),i()}),this.container.appendChild(k),this.searchResults=new c.SearchResults(this.container,e.excludeRoot,d),this.searchResults.addEventListener(c.Searchbox.Events.ON_SEARCH_SELECTED,function(a){h(),i(),m.fireEvent(a)});var l,m=this,n=!0;g.addEventListener("keydown",function(a){if(a=a||window.event,38===a.keyCode&&(m.searchResults.selectPrevious(),a.preventDefault()),40===a.keyCode&&(m.searchResults.selectNext(),a.preventDefault()),13===a.keyCode){var b=m.searchResults.getSelection();if(!b)return!1;h(),i(),m.fireEvent({type:c.Searchbox.Events.ON_SEARCH_SELECTED,id:b.nodeId,modelId:b.modelId}),a.preventDefault()}}),g.addEventListener("input",function(a){if(0===this.value.length)return m.container.classList.add("empty"),void i();m.container.classList.remove("empty"),this.value.length<3||(clearTimeout(l),l=setTimeout(f,800))}),g.addEventListener("change",function(a){a.target===document.activeElement&&(clearTimeout(l),f())}),g.addEventListener("focus",function(){j.classList.add("focused")}),g.addEventListener("blur",function(){j.classList.remove("focused")})}var b=Autodesk.Viewing,c=Autodesk.Viewing.UI;a.prototype=Object.create(c.Control.prototype),a.prototype.constructor=a,a.Events={ON_SEARCH_SELECTED:"search-selected"},Autodesk.Viewing.UI.Searchbox=a}(),function(){"use strict";function a(a,c){this._id=a,this._listeners={},this._options=c||{},this._filterFunction=this._options.filterFunction||function(){},this.container=document.createElement("div"),this.container.id=a,this.addClass("adsk-control"),this.addClass("adsk-filterbox"),this.addClass("empty");var d=document.createElement("input");d.classList.add("filter-box"),d.classList.add("docking-panel-delimiter-shadow"),d.type="search",d.placeholder=b.i18n.translate("Enter filter term"),d.setAttribute("data-i18n","Enter filter term"),d.incremental="incremental",d.autosave=this.container.id+"filter",this.container.appendChild(d),this.filterbox=d;var e=this,f=function(){e.filterbox.value="",e.addClass("empty")},g=function(a){a=a.trim(),0===a.length?e.container.classList.add("empty"):e.container.classList.remove("empty"),e._filterFunction&&e._filterFunction(a)},h=document.createElement("div");h.className="filter-box-icon",this.container.insertBefore(h,d.nextSibling);var i=document.createElement("div");i.className="filter-box-close",i.addEventListener("click",function(){f()}),this.container.appendChild(i),d.addEventListener("keydown",function(a){a=a||window.event,13===a.keyCode&&e.filterbox.blur()}),d.addEventListener("input",function(a){g(this.value)}),d.addEventListener("change",function(a){g(this.value)}),d.addEventListener("focus",function(){h.classList.add("focused")}),d.addEventListener("blur",function(){h.classList.remove("focused")})}var b=Autodesk.Viewing,c=Autodesk.Viewing.UI;a.prototype=Object.create(c.Control.prototype),a.prototype.constructor=a,Autodesk.Viewing.UI.Filterbox=a}(),function(){"use strict";function a(a){var b=a.target,c=this._getNodeAndModelIds(b);c&&(this.fireEvent({type:p.Searchbox.Events.ON_SEARCH_SELECTED,id:c.nodeId,modelId:c.modelId}),a.preventDefault())}function b(a){var b=this.container.results.scrollTop;Math.abs(this.scrollY-b)>=s&&(this.scrollY=b,c(this))}function c(a,b){a.dirty&&!b||(b?d(a):(a.dirty=!0,a.nextFrameId=requestAnimationFrame(function(){d(a)})))}function d(a){if(a.dirty=!1,e(a),0===a.resultCount)return void a.setDisplayNoResults(!0);a.setDisplayNoResults(!1),f(a)}function e(a){for(var b=a.elementsUsed,c=a.elementsPool,d=0;d<b;++d){l(c[d])}a.elementsUsed=0}function f(a){var b=a.container.results,c=0,d=b.clientHeight,e=a.scrollY,f=a.it.init(a.results),g=Math.max(0,a.scrollY-s),h=0|Math.floor(g/r),j=0;for(c=h*r;h;)h--,j++,f.next();var k=a.elementsPool[a.elementsUsed++];k.style.height=c+"px",a.scrollingContainer.appendChild(k);for(var l=!0;l;){if(f.next(),f.done()){l=!1;break}if(c>e+d+s){l=!1;break}if(a.elementsUsed===a.elementsPool.length){l=!1;break}var m=f.id(),n=f.delegate(),o=r,p=c,q=p+o,t=a.elementsPool[a.elementsUsed++];i(m,n,t,a,j===a.selectedIndex),a.scrollingContainer.appendChild(t),c=q,j++}var u=a.resultCount*r;a.scrollingContainer.style.height=u+"px"}function g(a){for(var b=0,c=0;c<a.length;++c){b+=a[c].ids.length}return b}function h(){return{init:function(a){return this.isDone=!1,this.results=a,this.indexRs=0,this.indexId=-1,this},done:function(){return this.isDone},next:function(){if(this.isDone)return this;for(this.indexId++;this.results.length!==this.indexRs&&this.indexId===this.results[this.indexRs].ids.length;)this.indexId=0,this.indexRs++;return this.isDone=this.indexRs===this.results.length,this},id:function(){return this.results[this.indexRs].ids[this.indexId]},delegate:function(){return this.results[this.indexRs].delegate}}}function i(a,b,c,d,e){c.classList.add("search-result"),e?c.classList.add("selected"):c.classList.remove("selected"),c.setAttribute("lmv-nodeId",a),c.setAttribute("lmv-modelId",b.model.id),c.style.height=r+"px";var f=b.instanceTree.getNodeName(a),g=d.searchString,h=f.toLowerCase().indexOf(g.toLowerCase()),i=f.substr(0,h),k=f.substr(h,g.length),l=f.substr(h+g.length);c.domPrefix.innerText=i,c.domMatch.innerText=k,c.domSufix.innerText=l;var m=j(a,b,d);c.domPath.innerText=m.join(" > ")}function j(a,b,c){for(var d=[],e=b.getRootId(),f=c.isRootExcluded(),g=b.instanceTree,h=a,i=!1;h&&!i&&(h!==e||(i=!0,!f));){var j=g.getNodeName(h);d.unshift(j),h=g.getNodeParentId(h)}return d}function k(){var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("span"),d=document.createElement("span"),e=document.createElement("span"),f=document.createElement("span");return b.classList.add("search-result-container"),d.classList.add("search-match"),f.classList.add("search-path"),b.appendChild(c),b.appendChild(d),b.appendChild(e),b.appendChild(f),a.appendChild(b),a.domPrefix=c,a.domMatch=d,a.domSufix=e,a.domPath=f,a.domContainer=b,a}function l(a){a.setAttribute("lmv-nodeId",""),a.setAttribute("lmv-modelId",""),a.domPrefix.innerText="",a.domMatch.innerText="",a.domSufix.innerText="",a.domPath.innerText="",a.style.height="0"}function m(){var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("div");a.classList.add("no-results-container"),a.style.display="none";b.setAttribute("data-i18n","No Results"),b.textContent=Autodesk.Viewing.i18n.translate("No Results"),b.classList.add("no-results-title");return c.setAttribute("data-i18n","Try another term"),c.textContent=Autodesk.Viewing.i18n.translate("Try another term"),c.classList.add("no-results-description"),a.appendChild(b),a.appendChild(c),a.domTitle=b,a.domMessage=c,a}function n(a,b){a.scrollTop+a.clientHeight<(b+1)*r&&(a.scrollTop+=(b+1)*r-(a.scrollTop+a.clientHeight)),a.scrollTop/r>b&&(a.scrollTop=b*r)}var o=Autodesk.Viewing,p=Autodesk.Viewing.UI,q=Autodesk.Viewing.Private,r=50,s=100,t=function(c,d,e){this.excludeRoot=d,this.viewer=e,this.results=[],this.resultCount=0,this.selectedIndex=-1,this.container=document.createElement("div"),this.container.classList.add("docking-panel"),this.container.classList.add("adsk-search-results"),this.container.results=document.createElement("div"),this.container.results.classList.add("docking-panel-scroll"),this.container.results.classList.add("docking-panel-container-solid-color-b"),this.container.results.addEventListener("scroll",b.bind(this)),this.container.appendChild(this.container.results),c.insertBefore(this.container,c.firstChild),this.scrollingContainer=document.createElement("div"),this.scrollingContainer.classList.add("adsk-search-results-scrolling-panel"),this.scrollingContainer.addEventListener("click",a.bind(this)),this.container.results.appendChild(this.scrollingContainer),this.footer=new q.ResizeFooter(this.container,function(){var a=this.container.getBoundingClientRect(),b=this.viewer.container.getBoundingClientRect();b.right<a.right&&(this.container.style.width=b.right-a.left+"px"),b.bottom<a.bottom&&(this.container.style.height=b.bottom-a.top+"px")}.bind(this)),this.divNoResults=m(),this.scrollingContainer.appendChild(this.divNoResults),this.scrollY=0,this.dirty=!1,this.nextFrameId=0,this.it=h(),this.elementsPool=[],this.elementsUsed=0;for(var f=0;f<150;++f)this.elementsPool[f]=k();this.setVisible(!1)};t.prototype.constructor=t,o.EventDispatcher.prototype.apply(t.prototype),t.prototype.setPosition=function(a,b){this.container.style.left=a+"px",this.container.style.top=b+"px"},t.prototype.setMinWidth=function(a){this.container.style.width=a+"px"},t.prototype.setMaxWidth=function(a){this.container.style.maxHeight=a+"px"},t.prototype.setVisible=function(a){this.container.style.display=a?"":"none"},t.prototype.setResults=function(a,b){this.searchString=a,this.results=b,this.resultCount=g(b),this.selectedIndex=0==this.resultCount?-1:0,this.container.style.height=this.resultCount*r+20+"px",this.container.results.scrollTop=0,this.scrollY=0,0===this.resultCount?this.container.classList.add("no-content"):this.container.classList.remove("no-content"),c(this)},t.prototype.getSelection=function(){var a=this.scrollingContainer.querySelector(".selected");if(!a)return null;var b=this._getNodeAndModelIds(a);return b||null},t.prototype.isRootExcluded=function(){return!(this.results&&this.results.length>1)&&(!(this.modelCount>1)&&this.excludeRoot)},t.prototype.uninitialize=function(){this.setVisible(!1),this.container=null,this.container.parentNode&&this.container.parentNode.removeChild(this.container),cancelAnimationFrame(this.nextFrameId),this.clearListeners()},t.prototype.setDisplayNoResults=function(a){this.divNoResults.style.display=a?"":"none"},t.prototype.selectNext=function(){0!==this.resultCount&&(this.selectedIndex=Math.min(this.resultCount-1,this.selectedIndex+1),n(this.container.results,this.selectedIndex),c(this))},t.prototype.selectPrevious=function(){0!==this.resultCount&&(this.selectedIndex=Math.max(0,this.selectedIndex-1),n(this.container.results,this.selectedIndex),c(this))},t.prototype._getNodeAndModelIds=function(a){for(;!a.hasAttribute("lmv-nodeId");)if(!(a=a.parentNode)||a===this.scrollingContainer)return;return{nodeId:parseInt(a.getAttribute("lmv-nodeId")),modelId:parseInt(a.getAttribute("lmv-modelId"))}},p.SearchResults=t}(),function(){function a(){this.ios=window.webkit,this.android=window.JSINTERFACE,this.iosSend=function(a,b){return window.webkit.messageHandlers.callbackHandler.postMessage({command:a,data:b})},this.androidSend=window.JSINTERFACE}AutodeskNamespace("Autodesk.Viewing");var b=a.prototype;b.animationReady=function(){this.ios?this.iosSend("animationReady"):this.android&&this.androidSend.animationReady()},b.onSelectionChanged=function(a){this.ios?this.iosSend("selectionChanged",a):this.android&&this.androidSend.onSelectionChanged(a)},b.onLongTap=function(a,b){this.ios?this.iosSend("onLongTap",[a,b]):this.android&&this.androidSend.onLongTap(a,b)},b.onSingleTap=function(a,b){this.ios?this.iosSend("onSingleTap",[a,b]):this.android&&this.androidSend.onSingleTap(a,b)},b.onDoubleTap=function(a,b){this.ios?this.iosSend("onDoubleTap",[a,b]):this.android&&this.androidSend.onDoubleTap(a,b)},b.setRTCSession=function(a){this.ios?this.iosSend("setRTCSession",{id:a}):this.android&&this.androidSend.setRTCSessionID(a)},b.putProperties=function(a,b){this.ios?this.iosSend("putProperties",{name:a,value:b}):this.android&&this.androidSend.putProperties(a,b)},b.onPropertyRetrievedSuccess=function(){this.ios?this.iosSend("onPropertyRetrievedSuccess"):this.android&&this.androidSend.onPropertyRetrievedSuccess()},b.onPropertyRetrievedFailOrEmptyProperties=function(){this.ios?this.iosSend("onPropertyRetrievedFailOrEmptyProperties"):this.android&&this.androidSend.onPropertyRetrievedFailOrEmptyProperties()},b.resetAnimationStatus=function(){this.ios?this.iosSend("resetAnimationStatus"):this.android&&this.androidSend.resetAnimationStatus()},b.setPauseUI=function(){this.ios?this.iosSend("setPauseUI"):this.android&&this.androidSend.setToPaused()},b.getDeviceAvailableMemory=function(){return this.ios?this.iosSend("getDeviceAvailableMemory"):this.android?this.androidSend.getDeviceAvailableMemory():void 0},b.onDeviceMemoryInsufficient=function(){return this.ios?this.iosSend("onDeviceMemoryInsufficient"):this.android?this.androidSend.onDeviceMemoryInsufficient():void 0},b.updateAnimationTime=function(a){this.ios?this.iosSend("updateAnimationTime",a):this.android&&this.androidSend.updateAnimationTime(a)},b.setLoadingProgress=function(a,b){this.ios?this.iosSend("setLoadingProgress",{state:a,progress:b}):this.android&&this.androidSend.setLoadingProgress(a,b)},
b.objectTreeCreated=function(){this.ios?this.iosSend("objectTreeCreated"):this.android&&this.androidSend.objectTreeCreated()},b.geometryLoaded=function(){this.ios?this.iosSend("geometryLoaded"):this.android&&this.androidSend.geometryLoaded()},b.putSheets=function(a,b){this.ios?this.iosSend("putSheets",[a,b]):this.android&&this.androidSend.putSheets(a,b)},b.putAllSheets=function(a){this.ios?this.iosSend("putAllSheets",a):this.android&&this.androidSend.putAllSheets(a)},b.hideLoadingView=function(){this.android&&this.androidSend.hideLoadingView()},b.instanceTree=function(a){this.ios?this.iosSend("instanceTree",a):this.android&&this.androidSend.instanceTree(a)},b.loadSheetFailed=function(){this.ios?this.iosSend("loadSheetFailed"):this.android&&this.androidSend.loadSheetFailed()},b.sheetSelected=function(a){this.ios?this.iosSend("sheetSelected",a):this.android&&this.androidSend.sheetSelected(a)},Autodesk.Viewing.MobileCallbacks=a,window.MobileCallbacks=a}(),function(){"use strict";function a(a){return"application/autodesk-db"==a.mime&&a.urn?0===a.urn.indexOf("urn:adsk.objects:os.object")?a.urn.substr(0,a.urn.lastIndexOf("%2F")+3):a.urn.substr(0,a.urn.lastIndexOf("/")+1):null}var b=1,c=function(d,e){if(this.parent=e,this.id=b++,this.data=d,this.isLeaf="geometry"===d.type&&("3d"===d.role||"2d"===d.role||"lod"===d.role),this.extractRevitMetadata(),Array.isArray(d.children)){this.children=[];for(var f=d.children.length,g=0;g<f;g++)this.children[g]=new c(d.children[g],this);for(var g=0;g<f;g++){var h=a(d.children[g]);h&&(this.sharedPropertyDbPath=h),"lod"===d.children[g].role&&(this.lodNode=this.children[g])}}};c.prototype.constructor=c,c.prototype.isOtg=function(){return!!this._getOtgManifest()},c.prototype._getOtgManifest=function(){if("undefined"!=typeof DISABLE_OTG&&DISABLE_OTG)return null;var a=this.findViewableParent();return a?a.data.otg_manifest:null},c.prototype.getOtgGraphicsNode=function(){var a=this._getOtgManifest();return a&&a.views&&a.views[this.guid()]},c.prototype.getPropertyDbManifest=function(){var a,b=this._getOtgManifest();if(b&&b.pdb_manifest){var c=b.pdb_manifest;a={};for(var d=0;d<c.assets.length;d++){var e,f=c.assets[d];e=f.isShared?b.paths.shared_root+c.pdb_shared_rel_path:b.paths.version_root+c.pdb_version_rel_path,a[f.tag]=[e+f.uri]}}else{var e=this.findPropertyDbPath();null===e&&(console.warn("Missing property database entry in manifest."),e=""),a={attrs:[e+"objects_attrs.json.gz"],values:[e+"objects_vals.json.gz"],avs:[e+"objects_avs.json.gz"],offsets:[e+"objects_offs.json.gz"],ids:[e+"objects_ids.json.gz"]}}return a},c.prototype.getRootNode=function(){return this.parent?this.parent.getRootNode():this},c.prototype.findPropertyDbPath=function(){var a=this._getOtgManifest(),b=a&&a.views&&a.views[this.guid()];if(b&&!b.error){return a.paths.version_root}return this.sharedPropertyDbPath?this.sharedPropertyDbPath:this.parent?this.parent.findPropertyDbPath():null},c.prototype._raw=function(){return this.data},c.prototype.name=function(){return this.data.name},c.prototype.guid=function(){return this.data.guid},c.prototype.urn=function(a){var b=this.data.urn;if(!a)return b;for(var c=this.parent;!b&&c;)b=c.data.urn,c=c.parent;return b},c.prototype.getTag=function(a){return(this.data.tags?this.data.tags:this.data)[a]},c.prototype.setTag=function(a,b){this.data.tags?this.data.tags[a]=b:this.data[a]=b},c.prototype.isGeomLeaf=function(){return this.isLeaf},c.prototype.isViewable=function(){return"viewable"===this.data.role},c.prototype.getLodNode=function(){return this.lodNode},c.prototype.isGeometry=function(){return"geometry"===this.data.type},c.prototype.isViewPreset=function(){return"view"===this.data.type},c.prototype.is2D=function(){return"2d"===this.data.role},c.prototype.is3D=function(){return"3d"===this.data.role},c.prototype.is2DGeom=function(){return this.isGeometry()&&this.is2D()},c.prototype.is3DGeom=function(){return this.isGeometry()&&this.is3D()},c.prototype.getPlacementTransform=function(){if(!this.is2DGeom())return this.findViewableParent().getTag("placement");var a=this.findViewableParent().data.sheet_placement;if(a&&a.placements){var b=a.placements[this.data.viewableID];if(b)return b}},c.prototype.isMetadata=function(){if(this.data.role){if(-1!==this.data.role.indexOf("Autodesk.CloudPlatform.DesignDescription"))return!0;if("Autodesk.CloudPlatform.PropertyDatabase"===this.data.role)return!0}return!1},c.prototype.findViewableParent=function(){for(var a=this;a&&!a.isViewable();)a=a.parent;return a},c.prototype.findParentGeom2Dor3D=function(){for(var a=this;a&&!a.is2DGeom()&&!a.is3DGeom();)a=a.parent;return a},c.prototype.getViewableRootPath=function(){if(!this.isGeomLeaf())return null;var a=this.getOtgGraphicsNode();if(a&&!a.error){return this._getOtgManifest().paths.version_root+a.urn}if(this.is2D()){var b=this.search({role:"leaflet"});if(b&&b.length)return b[0].urn()}var c=this.is2D()?"application/autodesk-f2d":"application/autodesk-svf",d=this.search({mime:c});if(d&&d.length){return d[0].data.urn}return null},c.prototype.getNamedViews=function(){var a=this.search({type:"view"});return a=a.filter(function(a){return!!a.data.name&&!!Array.isArray(a.data.camera)})},c.prototype.findByGuid=function(a){var b=null;return this.traverse(function(c){if(c.data.guid===a)return b=c,!0}),b},c.prototype.search=function(a){var b=[];return this.traverse(function(c){var d=!0;for(var e in a)if(!c.data.hasOwnProperty(e)||c.data[e]!==a[e]){d=!1;break}d&&b.push(c)}),b},c.prototype.getAecModelData=function(){var a=this.findViewableParent();return a?a.data.aec_model_data:null},c.prototype.searchByTag=function(a){var b=[];return this.traverse(function(c){var d=!0;for(var e in a)if(c.getTag(e)!==a[e]){d=!1;break}d&&b.push(c)}),b.length?b:null},c.prototype.traverse=function(a){if(a(this))return!0;if(this.children)for(var b=0;b<this.children.length;b++)if(this.children[b].traverse(a))return!0;return!1},c.prototype.extractRevitMetadata=function(){var a=this.data;if(a.hasOwnProperty("levelNumber")){var b=a.levelNumber,c=a.levelName||b,d=this.findViewableParent();d&&(d.levelNumToName=d.levelNumToName||{},d.levelNameToNum=d.levelNameToNum||{},d.levelNumToName[b]=c,d.levelNameToNum[c]=b)}if(a.placement&&"2d"===a.role){for(var e=!0,f=0;f<11;f++)if(0!==a.placement[f]&&1!==a.placement[f]){e=!1;break}e&&(a.placement[12]*=-1,a.placement[13]*=-1,a.placement[14]*=-1)}},c.prototype.getLevel=function(){var a=this.data.levelNumber;return Array.isArray(a)?a[0]:a},c.prototype.getLevelName=function(){return this.data.levelName||this.getLevel()},c.MODEL_NODE={role:"3d",type:"geometry"},c.GEOMETRY_SVF_NODE={role:"graphics",mime:"application/autodesk-svf"},c.SHEET_NODE={role:"2d",type:"geometry"},c.LEAFLET_NODE={role:"leaflet"},c.IMAGE_NODE={role:"image"},c.GEOMETRY_F2D_NODE={role:"graphics",mime:"application/autodesk-f2d"},c.VIEWABLE_NODE={role:"viewable"},Autodesk.Viewing.BubbleNode=c}(),function(){"use strict";var a={SNAP_VERTEX:0,SNAP_MIDPOINT:1,SNAP_CIRCLE_CENTER:2,SNAP_EDGE:3,SNAP_FACE:4,SNAP_CIRCULARARC:5,SNAP_CURVEDEDGE:6,SNAP_CURVEDFACE:7};AutodeskNamespace("Autodesk.Viewing.MeasureCommon"),Autodesk.Viewing.MeasureCommon.SnapType=a}(),function(){"use strict";var a={MEASUREMENT_DISTANCE:1,MEASUREMENT_ANGLE:2,MEASUREMENT_AREA:3,CALIBRATION:4};Autodesk.Viewing.MeasureCommon.MeasurementTypes=a}(),function(){"use strict";var a={MEASUREMENT_CHANGED_EVENT:"measurement-changed",UNITS_CALIBRATION_STARTS_EVENT:"units_calibration_starts_event"};Autodesk.Viewing.MeasureCommon.Events=a}(),AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.Private.formatValueWithUnits=function(a,b,c,d){function e(a){var b=0<=a?Math.floor(a):Math.ceil(a);return{intPart:b,fracPart:a-b}}function f(a,b,c){var d="";return c&&0===a&&(d+="-"),d+=0<b?a.toFixed(b):a.toFixed(0)}function g(a,b,c){for(var d="",g=1,h=a<0,i=0;i<b;++i)g*=2;a>0?a+=.5/g:a-=.5/g;var j,k;c?k=a:(j=e(a/12).intPart,d+=f(j,0,h)+"' ",(k=a-12*j)<0&&(k=-k));var l=e(k).intPart,m=e((k-l)*g).intPart;if(0!==m&&0===l||(d+=f(l,0)),0!==m){for(l<0&&m<0&&(m=-m);m%2==0;)m/=2,g/=2;0!==l&&(d+="-"),d+=f(m,0)+"/"+f(g,0)}return d+='"'}function h(a,b){var c="";a<0&&(c="-",a=Math.abs(a));var d=e(a),g=d.intPart,h=100*d.fracPart;return c+f(g,0)+" m "+f(h,b)+" cm"}function i(a,b){var c="";a<0&&(c="-",a=Math.abs(a));var d=e(a),g=d.intPart,h=12*d.fracPart;return c+f(g,0)+"' "+f(h,b)+'"'}var j;null!==d&&void 0!==d||(d=3);try{if(1===c)j=Autodesk.Viewing.i18n.translate(a?"Yes":"No");else if(24===c){var k=a.split(" ");j=[];for(var l=0;l<k.length;++l)j.push(Autodesk.Viewing.Private.formatValueWithUnits(parseFloat(k[l]),b,3,d));j=j.join(", ")}else 2!==c&&3!==c||!isNaN(a)?"ft-and-fractional-in"===b?j=g(12*a,d):"ft-and-fractional-in^2"===b?j=g(12*a,d)+" "+String.fromCharCode(178):"ft-and-decimal-in"===b?j=i(a,d):"ft-and-decimal-in^2"===b?j=i(a,d)+" "+String.fromCharCode(178):"decimal-in"===b||"in"===b||"inch"===b?j=f(a,d)+'"':"decimal-in^2"===b||"in^2"===b||"inch^2"===b?j=f(a,d)+'" '+String.fromCharCode(178):"decimal-ft"===b||"ft"===b||"feet"===b||"foot"===b?j=f(a,d)+"'":"decimal-ft^2"===b||"ft^2"===b||"feet^2"===b||"foot^2"===b?j=f(a,d)+"' "+String.fromCharCode(178):"fractional-in"===b?j=g(a,d,!0):"fractional-in^2"===b?j=g(a,d,!0)+" "+String.fromCharCode(178):"m-and-cm"===b?j=h(a,d):"m-and-cm^2"===b?j=h(a,d)+" "+String.fromCharCode(178):3===c&&b?(b=b.replace("^2",String.fromCharCode(178)),b=b.replace("^3",String.fromCharCode(179)),j=f(a,d)+" "+b):j=b?a+" "+b:3===c?f(a,d):a:j="NaN"}catch(c){j=b?a+" "+b:a}return j},Autodesk.Viewing.Private.convertUnits=function(a,b,c,d,e){if(c=c||1,a===b&&1==c)return d;var f=1;switch(b){case"mm":f=1e3;break;case"cm":f=100;break;case"m":f=1;break;case"in":f=39.37007874;break;case"ft":case"ft-and-fractional-in":case"ft-and-decimal-in":f=3.280839895;break;case"decimal-in":f=39.37007874;break;case"decimal-ft":f=3.280839895;break;case"fractional-in":f=39.37007874;break;case"m-and-cm":f=1}var g=1;switch(a){case"mm":g=.001;break;case"cm":g=.01;break;case"m":g=1;break;case"in":g=.0254;break;case"ft":case"ft-and-fractional-in":case"ft-and-decimal-in":g=.3048;break;case"decimal-in":g=.0254;break;case"decimal-ft":g=.3048;break;case"fractional-in":g=.0254;break;case"m-and-cm":g=1}return"square"===e?d*Math.pow(f*g*c,2):d*f*g*c},Autodesk.Viewing.Private.calculatePrecision=function(a){if(!a)return 0;var b=a.toString().split(".")[1];if(!b){var c=a.toString().split("/")[1],d=c&&c.match(/\d+/);if(d){var e=parseFloat(d);if(e&&!isNaN(e))return Math.floor(Math.log2(e))}return 0}return(b=b.match(/\d+/))&&b[0]&&b[0].length||0},function(){function a(a,b,c,d){if(!a)return NaN;a=a.toString();var e=a.trim();if(0==e.length)return NaN;var f,g=c.join("| *"),h=d.join("| *");if(f=e.match(new RegExp("^([+-]?\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+h+") *$")))return parseFloat(f[1])/parseFloat(f[2])/b;if(f=e.match(new RegExp("^([+-]?\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+g+")? *$")))return parseFloat(f[1])/parseFloat(f[2]);var i=NaN;if(!(f=e.match(/^[+-]? *(?:\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?/i)))return NaN;if(i=parseFloat(f[0].replace(/ */g,"")),e=e.slice(f[0].length),e=e.replace("-"," "),0==e.length||isNaN(i))return i;var j=Math.sign(i);return 0===j&&(j=1),e.match(new RegExp("^(?: *)(?:"+h+") *$","i"))?i/b:(f=e.match(new RegExp("^ +(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+h+") *$","i")))?(i+j*parseFloat(f[1])/parseFloat(f[2]))/b:(f=e.match(new RegExp("^(?: *)(?:"+g+"|-| +-?) *","i")))?(e=e.slice(f[0].length).trim(),0==e.length?f[0].match(/-/)?NaN:i:(f=e.match(new RegExp("^(\\d+(?:\\.\\d*)?)(?: *)(?:"+h+")? *$")))?i+j*parseFloat(f[1])/b:(f=e.match(new RegExp("^(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+h+")? *$")))?i+j*(parseFloat(f[1])/parseFloat(f[2]))/b:(f=e.match(new RegExp("^(\\d+) +(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+h+")? *$")))?i+j*(parseFloat(f[1])+parseFloat(f[2])/parseFloat(f[3]))/b:NaN):NaN}var b=AutodeskNamespace("Autodesk.Viewing.Private.UnitParser");b.parseFeet=function(b){return a(b,12,["ft","feet","'"],["in","inch",'\\"',"''"])},b.parseMeter=function(b){return a(b,100,["m","meter"],["cm","centimeter"])},b.parseNumber=function(a,c){switch(c){case"ft":case"decimal-ft":case"ft-and-fractional-in":case"ft-and-decimal-in":case"decimal-in":case"fractional-in":return b.parseFeet(a);case"":case"m":case"cm":case"mm":case"m-and-cm":default:return b.parseMeter(a)}},b.parsePositiveNumber=function(a,c){var d=b.parseNumber(a,c);return d>=0?d:NaN}}(),function(){"use strict";var a=AutodeskNamespace("Autodesk.Viewing.MeasureCommon");a.EPSILON=1e-4,a.getSnapResultPosition=function(b,c){if(!b)return null;if(b.isPerpendicular)return b.intersectPoint;switch(b.geomType){case a.SnapType.SNAP_VERTEX:case a.SnapType.SNAP_MIDPOINT:case a.SnapType.SNAP_CIRCLE_CENTER:return b.getGeometry();case a.SnapType.SNAP_EDGE:var d=a.getEndPointsInEdge(b.getGeometry()),e=d[0].clone(),f=d[1].clone();return a.nearestPointInPointToLine(b.intersectPoint,e,f);case a.SnapType.SNAP_FACE:return a.nearestPointInPointToPlane(b.intersectPoint,b.getGeometry().vertices[0],b.faceNormal);case a.SnapType.SNAP_CIRCULARARC:if(c&&c.model&&c.model.is2d()){var g=a.nearestVertexInVertexToEdge(b.intersectPoint,b.getGeometry());return b.geomType=a.SnapType.SNAP_VERTEX,b.geomVertex=g,g}return b.circularArcCenter;case a.SnapType.SNAP_CURVEDEDGE:return a.nearestVertexInVertexToEdge(b.intersectPoint,b.getGeometry());case a.SnapType.SNAP_CURVEDFACE:return b.intersectPoint;default:return null}},a.correctPerpendicularPicks=function(b,c,d,e){if(!(b&&c&&b.getGeometry()&&c.getGeometry()))return!1;var f=a.getSnapResultPosition(b,d);if(e&&d)if(c.geomType===a.SnapType.SNAP_EDGE){var g=new THREE.Vector3,h=new THREE.Vector3,i=c.getGeometry();if(g.subVectors(c.intersectPoint,f).normalize(),h.subVectors(i.vertices[0],i.vertices[1]).normalize(),a.isPerpendicular(g,h,.05)){var j=a.nearestPointInPointToSegment(f,i.vertices[0],i.vertices[1],!0);if(j)return e.onMouseMove(a.project(j,d))&&e.setPerpendicular(!0),c.geomVertex=j,c.intersectPoint=j,!0}}else if(c.geomType===a.SnapType.SNAP_FACE){var k=new THREE.Vector3,l=c.getGeometry();if(k.subVectors(c.intersectPoint,f).normalize(),a.isParallel(c.faceNormal,k,.05)){var j=a.nearestPointInPointToPlane(f,l.vertices[0],c.faceNormal);return e.onMouseMove(a.project(j,d))&&e.setPerpendicular(!0),c.geomVertex=j,c.intersectPoint=j,!0}}},a.calculateDistance=function(b,c,d,e){if(!(b&&c&&b.getGeometry()&&c.getGeometry()))return null;var f=a.getSnapResultPosition(b,e),g=a.getSnapResultPosition(c,e);if(!f||!g)return null;if(a.isEqualVectors(f,g,a.EPSILON))return null;var h,i,j,k;if(e.model.is2d()&&(f=f.clone(),g=g.clone(),e.model.pageToModel(f,g,b.viewportIndex2d)),d){var l=Math.log(2*d)/Math.log(10),m=Math.floor(l);1<2*d/Math.pow(10,m)&&m++,d=Math.pow(10,m);var n=f.distanceTo(g),o=n/d;return h=Math.floor(o+.5)*d,n=Math.abs(f.x-g.x),o=n/d,i=Math.floor(o+.5)*d,n=Math.abs(f.y-g.y),o=n/d,j=Math.floor(o+.5)*d,{distanceXYZ:h,distanceX:i,distanceY:j,distanceZ:0,type:a.MeasurementTypes.MEASUREMENT_DISTANCE}}return h=f.distanceTo(g),i=Math.abs(f.x-g.x),j=Math.abs(f.y-g.y),k=Math.abs(f.z-g.z),{distanceXYZ:h,distanceX:i,distanceY:j,distanceZ:k,type:a.MeasurementTypes.MEASUREMENT_DISTANCE}},a.getDpiPrecision=function(a,b){if(a.is3d())return 0;var c=a.getMetadata("page_dimensions","page_width",null),d=a.getMetadata("page_dimensions","logical_width",null),e=a.getMetadata("page_dimensions","page_height",null),f=a.getMetadata("page_dimensions","logical_height",null);if(!(c&&d&&e&&f))return 0;var g=c/d,h=e/f,i=new THREE.Vector3(0,0,0),j=new THREE.Vector3(g,h,0);return a.pageToModel(i,j,b),i.distanceTo(j)},a.isContainsEqualVectors=function(b){for(var c=0;c<b.length;c++)for(var d=0;d<b.length;d++)if(c!==d&&a.isEqualVectors(b[c],b[d],a.EPSILON))return!0;return!1},a.calculateAngle=function(b,c){var d=[];for(var e in b)if(b.hasOwnProperty(e)){var f=a.getSnapResultPosition(b[e],c);f&&d.push(f)}if(3!==d.length||a.isContainsEqualVectors(d))return null;var g=new THREE.Vector3,h=new THREE.Vector3;return g.subVectors(d[0],d[1]),h.subVectors(d[2],d[1]),a.angleVectorToVector(g,h)},a.calculateArea=function(b,c){var d=[];for(var e in b)if(b.hasOwnProperty(e)){var f=a.getSnapResultPosition(b[e],c);f&&d.push(f.clone())}var g=a.getSnapResultPosition(b[1],c);g&&d.push(g.clone());for(var h=0;h<d.length;h+=2)c.model.pageToModel(d[h],d[h+1],b[1].viewportIndex2d);for(var i=0,j=0,h=0;h<d.length-1;h++)i+=d[h].x*d[h+1].y,j+=d[h].y*d[h+1].x;return Math.abs((i-j)/2)},a.computeResult=function(b,c,d){switch(c){case a.MeasurementTypes.MEASUREMENT_DISTANCE:var e=b[1],f=b[2],g=a.getDpiPrecision(d.model,e.viewportIndex2d);return a.calculateDistance(e,f,g,d);case a.MeasurementTypes.MEASUREMENT_ANGLE:var h=a.calculateAngle(b,d);return h?{angle:h,type:c}:null;case a.MeasurementTypes.MEASUREMENT_AREA:return{area:a.calculateArea(b,d),type:c};default:return null}},a.getFaceArea=function(a,b,c,d,e,f){for(var g=0,h=c.vertices,i=new THREE.Vector3,j=new THREE.Vector3,k=0;k<h.length;k+=3)i.subVectors(h[k+1],h[k]),j.subVectors(h[k+2],h[k]),g+=i.length()*j.length()*Math.sin(i.angleTo(j))/2;return g=Autodesk.Viewing.Private.convertUnits(a.model.getUnitString(),d,f,g,"square"),d?Autodesk.Viewing.Private.formatValueWithUnits(g,d+"^2",3,e):Autodesk.Viewing.Private.formatValueWithUnits(g,null,3,e)},a.getCircularArcRadius=function(a,b,c,d,e,f){var g=c.radius;if(g){if(a.model.is2d()){var h=c.center.clone(),i=c.vertices[0].clone();a.model.pageToModel(h,i,b.getPick(1).viewportIndex2d),g=h.distanceTo(i)}return g=Autodesk.Viewing.Private.convertUnits(a.model.getUnitString(),d,f,g),Autodesk.Viewing.Private.formatValueWithUnits(g,d,3,e)}},a.project=function(a,b,c){var d=b.navigation.getCamera(),e=b.navigation.getScreenViewport(),f=new THREE.Vector3(a.x,a.y,a.z);return f=f.project(d),c=c||0,new THREE.Vector2(Math.round((f.x+1)/2*e.width)+c,Math.round((1-f.y)/2*e.height)+c)},a.inverseProject=function(a,b){var c=b.navigation.getCamera(),d=b.navigation.getScreenViewport(),e=new THREE.Vector3;return e.x=a.x/d.width*2-1,e.y=-(a.y/d.height*2-1),e.z=0,e=e.unproject(c)},a.nearestPointInPointToLine=function(a,b,c){var d,e=new THREE.Vector3,f=new THREE.Vector3;return e.subVectors(b,a),f.subVectors(c,b),d=e.dot(f),e.subVectors(c,b),d=-d/e.dot(e),e.subVectors(c,b),e.multiplyScalar(d),e.add(b)},a.nearestPointInPointToSegment=function(a,b,c,d){var e,f,g=new THREE.Vector3,h=new THREE.Vector3;return g.subVectors(b,a),h.subVectors(c,b),f=g.dot(h),g.subVectors(c,b),f=-f/g.dot(g),f<0?e=d?null:b:f>1?e=d?null:c:(g.subVectors(c,b),g.multiplyScalar(f),e=g.add(b)),e},a.isEqualVectors=function(a,b,c){return!(!a||!b)&&(Math.abs(a.x-b.x)<=c&&Math.abs(a.y-b.y)<=c&&Math.abs(a.z-b.z)<=c)},a.isInverseVectors=function(a,b,c){return Math.abs(a.x+b.x)<=c&&Math.abs(a.y+b.y)<=c&&Math.abs(a.z+b.z)<=c},a.getEndPointsInEdge=function(a){for(var b=a.vertices,c=[],d=0;d<b.length;++d){for(var e=!1,f=0;f<b.length;++f)if(f!==d&&b[f].equals(b[d])){e=!0;break}e||c.push(b[d])}return c},a.angleVectorToVector=function(a,b){return 180*a.angleTo(b)/Math.PI},a.nearestPointsInSegmentToSegment=function(b,c,d,e){var f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3;f.subVectors(c,b),g.subVectors(e,d),h.subVectors(b,d);var i,j,k,l,m=f.dot(f),n=f.dot(g),o=g.dot(g),p=f.dot(h),q=g.dot(h),r=m*o-n*n,s=r,t=r;return r<a.EPSILON?(j=0,s=1,l=q,t=o):(j=n*q-o*p,l=m*q-n*p,j<0?(j=0,l=q,t=o):j>s&&(j=s,l=q+n,t=o)),l<0?(l=0,-p<0?j=0:-p>m?j=s:(j=-p,s=m)):l>t&&(l=t,-p+n<0?j=0:-p+n>m?j=s:(j=-p+n,s=m)),i=Math.abs(j)<a.EPSILON?0:j/s,k=Math.abs(l)<a.EPSILON?0:l/t,f.multiplyScalar(i),g.multiplyScalar(k),h.add(f),h.sub(g),f.add(b),g.add(d),[f,g]},a.nearestPointInPointToEdge=function(b,c){for(var d=b.vertices,e=Number.MAX_VALUE,f=null,g=0;g<d.length;g+=2){var h=a.nearestPointInPointToSegment(c,d[g],d[g+1]),i=c.distanceTo(h);i<e&&(e=i,f=h)}return f},a.nearestPointInPointToPlane=function(a,b,c){var d=new THREE.Vector3,e=c.clone(),f=new THREE.Vector3;f.subVectors(a,b);var g=-e.dot(f),h=e.dot(e),i=g/h;return d.addVectors(a,e.multiplyScalar(i)),d},a.intersectLineToLine=function(a,b,c,d){var e=new THREE.Vector3,f=new THREE.Vector3;e.subVectors(c,a),e.cross(d),f.crossVectors(b,d);var g=e.divide(f);return f=b.clone(),f.multiplyScalar(g),e.addVectors(a,f),e},a.isParallel=function(b,c,d){return d=d||a.EPSILON,1-Math.abs(b.dot(c))<d},a.isPerpendicular=function(b,c,d){return d=d||a.EPSILON,Math.abs(b.dot(c))<d},a.intersectPlaneToPlane=function(b,c,d,e){var f=new THREE.Vector3;f.crossVectors(c,e);var g,h=f.x>=0?f.x:-f.x,i=f.y>=0?f.y:-f.y,j=f.z>=0?f.z:-f.z;g=h>i?h>j?1:3:i>j?2:3;var k,l,m=new THREE.Vector3;switch(k=-c.dot(b),l=-e.dot(d),g){case 1:m.x=0,0!==f.x?(m.y=(l*c.z-k*e.z)/f.x,m.z=(k*e.y-l*c.y)/f.x):(m.y=-l*c.z/(c.z*e.y),m.z=-k*e.y/(c.z*e.y));break;case 2:m.y=0,0!==f.y?(m.x=(k*e.z-l*c.z)/f.y,m.z=(l*c.x-k*e.x)/f.y):(m.x=-k*e.z/(c.x*e.z),m.z=-l*c.x/(c.x*e.z));break;case 3:m.z=0,0!==f.z?(m.x=(l*c.y-k*e.y)/f.z,m.y=(k*e.x-l*c.x)/f.z):(m.x=-l*c.y/(c.y*e.x),m.y=-k*e.x/(c.y*e.x))}var n=new THREE.Vector3;return n.addVectors(m,f.multiplyScalar(100)),[a.nearestPointInPointToLine(b,m,n),a.nearestPointInPointToLine(d,m,n)]},a.nearestPointInPointToTriangle=function(b,c,d,e){var f,g=Number.MAX_VALUE;if(f=a.pointProjectsInTriangle(b,c,d,e))return f;var h=a.nearestPointInPointToSegment(b,c,d);return b.distanceTo(h)<g&&(g=b.distanceTo(h),f=h.clone()),h=a.nearestPointInPointToSegment(b,c,e),b.distanceTo(h)<g&&(g=b.distanceTo(h),f=h.clone()),h=a.nearestPointInPointToSegment(b,d,e),b.distanceTo(h)<g&&(f=h.clone()),f},a.pointProjectsInTriangle=function(a,b,c,d){var e=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3;e.subVectors(c,b),f.subVectors(d,b),h.crossVectors(e,f),g.subVectors(a,b),e.cross(g);var i=e.dot(h)/h.dot(h);g.cross(f);var c=g.dot(h)/h.dot(h),b=1-i-c;if(b>=0&&b<=1&&c>=0&&c<=1&&i>=0&&i<=1){var j=THREE.Triangle.normal(b,c,d);return this.nearestPointInPointToPlane(a,b,j)}},a.nearestPointsInLineSegmentToTriangle=function(b,c,d,e,f){var g,h,i=[],j=Number.MAX_VALUE,k=a.pointProjectsInTriangle(b,d,e,f);k&&b.distanceTo(k)<j&&(j=b.distanceTo(k),i[0]=b,i[1]=k);var l=a.pointProjectsInTriangle(c,d,e,f);l&&c.distanceTo(l)<j&&(j=c.distanceTo(l),i[0]=c,i[1]=l),g=d,h=e;var m=a.nearestPointsInSegmentToSegment(b,c,g,h);return m[0].distanceTo(m[1])<j&&(j=m[0].distanceTo(m[1]),i[0]=m[0].clone(),i[1]=m[1].clone()),g=d,h=f,m=a.nearestPointsInSegmentToSegment(b,c,g,h),m[0].distanceTo(m[1])<j&&(j=m[0].distanceTo(m[1]),i[0]=m[0].clone(),i[1]=m[1].clone()),g=e,h=f,m=a.nearestPointsInSegmentToSegment(b,c,g,h),m[0].distanceTo(m[1])<j&&(i[0]=m[0].clone(),i[1]=m[1].clone()),i},a.nearestPointsInTriangleToTriangle=function(b,c,d,e,f,g){function h(b,c,d,e){var f=a.pointProjectsInTriangle(b,c,d,e);f&&b.distanceTo(f)<k&&(k=b.distanceTo(f),j[0]=b,j[1]=f)}function i(b,c,d,e){var f=a.nearestPointsInSegmentToSegment(b,c,d,e);f[0].distanceTo(f[1])<k&&(k=f[0].distanceTo(f[1]),j=f)}var j=[],k=Number.MAX_VALUE;return h(b,e,f,g),h(c,e,f,g),h(d,e,f,g),h(e,b,c,d),h(f,b,c,d),h(g,b,c,d),i(b,c,e,f),i(b,c,e,g),i(b,c,f,g),i(b,d,e,f),i(b,d,e,g),i(b,d,f,g),i(c,d,e,f),i(c,d,e,g),i(c,d,f,g),j},a.nearestPointsInEdgeToFace=function(b,c,d){for(var e=[],f=Number.MAX_VALUE,g=0;g<d.vertices.length;g+=3){var h=a.nearestPointsInLineSegmentToTriangle(b,c,d.vertices[g],d.vertices[g+1],d.vertices[g+2]);h[0].distanceTo(h[1])<f&&(f=h[0].distanceTo(h[1]),e=h)}return e},a.angleLineToPlane=function(b,c){var d=a.angleVectorToVector(b,c);return d>90?d-=90:d=90-d,d},a.intersectPointLineToPlane=function(b,c,d,e){var f=new THREE.Vector3,g=new THREE.Vector3;f.subVectors(e,d),g.subVectors(d,b);var h=c.dot(f),i=-c.dot(g);return Math.abs(h)<a.EPSILON?null:(f.multiplyScalar(i/h),f.add(d),f)},a.nearestVertexInVertexToEdge=function(a,b){for(var c,d=Number.MAX_VALUE,e=0;e<b.vertices.length;e++){var f=a.distanceTo(b.vertices[e]);d>f&&(c=b.vertices[e],d=f)}return c},a.distancePointToLine=function(a,b,c){var d,e,f=new THREE.Vector3,g=new THREE.Vector3;return f.subVectors(b,a),g.subVectors(c,b),e=f.dot(g),f.subVectors(c,b),e=-e/f.dot(f),e<0?d=a.distanceTo(b):e>1?d=a.distanceTo(c):(f.subVectors(a,b),g.subVectors(a,c),f.cross(g),g.subVectors(c,b),d=Math.sqrt(f.dot(f))/Math.sqrt(g.dot(g))),d},a.forAll=function(a,b){if(a)for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];d&&b(d)}},a.createCommonOverlay=function(a,b){a.impl.overlayScenes[b]||a.impl.createOverlayScene(b)},a.safeToggle=function(a,b,c){(a.classList.contains(b)&&!c||!a.classList.contains(b)&&c)&&a.classList.toggle(b,c)},a.getCentroidOfPolygon=function(a){for(var b=new THREE.Vector3,c=a.length,d=0;d<c;d++)b.add(a[d]);return b.multiplyScalar(1/c),b},a.isSegmentsIntersect=function(b,c,d,e){var f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3,i=new THREE.Vector3;if(f.subVectors(c,b),g.subVectors(e,d),h.crossVectors(f,g),Math.abs(h.z)<a.EPSILON)return!1;var j=i.subVectors(d,b).cross(g).z/h.z,k=i.subVectors(d,b).cross(f).z/h.z;return!(Math.abs(h.z)<a.EPSILON)&&0<=j&&j<=1&&0<=k&&k<=1},a.isPolygonSimple=function(b){var c=b.length;if(3===c)return!0;for(var d=0;d<c;d++)for(var e=b[d],f=b[(d+1)%c],g=d+2;g<c;g++){var h=b[g%c],i=b[(g+1)%c];if(i===e)break;if(a.isSegmentsIntersect(e,f,h,i))return!1}return!0},a.getPolygonVisualCenter=function(b){function c(a,b){return b.max-a.max}function d(a,b,c,d){this.x=a,this.y=b,this.h=c,this.d=e(a,b,d),this.max=this.d+this.h*Math.SQRT2}function e(a,b,c){for(var d=!1,e=1/0,g=0;g<c.length;g++)for(var h=c[g],i=0,j=h.length,k=j-1;i<j;k=i++){var l=h[i],m=h[k];l.y>b!=m.y>b&&a<(m.x-l.x)*(b-l.y)/(m.y-l.y)+l.x&&(d=!d),e=Math.min(e,f(a,b,l,m))}return(d?1:-1)*Math.sqrt(e)}function f(a,b,c,d){var e=c.x,f=c.y,g=d.x-e,h=d.y-f;if(0!==g||0!==h){var i=((a-e)*g+(b-f)*h)/(g*g+h*h);i>1?(e=d.x,f=d.y):i>0&&(e+=g*i,f+=h*i)}return g=a-e,h=b-f,g*g+h*h}function g(a,b){function c(a,b){return a<b?-1:a>b?1:0}if(!(this instanceof g))return new g(a,b);if(this.data=a||[],this.length=this.data.length,this.compare=b||c,this.length>0)for(var d=this.length>>1;d>=0;d--)this._down(d)}if(g.prototype={push:function(a){this.data.push(a),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var a=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),a}},peek:function(){return this.data[0]},_up:function(a){for(var b=this.data,c=this.compare,d=b[a];a>0;){var e=a-1>>1,f=b[e];if(c(d,f)>=0)break;b[a]=f,a=e}b[a]=d},_down:function(a){for(var b=this.data,c=this.compare,d=this.length>>1,e=b[a];a<d;){var f=1+(a<<1),g=f+1,h=b[f];if(g<this.length&&c(b[g],h)<0&&(f=g,h=b[g]),c(h,e)>=0)break;b[a]=h,a=f}b[a]=e}},3===b.length)return a.getCentroidOfPolygon(b);b=[b];for(var h,i,j,k,l=0;l<b[0].length;l++){var m=b[0][l];(!l||m.x<h)&&(h=m.x),(!l||m.y<i)&&(i=m.y),(!l||m.x>j)&&(j=m.x),(!l||m.y>k)&&(k=m.y)}var n=j-h,o=k-i,p=Math.min(n,o),q=p/2,r=new g(null,c);if(0===p)return[h,i];for(var s=h;s<j;s+=p)for(var t=i;t<k;t+=p)r.push(new d(s+q,t+q,q,b));var u=function(a){for(var b=0,c=0,e=0,f=a[0],g=0,h=f.length,i=h-1;g<h;i=g++){var j=f[g],k=f[i],l=j.x*k.y-k.x*j.y;c+=(j.x+k.x)*l,e+=(j.y+k.y)*l,b+=3*l}return 0===b?new d(f[0].x,f[0].y,0,a):new d(c/b,e/b,0,a)}(b),v=new d(h+n/2,i+o/2,0,b);for(v.d>u.d&&(u=v);r.length;){var w=r.pop();w.d>u.d&&(u=w),w.max-u.d<=.01||(q=w.h/2,r.push(new d(w.x-q,w.y-q,q,b)),r.push(new d(w.x+q,w.y-q,q,b)),r.push(new d(w.x-q,w.y+q,q,b)),r.push(new d(w.x+q,w.y+q,q,b)))}return{x:u.x,y:u.y}}}(),function(){"use strict";function a(a,b){this.measurementType=a,this.id=b,this.picks=[],this.closedArea=!1,this.resetMeasureValues()}var b=Autodesk.Viewing.MeasureCommon;a.prototype.resetMeasureValues=function(){this.angle=0,this.distanceX=0,this.distanceY=0,this.distanceZ=0,this.distanceXYZ=0,this.result=null},a.prototype.setPick=function(a,b){var c=this.picks[a]=b;return c.id=parseInt(a),c},a.prototype.getPick=function(a){var c=this.picks[a];return c||(c=this.setPick(a,new b.SnapResult)),c},a.prototype.countPicks=function(){return Object.keys(this.picks).length},a.prototype.getMaxNumberOfPicks=function(){switch(this.measurementType){case b.MeasurementTypes.MEASUREMENT_DISTANCE:return 2;case b.MeasurementTypes.MEASUREMENT_ANGLE:return 3;case b.MeasurementTypes.MEASUREMENT_AREA:return this.closedArea?this.countPicks():Number.MAX_VALUE-1}},a.prototype.hasPick=function(a){return this.picks[a]&&!this.picks[a].isEmpty()},a.prototype.isComplete=function(){var a=this.countPicks()===this.getMaxNumberOfPicks();for(var b in this.picks)if(this.picks.hasOwnProperty(b)&&!(a=a&&this.hasPick(b)))break;return a},a.prototype.isEmpty=function(){var a=!0;for(var b in this.picks)if(this.picks.hasOwnProperty(b)&&!(a=a&&!this.hasPick(b)))break;return a},a.prototype.clearPick=function(a){this.picks[a]&&this.picks[a].clear(),this.resetMeasureValues()},a.prototype.clearAllPicks=function(){for(var a in this.picks)this.picks.hasOwnProperty(a)&&this.clearPick(a)},a.prototype.hasEqualPicks=function(a,c){if(!a||!c)return!1;if(a.geomType===c.geomType){var d=b.getSnapResultPosition(a),e=b.getSnapResultPosition(c);return b.isEqualVectors(d,e,b.EPSILON)}return!1},a.prototype.computeResult=function(a,c){if(this.resetMeasureValues(),!c.model)return this.result=null,!1;var d=this.result=b.computeResult(a,this.measurementType,c);if(null===d)return!this.isComplete();switch(d.type){case b.MeasurementTypes.MEASUREMENT_DISTANCE:return this.distanceXYZ=d.distanceXYZ,this.distanceX=d.distanceX,this.distanceY=d.distanceY,this.distanceZ=d.distanceZ,!0;case b.MeasurementTypes.MEASUREMENT_ANGLE:return this.angle=isNaN(d.angle)?0:d.angle,!0;case b.MeasurementTypes.MEASUREMENT_AREA:return this.area=d.area,!0;default:return!1}},a.prototype.getGeometry=function(a){return{type:this.picks[a].geomType,geometry:this.picks[a].getGeometry()}},a.prototype.attachIndicator=function(a,b,c){this.indicator=new c(a,this,b),this.indicator.init()},b.Measurement=a}(),function(){"use strict";var a=AutodeskNamespace("Autodesk.Viewing.MeasureCommon");a.SnapResult=function(){this.clear()},a.SnapResult.prototype.clear=function(){this.geomType=null,this.snapNode=null,this.geomVertex=null,this.geomEdge=null,this.geomFace=null,this.radius=null,this.intersectPoint=null,this.faceNormal=null,this.viewportIndex2d=null,this.circularArcCenter=null,this.circularArcRadius=null,this.fromTopology=!1,this.isPerpendicular=!1},a.SnapResult.prototype.copyTo=function(a){a.snapNode=this.snapNode,a.geomVertex=this.geomVertex,a.geomFace=this.geomFace,a.geomEdge=this.geomEdge,a.radius=this.radius,a.geomType=this.geomType,a.intersectPoint=this.intersectPoint,a.faceNormal=this.faceNormal,a.viewportIndex2d=this.viewportIndex2d,a.circularArcCenter=this.circularArcCenter,a.circularArcRadius=this.circularArcRadius,a.fromTopology=this.fromTopology,a.isPerpendicular=this.isPerpendicular},a.SnapResult.prototype.clone=function(){var b=new a.SnapResult;return this.copyTo(b),b},a.SnapResult.prototype.isEmpty=function(){return!this.getGeometry()},a.SnapResult.prototype.getFace=function(){return this.geomFace},a.SnapResult.prototype.getEdge=function(){return this.geomEdge},a.SnapResult.prototype.getVertex=function(){return this.geomVertex},a.SnapResult.prototype.getGeometry=function(){switch(this.geomType){case a.SnapType.SNAP_VERTEX:case a.SnapType.SNAP_MIDPOINT:case a.SnapType.SNAP_CIRCLE_CENTER:return this.geomVertex;case a.SnapType.SNAP_EDGE:return this.geomEdge;case a.SnapType.SNAP_FACE:return this.geomFace;case a.SnapType.SNAP_CIRCULARARC:case a.SnapType.SNAP_CURVEDEDGE:return this.geomEdge;case a.SnapType.SNAP_CURVEDFACE:return this.geomFace}return null},a.SnapResult.prototype.setGeometry=function(b,c){switch(b){case a.SnapType.SNAP_VERTEX:case a.SnapType.SNAP_MIDPOINT:case a.SnapType.SNAP_CIRCLE_CENTER:this.geomVertex=c;break;case a.SnapType.SNAP_EDGE:this.geomEdge=c;break;case a.SnapType.SNAP_FACE:this.geomFace=c;break;case a.SnapType.SNAP_CIRCULARARC:case a.SnapType.SNAP_CURVEDEDGE:this.geomEdge=c;break;case a.SnapType.SNAP_CURVEDFACE:this.geomFace=c;break;default:return}this.geomType=b}}(),function(){function a(a,b){return Math.abs(a-b)<=h}function b(a,b){return Math.abs(a.x-b.x)<=h&&Math.abs(a.y-b.y)<=h&&Math.abs(a.z-b.z)<=h}function c(a,b){
return Math.abs(a.x+b.x)<=h&&Math.abs(a.y+b.y)<=h&&Math.abs(a.z+b.z)<=h}function d(d,i){function j(a,b,c){this.viewer=a,this.snapper=b,this.lineGeom=new THREE.Geometry,this.circularArc=null,this.circularArcCenter,this.circularArcRadius,this.ellipticalArc=null,this.ellipticalArcCenter,this.minDist=Number.MAX_VALUE,this.vpIdLine=null,this.vpIdCircular=null,this.vpIdElliptical=null,this.detectRadius=c}var k,l=new g.SnapResult,m=d,n=i||{};k=n.markupMode?["snapper-markup"]:["snapper"];var o=!1,p=Number.MAX_VALUE,q=null,r=!1,s=!1,t=!1,u=null;this.indicator=new g.SnapperIndicator(d,this),this.markupMode=n.markupMode,this.isActive=function(){return o},this.getNames=function(){return k},this.getName=function(){return k[0]},this.getPriority=function(){return 60},this.activate=function(){o=!0,this.indicator||(this.indicator=new g.SnapperIndicator(d,this))},this.deactivate=function(){o=!1,this.indicator&&(this.indicator.destroy(),this.indicator=null)},this.copyResults=function(a){l.copyTo(a)},this.getEdge=function(){return l.geomEdge},this.getVertex=function(){return l.geomVertex},this.getGeometry=function(){return l.getGeometry()},this.getGeometryType=function(){return l.geomType},this.getIntersectPoint=function(){return l.intersectPoint},this.getSnapResult=function(){return l},this.isSnapped=function(){return t},this.clearSnapped=function(){l.clear(),t=!1},this.setViewportId=function(a){u=a},this.snapping3D=function(a){l.snapNode=a.dbId,l.intersectPoint=a.intersectPoint;var b,c=a.face;b=a.fragId&&void 0!==a.fragId.length?a.fragId:[a.fragId],l.hasTopology=a.model.hasTopology(),l.hasTopology?this.snapping3DwithTopology(c,b,a.model):this.snapping3DtoMesh(c,b,a.model)},this.snapping3DwithTopology=function(a,b,c){l.snapNode&&(b=[],c.getData().instanceTree.enumNodeFragments(l.snapNode,function(a){b.push(a)},!0)),l.geomFace=l.geomEdge=l.geomVertex=null,p=Number.MAX_VALUE;for(var d=0;d<b.length;++d){var e=b[d],f=m.impl.getRenderProxy(c,e),h=f.geometry,i=c.getTopoIndex(e),j=c.getTopology(i),k=j.faces,o=j.edges;if(!l.geomFace){l.geomFace=this.faceSnappingWithTopology(a,h,k,f),l.geomFace&&(l.geomFace.fragId=e);var r=(new THREE.Matrix3).getNormalMatrix(f.matrixWorld);l.faceNormal=a.normal.applyMatrix3(r).normalize()}this.edgeSnappingWithTopology(l.intersectPoint,h,o,f)}if(l.geomVertex=this.vertexSnappingWithTopology(l.geomEdge,l.intersectPoint),l.geomFace){if(l.radius=this.setDetectRadius(l.intersectPoint),(n.forceSnapVertices||q<l.radius)&&l.geomVertex)l.geomType=g.SnapType.SNAP_VERTEX;else if((n.forceSnapEdges||p<l.radius)&&l.geomEdge){var s=this.edgeIsCircle(l.geomEdge);s?(l.circularArcCenter=s,l.circularArcRadius=s.distanceTo(l.geomEdge.vertices[0]),l.geomEdge.center=l.circularArcCenter,l.geomEdge.radius=l.circularArcRadius,l.geomType=g.SnapType.SNAP_CIRCULARARC):this.edgeIsCurved(l.geomEdge)?l.geomType=g.SnapType.SNAP_CURVEDEDGE:l.geomType=g.SnapType.SNAP_EDGE}else this.faceIsCurved(l.geomFace)?l.geomType=g.SnapType.SNAP_CURVEDFACE:l.geomType=g.SnapType.SNAP_FACE;t=!0}},this.snapping3DtoMesh=function(a,b,c){for(var d=0;d<b.length;++d){var e=b[d],f=m.impl.getRenderProxy(c,e),h=f.geometry;if(l.geomFace=this.faceSnapping(a,h),l.geomFace){l.geomFace.applyMatrix(f.matrixWorld),l.geomEdge=this.edgeSnapping(l.geomFace,l.intersectPoint),l.geomVertex=this.vertexSnapping(l.geomEdge,l.intersectPoint);var i=(new THREE.Matrix3).getNormalMatrix(f.matrixWorld);l.faceNormal=a.normal.applyMatrix3(i).normalize(),l.radius=this.setDetectRadius(l.intersectPoint),n.forceSnapVertices||q<l.radius?l.geomType=g.SnapType.SNAP_VERTEX:n.forceSnapEdges||p<l.radius?l.geomType=g.SnapType.SNAP_EDGE:l.geomType=g.SnapType.SNAP_FACE,t=!0;break}}},this.faceSnappingWithTopology=function(a,b,c,d){var e=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Geometry,i=b.attributes;if(void 0!==i.index){for(var j=b.vb?b.vb:i.position.array,k=b.vb?b.vbstride:3,l=0;l<c.length;l++){for(var m=c[l].indexList,n=c[l].id,o=0;o<m.length;o+=3)if(a.a===m[o]){if(a.b===m[o+1]&&a.c===m[o+2]||a.b===m[o+2]&&a.c===m[o+1])break}else if(a.a===m[o+1]){if(a.b===m[o]&&a.c===m[o+2]||a.b===m[o+2]&&a.c===m[o])break}else if(a.a===m[o+2]&&(a.b===m[o]&&a.c===m[o+1]||a.b===m[o+1]&&a.c===m[o]))break;if(o<m.length)break}if(l<c.length)for(var o=0;o<m.length;o+=3){e.set(j[m[o]*k],j[m[o]*k+1],j[m[o]*k+2]),f.set(j[m[o+1]*k],j[m[o+1]*k+1],j[m[o+1]*k+2]),g.set(j[m[o+2]*k],j[m[o+2]*k+1],j[m[o+2]*k+2]);var p=h.vertices.length;h.vertices.push(e.clone()),h.vertices.push(f.clone()),h.vertices.push(g.clone()),h.faces.push(new THREE.Face3(p,p+1,p+2))}}return h.vertices.length>0?(h.faceId=n,h.applyMatrix(d.matrixWorld),h):null},this.faceSnapping=function(c,d){var e=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Geometry,i=d.attributes;if(void 0!==i.index){var j=i.index.array||d.ib,k=d.vb?d.vb:i.position.array,l=d.vb?d.vbstride:3,m=d.offsets;m&&0!==m.length||(m=[{start:0,count:j.length,index:0}]);for(var n=0;n<m.length;++n)for(var o=m[n].start,p=m[n].count,q=m[n].index,r=o;r<o+p;r+=3){var s=q+j[r],t=q+j[r+1],u=q+j[r+2];e.set(k[s*l],k[s*l+1],k[s*l+2]),f.set(k[t*l],k[t*l+1],k[t*l+2]),g.set(k[u*l],k[u*l+1],k[u*l+2]);var v=THREE.Triangle.normal(e,f,g),w=new THREE.Vector3;if(w.set(k[c.a*l],k[c.a*l+1],k[c.a*l+2]),b(v,c.normal)&&a(v.dot(e),c.normal.dot(w))){var x=h.vertices.length;h.vertices.push(e.clone()),h.vertices.push(f.clone()),h.vertices.push(g.clone()),h.faces.push(new THREE.Face3(x,x+1,x+2))}}}return h.vertices.length>0?this.getTrianglesOnSameFace(h,c,k,l):null},this.getTrianglesOnSameFace=function(a,b,c,d){var e=!1,f=a.vertices.slice(),g=new THREE.Vector3;g.set(c[b.a*d],c[b.a*d+1],c[b.a*d+2]);var h=new THREE.Vector3;h.set(c[b.b*d],c[b.b*d+1],c[b.b*d+2]);var i=new THREE.Vector3;i.set(c[b.c*d],c[b.c*d+1],c[b.c*d+2]);var j=new THREE.Geometry;j.vertices.push(g),j.vertices.push(h),j.vertices.push(i),j.faces.push(new THREE.Face3(0,1,2));var k=[];do{k=[];for(var l=0;l<f.length;l+=3)if(f[l].equals(g)&&f[l+1].equals(h)&&f[l+2].equals(i))e=!0,k.push(l);else for(var m=0;m<j.vertices.length;m+=3)if(this.trianglesSharedEdge(f[l],f[l+1],f[l+2],j.vertices[m],j.vertices[m+1],j.vertices[m+2])){var n=j.vertices.length;j.vertices.push(f[l].clone()),j.vertices.push(f[l+1].clone()),j.vertices.push(f[l+2].clone()),j.faces.push(new THREE.Face3(n,n+1,n+2)),k.push(l);break}for(var o=k.length-1;o>=0;--o)f.splice(k[o],3)}while(k.length>0);return e?j:null},this.trianglesSharedEdge=function(a,b,c,d,e,f){var g=!1,h=!1,i=!1;return(a.equals(d)||a.equals(e)||a.equals(f))&&(g=!0),(b.equals(d)||b.equals(e)||b.equals(f))&&(h=!0),(c.equals(d)||c.equals(e)||c.equals(f))&&(i=!0),!!(g&h||g&i||h&i)},this.edgeSnappingWithTopology=function(a,b,c,d){var e,f=new THREE.Geometry,h=Number.MAX_VALUE,i=new THREE.Vector3,j=new THREE.Vector3,k=b.attributes;if(void 0!==k.index&&void 0!=c){for(var m=b.vb?b.vb:k.position.array,n=b.vb?b.vbstride:3,o=0;o<c.length;o++)for(var q=c[o].indexList,r=0;r<q.length-1;r++){i.set(m[q[r]*n],m[q[r]*n+1],m[q[r]*n+2]),j.set(m[q[r+1]*n],m[q[r+1]*n+1],m[q[r+1]*n+2]),i.applyMatrix4(d.matrixWorld),j.applyMatrix4(d.matrixWorld);var s=g.distancePointToLine(a,i,j);s<h&&(h=s,e=o)}if(e){q=c[e].indexList;for(var t=0;t<q.length-1;t++)f.vertices.push(new THREE.Vector3(m[q[t]*n],m[q[t]*n+1],m[q[t]*n+2])),f.vertices.push(new THREE.Vector3(m[q[t+1]*n],m[q[t+1]*n+1],m[q[t+1]*n+2]))}}p>=h&&f.vertices.length>0&&(p=h,f.applyMatrix(d.matrixWorld),l.geomEdge=f)},this.edgeSnapping=function(a,b){for(var c=new THREE.Geometry,d=!0,e=!0,f=!0,h=0;h<a.vertices.length;h+=3){for(var i=0;i<a.vertices.length;i+=3)h!==i&&((a.vertices[h].equals(a.vertices[i])||a.vertices[h].equals(a.vertices[i+1])||a.vertices[h].equals(a.vertices[i+2]))&&(a.vertices[h+1].equals(a.vertices[i])||a.vertices[h+1].equals(a.vertices[i+1])||a.vertices[h+1].equals(a.vertices[i+2]))&&(d=!1),(a.vertices[h].equals(a.vertices[i])||a.vertices[h].equals(a.vertices[i+1])||a.vertices[h].equals(a.vertices[i+2]))&&(a.vertices[h+2].equals(a.vertices[i])||a.vertices[h+2].equals(a.vertices[i+1])||a.vertices[h+2].equals(a.vertices[i+2]))&&(e=!1),(a.vertices[h+1].equals(a.vertices[i])||a.vertices[h+1].equals(a.vertices[i+1])||a.vertices[h+1].equals(a.vertices[i+2]))&&(a.vertices[h+2].equals(a.vertices[i])||a.vertices[h+2].equals(a.vertices[i+1])||a.vertices[h+2].equals(a.vertices[i+2]))&&(f=!1));d&&(c.vertices.push(a.vertices[h].clone()),c.vertices.push(a.vertices[h+1].clone())),e&&(c.vertices.push(a.vertices[h].clone()),c.vertices.push(a.vertices[h+2].clone())),f&&(c.vertices.push(a.vertices[h+1].clone()),c.vertices.push(a.vertices[h+2].clone())),d=!0,e=!0,f=!0}for(var j,k=new THREE.Geometry,l=Number.MAX_VALUE,m=0;m<c.vertices.length;m+=2){var n=g.distancePointToLine(b,c.vertices[m],c.vertices[m+1]);n<l&&(l=n,j=m)}return k.vertices.push(c.vertices[j].clone()),k.vertices.push(c.vertices[j+1].clone()),k.vertices=this.getConnectedLineSegmentsOnSameLine(c,k.vertices),p=l,k},this.getConnectedLineSegmentsOnSameLine=function(a,d){var e=a.vertices.slice(),f=d[0],g=d[1],h=[];do{h=[];for(var i=0;i<e.length;i+=2)if(!e[i].equals(f)||!e[i+1].equals(g))for(var j=0;j<d.length;j+=2)if(e[i].equals(d[j])||e[i+1].equals(d[j])||e[i].equals(d[j+1])||e[i+1].equals(d[j+1])){var k=new THREE.Vector3,l=new THREE.Vector3;if(k.subVectors(d[j],d[j+1]),k.normalize(),l.subVectors(e[i],e[i+1]),l.normalize(),b(k,l)||c(k,l)){h.push(i);break}}for(var m=h.length-1;m>=0;--m)d.push(e[h[m]]),d.push(e[h[m]+1]),e.splice(h[m],2)}while(h.length>0);return d},this.vertexSnappingWithTopology=function(a,b){var c=Number.MAX_VALUE,d=new THREE.Vector3;if(a&&a.vertices.length>1){var e=b.distanceTo(a.vertices[0]),f=b.distanceTo(a.vertices[a.vertices.length-1]);e<=f?(c=e,d=a.vertices[0].clone()):(c=f,d=a.vertices[a.vertices.length-1].clone())}return q=c,d},this.vertexSnapping=function(a,b){for(var c=Number.MAX_VALUE,d=new THREE.Vector3,e=0;e<a.vertices.length;++e){var f=b.distanceTo(a.vertices[e]);f<c-h&&(c=f,d=a.vertices[e].clone())}return q=c,d},this.edgeIsCircle=function(a){var b=a.vertices;if(b.length<8)return!1;if(b[0].equals(b[b.length-1])){for(var c=new THREE.Vector3(0,0,0),d=0;d<b.length;d+=2)c.add(b[d]);c.divideScalar(b.length/2);for(var e=c.distanceTo(b[0]),d=0;d<b.length;d+=2)if(!(Math.abs(c.distanceTo(b[d])-e)<=h))return!1;return c}return!1},this.edgeIsCurved=function(a){var c=a.vertices;if(c.length<=2)return!1;if(c[0].equals(c[c.length-1]))return!0;var d=new THREE.Vector3;d.subVectors(c[0],c[1]);for(var e=new THREE.Vector3,f=2;f<c.length;f+=2)if(e.subVectors(c[f],c[f+1]),!b(d,e))return!0;return!1},this.faceIsCurved=function(c){var d=c.vertices,e=c.faces;if(e.length<=1)return!1;for(var f=THREE.Triangle.normal(d[e[0].a],d[e[0].b],d[e[0].c]),g=d[e[0].a],h=1;h<e.length;h++){var i=THREE.Triangle.normal(d[e[h].a],d[e[h].b],d[e[h].c]),j=d[e[h].a];if(!b(f,i)||!a(f.dot(g),i.dot(j)))return!0}return!1},this.angleVector2=function(a){return a.x>0&&a.y>=0?Math.atan(a.y/a.x):a.x>=0&&a.y<0?Math.atan(a.y/a.x)+2*Math.PI:a.x<0&&a.y<=0?Math.atan(a.y/a.x)+Math.PI:a.x<=0&&a.y>0?Math.atan(a.y/a.x)+Math.PI:null},j.prototype.onLineSegment=function(a,b,c,d,e){var f=this.snapper.getIntersectPoint(),h=this.lineGeom.vertices,i=new THREE.Vector3(a,b,f.z),j=new THREE.Vector3(c,d,f.z),k=g.distancePointToLine(f,i,j);k<=this.detectRadius&&k<this.minDist&&(h.splice(0,2,i,j),this.minDist=k,this.vpIdLine=e)},j.prototype.onCircularArc=function(a,b,c,d,e,f){var g=this.snapper.getIntersectPoint(),h=new THREE.Vector2(g.x,g.y),i=new THREE.Vector2(a,b),j=h.distanceTo(i);h.sub(i);var k=this.snapper.angleVector2(h);if(Math.abs(j-e)<=this.detectRadius){if(d>c&&k>=c&&k<=d)var l=new THREE.CircleGeometry(e,100,c,d-c);else{if(!(d<c&&(k>=c||k<=d)))return;var l=new THREE.CircleGeometry(e,100,c,2*Math.PI-c+d)}l.vertices.splice(0,1),l.applyMatrix((new THREE.Matrix4).makeTranslation(a,b,g.z)),this.circularArc=l,this.circularArcCenter=new THREE.Vector3(a,b,g.z),this.circularArcRadius=e,this.vpIdCircular=f}},j.prototype.onEllipticalArc=function(b,c,d,e,f,g,h,i){var j=this.snapper.getIntersectPoint(),k=new THREE.Vector2(j.x,j.y),l=f-this.detectRadius,m=g-this.detectRadius,n=f+this.detectRadius,o=g+this.detectRadius,p=(k.x-b)*(k.x-b)/(l*l)+(k.y-c)*(k.y-c)/(m*m),q=(k.x-b)*(k.x-b)/(n*n)+(k.y-c)*(k.y-c)/(o*o),r=new THREE.Vector2(b,c);k.sub(r),k.x*=g,k.y*=f;var s=this.snapper.angleVector2(k);if(e>2*Math.PI&&(e=2*Math.PI),p>=1&&q<=1&&(e>d&&s>=d&&s<=e||e<d&&(s>=d||s<=e))){var t=new THREE.EllipseCurve(b,c,f,g,d,e,!1),u=new THREE.Path(t.getPoints(50)),v=u.createPointsGeometry(50);a(e-d,2*Math.PI)||v.vertices.pop(),v.applyMatrix((new THREE.Matrix4).makeTranslation(0,0,j.z)),this.ellipticalArc=v,this.ellipticalArcCenter=new THREE.Vector3(b,c,j.z),this.vpIdElliptical=i}},this.snapping2D=function(a){if(a){var b=a.intersectPoint,c=a.fragId;if(void 0!==c){Array.isArray(c)||(c=[c]),l.hasTopology=!1,l.intersectPoint=b,l.radius=this.setDetectRadius(b);if(!(null!=m.model.getFragmentList()))return t=!0,l.geomType=g.SnapType.SNAP_VERTEX,void(l.geomVertex=b);for(var d=new j(m,this,l.radius),e=0;e<c.length;++e){var h=m.impl.getRenderProxy(m.model,c[e]);if(h&&h.geometry){new f.VertexBufferReader(h.geometry,m.impl.use2dInstancing).enumGeomsForObject(a.dbId,d)}}if(d.circularArc){if(l.viewportIndex2d=d.vpIdCircular,null!==u&&u!==l.viewportIndex2d)return;b.distanceTo(d.circularArc.vertices[0])<l.radius?(l.geomVertex=d.circularArc.vertices[0],l.geomType=g.SnapType.SNAP_VERTEX):b.distanceTo(d.circularArc.vertices[d.circularArc.vertices.length-1])<l.radius?(l.geomVertex=d.circularArc.vertices[d.circularArc.vertices.length-1],l.geomType=g.SnapType.SNAP_VERTEX):(this.lineStripToPieces(d.circularArc),l.geomEdge=d.circularArc,l.circularArcCenter=d.circularArcCenter,l.circularArcRadius=d.circularArcRadius,l.geomType=g.SnapType.SNAP_CIRCULARARC),t=!0}else if(d.ellipticalArc){if(l.viewportIndex2d=d.vpIdElliptical,null!==u&&u!==l.viewportIndex2d)return;b.distanceTo(d.ellipticalArc.vertices[0])<l.radius?(l.geomVertex=d.ellipticalArc.vertices[0],l.geomType=g.SnapType.SNAP_VERTEX):b.distanceTo(d.ellipticalArc.vertices[d.ellipticalArc.vertices.length-1])<l.radius?(l.geomVertex=d.ellipticalArc.vertices[d.ellipticalArc.vertices.length-1],l.geomType=g.SnapType.SNAP_VERTEX):(this.lineStripToPieces(d.ellipticalArc),l.geomEdge=d.ellipticalArc,l.circularArcCenter=d.ellipticalArcCenter,l.circularArcRadius=null,l.geomType=g.SnapType.SNAP_CIRCULARARC),t=!0}else if(d.lineGeom.vertices.length){if(l.viewportIndex2d=d.vpIdLine,null!==u&&u!==l.viewportIndex2d)return;if(this.markupMode){var i=d.lineGeom.vertices[0],k=d.lineGeom.vertices[1],o=new THREE.Vector3;o.addVectors(i,k),o.divideScalar(2);var p=b.distanceTo(o),q=b.distanceTo(i),r=b.distanceTo(k);l.geomEdge=d.lineGeom,p<l.radius?(l.geomVertex=o,l.geomType=g.SnapType.SNAP_VERTEX):q<l.radius?(l.geomVertex=i,l.geomType=g.SnapType.SNAP_VERTEX):r<l.radius?(l.geomVertex=k,l.geomType=g.SnapType.SNAP_VERTEX):l.geomType=g.SnapType.SNAP_EDGE,d.lineGeom.vertices[0].distanceTo(d.lineGeom.vertices[1])<g.EPSILON&&(l.geomType=g.SnapType.SNAP_CIRCLE_CENTER)}else b.distanceTo(d.lineGeom.vertices[0])<l.radius?(d.lineGeom.vertices[0].distanceTo(d.lineGeom.vertices[1])<g.EPSILON?l.geomType=g.SnapType.SNAP_CIRCLE_CENTER:l.geomType=g.SnapType.SNAP_VERTEX,l.geomVertex=d.lineGeom.vertices[0]):n.forceSnapVertices||b.distanceTo(d.lineGeom.vertices[1])<l.radius?(l.geomVertex=d.lineGeom.vertices[1],l.geomType=g.SnapType.SNAP_VERTEX):(l.geomEdge=d.lineGeom,l.geomType=g.SnapType.SNAP_EDGE);t=!0}}}},this.snappingLeaflet=function(a){if(a){var b=a.intersectPoint;l.intersectPoint=b,l.hasTopology=!1,l.radius=this.setDetectRadius(b),l.geomType=g.SnapType.SNAP_VERTEX,l.geomVertex=b,t=!0}},this.snapMidpoint=function(){if(l.isMidpoint=!1,t&&l.geomType===g.SnapType.SNAP_EDGE){var a=l.geomEdge,b=a.vertices[0],c=a.vertices[1],d=new THREE.Vector3((b.x+c.x)/2,(b.y+c.y)/2,(b.z+c.z)/2);l.intersectPoint.distanceTo(d)<2*l.radius&&(l.geomVertex=d,l.geomType=g.SnapType.SNAP_MIDPOINT)}},this.setPerpendicular=function(a){l.isPerpendicular=a},this.lineStripToPieces=function(a){for(var b=a.vertices,c=b.length-2;c>0;c--)b.splice(c,0,b[c])},this.setDetectRadius=function(a){var b=e.isMobileDevice()?50:10,c=m.navigation,d=c.getCamera(),f=c.getPosition(),g=a.clone(),h=d.isPerspective?g.sub(f).length():c.getEyeVector().length(),i=c.getVerticalFov(),j=2*h*Math.tan(THREE.Math.degToRad(.5*i)),k=c.getScreenViewport(),l=window.devicePixelRatio||1;return b*j/(k.height*l)},this.handleButtonDown=function(a,b){return r=!0,!1},this.handleButtonUp=function(a,b){return r=!1,!1},this.handleMouseMove=function(a){return!r&&(this.onMouseMove({x:a.canvasX,y:a.canvasY}),!1)},this.handleSingleTap=function(a){return this.handleMouseMove(a)},this.handlePressHold=function(a){if(e.isMobileDevice())switch(a.type){case"press":s=!0,this.onMouseMove({x:a.canvasX,y:a.canvasY});break;case"pressup":this.onMouseMove({x:a.canvasX,y:a.canvasY}),s=!1}return!1},this.handleGesture=function(a){if(e.isMobileDevice()&&s)switch(a.type){case"dragstart":case"dragmove":this.onMouseMove({x:a.canvasX,y:a.canvasY});break;case"dragend":this.onMouseMove({x:a.canvasX,y:a.canvasY}),s=!1}return!1},this.onMouseDown=function(a){return this.onMouseMove(a)},this.onMouseMove=function(a){this.clearSnapped();var b=m.impl.snappingHitTest(a.x,a.y,!1);return!(!b||!b.intersectPoint)&&(b.face?this.snapping3D(b):b.dbId||0===b.dbId?this.snapping2D(b):this.snappingLeaflet(b),this.snapMidpoint(),!0)}}var e=Autodesk.Viewing,f=Autodesk.Viewing.Private,g=AutodeskNamespace("Autodesk.Viewing.MeasureCommon"),h=.001;g.Snapper=d}(),function(){"use strict";function a(a,b){this.viewer=a,this.snapper=b,this.overlayType=c,this.previewsIntersectPoint=null,this.viewer.impl.createOverlayScene(d),this.viewer.impl.createOverlayScene(e),this.geometryMaterial=new THREE.MeshPhongMaterial({color:h,ambient:h,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),this.indicatorMaterial=new THREE.MeshBasicMaterial({color:g,ambient:g,opacity:1,transparent:!1,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide})}var b=Autodesk.Viewing.MeasureCommon,c=0,d="MeasureTool-snapper-geometries",e="MeasureTool-snapper-indicator",f=null,g=16742144,h=52224;a.prototype.constructor=a;var i=a.prototype;i.render=function(){var a=this.snapper.getSnapResult();b.isEqualVectors(this.previewsIntersectPoint,a.intersectPoint,b.EPSILON)||this.clearOverlay(d),this.clearOverlay(e),a.isEmpty()||(this.renderIndicator(a),this.previewsIntersectPoint=a.intersectPoint.clone())},i.removeOverlay=function(a){this.viewer.impl.clearOverlay(a),this.viewer.impl.removeOverlayScene(a)},i.clearOverlay=function(a){this.removeOverlay(a),this.viewer.impl.createOverlayScene(a)},i.clearOverlays=function(){this.removeOverlay(d),this.viewer.impl.createOverlayScene(d),this.removeOverlay(e),this.viewer.impl.createOverlayScene(e),this.previewsIntersectPoint=null},i.addOverlay=function(a,b){this.viewer.impl.addOverlay(a,b)},i.drawFace=function(a,b,c){var e=new THREE.Mesh(a,b,!0);c===d&&(this.overlayType=1),this.addOverlay(c,e)},i.cylinderMesh=function(a,b,c,d){var e=(new THREE.Vector3).subVectors(b,a),f=new THREE.Matrix4;f.lookAt(a,b,(new THREE.Object3D).up),f.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-e.length(),0,0,0,0,0,1)),d=d||.5;var g=new THREE.CylinderGeometry(d,d,1,8,1,!0),h=new THREE.Mesh(g,c);return g=null,h.applyMatrix(f),h.position.x=(b.x+a.x)/2,h.position.y=(b.y+a.y)/2,h.position.z=(b.z+a.z)/2,h},i.renderGeometry=function(a){if(!b.isEqualVectors(this.previewsIntersectPoint,a.intersectPoint,b.EPSILON))switch(a.geomType){case b.SnapType.SNAP_VERTEX:this.drawPoint(a.geomVertex,this.geometryMaterial,d);break;case b.SnapType.SNAP_EDGE:case b.SnapType.SNAP_CURVEDEDGE:case b.SnapType.SNAP_CIRCULARARC:case b.SnapType.SNAP_MIDPOINT:this.drawLine(a.geomEdge,this.geometryMaterial,.3,d);break;case b.SnapType.SNAP_FACE:case b.SnapType.SNAP_CURVEDFACE:this.drawFace(a.geomFace,this.geometryMaterial,d)}},i.renderVertexIndicator=function(a){var c=b.getSnapResultPosition(a,this.viewer),d=this.setScale(c),f=1.2*d,g=this.viewer.navigation.getCameraRightVector().multiplyScalar(f),h=this.viewer.navigation.getCameraUpVector().multiplyScalar(f),i=new THREE.Geometry,j=new THREE.Vector3;j.addVectors(c,g),j.addVectors(j,h),i.vertices[0]=j.clone(),j.subVectors(c,g),j.addVectors(j,h),i.vertices[1]=j.clone(),this.drawLine(i,this.indicatorMaterial,.2,e),j.addVectors(c,g),j.subVectors(j,h),i.vertices[0]=j.clone(),j.subVectors(c,g),j.subVectors(j,h),i.vertices[1]=j.clone(),this.drawLine(i,this.indicatorMaterial,.2,e),j.subVectors(c,g),j.subVectors(j,h),i.vertices[0]=j.clone(),j.subVectors(c,g),j.addVectors(j,h),i.vertices[1]=j.clone(),this.drawLine(i,this.indicatorMaterial,.2,e),j.addVectors(c,g),j.subVectors(j,h),i.vertices[0]=j.clone(),j.addVectors(c,g),j.addVectors(j,h),i.vertices[1]=j.clone(),this.drawLine(i,this.indicatorMaterial,.2,e)},i.renderMidpointIndicator=function(a){var b=a.geomVertex,c=this.setScale(b),d=1.2*c,f=this.viewer.navigation.getCameraRightVector().multiplyScalar(d),g=this.viewer.navigation.getCameraUpVector().multiplyScalar(d),h=new THREE.Geometry,i=new THREE.Vector3;i.addVectors(b,f),i.subVectors(i,g),h.vertices[0]=i.clone(),i.subVectors(b,f),i.subVectors(i,g),h.vertices[1]=i.clone(),this.drawLine(h,this.indicatorMaterial,.2,e),i.subVectors(b,f),i.subVectors(i,g),h.vertices[0]=i.clone(),i.addVectors(b,g),h.vertices[1]=i.clone(),this.drawLine(h,this.indicatorMaterial,.2,e),i.addVectors(b,f),i.subVectors(i,g),h.vertices[0]=i.clone(),i.addVectors(b,g),h.vertices[1]=i.clone(),this.drawLine(h,this.indicatorMaterial,.2,e)},i.renderEdgeIndicator=function(a){var c=b.getSnapResultPosition(a,this.viewer),d=this.setScale(c),f=1.2*d,g=this.viewer.navigation.getCameraRightVector().multiplyScalar(f),h=this.viewer.navigation.getCameraUpVector().multiplyScalar(f),i=new THREE.Geometry,j=new THREE.Vector3;j.addVectors(c,g),j.subVectors(j,h),i.vertices[0]=j.clone(),i.vertices[1]=c.clone(),this.drawLine(i,this.indicatorMaterial,.2,e),j.subVectors(c,g),j.subVectors(j,h),i.vertices[0]=j.clone(),i.vertices[1]=c.clone(),this.drawLine(i,this.indicatorMaterial,.2,e),j.addVectors(c,h),i.vertices[0]=j.clone(),i.vertices[1]=c.clone(),this.drawLine(i,this.indicatorMaterial,.2,e)},i.renderCircleIndicator=function(a){var c=b.getSnapResultPosition(a,this.viewer);this.drawCircle(c,this.indicatorMaterial,e)},i.renderPerpendicular=function(a){var c=b.getSnapResultPosition(a,this.viewer),d=this.setScale(c),f=1.2*d,g=this.viewer.navigation.getCameraRightVector().multiplyScalar(f),h=this.viewer.navigation.getCameraUpVector().multiplyScalar(f),i=new THREE.Geometry,j=new THREE.Vector3;i.vertices[0]=c.clone(),j.subVectors(c,g),i.vertices[1]=j.clone(),this.drawLine(i,this.indicatorMaterial,.2,e),j.addVectors(c,g),j.subVectors(j,h),i.vertices[0]=j.clone(),j.subVectors(c,g),j.subVectors(j,h),i.vertices[1]=j.clone(),this.drawLine(i,this.indicatorMaterial,.2,e),j.subVectors(c,g),j.subVectors(j,h),i.vertices[0]=j.clone(),j.subVectors(c,g),j.addVectors(j,h),i.vertices[1]=j.clone(),this.drawLine(i,this.indicatorMaterial,.2,e),i.vertices[0]=c.clone(),j.subVectors(c,h),i.vertices[1]=j.clone(),this.drawLine(i,this.indicatorMaterial,.2,e)},i.renderIndicator=function(a){if(a.isPerpendicular)return void this.renderPerpendicular(a);switch(a.geomType){case b.SnapType.SNAP_VERTEX:this.renderVertexIndicator(a);break;case b.SnapType.SNAP_MIDPOINT:this.renderMidpointIndicator(a);break;case b.SnapType.SNAP_CIRCLE_CENTER:this.renderCircleIndicator(a);break;case b.SnapType.SNAP_EDGE:case b.SnapType.SNAP_CURVEDEDGE:this.renderEdgeIndicator(a);break;case b.SnapType.SNAP_CIRCULARARC:this.viewer.model.is2d()?this.renderVertexIndicator(a):this.renderCircleIndicator(a);break;case b.SnapType.SNAP_FACE:case b.SnapType.SNAP_CURVEDFACE:this.renderVertexIndicator(a)}},i.drawLine=function(a,b,c,e){e===d&&(this.overlayType=2);for(var f=0;f<a.vertices.length;f+=2){var g=this.cylinderMesh(a.vertices[f],a.vertices[f+1],b,c);this.setEdgeScale(g),this.addOverlay(e,g)}},i.drawPoint=function(a,b,c){if(!this.viewer.model.getData().isLeaflet){f||(f=new THREE.SphereGeometry(1));var e=new THREE.Mesh(f,b);e.position.set(a.x,a.y,a.z),this.setPointScale(e),c===d&&(this.overlayType=3),this.addOverlay(c,e)}},i.drawCircle=function(a,b,c){var d=new THREE.TorusGeometry(1.2,.2,2,20),e=new THREE.Mesh(d,b);e.lookAt(this.viewer.navigation.getEyeVector().normalize()),d=null,e.position.set(a.x,a.y,a.z),this.setCircleScale(e),this.addOverlay(c,e)},i.setScale=function(a){var b=this.viewer.navigation,c=b.getCamera(),d=b.getPosition(),e=a.clone(),f=c.isPerspective?e.sub(d).length():b.getEyeVector().length(),g=b.getVerticalFov();return 2*f*Math.tan(THREE.Math.degToRad(.5*g))*5/b.getScreenViewport().height},i.setPointScale=function(a){var b=this.setScale(a.position);a.scale.x=b,a.scale.y=b,a.scale.z=b},i.setCircleScale=function(a){var b=this.setScale(a.position);a.scale.x=b,a.scale.y=b},i.setEdgeScale=function(a){var b=this.setScale(a.position);a.scale.x=b,a.scale.z=b},i.updatePointScale=function(a){if(3==this.overlayType){var b=this.viewer.impl.overlayScenes[a];if(b)for(var c=b.scene,d=0;d<c.children.length;d++){var e=c.children[d];e&&this.setPointScale(e)}}},i.updateEdgeScale=function(a){if(2==this.overlayType){var b=this.viewer.impl.overlayScenes[a];if(b)for(var c=b.scene,d=0;d<c.children.length;d++){var e=c.children[d];e&&this.setEdgeScale(e)}}},i.onCameraChange=function(){this.updatePointScale(d),this.updateEdgeScale(d),this.render()},i.destroy=function(){this.removeOverlay(d),this.removeOverlay(e),f&&(f.dispose(),f=null)},b.SnapperIndicator=a}(),function(){"use strict";Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Viewing.Wireframes","extensions/Wireframes/Wireframes.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Viewing.MarkupsCore","extensions/Markups/Markups.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Viewing.MarkupsGui","extensions/Markups/MarkupsGui.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Billboard","extensions/Billboard/Billboard.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.BillboardGui","extensions/Billboard/Billboard.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Viewing.Comments","extensions/Comments/Comments.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.InViewerSearch","extensions/InViewerSearch/InViewerSearch.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Viewing.WebVR","extensions/WebVR/WebVR.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Viewing.MemoryManager","extensions/MemoryManager/MemoryManager.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Viewing.MemoryManager","extensions/MemoryManager/MemoryManager.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Beeline","extensions/Beeline/Beeline.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.FirstPerson","extensions/FirstPerson/FirstPerson.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.BimWalk","extensions/BimWalk/BimWalk.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Viewing.ScalarisSimulation","extensions/ScalarisSimulation/ScalarisSimulation.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Debug","extensions/Debug/Debug.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.ModelStructure","extensions/ModelStructure/ModelStructure.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.LayerManager","extensions/LayerManager/LayerManager.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.ViewerSettings","extensions/ViewerSettings/ViewerSettings.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.PropertiesManager","extensions/PropertiesManager/PropertiesManager.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.FullScreen","extensions/FullScreen/FullScreen.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Explode","extensions/Explode/Explode.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Section","extensions/Section/Section.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Measure","extensions/Measure/Measure.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Hyperlink","extensions/Hyperlink/Hyperlink.min.js"),Autodesk.Viewing.theExtensionManager.registerExternalExtension("Autodesk.Viewing.PixelCompare","extensions/PixelCompare/PixelCompare.min.js")}(),function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.name="cam360"}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.CAM360");a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a,a.prototype.load=function(){function a(){c.impl.setLightPreset(0,!0),c.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a)}var c=this.viewer,d=new b.CAMModelStructurePanel(this.viewer,"CAM Model Structure Loading",{});return c.setModelStructurePanel(d),c.hideLines(!1),c.setGhosting(!1),c.setQualityLevel(!1,!0),c.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a),!0},a.prototype.unload=function(){this.viewer.setModelStructurePanel(null)},a.prototype.activate=function(){return this.activeStatus||(this.viewer.showModelStructurePanel(!0),this.activeStatus=!0),!0},a.prototype.deactivate=function(){return this.activeStatus&&(this.viewer.showModelStructurePanel(!1),this.activeStatus=!1),!0},b.CAM360Extension=a,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.CAM360",b.CAM360Extension)}(),function(){"use strict";function a(a,b,d){c.ViewerModelStructurePanel.call(this,a,b,d),this.viewer=a,this.delegate=null,this.instanceTree=null,this.model=null,this.camNodes=[],this.camModelNodes=[],this.camSetupNodes=[],this.camStockNodes=[],this.camOperationNodes=[],this.camToolNodes=[],this.camFolderNodes=[]}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.CAM360"),c=Autodesk.Viewing.Extensions;a.prototype=Object.create(c.ViewerModelStructurePanel.prototype),a.prototype.constructor=a,a.prototype.sortCamNodes=function(a,b){function c(a,b){function c(a,b){for(var c=0;c<a.length;++c){var d=a[c];if(d.displayName===b)return d.displayValue}return null}function d(d){var f=c(d.properties,"9429B915-D020-4CEB-971B-6ADD0A5D4BFA");f?("CAM_Setup"==f?e.camSetupNodes.push(a):"CAM_Operation"==f?e.camOperationNodes.push(a):"CAM_Tool"===f?e.camToolNodes.push(a):"CAM_Stock"===f?e.camStockNodes.push(a):"CAM_Folder"==f&&e.camFolderNodes.push(a),e.camNodes.push(a)):e.camModelNodes.push(a),b()}function f(a,c,d){b()}e.viewer.getProperties(a,d,f)}function d(){f.length>0?c(f.shift(),d):b()}var e=this,f=[];a.enumNodeChildren(a.getRootId(),function(a){f.push(a)},!0),f.shift(),d()},a.prototype.addModel=function(a){this.model=a,this.setVisible(!0),c.ViewerModelStructurePanel.prototype.addModel.call(this,a)},a.prototype.setInstanceTree=function(a,b){if(c.ViewerModelStructurePanel.prototype.setInstanceTree.call(this,a,b),b){this.delegate=a,this.instanceTree=b;var d=this;d.sortCamNodes(b,function(){d.SetCAMNodeVisible(!1),d.setVisible(!0),d.ExpandSetupNodes(),d.resizeToContent()})}},a.prototype.initialize=function(){function a(c){b.SetCAMNodeVisible(!1),b.removeEventListener(b.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a)}c.ViewerModelStructurePanel.prototype.initialize.call(this);var b=this;this.viewer.model&&this.viewer.model.isLoadDone()||b.addEventListener(b.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a),b.addEventListener(b.viewer,Autodesk.Viewing.SHOW_EVENT,function(a){var c=a.nodeIdArray;if(c)for(var d=0;d<c.length;d++)b.setCamNodeVisibility(c[d])}),b.addEventListener(b.viewer,Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){var c=a.nodeArray
;if(c)for(var d=0;d<c.length;d++)b.HideHightlightCAMNode(c[d])}),b.addEventListener(b.viewer,Autodesk.Viewing.ISOLATE_EVENT,function(a){var c=a.nodeIdArray;if(c)if(0==c.length)b.SetModelVisible(),b.SetCAMNodeVisible(!0);else for(var d=0;d<c.length;d++)b.setCamNodeVisibility(c[d])})},a.prototype.IsCAMNode=function(a){return-1!==this.camNodes.indexOf(a)},a.prototype.IsCAMSetupNode=function(a){return-1!==this.camSetupNodes.indexOf(a)},a.prototype.IsCAMStockNode=function(a){return-1!==this.camStockNodes.indexOf(a)},a.prototype.IsCAMToolNode=function(a){return-1!==this.camToolNodes.indexOf(a)},a.prototype.IsCAMOperationNode=function(a){return-1!==this.camOperationNodes.indexOf(a)},a.prototype.IsCAMFolderNode=function(a){return-1!==this.camFolderNodes.indexOf(a)},a.prototype.shouldInclude=function(a){return!this.IsCAMStockNode(a)},a.prototype.isGroupNode=function(a){return!this.IsCAMOperationNode(a)&&c.ViewerModelStructurePanel.prototype.isGroupNode.call(this,a)},a.prototype.setNodeVisibility=function(a,b){b?this.viewer.show(a):this.viewer.hide(a)},a.prototype.SetModelVisible=function(){if(this.camModelNodes)for(var a=0;a<this.camModelNodes.length;a++)this.setNodeVisibility(this.camModelNodes[a],!0)},a.prototype.SetCAMNodeVisible=function(a){if(this.camNodes){for(var b=0;b<this.camNodes.length;b++)this.setNodeVisibility(this.camNodes[b],a);this.SetToolNodeVisible(!1)}},a.prototype.SetToolNodeVisible=function(a){if(this.camToolNodes)for(var b=0;b<this.camToolNodes.length;b++)this.setNodeVisibility(this.camToolNodes[b],a)},a.prototype.HideHightlightNode=function(a){var b=this.viewer.impl,c=this;c.instanceTree.enumNodeFragments(a,function(a){b.highlightFragment(c.model,a,!1)},!0)},a.prototype.HideHightlightCAMNode=function(a){var b=this.IsCAMSetupNode(a),c=this.IsCAMOperationNode(a),d=this.IsCAMFolderNode(a),e=this;e.instanceTree.enumNodeChildren(a,function(a){b?e.IsCAMStockNode(a)||e.HideHightlightNode(a):c?e.IsCAMToolNode(a)&&e.HideHightlightNode(a):d&&e.HideHightlightNode(a)},!1)},a.prototype.setCamNodeVisibility=function(a){var b=this.IsCAMSetupNode(a),c=this.IsCAMOperationNode(a),d=this.IsCAMFolderNode(a),e=this;b?this.instanceTree.enumNodeChildren(a,function(a){var b=e.IsCAMStockNode(a);e.setNodeVisibility(a,b)}):c?this.instanceTree.enumNodeChildren(a,function(a){e.IsCAMToolNode(a)&&e.setNodeVisibility(a,!1)}):d&&this.instanceTree.enumNodeChildren(a,function(a){e.setNodeVisibility(a,!1)})},a.prototype.onClick=function(a,b){c.ViewerModelStructurePanel.prototype.onClick.call(this,a,b),this.SetModelVisible(),this.setCamNodeVisibility(a),this.viewer.fitToView()},a.prototype.ExpandSetupNodes=function(){if(this.camSetupNodes)for(var a=0;a<this.camSetupNodes.length;a++)this.tree.setCollapsed(this.delegate,this.camSetupNodes[a],!1)},b.CAMModelStructurePanel=a}(),function(){"use strict";function a(a){var b="";a<0&&(b="-",a=-a);var c=~~(a/3600),d=~~(a%3600/60),e=a%60,f=b;return c>0&&(f+=c+":"+(d<10?"0":"")),f+=d+":"+(e<10?"0":""),f+=e.toFixed(2)}var b=Autodesk.Viewing,c=b.UI;b.ANIMATION_PLAY_EVENT="animationPlayEvent",b.ANIMATION_PAUSE_EVENT="animationPauseEvent",b.ANIMATION_SEEK_EVENT="animationSeekEvent",b.ANIMATION_PREVIOUS_FRAME_EVENT="animationPreviousFrameEvent",b.ANIMATION_NEXT_FRAME_EVENT="animationNextFrameEvent",b.ANIMATION_TRACK_UPDATE_EVENT="animationTrackUpdateEvent",b.ANIMATION_TOOLBAR_CLOSE_EVENT="animationToolbarCloseEvent";var d=function(a,c){b.Extension.call(this,a,c),this.viewer=a,this.animTools=null,this.animToolsId="animationTools",this.playButton=null,this.playButtonIsPaused=!0,this.prevAnimationTime=-1,this.name="fusionanimation"};d.prototype=Object.create(b.Extension.prototype),d.prototype.constructor=d,d.prototype.load=function(){var a=this.viewer;return this.onPlayCallbackBinded=this.onPlayCallback.bind(this),this.onCameraChangeBinded=this.onCameraChange.bind(this),this.onExplodeBinded=this.onExplode.bind(this),this.onResizeBinded=this.onResize.bind(this),this.onEscapeBinded=this.onEscape.bind(this),a.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),a.addEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT,this.onExplodeBinded),a.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResizeBinded),a.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,this.onEscapeBinded),a.model&&a.model.isObjectTreeCreated()?this.onAnimationReady():(this.onAnimationReadyBinded=this.onAnimationReady.bind(this),a.addEventListener(Autodesk.Viewing.ANIMATION_READY_EVENT,this.onAnimationReadyBinded)),!0},d.prototype.unload=function(){var a=this.viewer;if(this.onAnimationReadyBinded&&(a.removeEventListener(Autodesk.Viewing.ANIMATION_READY_EVENT,this.onAnimationReadyBinded),this.onAnimationReadyBinded=null),this.rewind(),a.impl.invalidate(!0,!0,!0),this.onPlayCallbackBinded=null,this.animTools&&(this.animTools.removeControl(this.animTools.timeText.getId()),this.animTools.removeControl(this.animTools.timeline.getId()),this.animTools.removeControl(this.animTools.timeLeftText.getId()),this.animTools.removeControl(this.animTools.forwardButton.getId()),this.animTools.removeControl(this.animTools.backwardButton.getId()),this.animTools.removeControl(this.animTools.closeButton.getId())),this.toolbar&&(this.toolbar.removeControl(this.animTools),this.toolbar.container.parentNode.removeChild(this.toolbar.container),this.toolbar=null),this.playButton){var c=a.getToolbar(!1);c&&c.getControl(b.TOOLBAR.MODELTOOLSID).removeControl(this.playButton.getId())}return a.removeEventListener(b.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),a.removeEventListener(b.EXPLODE_CHANGE_EVENT,this.onExplodeBinded),a.removeEventListener(b.VIEWER_RESIZE_EVENT,this.onResizeBinded),a.removeEventListener(b.ESCAPE_EVENT,this.onEscapeBinded),this.onToolbarCreatedBinded&&(a.removeEventListener(b.TOOLBAR_CREATED_EVENT,this.onToolbarCreatedBinded),this.onToolbarCreatedBinded=null),!0},d.prototype.play=function(){if(!this.isPlaying()){this.resetExplode(0,!0);var a=this.viewer,b=a.impl.keyFrameAnimator;b&&(this.prevAnimationTime>0&&(b.goto(this.prevAnimationTime),this.prevAnimationTime=-1),b.play(0,this.onPlayCallbackBinded),this.updatePlayButton(b.isPaused),this.animTools&&(this.animTools.setVisible(!0),this.animTools.isPositionAdjusted||(this.adjustToolbarPosition(),this.animTools.isPositionAdjusted=!0)))}},d.prototype.pause=function(){if(!this.isPaused()){var a=this.viewer.impl.keyFrameAnimator;a&&(a.pause(),this.updatePlayButton(a.isPaused))}},d.prototype.isPlaying=function(){var a=this.viewer.impl.keyFrameAnimator;return!!a&&(a.isPlaying&&!a.isPaused)},d.prototype.isPaused=function(){var a=this.viewer.impl.keyFrameAnimator;return!!a&&a.isPaused},d.prototype.rewind=function(){this.setTimelineValue(0)},d.prototype.setTimelineValue=function(a){var b=this.viewer.impl.keyFrameAnimator;if(b){a=Math.min(Math.max(0,a),1);var c=a*b.duration;b.goto(c),this.updateUI()}},d.prototype.prevKeyframe=function(){var a=this.viewer.impl.keyFrameAnimator;a&&(a.prev(),this.updateUI())},d.prototype.nextKeyframe=function(){var a=this.viewer.impl.keyFrameAnimator;a&&(a.next(),this.updateUI())},d.prototype.getDuration=function(){var a=this.viewer.impl.keyFrameAnimator;return a?a.duration:0},d.prototype.getDurationLabel=function(){return a(this.getDuration())},d.prototype.getCurrentTime=function(){var a=this.viewer.impl.keyFrameAnimator;return a?a.currentTime:0},d.prototype.getCurrentTimeLabel=function(){return a(this.getCurrentTime())},d.prototype.onAnimationReady=function(){var a=this.viewer;this.onAnimationReadyBinded&&(a.removeEventListener(Autodesk.Viewing.ANIMATION_READY_EVENT,this.onAnimationReadyBinded),this.onAnimationReadyBinded=null),a.impl.keyFrameAnimator&&(a.toolbar&&a.modelTools?this.onToolbarCreated():(this.onToolbarCreatedBinded=this.onToolbarCreated.bind(this),a.addEventListener(b.TOOLBAR_CREATED_EVENT,this.onToolbarCreatedBinded)))},d.prototype.updateUI=function(){var b=this.viewer.impl.keyFrameAnimator;this.animTools&&b&&(this.animTools.input.value=b.duration>0?b.currentTime/b.duration*100:0,this.animTools.lapse.value=a(b.currentTime),this.animTools.lapseLeft.value=a(b.duration),this.updatePlayButton(b.isPaused),this.updateToolbarBackground())},d.prototype.onPlayCallback=function(c){if(this.animTools){var d=this.viewer.impl.keyFrameAnimator;this.viewer.dispatchEvent({type:b.ANIMATION_TRACK_UPDATE_EVENT,data:{time:d.currentTime,duration:d.duration}}),this.animTools.input.value=c,this.animTools.lapse.value=a(d.currentTime),this.animTools.lapseLeft.value=a(d.duration),c>=100&&this.updatePlayButton(!0),this.updateToolbarBackground()}},d.prototype.updatePlayButton=function(a){if(this.playButton&&a!==this.playButtonIsPaused){this.playButtonIsPaused=a;var c=this.viewer.impl.keyFrameAnimator;a?(this.playButton.setIcon("toolbar-animation-play-icon"),this.playButton.setToolTip("Play"),this.viewer.dispatchEvent({type:b.ANIMATION_PAUSE_EVENT,data:{time:c.currentTime,duration:c.duration}})):(this.playButton.setIcon("toolbar-animation-pause-icon"),this.playButton.setToolTip("Pause"),this.viewer.dispatchEvent({type:b.ANIMATION_PLAY_EVENT,data:{time:c.currentTime,duration:c.duration}}))}},d.prototype.resetExplode=function(a,b){var c=this.viewer;c.model.is2d()||0===c.getExplodeScale()||(b&&c.explodeSlider&&(c.explodeSlider.value=a),c.explode(a))},d.prototype.adjustToolbarPosition=function(){var a=this.viewer;if(a.toolbar){var b=a.toolbar.getDimensions().width;b>a.container.getBoundingClientRect().width&&(b=a.modelTools.getDimensions().width);var c=b-(2*this.animTools.backwardButton.getDimensions().width+3*this.animTools.timeText.getDimensions().width+this.animTools.closeButton.getDimensions().width+20);this.animTools.input.style.width=c+"px"}},d.prototype.hideAnimateToolbar=function(){this.animTools&&this.animTools.setVisible(!1)},d.prototype.updateToolbarBackground=function(){if(this.animTools){var a=this.animTools.input,b=a.value,c="#393939";a.style.background="-webkit-linear-gradient(left,#ffffff "+b+"%, "+c+" "+b+"%)",a.style.background="-moz-linear-gradient(left,#ffffff "+b+"%, "+c+" "+b+"%)",a.style.background="-ms-linear-gradient(left,#ffffff "+b+"%, "+c+" "+b+"%)",a.style.background="-o-linear-gradient(left,#ffffff "+b+"%, "+c+" "+b+"%)",a.style.background="linear-gradient(to right,#ffffff "+b+"%, "+c+" "+b+"%)"}},d.prototype.onCameraChange=function(){if(this.viewer.toolController.cameraUpdated){var a=this.viewer.impl.keyFrameAnimator;if(!a)return;a.isPlaying&&!a.isPaused&&(a.pause(),this.updatePlayButton(a.isPaused))}},d.prototype.onResize=function(){this.toolbar&&(this.viewer.container.clientWidth<(b.isTouchDevice()?560:600)?this.toolbar.setCollapsed(!0):(this.toolbar.setCollapsed(!1),this.adjustToolbarPosition()))},d.prototype.onEscape=function(){this.isPlaying()?this.pause():this.hideAnimateToolbar()},d.prototype.onExplode=function(){var a=this.viewer.impl.keyFrameAnimator;a&&(0!==a.currentTime&&(this.prevAnimationTime=a.currentTime,a.goto(0)),this.updatePlayButton(!0)),this.hideAnimateToolbar()},d.prototype.onToolbarCreated=function(){var d=this.viewer,e=this;this.onToolbarCreatedBinded&&(d.removeEventListener(b.TOOLBAR_CREATED_EVENT,this.onToolbarCreatedBinded),this.onToolbarCreatedBinded=null),this.toolbar=new c.ToolBar("animation-toolbar"),this.toolbar.addClass("toolbar-animation-subtoolbar"),d.container.appendChild(this.toolbar.container),this.animTools=new c.ControlGroup(this.animToolsId),this.animTools.setVisible(!1),this.toolbar.addControl(this.animTools),this.playButton=new c.Button("toolbar-animationPlay"),this.playButton.setIcon("toolbar-animation-play-icon"),this.playButton.setToolTip("Play"),this.playButton.onClick=function(){e.isPaused()?e.activate():e.deactivate()},d.modelTools.addControl(this.playButton),d.modelTools.resetModelButton&&(d.modelTools.resetModelButton.onClick=function(b){d.showAll();var c=d.impl.keyFrameAnimator;c&&(c.goto(0),g.value=0,f.value=a(0),i.value=a(c.duration),e.updatePlayButton(!0)),e.resetExplode(0,!0),e.updateToolbarBackground()}),this.animTools.backwardButton=new c.Button("toolbar-animationBackward"),this.animTools.backwardButton.setToolTip("Previous keyframe"),this.animTools.backwardButton.onClick=function(a){var c=d.impl.keyFrameAnimator;void 0!==c&&c&&(c.prev(),d.dispatchEvent({type:b.ANIMATION_PREVIOUS_FRAME_EVENT,data:{time:c.currentTime,duration:c.duration}}),e.updateUI())},this.animTools.backwardButton.addClass("toolbar-animation-button"),this.animTools.backwardButton.setIcon("toolbar-animation-backward-icon"),this.animTools.addControl(this.animTools.backwardButton),this.animTools.forwardButton=new c.Button("toolbar-animationForward"),this.animTools.forwardButton.setToolTip("Next keyframe"),this.animTools.forwardButton.onClick=function(a){var c=d.impl.keyFrameAnimator;void 0!==c&&c&&(c.next(),d.dispatchEvent({type:b.ANIMATION_NEXT_FRAME_EVENT,data:{time:c.currentTime,duration:c.duration}}),e.updateUI())},this.animTools.forwardButton.addClass("toolbar-animation-button"),this.animTools.forwardButton.setIcon("toolbar-animation-forward-icon"),this.animTools.addControl(this.animTools.forwardButton),this.animTools.timeText=new c.Control("toolbar-animation-time-lapse");var f=this.animTools.lapse=document.createElement("input");f.type="text",f.value="0",f.className="animation-time-lapse",f.disabled=!0,this.animTools.timeText.container.appendChild(f),this.animTools.timeText.addClass("toolbar-animation-button"),this.animTools.addControl(this.animTools.timeText),this.animTools.timeline=new c.Control("toolbar-animation-timeline");var g=this.animTools.input=document.createElement("input");g.type="range",g.value="0",g.className="animation-timeline",b.isIE11&&(g.style["padding-top"]="0",g.style["padding-bottom"]="0",g.style["margin-top"]="10px"),this.animTools.timeline.container.appendChild(g),g.addEventListener(b.isIE11?"change":"input",function(c){var h=d.impl.keyFrameAnimator;if(void 0!==h&&h){var j=g.value*h.duration/100;f.value=a(j),i.value=a(h.duration),h.goto(j),d.dispatchEvent({type:b.ANIMATION_SEEK_EVENT,data:{time:j,duration:h.duration}}),e.updatePlayButton(h.isPaused),e.updateToolbarBackground()}});var h=document.createElement("div");h.className="adsk-control-tooltip",h.textContent=Autodesk.Viewing.i18n.translate("Click-drag to scrub"),this.animTools.timeline.container.appendChild(h),g.addEventListener("mouseover",function(a){a.target===g&&(h.style.visibility="visible")}),g.addEventListener("mouseout",function(a){a.target===g&&(h.style.visibility="hidden")}),this.animTools.timeline.addClass("toolbar-animation-button"),this.animTools.timeline.addClass("toolbar-animation-timeline"),this.animTools.addControl(this.animTools.timeline),this.animTools.timeLeftText=new c.Control("toolbar-animationRemainingTime");var i=this.animTools.lapseLeft=document.createElement("input");i.type="text",i.value="0",i.className="animation-time-lapse",i.disabled=!0,this.animTools.timeLeftText.container.appendChild(i),this.animTools.timeLeftText.addClass("toolbar-animation-button"),this.animTools.addControl(this.animTools.timeLeftText),this.animTools.closeButton=new c.Button("toolbar-animation-Close"),this.animTools.closeButton.addClass("docking-panel-close"),this.animTools.closeButton.addClass("toolbar-animation-button"),this.animTools.closeButton.addClass("toolbar-animation-close-button"),this.animTools.closeButton.onClick=function(){e.hideAnimateToolbar(),d.dispatchEvent({type:b.ANIMATION_TOOLBAR_CLOSE_EVENT})},this.animTools.addControl(this.animTools.closeButton)},d.prototype.activate=function(){return this.activeStatus||(this.play(),this.activeStatus=!0),!0},d.prototype.deactivate=function(){return this.activeStatus&&(this.pause(),this.activeStatus=!1),!0},AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360"),Autodesk.Viewing.Extensions.Fusion360.AnimationExtension=d,b.theExtensionManager.registerExtension("Autodesk.Fusion360.Animation",d)}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Collaboration"),function(){var a=Autodesk.Viewing,b=a.Private,c=a.Extensions,d=c.Collaboration;d.InteractionInterceptor=function(a){this.getNames=function(){return["intercept"]},this.getName=function(){return"intercept"},this.activate=function(a){},this.deactivate=function(a){},this.update=function(a){return!1},this.handleSingleClick=function(a,b){return!1},this.handleDoubleClick=function(a,b){return!1},this.handleSingleTap=function(a){return!1},this.handleDoubleTap=function(a,b){return!1},this.handleKeyDown=function(a,b){return!1},this.handleKeyUp=function(a,b){return!1},this.handleWheelInput=function(b){return a.takeControl(),!1},this.handleButtonDown=function(b,c){return a.takeControl(),!1},this.handleButtonUp=function(a,b){return!1},this.handleMouseMove=function(b){return a.updatePointer(b),!1},this.handleGesture=function(b){return a.takeControl(),!1},this.handleBlur=function(a){return!1},this.handleResize=function(){}},d.ViewTransceiver=function(c){function d(a){p=!0;var b=JSON.parse(a.data.msg);w.restoreState(b),o.impl.invalidate(!0,!1,!0),p=!1}function e(a){return Math.round(1e3*a)/1e3}function f(a){for(var b=0;b<a.length;b++)a[b]=e(a[b])}function g(a){var b=a.data.msg;!0===b[1]||r||(b[0]!=m&&(m=b[0],a.data.lastInControl=b[0],n.dispatchEvent({type:"controlChange",channelId:n.channelId,data:a.data})),q=!1,o.navigation.setView((new THREE.Vector3).set(b[2],b[3],b[4]),(new THREE.Vector3).set(b[5],b[6],b[7])),o.navigation.setCameraUpVector((new THREE.Vector3).set(b[8],b[9],b[10])))}function h(a){if(q||r){var b=a.camera,d=[b.position.x,b.position.y,b.position.z,b.target.x,b.target.y,b.target.z,b.up.x,b.up.y,b.up.z];f(d),d.unshift(r),d.unshift(c.getLocalId()),s.sendMessage("camera",d,n.channelId),m!=d[0]&&(m=d[0],n.dispatchEvent({type:"controlChange",channelId:n.channelId,data:{lastInControl:m}}))}}function i(a,b,c){a&&!u&&(u=document.createElement("div"),u.classList.add("collabPointer")),a&&!v?(o.container.appendChild(u),v=!0):!a&&v&&(o.container.removeChild(u),v=!1),a&&(u.style.left=b-6+"px",u.style.top=c-6+"px")}function j(a){if(!q&&!r){var b=a.data.msg;t.origin.set(b[1],b[2],b[3]),t.direction.set(b[4],b[5],b[6]);var c=t.at(o.getCamera().near);c.project(o.getCamera()),c=o.impl.viewportToClient(c.x,c.y),i(!0,c.x,c.y)}}function k(a){if(q){var b=o.impl.clientToViewport(a.canvasX,a.canvasY);o.impl.viewportToRay(b,t);var d=[t.origin.x,t.origin.y,t.origin.z,t.direction.x,t.direction.y,t.direction.z];f(d),d.unshift(c.getLocalId()),s.sendMessage("pointer",d,n.channelId)}}function l(a){if(!p){var b=w.getState(x);c.sendMessage("state",JSON.stringify(b),n.channelId)}}var m,n=this,o=this.viewer=null,p=!1,q=!1,r=!1,s=this.client=c,t=new THREE.Ray,u=null,v=!1;this.channelId=null;var w,x={seedURN:!1,objectSet:!0,viewport:!1,cutplanes:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}};this.takeControl=function(){q=!0,i(!1)},this.updatePointer=function(a){k(a)},this.connectCamera=function(a){r=!a},this.attach=function(c){o&&this.detach(),this.viewer=o=c,w=new b.ViewerState(o),s.addEventListener("cameraChange",g),s.addEventListener("pointerMove",j),s.addEventListener("viewerState",d),o.hasEventListener(a.CAMERA_CHANGE_EVENT,h)||o.addEventListener(a.CAMERA_CHANGE_EVENT,h),o.hasEventListener(a.SELECTION_CHANGED_EVENT,l)||(o.addEventListener(a.SELECTION_CHANGED_EVENT,l),o.addEventListener(a.ISOLATE_EVENT,l),o.addEventListener(a.HIDE_EVENT,l),o.addEventListener(a.SHOW_EVENT,l),o.addEventListener(a.EXPLODE_CHANGE_EVENT,l),o.addEventListener(a.LAYER_VISIBILITY_CHANGED_EVENT,l),o.addEventListener(a.CUTPLANES_CHANGE_EVENT,l))},this.detach=function(){s&&(s.removeEventListener("cameraChange",g),s.removeEventListener("viewerState",d)),o&&(o.removeEventListener(a.CAMERA_CHANGE_EVENT,h),o.removeEventListener(a.SELECTION_CHANGED_EVENT,l),o.removeEventListener(a.ISOLATE_EVENT,l),o.removeEventListener(a.HIDE_EVENT,l),o.removeEventListener(a.SHOW_EVENT,l),o.removeEventListener(a.EXPLODE_CHANGE_EVENT,l),o.removeEventListener(a.LAYER_VISIBILITY_CHANGED_EVENT,l),o.removeEventListener(a.CUTPLANES_CHANGE_EVENT,l),this.viewer=o=null,w=null)}},d.ViewTransceiver.prototype.constructor=d.ViewTransceiver,Autodesk.Viewing.EventDispatcher.prototype.apply(d.ViewTransceiver.prototype)}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Collaboration"),function(){var a=Autodesk.Viewing,b=a.Extensions,c=a.Private,d=a.UI,e=b.Collaboration;b.Collaboration.Collaboration=function(b,c){a.Extension.call(this,b,c),c&&c.rtc&&c.rtc.disableRTCToolbarButton&&(this.disableRTCToolbarButton=!0),this.name="collaboration"},b.Collaboration.Collaboration.prototype=Object.create(a.Extension.prototype),b.Collaboration.Collaboration.prototype.constructor=b.Collaboration.Collaboration;var f=b.Collaboration.Collaboration.prototype;f.initNetwork=function(a){this.p2p&&!a||(this.viewtx=new e.ViewTransceiver(this.client),this.interceptor=new e.InteractionInterceptor(this.viewtx),this.viewer.toolController.registerTool(this.interceptor),this.p2p=new c.P2PClient(this.client))},f.createUI=function(){var a=this,f=this.viewer;if(this.initNetwork(!1),this.panel=new e.DockingCollabPanel(this.viewer,this.client,this.p2p,this.viewtx),b.Collaboration.Collaboration.Panel=this.panel,this.collabButton=new d.Button("toolbar-collaborateTool"),this.collabButton.setToolTip("Live review"),this.collabButton.setIcon("adsk-icon-live-review"),this.collabButton.onClick=function(b){var c=a.panel.isVisible();document.getElementById("collabBox")||(c||a.inviteDivInstantiated||a.activeStatus?a.deactivate():a.activate())},this.disableRTCToolbarButton&&this.collabButton.setVisible(!1,!0),this.panel.addVisibilityListener(function(b){if(b){if(f.model){var e=f.model.getData();a.viewtx.channelId=e.basePath,a.viewtx.attach(f),a.client.connect(a.viewtx.channelId),a.client.join(a.viewtx.channelId)}f.toolController.activateTool(a.interceptor.getName());a.collabButton.setState(d.Button.State.ACTIVE),c.logger.track({category:"viewer_rtc_start"})}else c.logger&&a.client.isConnected()&&c.logger.track({category:"viewer_rtc_stop"}),a.p2p.hangup(),a.viewtx.detach(f),a.viewtx.channelId=null,a.client.disconnect(),a.panel.reset(),f.toolController.deactivateTool(a.interceptor.getName()),a.collabButton.setState(d.Button.State.INACTIVE)}),f.modelTools.addControl(this.collabButton),Autodesk.Viewing.Private.getParameterByName("invited")){var g=new CollabPromptBox,h=f.container;g.start(h,function(){a.panel.setVisible(!0,!0)},"Join a Live Review","Join Review")}},f.close=function(){this.panel.setVisible(!1,!0),this.panel.reset()},f.load=function(){function a(){function a(c){b.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a),d.createUI()}d.client=c.MessageClient.GetInstance(d.options?d.options.messageServerURL:void 0),d.socketErrorHandler=function(a){c.ErrorHandler.reportError(b.container,Autodesk.Viewing.ErrorCodes.RTC_ERROR,a.data),d.close()},d.client.addEventListener("socketError",d.socketErrorHandler),d.presenceChannelId=window.location.host,d.client.isConnected(),b.modelTools?d.createUI():b.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a)}var b=this.viewer,d=this;return c.loadDependency("lmv_io","socket.io-1.3.5.js",a),!0},f.unload=function(){var a=this.viewer;return this.client.removeEventListener("socketError",this.socketErrorHandler),this.socketErrorHandler=null,this.p2p.hangup(),this.viewtx.detach(a),this.client.disconnect(),this.panel&&(this.panel.reset(),this.panel.setVisible(!1),this.panel.uninitialize(),this.panel=null),a.toolController.deactivateTool(this.interceptor.getName()),this.interceptor=null,a.modelTools.removeControl(this.collabButton.getId()),this.collabButton=null,!0},f.activate=function(){if(!this.activeStatus){var a=this.viewer,b=new e.CollabPromptBox,c=a.container;b.start(c,function(){this.panel.setVisible(!0,!0)}.bind(this),"Start a Live Review","Start Review"),this.activeStatus=!0}return!0},f.deactivate=function(){return this.activeStatus&&(this.panel.setVisible(!1,!0),this.panel.reset(),this.activeStatus=!1),!0},a.theExtensionManager.registerExtension("Autodesk.Viewing.Collaboration",b.Collaboration.Collaboration)}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Collaboration"),function(){function a(a,c,d,e){this.viewer=a,this.client=c,this.p2p=d,this.viewtx=e;b.UI.DockingPanel.call(this,a.container,"CollabPanel","Live review"),this.container.classList.add("collabPanel"),this.container.style.height="auto",this.container.dockRight=!0,this.content=document.createElement("div"),this.container.appendChild(this.content),this.content.classList.add("collabPanelContent"),this.tableContainer=document.createElement("div"),this.tableContainer.classList.add("userListTable","docking-panel-scroll"),this.table=document.createElement("table"),this.table.classList.add("adsk-lmv-tftable"),this.tbody=document.createElement("tbody"),this.table.appendChild(this.tbody),this.tableContainer.appendChild(this.table),this.content.appendChild(this.tableContainer),this.inviteDiv=document.createElement("div"),this.inviteDiv.className="collabBoxOK",this.inviteDiv.style.float="left",this.inviteDiv.style.width="232px",this.inviteDiv.setAttribute("data-i18n","Invite"),this.inviteDiv.textContent=Autodesk.Viewing.i18n.translate("Invite"),this.content.appendChild(this.inviteDiv),this.inviteDiv.addEventListener("click",function(b){var c=new CollabPromptBox,d=a.container;c.start(d,function(){var a=Autodesk.Viewing.i18n.translate("Please Join My Live Review");document.location.href="mailto:?subject="+a},"Invite Others","Email Invite",!0)}),this.chatHistory=document.createElement("div"),this.chatHistory.classList.add("chatHistory"),this.chatHistory.classList.add("textEntry"),this.chatHistory.classList.add("docking-panel-scroll"),this.content.appendChild(this.chatHistory),this.chatPanel=document.createElement("div"),this.chatPanel.classList.add("chatPanel"),this.textInput=document.createElement("input"),this.textInput.type="text",this.textInput.classList.add("textEntry"),this.textInput.placeholder=Autodesk.Viewing.i18n.translate("Type a message"),this.chatPanel.appendChild(this.textInput),this.content.appendChild(this.chatPanel),this.isCameraConnected=!0;var f=this;this.addEventListener(c,"userListChange",function(a){if(!a.channelId||a.channelId===f.viewtx.channelId){var b=f.client.getChannelInfo(f.viewtx.channelId);b&&f.updateUsers(b.users)}}),this.addEventListener(this.viewtx,"controlChange",function(a){a.channelId===f.viewtx.channelId&&f.updateUserInControl(a.data.lastInControl)}),this.addEventListener(c,"chatReceived",function(a){a.channelId===f.viewtx.channelId&&f.updateChatHistory(a)}),this.textInput.onkeyup=function(a){f.handleChatInput(a)},this.addEventListener(this.p2p,"remoteStreamAdded",function(a){f.videoPanel||f.createVideoPanel(),f.remoteVideo.src=window.URL.createObjectURL(a.data)}),this.addEventListener(this.p2p,"localStreamAdded",function(a){f.videoPanel||f.createVideoPanel(),f.localVideo.src=window.URL.createObjectURL(a.data)}),this.addEventListener(this.p2p,"remoteHangup",function(a){f.removeVideoPanel()})}var b=Autodesk.Viewing,c=b.Extensions,d=b.Private,e=(b.UI,c.Collaboration);Autodesk.Viewing.startLiveReviewSession=function(){e.Panel&&e.Panel.startSession()},Autodesk.Viewing.endLiveReviewSession=function(){e.Panel&&e.Panel.endSession()};a.prototype=Object.create(b.UI.DockingPanel.prototype),a.prototype.constructor=a,a.prototype.startSession=function(){var a=this;if(!this.isVisible()){var b=new CollabPromptBox,c=this.viewer.container;b.start(c,function(){a.setVisible(!0,!0)},"Start a Live Review","Start Review")}},a.prototype.endSession=function(){this.isVisible()&&(this.setVisible(!1,!0),this.reset())},a.prototype.updateUsers=function(a){for(var b=document.createElement("tbody"),c=0;c<a.length;c++){var d=b.insertRow(-1);d.id=a[c].id;var e=d.insertCell(0);e.style.width="14px",e.style.cursor="default";var f=document.createElement("div");f.classList.add("statusBase"),f.classList.add("statusNormal"),f.innerHTML="&#9679",e.appendChild(f);d.insertCell(1).textContent=a[c].name}this.table.replaceChild(b,this.tbody),this.tbody=b,this.fixComponentPlacement()},a.prototype.updateUserInControl=function(a){for(var b=0;b<this.tbody.rows.length;b++){var c=this.tbody.rows[b],d=c.cells[0].childNodes[0];c.id==a?(d.classList.remove("statusNormal"),d.classList.add("statusInControl"),d.innerHTML="&#9784",c.cells[1].style.color="#4CBA36"):(d.classList.remove("statusInControl"),d.classList.add("statusNormal"),d.innerHTML="&#9679",c.cells[1].style.color="#ffffff")}},a.prototype.updateChatHistory=function(a){var b=this.client.getUserById(a.data.from,a.channelId);if("/"!=a.data.msg.charAt(0)){if(this.chatHistory.lastUser!=b.name){var c=document.createElement("p"),d=document.createElement("div");d.classList.add("heading"),d.style.float="left",d.style.fontStyle="normal",d.style.color="#857E7E",d.textContent=b.name,c.appendChild(d);var e=document.createElement("div");e.classList.add("heading"),e.style.textAlign="right",e.style.fontStyle="normal",e.style.color="#857E7E",e.textContent=(new Date).toLocaleTimeString(),c.appendChild(e),this.chatHistory.appendChild(c),this.chatHistory.lastUser=b.name}else{var f=document.createElement("br");this.chatHistory.appendChild(f)}var g=document.createElement("span");g.classList.add("messageText"),g.textContent=a.data.msg,this.chatHistory.appendChild(g),this.chatHistory.scrollTop=this.chatHistory.scrollHeight}},a.prototype.handleChatInput=function(a){13==a.which&&0!=this.textInput.value.length&&(this.client.sendChatMessage(this.textInput.value,this.viewtx.channelId),this.textInput.value="",this.textInput.placeholder="")},a.prototype.fixComponentPlacement=function(a){var b=this.tableContainer.offsetHeight+this.chatPanel.offsetHeight;this.videoPanel?(b+=this.videoPanel.offsetHeight,this.chatHistory.style.height="calc(100% - "+b+"px)"):this.chatHistory.style.height="calc(100% - "+b+"px)"},a.prototype.createVideoPanel=function(a){this.videoPanel=document.createElement("div"),this.videoPanel.classList.add("videoPanel"),this.localVideo=document.createElement("video"),this.localVideo.autoplay=!0,this.localVideo.muted=!0,this.localVideo.classList.add("videoInset"),this.videoPanel.appendChild(this.localVideo),this.remoteVideo=document.createElement("video"),this.remoteVideo.autoplay=!0,this.remoteVideo.classList.add("videoMain"),this.videoPanel.appendChild(this.remoteVideo);var b=this,c=document.createElement("div");c.classList.add("docking-panel-close"),c.innerHTML="&times",c.title=Autodesk.Viewing.i18n.translate("End video call"),c.onclick=function(a){b.p2p.hangup(),b.removeVideoPanel()},this.videoPanel.appendChild(c),this.content.insertBefore(this.videoPanel,this.chatHistory),this.fixComponentPlacement()},a.prototype.removeCollabPrompt=function(){var a=document.getElementById("collabBox");a&&(a.style.visibility="hidden",this.viewer.container.removeChild(a))},a.prototype.removeVideoPanel=function(){this.videoPanel&&this.content.removeChild(this.videoPanel),this.videoPanel=null},a.prototype.reset=function(a){if(this.tbody){var b=document.createElement("tbody");this.table.replaceChild(b,this.tbody),this.tbody=b}this.chatHistory.textContent="",this.textInput.value="",this.removeVideoPanel(),this.removeCollabPrompt()},CollabPromptBox=function(){},CollabPromptBox.prototype.start=function(a,b,c,e,f){if(a&&!document.getElementById("collabBox")){var g=document.createElement("div");g.id="collabBox",g.className="collabBox",a.appendChild(g);var h=document.createElement("div");h.className="collabBoxTitle",h.textContent=Autodesk.Viewing.i18n.translate(c,{defaultValue:c}),g.appendChild(h);var i=document.createElement("span");i.className="collabBoxText";var j="Enter your name";f&&(j="Review URL"),i.textContent=Autodesk.Viewing.i18n.translate(j,{defaultValue:j}),g.appendChild(i);var k=document.createElement("span");k.className="collabBoxInputContainer",g.appendChild(k);var l=document.createElement("input");if(l.type="text",l.className="collabBoxInputText",f){var m=window.location.toString();-1==m.indexOf("?")?m+="?invited=true":m+="&invited=true",
Autodesk.Viewing.Private.docItemId&&(m+="&itemid="+Autodesk.Viewing.Private.docItemId),m+="&doNotRedirect=true",l.value=m}k.appendChild(l),l.onkeyup=function(c){13==c.keyCode&&(g.style.visibility="hidden",a.removeChild(g),d.setUserName(l.value),b())};var n=document.createElement("div");if(n.className="collabBoxClose",n.innerHTML="&times;",n.addEventListener("click",function(b){g.style.visibility="hidden",a.removeChild(g)}),g.appendChild(n),f){var i=document.createElement("span");i.className="collabBoxText",i.style.marginTop="0px";var j="Copy and send this URL to invite others";i.textContent=Autodesk.Viewing.i18n.translate(j,{defaultValue:j}),g.appendChild(i)}else{var o=document.createElement("div");o.className="collabBoxOK",o.textContent=Autodesk.Viewing.i18n.translate(e,{defaultValue:e}),o.addEventListener("click",function(c){g.style.visibility="hidden",a.removeChild(g),""!==l.value.trim()&&d.setUserName(l.value),b()}),g.appendChild(o)}g.style.visibility="visible",l.focus(),f&&l.select()}},e.DockingCollabPanel=a,e.CollabPromptBox=CollabPromptBox}(),function(){"use strict";function a(a,b,c){return function(){var e=b.getState();e===d.Button.State.INACTIVE?(a.activate(c),b.setState(d.Button.State.ACTIVE)):e===d.Button.State.ACTIVE&&(a.deactivate(),b.setState(d.Button.State.INACTIVE))}}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.DefaultTools"),c=Autodesk.Viewing,d=c.UI,e=function(a,b){c.Extension.call(this,a,b),this.name="navtools",this.modes=["pan","dolly","freeorbit","orbit","fov","worldup","fittoview"]};e.prototype=Object.create(c.Extension.prototype),e.prototype.constructor=e;var f=e.prototype;f.load=function(){var a=this.viewer,b=new c.FovTool(a),d=new c.WorldUpTool(a.impl,a);return a.toolController.registerTool(b),a.toolController.registerTool(d),this.createUI(),this.initCameraStateMachine(),this.initFocalLengthOverlay(),!0},f.createUI=function(){var b=this.viewer,e=b.getToolbar(!0),f=e.getControl(c.TOOLBAR.NAVTOOLSID),g=function(a){return b.navigation.isActionEnabled(a)?"block":"none"};if(b.model.is3d()){var h=new d.ComboButton("toolbar-orbitTools");h.setToolTip("Orbit"),h.setIcon("adsk-icon-orbit-constrained"),h.setDisplay(g("orbit")),this.createOrbitSubmenu(h),f.addControl(h),f.orbittoolsbutton=h,h.setState(d.Button.State.ACTIVE),f.returnToDefault=function(){h.setState(d.Button.State.ACTIVE)}}var i=new d.Button("toolbar-panTool");i.setToolTip("Pan"),i.setIcon("adsk-icon-pan"),i.onClick=a(this,i,"pan"),i.setDisplay(g("pan")),f.addControl(i),f.panbutton=i,b.model.is2d()&&(f.returnToDefault=function(){i.setState(d.Button.State.ACTIVE)},f.returnToDefault());var j=new d.Button("toolbar-zoomTool");j.setToolTip("Zoom"),j.setIcon("adsk-icon-zoom"),j.onClick=a(this,j,"dolly"),j.setDisplay(g("zoom")),f.addControl(j),f.dollybutton=j;var k=new d.ComboButton("toolbar-cameraSubmenuTool");k.setToolTip("Camera interactions"),k.setIcon("adsk-icon-camera"),k.saveAsDefault(),this.createCameraSubmenu(k),f.addControl(k),f.camerabutton=k},f.createOrbitSubmenu=function(b){var e=this.viewer,f=e.getToolbar(!0),g=f.getControl(c.TOOLBAR.NAVTOOLSID),h=new d.Button("toolbar-freeOrbitTool");h.setToolTip("Free orbit"),h.setIcon("adsk-icon-orbit-free"),h.onClick=a(this,h,"freeorbit"),b.addControl(h),g.freeorbitbutton=h;var i=new d.Button("toolbar-orbitTool");i.setToolTip("Orbit"),i.setIcon("adsk-icon-orbit-constrained"),i.onClick=a(this,i,"orbit"),b.addControl(i),g.orbitbutton=i,b.onClick=i.onClick},f.createCameraSubmenu=function(b){var e=this,f=this.viewer,g=f.getToolbar(!0),h=g.getControl(c.TOOLBAR.NAVTOOLSID),i=function(a){return f.navigation.isActionEnabled(a)?"block":"none"};if(c.isTouchDevice()){var j=new d.Button("toolbar-homeTool");j.setToolTip("Home"),j.setIcon("adsk-icon-home"),j.onClick=function(){f.navigation.setRequestHomeView(!0);var a=f.getDefaultNavigationToolName();e.activate(a),b.restoreDefault()},j.setDisplay(i("gotoview")),b.addControl(j),h.homebutton=j}var k=new d.Button("toolbar-fitToViewTool");if(k.setToolTip("Fit to view"),k.setIcon("adsk-icon-fit-to-view"),k.onClick=function(a){f.impl.fitToView(f.impl.selector.getAggregateSelection());var c=f.getDefaultNavigationToolName();f.setActiveNavigationTool(c),b.restoreDefault()},k.setDisplay(i("gotoview")),b.addControl(k),h.fovbutton=k,f.model.is3d()){var l=new d.Button("toolbar-focalLengthTool");l.setToolTip("Focal length"),l.setIcon("adsk-icon-fov"),l.onClick=a(this,l,"fov"),l.setDisplay(i("fov")),b.addControl(l),h.fovbutton=l}var m=new d.Button("toolbar-rollTool");m.setToolTip("Roll"),m.setIcon("adsk-icon-roll"),m.onClick=a(this,m,"worldup"),m.setDisplay(i("roll")),b.addControl(m),h.rollbutton=m},f.initCameraStateMachine=function(a){var b=this,d=this.viewer,e=d.getToolbar(!0),f=e.getControl(c.TOOLBAR.NAVTOOLSID);this.toolChangedHandler=function(a){"fov"===a.toolName&&b.showFocalLengthOverlay(a.active)},d.addEventListener(c.TOOL_CHANGE_EVENT,this.toolChangedHandler),this.navChangedHandler=function(a){d.getDefaultNavigationToolName()===a.id&&f.returnToDefault()},d.addEventListener(c.NAVIGATION_MODE_CHANGED_EVENT,this.navChangedHandler)},f.initFocalLengthOverlay=function(){var a=this.focallength=document.createElement("div");a.classList.add("message-panel"),a.classList.add("docking-panel"),a.classList.add("focal-length"),a.classList.add("docking-panel-container-solid-color-b");var b=document.createElement("table"),c=document.createElement("tbody");b.appendChild(c),a.appendChild(b),this.viewer.container.appendChild(a);var d=c.insertRow(-1),e=d.insertCell(0);e.classList.add("name"),e.setAttribute("data-i18n","Focal Length"),e.textContent=Autodesk.Viewing.i18n.translate("Focal Length"),e=d.insertCell(1),e.classList.add("value"),e.textContent="",this.fovCell=e,a.style.visibility="hidden"},f.showFocalLengthOverlay=function(a){function b(a){if(a){var b={msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic",messageDefaultValue:"The view is set to Orthographic. Changing the focal length will switch to Perspective."};c.Private.HudMessage.displayMessage(h.container,b)}else c.Private.HudMessage.dismiss()}function d(a){a&&e(),g.focallength&&(g.focallength.style.visibility=a?"visible":"hidden")}function e(){var a=h.getFocalLength();i!==a&&(i=a,g.fovCell.textContent=a.toString()+" mm")}function f(a){if(e(),"fov"===h.toolController.getActiveToolName()){var c=h.navigation.getCamera(),f=c&&!c.isPerspective;d(!f),b(f)}}var g=this,h=this.viewer,i=0,j=h.navigation.getCamera(),k=j&&!j.isPerspective;d(a&&!k),b(a&&k),a?h.addEventListener(c.CAMERA_CHANGE_EVENT,f):h.removeEventListener(c.CAMERA_CHANGE_EVENT,f)},f.unload=function(){return this.destroyUI(),!0},f.destroyUI=function(){var a=this.viewer,b=a.getToolbar(!1);if(!b)return!0;var e=b.getControl(c.TOOLBAR.NAVTOOLSID);return!e||(a.model&&a.model.is3d()&&(e.orbittoolsbutton.subMenu.removeEventListener(d.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,e.orbittoolsbutton.subMenuActiveButtonChangedHandler(e)),e.removeControl(e.orbittoolsbutton.getId()),e.orbittoolsbutton=null,e.orbitbutton.onClick=null,e.orbitbutton=null,e.freeorbitbutton.onClick=null,e.freeorbitbutton=null),e.removeControl(e.panbutton.getId()),e.panbutton.onClick=null,e.panbutton=null,e.removeControl(e.dollybutton.getId()),e.dollybutton.onClick=null,e.dollybutton=null,e.camerabutton.subMenu.removeEventListener(d.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,e.camerabutton.subMenuActiveButtonChangedHandler(e)),e.removeControl(e.camerabutton.getId()),e.camerabutton.onClick=null,e.camerabutton=null,e.rollbutton.onClick=null,e.rollbutton=null,e.fovbutton.onClick=null,e.fovbutton=null,this.focallength=null,a.removeEventListener(c.TOOL_CHANGE_EVENT,this.toolChangedHandler),this.toolChangedHandler=null,a.removeEventListener(c.NAVIGATION_MODE_CHANGED_EVENT,this.navChangedHandler),this.navChangedHandler=null,!0)},f.activate=function(a){if(!this.activeStatus||this.mode!==a){var b=this.viewer.getDefaultNavigationToolName();switch(a){default:case"pan":this.viewer.setActiveNavigationTool("pan"),this.mode="pan";break;case"dolly":case"orbit":case"freeorbit":case"fov":case"worldup":this.viewer.setActiveNavigationTool(a),this.mode=a;break;case"fittoview":this.viewer.impl.fitToView(this.viewer.impl.selector.getAggregateSelection()),this.viewer.setActiveNavigationTool(b),this.mode="fittoview"}return this.activeStatus=!0,!0}},f.deactivate=function(){return this.activeStatus&&(this.viewer.setActiveNavigationTool(),this.activeStatus=!1),!0},b.NavToolsExtension=e,c.theExtensionManager.registerExtension("Autodesk.DefaultTools.NavTools",e)}(),function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.createUIBound=function(){a.removeEventListener(av.TOOLBAR_CREATED_EVENT,this.createUIBound),this.createUI(this.viewer.getToolbar(!1))}.bind(this),this.name="zoomwindow",this.modes=["zoomwindow","dolly"]}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.ZoomWindow");a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a;var c=a.prototype;c.load=function(){var a=this.viewer;return this.tool=new b.ZoomWindowTool(a),a.toolController.registerTool(this.tool),this.createUI(a.getToolbar(!1)),!0},c.createUI=function(a){var b;if(!a||!(b=a.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID))||!b.dollybutton)return void this.viewer.addEventListener(av.TOOLBAR_CREATED_EVENT,this.createUIBound);var c=this;b.removeControl(b.dollybutton.getId()),this.defaultDollyButton=b.dollybutton,this.zoomWindowToolButton=new Autodesk.Viewing.UI.ComboButton("toolbar-zoomTools"),this.zoomWindowToolButton.setIcon("zoomwindowtoolicon-zoom-window"),this.zoomWindowToolButton.setToolTip("Zoom window"),this.createZoomSubmenu(this.zoomWindowToolButton),b.addControl(this.zoomWindowToolButton);var d=[{keycodes:[Autodesk.Viewing.theHotkeyManager.KEYCODES.ESCAPE],onRelease:function(){c.zoomWindowToolButton.getState()===Autodesk.Viewing.UI.Button.State.ACTIVE&&(c.viewer.setActiveNavigationTool(),c.zoomWindowToolButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE))}}];Autodesk.Viewing.theHotkeyManager.pushHotkeys(this.escapeHotkeyId,d)},c.destroyUI=function(){var a=this.viewer,b=a.getToolbar(!1);if(b){var c=b.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);c&&(this.zoomWindowToolButton&&(this.zoomWindowToolButton.subMenu.removeEventListener(Autodesk.Viewing.UI.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,this.zoomWindowToolButton.subMenuActiveButtonChangedHandler(c)),c.removeControl(this.zoomWindowToolButton.getId())),this.zoomWindowToolButton=null,c.panbutton&&this.defaultDollyButton?c.addControl(this.defaultDollyButton):this.defaultDollyButton=null)}Autodesk.Viewing.theHotkeyManager.popHotkeys(this.escapeHotkeyId)},c.createZoomSubmenu=function(a){var b=function(a,b,c){return function(){var d=b.getState();d===Autodesk.Viewing.UI.Button.State.INACTIVE?(a.activate(c),b.setState(Autodesk.Viewing.UI.Button.State.ACTIVE)):d===Autodesk.Viewing.UI.Button.State.ACTIVE&&(a.deactivate(),b.setState(Autodesk.Viewing.UI.Button.State.INACTIVE))}},c=this.viewer,d=c.getToolbar(!0),e=(d.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID),new Autodesk.Viewing.UI.Button("toolbar-zoomWindowTool"));e.setToolTip(Autodesk.Viewing.i18n.translate("Zoom window")),e.setIcon("zoomwindowtoolicon-zoom-window"),e.onClick=b(this,e,"zoomwindow"),a.addControl(e);var f=new Autodesk.Viewing.UI.Button("toolbar-zoomTool");f.setToolTip("Zoom"),f.setIcon("adsk-icon-zoom"),f.onClick=b(this,f,"dolly"),a.addControl(f)},c.unload=function(){var a=this.viewer;return"dolly"!==a.getActiveNavigationTool()&&"zoomwindow"!==a.getActiveNavigationTool()||a.setActiveNavigationTool(),this.destroyUI(),a.toolController.deregisterTool(this.tool),this.tool=null,!0},c.activate=function(a){if(!this.activeStatus||this.mode!==a){switch(a){default:case"zoomwindow":this.viewer.setActiveNavigationTool("zoomwindow"),this.mode="zoomwindow";break;case"dolly":this.viewer.setActiveNavigationTool("dolly"),this.mode="dolly"}return this.activeStatus=!0,!0}},c.deactivate=function(){return this.activeStatus&&(this.viewer.setActiveNavigationTool(),this.activeStatus=!1),!0},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Viewing.ZoomWindow",a)}(),function(){"use strict";function a(a){var c=["zoomwindow"],d=!1,e=!1,f=new THREE.Vector3(0,0,-10),g=new THREE.Vector3(0,0,-10),h=null,i=null,j=null,k=null,l=null,m=a.navigation.getCamera();this.isActive=function(){return d},this.getNames=function(){return c},this.getName=function(){return c[0]},this.onResize=function(){l=null;var b=a.canvas,c=b.clientWidth,d=b.clientHeight,e=new THREE.OrthographicCamera(0,c,0,d,1,1e3);a.impl.overlayScenes.ZoomWindowRect.camera=e},this.activate=function(b){if(d=!0,null===h){var c=null;c=a.navigation.getIs2D()?new THREE.Color(0):new THREE.Color(16777215),h=new THREE.LineBasicMaterial({color:c,opacity:.6,linewidth:1,depthTest:!1,depthWrite:!1})}var e=a.canvas,f=e.clientWidth,g=e.clientHeight,i=new THREE.OrthographicCamera(0,f,0,g,1,1e3);a.impl.createOverlayScene("ZoomWindowRect",h,h,i),a.impl.api.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResize),a.toolController.getTool("dolly").activate("orbit")},this.deactivate=function(b){l=null,a.impl.removeOverlayScene("ZoomWindowRect"),d=!1,e=!1,f.set(0,0,-10),g.set(0,0,-10),a.impl.api.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResize),a.toolController.getTool("dolly").deactivate("orbit")},this.getCursor=function(){switch(a.toolController.getTool("dolly").getTriggeredMode()){case"dolly":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), auto";case"pan":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC), auto"}return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAADWSURBVEiJ1ZVNEsIwCEYfTg/UjTPuemcvojfCRRMlNKGdKguZyaLkK4/8EERVybQJQERCUU3C63p+n/Bk9QHDRtbIX2GqKh6woRfxLdL0/M1KzYRaA+7AXDW9wN5fvrXEWud6AOABLD7QwREDgCdw7WV6ZjSAsi0Lzn4JmEcHeHbYWxQXw3FTEWmvaWY1X9Iie4CIKHE1fwfIsnSAZD/X/79FGbdISyzA9QMDG3axTTTVwx3NaNbm5B2dRHY1DWCUyd4qIs0bUB8nuz32/11Cu+KPM7sOXlrOS4sOkzb1AAAAAElFTkSuQmCC), auto"},this.handleGesture=function(a){switch(a.type){case"dragstart":return this.handleButtonDown(a,0);case"dragmove":return this.handleMouseMove(a);case"dragend":return this.handleButtonUp(a,0)}return!1},this.handleSingleClick=function(a,b){return!0},this.startDrag=function(b){if(!1===e){if(e=!0,f.x=b.canvasX,f.y=b.canvasY,g.x=b.canvasX,g.y=b.canvasY,null===l){i=new THREE.Geometry,i.vertices.push(f.clone(),f.clone(),f.clone(),f.clone(),f.clone()),j=new THREE.Geometry,j.vertices.push(f.clone(),f.clone()),k=new THREE.Geometry,k.vertices.push(f.clone(),f.clone());var c=new THREE.Line(i,h,THREE.LineStrip),d=new THREE.Line(j,h,THREE.LineStrip),m=new THREE.Line(k,h,THREE.LineStrip);l=new THREE.Group,l.add(c),l.add(d),l.add(m)}else i.vertices[0]=f.clone(),i.vertices[1]=f.clone(),i.vertices[2]=f.clone(),i.vertices[3]=f.clone(),i.vertices[4]=f.clone(),j.vertices[0]=f.clone(),j.vertices[1]=f.clone(),k.vertices[0]=f.clone(),k.vertices[1]=f.clone(),j.verticesNeedUpdate=!0,k.verticesNeedUpdate=!0,i.verticesNeedUpdate=!0;a.impl.addOverlay("ZoomWindowRect",l)}},this.handleButtonDown=function(a,b){return 0===b&&(this.startDrag(a),!0)},this.handleMouseMove=function(a){return!(!i||!e)&&(g.x=a.canvasX,g.y=a.canvasY,!0)},this.endDrag=function(b){!0===e&&(a.impl.removeOverlay("ZoomWindowRect",l),e=!1)},this.handleButtonUp=function(a,b){return 0===b&&(this.endDrag(),!0)},this.handleKeyDown=function(a,b){return!1},this.handleKeyUp=function(a,b){return!1},this.handleWheelInput=function(a){return!1},this.handleSingleClick=function(a,b){return!1},this.handleDoubleClick=function(a,b){return!1},this.handleSingleTap=function(a){return!1},this.handleDoubleTap=function(a){return!1},this.handleBlur=function(a){return!1},this.update=function(){if(this.isActive()){if(!i||!e)return this.zoomWindow();i.vertices[1].x=f.x,i.vertices[1].y=g.y,i.vertices[2]=g.clone(),i.vertices[3].x=g.x,i.vertices[3].y=f.y,i.vertices[4]=i.vertices[0];var c=Math.abs(g.x-f.x),d=Math.abs(g.y-f.y),h=c>d?d:c;h>b&&(h=b);var l=.5*h,m=[.5*(g.x+f.x),.5*(g.y+f.y)];return j.vertices[0].x=m[0]-l,j.vertices[0].y=m[1],j.vertices[1].x=m[0]+l,j.vertices[1].y=m[1],k.vertices[0].x=m[0],k.vertices[0].y=m[1]-l,k.vertices[1].x=m[0],k.vertices[1].y=m[1]+l,j.verticesNeedUpdate=!0,k.verticesNeedUpdate=!0,i.verticesNeedUpdate=!0,a.impl.invalidate(!1,!1,!0),!1}},this.getPivot=function(a,b,c,d,e){a=2*a/c-1,b=1-2*b/d;var f=new THREE.Vector3(a,b,-1),g=new THREE.Vector3(a,b,1);f.unproject(e),g.unproject(e),g.sub(f);var h=e.position,i=e.target,j=i.clone().sub(h).normalize(),k=(j.dot(i)-j.dot(f))/j.dot(g);return f.add(g.multiplyScalar(k)),f},this.queryMouseRaySceneIntersection=function(b,c){if(null==a)return null;if(null==a.model)return null;if(a.model.is2d())return null;var d=a.impl.hitTest(b,c,!1);return d?d.intersectPoint:null};this.zoomWindow=function(){var b=m,c=a.canvas.clientWidth,d=a.canvas.clientHeight,e=f.x,h=f.y,i=g.x,j=g.y,k=Math.abs(i-e),l=Math.abs(j-h);if(0===k||0===l)return!1;if(g.copy(f),a.navigation.getIs2D()){var n={x:.5*(e+i),y:.5*(h+j)},o=a.navigation.getEyeVector().length(),p=a.impl.clientToViewport(n.x,n.y),q=a.impl.clientToViewport(c/2,d/2);p.subVectors(p,q),a.navigation.panRelative(p.x/2,p.y/2,o);var r=k/c,s=l/d,t=r>s?r:s;o=a.navigation.getEyeVector().length();var u=a.navigation.getWorldPoint(.5,.5);return a.navigation.dollyFromPoint(o*(t-1),u),!0}var v=null,w=.5*(e+i),x=.5*(h+j);null===(v=this.queryMouseRaySceneIntersection(w,x))&&(v=this.getPivot(w,x,c,d,m));var y=b.position,z=b.target.clone().sub(y);z.normalize();var A=Math.min(c/k,d/l),B=v.distanceTo(y),C=1*B/A;return z.multiplyScalar(-C),z.add(v),b.position.set(z.x,z.y,z.z),b.target.set(v.x,v.y,v.z),b.dirty=!0,!0}}AutodeskNamespace("Autodesk.Viewing.Extensions.ZoomWindow");var b=20;Autodesk.Viewing.Extensions.ZoomWindow.ZoomWindowTool=a}(),function(){"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.FusionOrbit");var a=Autodesk.Viewing,b=a.UI,c=a.Extensions.FusionOrbit,d=function(b,c){a.Extension.call(this,b,c),this.name="fusionorbit",this.modes=["fusionorbit","fusionfreeorbit"]};d.prototype=Object.create(a.Extension.prototype),d.prototype.constructor=d;var e=d.prototype;e.load=function(){function b(){e.removeEventListener(a.TOOLBAR_CREATED_EVENT,b),d.createUI()}var d=this,e=this.viewer,f=e.getToolbar?e.getToolbar(!0):void 0;if(this.tool=new c.FusionOrbitTool,this.tool.setViewer(e),e.toolController.registerTool(this.tool),f){var g=f.getControl(a.TOOLBAR.NAVTOOLSID);g&&g.getNumberOfControls()>0?b():e.addEventListener(a.TOOLBAR_CREATED_EVENT,b)}else e.addEventListener(a.TOOLBAR_CREATED_EVENT,b);return!0},e.createUI=function(){var c=this,d=this.viewer,e=d.getToolbar(!1),f=e.getControl(a.TOOLBAR.NAVTOOLSID);this.classicBehavior={},this.classicBehavior.orbitOnClick=f.orbitbutton.onClick,this.classicBehavior.freeorbitOnClick=f.freeorbitbutton.onClick,this.classicBehavior.returnToDefault=f.returnToDefault,f.freeorbitbutton.onClick=function(a){var d=f.freeorbitbutton.getState();d===b.Button.State.INACTIVE?(c.activate("fusionfreeorbit"),f.freeorbitbutton.setState(b.Button.State.ACTIVE)):d===b.Button.State.ACTIVE&&(c.deactivate(),f.freeorbitbutton.setState(b.Button.State.INACTIVE))},f.orbitbutton.onClick=function(a){var d=f.orbitbutton.getState();d===b.Button.State.INACTIVE?(c.activate("fusionorbit"),f.orbitbutton.setState(b.Button.State.ACTIVE)):d===b.Button.State.ACTIVE&&(c.deactivate(),f.orbitbutton.setState(b.Button.State.INACTIVE))},f.returnToDefault=function(){f.orbittoolsbutton.setState(b.Button.State.ACTIVE),f.orbittoolsbutton.setState(b.Button.State.INACTIVE)},f.orbittoolsbutton.setState(b.Button.State.INACTIVE),d.prefs.fusionOrbitConstrained?(f.orbittoolsbutton.onClick=f.orbitbutton.onClick,f.orbittoolsbutton.setIcon(f.orbitbutton.iconClass),d.setDefaultNavigationTool("orbit")):(f.orbittoolsbutton.onClick=f.freeorbitbutton.onClick,f.orbittoolsbutton.setIcon(f.freeorbitbutton.iconClass),d.setDefaultNavigationTool("freeorbit")),d.setActiveNavigationTool(),f.returnToDefault()},e.unload=function(){var c=this.viewer,d=c.getToolbar(!1),e=d.getControl(a.TOOLBAR.NAVTOOLSID);return e&&(e.orbitbutton&&(e.orbitbutton.onClick=this.classicBehavior.orbitOnClick),e.freeorbitbutton&&(e.freeorbitbutton.onClick=this.classicBehavior.freeorbitOnClick),e.returnToDefault=this.classicBehavior.returnToDefault,e.orbittoolsbutton&&(e.orbitbutton?e.orbittoolsbutton.onClick=e.orbitbutton.onClick:e.orbittoolsbutton.onClick=null,e.orbittoolsbutton.setIcon("adsk-icon-orbit-constrained"),e.orbittoolsbutton.setState(b.Button.State.ACTIVE))),c.setActiveNavigationTool("orbit"),c.setDefaultNavigationTool("orbit"),c.toolController.deregisterTool(this.tool),this.tool.setViewer(null),this.tool=null,!0},e.activate=function(a){if(!this.activeStatus||this.mode!==a){switch(a){default:case"fusionorbit":this.viewer.setActiveNavigationTool("fusion orbit constrained"),this.mode="fusionorbit";break;case"fusionfreeorbit":this.viewer.setActiveNavigationTool("fusion orbit"),this.mode="fusionfreeorbit"}return this.activeStatus=!0,!0}},e.deactivate=function(){return this.activeStatus&&(this.viewer.setActiveNavigationTool(),this.activeStatus=!1),!0},c.FusionOrbitExtension=d,a.theExtensionManager.registerExtension("Autodesk.Viewing.FusionOrbit",d)}(),Autodesk.Viewing.Extensions.FusionOrbit.html=['<div class="orbit-gizmo noselect">','<div class="outside"></div>','<div class="ring"></div>','<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="layout-mid">','<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="circle">','<div class="crosshair-area">','<div class="crosshair-v"></div>','<div class="crosshair-h"></div>',"</div>","</div>",'<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>",'<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>"].join("\n"),Autodesk.Viewing.Extensions.FusionOrbit.FusionOrbitTool=function(){var a,b,c,d,e,f=Autodesk.Viewing,g=Autodesk.Viewing.Private,h=["fusion orbit","fusion orbit constrained"],i={HORIZONTAL:0,VERTICAL:1,ROLL:2},j={HORIZONTAL:.005,VERTICAL:.005,ROLL:1},k={},l=f.isTouchDevice(),m=!1,n={buttons:[],src:void 0,x:0,y:0,dx:0,dy:0,firstMove:!0,mode:void 0},o=this;this.setViewer=function(a){this.viewer=a,this.navapi=a?a.navigation:null};var p=function(a){n.buttons[a.touches?0:a.button]=!0,n.src=a.target.className,n.x=0,n.y=0,n.dx=0,n.dy=0,n.firstMove=!0,n.mode=void 0,"ring"===n.src?n.mode=i.ROLL:"edgemark-area"===n.src&&("layout-ver"===a.target.parentNode.className?n.mode=i.HORIZONTAL:"layout-hor"===a.target.parentNode.className&&(n.mode=i.VERTICAL)),w(),a.stopPropagation()},q=function(a){n.buttons[a.touches?0:a.button]=!1,n.src=void 0},r=function(a){n.buttons[0]&&(s(a),t(),n.firstMove=!1)},s=function(a){var b=a.touches?a.touches[0].pageX:a.pageX,c=a.touches?a.touches[0].pageY:a.pageY;n.firstMove||(n.dx=b-n.x,n.dy=c-n.y),n.x=b,n.y=c},t=function(){switch(n.mode){case i.ROLL:if(!o.navapi.isActionEnabled("roll"))return;break;case i.HORIZONTAL:case i.VERTICAL:if(!o.navapi.isActionEnabled("orbit"))return}var a=e.target.clone().sub(e.position).normalize(),b=a.clone().cross(e.up).normalize(),c=b.clone().cross(a).normalize();if(e.up.copy(c),n.mode===i.ROLL){var f=new THREE.Vector3(n.x-k.center.x,n.y-k.center.y,0),g=new THREE.Vector3(n.dx,n.dy,0).add(f);f.normalize(),g.normalize();var h=f.clone().cross(g),l=Math.asin(h.z);e.up.applyAxisAngle(a,-l*j.ROLL)}else{var m,p;n.mode===i.HORIZONTAL?(p=-n.dx*j.HORIZONTAL,d&&(e.up=Autodesk.Viewing.Navigation.snapToAxis(e.up.clone())),m=e.up):n.mode===i.VERTICAL&&(p=-n.dy*j.VERTICAL,d?(n.firstMove&&(e.up=Autodesk.Viewing.Navigation.snapToAxis(e.up.clone())),m=a.clone().cross(e.up).normalize()):m=b,e.up.applyAxisAngle(m,p));var q=o.navapi.getPivotPoint(),r=e.position.clone().sub(q);r.applyAxisAngle(m,p),e.position.addVectors(q,r);var s=e.target.clone().sub(q);s.applyAxisAngle(m,p),e.target.addVectors(q,s)}e.dirty=!0},u=function(){var a=e.target.clone().sub(e.position).normalize(),b=o.viewer.impl.rayIntersect(new THREE.Ray(e.position,a));return b&&b.intersectPoint?b.intersectPoint:e.target},v=function(a,b){var c=b||a.clone().sub(e.position).normalize();return new THREE.Plane(c,-c.x*a.x-c.y*a.y-c.z*a.z)},w=function(){var a=e.target.clone().sub(e.position).normalize(),b=v(e.position,a),c=b.distanceToPoint(e.pivot);e.pivot.copy(a).multiplyScalar(c).add(e.position)},x=function(a){a.touches||0!==a.button||w()},y=function(a){m&&o.viewer.setActiveNavigationTool()},z=function(a,b){var c,d=o.viewer.impl.hitTest(a,b);if(d&&d.intersectPoint)c=d.intersectPoint;else{c=o.viewer.impl.viewportToRay(o.viewer.impl.clientToViewport(a,b)).intersectPlane(v(e.target))}var f=e.position.clone().sub(u()).add(c);o.navapi.setRequestTransition(!0,f,c,e.fov)};this.register=function(){a=g.stringToDOM(Autodesk.Viewing.Extensions.FusionOrbit.html),a.style.display="none",this.viewer.canvasWrap.insertBefore(a,this.viewer.canvasWrap.firstChild),b=a.querySelector(".ring"),b.addEventListener("mousedown",p),Array.prototype.forEach.call(a.querySelectorAll(".edgemark-area"),function(a,b){a.addEventListener("mousedown",p),l&&a.addEventListener("touchstart",p)}),window.addEventListener("mouseup",q),window.addEventListener("mousemove",r),c=a.querySelector(".outside"),c.addEventListener("mousedown",y);var d=a.querySelector(".circle");d.addEventListener("mousedown",x),l&&(b.addEventListener("touchstart",p),window.addEventListener("touchend",q),window.addEventListener("touchmove",r),c.addEventListener("touchstart",y),d.addEventListener("touchstart",x)),e=this.viewer.impl.camera},this.deregister=function(){window.removeEventListener("mouseup",q),window.removeEventListener("mousemove",r),c.removeEventListener("mousedown",y),l&&(window.removeEventListener("touchend",q),window.removeEventListener("touchmove",r),c.removeEventListener("touchstart",y)),this.viewer.canvasWrap.removeChild(a),a=void 0,b=void 0,c=void 0},this.activate=function(b){a.style.display="",this.handleResize(),d="fusion orbit constrained"===b;var c=this.viewer.toolController.isToolActivated("hyperlink");c&&this.viewer.toolController.deactivateTool("hyperlink"),d?(this.viewer.setDefaultNavigationTool("orbit"),this.viewer.prefs.set("fusionOrbitConstrained",!0)):(this.viewer.setDefaultNavigationTool("freeorbit"),this.viewer.prefs.set("fusionOrbitConstrained",!1)),c&&this.viewer.toolController.activateTool("hyperlink"),this.viewer.navigation.setZoomTowardsPivot(!0)},this.deactivate=function(b){a.style.display="none",this.viewer.navigation.setZoomTowardsPivot(this.viewer.prefs.zoomTowardsPivot)},this.getNames=function(){return h},this.getName=function(){return h[0]},this.update=function(){return!1},this.handleSingleClick=function(a,b){return z(a.canvasX,a.canvasY),!0},this.handleDoubleClick=function(a,b){return!0},this.handleSingleTap=function(a){return z(a.canvasX,a.canvasY),!0},this.handleDoubleTap=function(a){return!1},this.handleKeyDown=function(a,b){return!1},this.handleKeyUp=function(a,b){return!1},this.handleWheelInput=function(a){return!1},this.handleButtonDown=function(a,b){return!1},this.handleButtonUp=function(a,b){return!1},this.handleMouseMove=function(a){var b,d=this.viewer.impl.getCanvasBoundingClientRect();b=d.width>d.height?new THREE.Vector2(((a.canvasX+.5)/d.width*2-1)*d.width/d.height,-(a.canvasY+.5)/d.height*2+1):new THREE.Vector2((a.canvasX+.5)/d.width*2-1,(-(a.canvasY+.5)/d.height*2+1)*d.height/d.width);var e=b.length(),f=e>1.2;return m!==f&&(c.style.cursor=f?"":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto",m=f),!1},this.handleGesture=function(a){return w(),!1},this.handleBlur=function(a){return!1},this.handleResize=function(){var c=a.getBoundingClientRect();k.left=c.left+window.pageXOffset,k.top=c.top+window.pageYOffset,k.width=c.width,k.height=c.height,k.center={},k.center.x=k.left+k.width/2,k.center.y=k.top+k.height/2;var d=.8*(window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth);a.style.width=a.style.height=d+"px",a.style.top=a.style.left="calc(50% - "+d/2+"px)",b.style.borderWidth=.1*d+"px"}},AutodeskNamespace("Autodesk.Viewing.Private.Collaboration"),function(){function a(a,b,c){function e(b){var c=b.data.msg;if(h.x=c.x1,h.y=c.y1,i.x=c.x2,i.y=c.y2,j=c.explode,c.command)if("gohome"==c.command)h.x=h.y=0,i.x=i.y=0,a.navigation.setRequestHomeView(!0),a.showAll(),a.impl.selector.clearSelection(),a.explode(0),k=null;else if("select"==c.command){var d=a.impl.hitTestViewport(new THREE.Vector3(0,0,0));d?a.impl.selector.toggleSelection(d.dbId,d.model):a.impl.selector.clearSelection()}else if("hide"==c.command){var d=a.impl.hitTestViewport(new THREE.Vector3(0,0,0));d&&a.hide(d.dbId)}else if("fly"==c.command)k=k?null:f.target.clone().sub(f.position).normalize();else if("savepoint"==c.command){var c=g.getState(r);p.push(c),alertify.success("Savepoint created.")}else"nextsavepoint"==c.command&&p.length&&(q>=p.length&&(q=0),g.restoreState(p[q++]))}var f,g,h=new THREE.Vector2,i=new THREE.Vector2,j=0,k=null,l=a,m=.02,n=.002,o=1,p=[],q=0,r={seedURN:!1,objectSet:!0,viewport:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}},s=function(){if(!a.impl.model.is2d()){var b=a.impl.model.getData().bbox.size(),c=b.length();m*=c,n*=c,a.removeEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,s)}};a.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,s),this.getNames=function(){return["joystick"]},this.getName=function(){return"joystick"},this.activate=function(a){if(b.addEventListener("joystick",e),c.addEventListener("joystick",e),f=l.navigation.getCamera(),l.model){var h=l.model.getBoundingBox();o=.001*h.size().length(),
g=new d.ViewerState(l)}},this.deactivate=function(a){b.removeEventListener("joystick",e),c.removeEventListener("joystick",e),f=null,g=null,p.length=0},this.update=function(b){if(f.isPerspective||a.navigation.toPerspective(),k){var c=k.clone().multiplyScalar(n);f.position.add(c),f.target.add(c)}if(0!=j){var d=a.getExplodeScale()+.01*j;d>1&&(d=1),d<0&&(d=0),a.explode(d)}if(0==h.x&&0==h.y&&0==i.x&&0==i.y)return!(!k&&!j);var e=f.target.clone().sub(f.position),g=e.length();e.multiplyScalar(1/g);var l=e.clone().cross(f.up).normalize(),o=e.clone().multiplyScalar(h.y*m);f.position.add(o),f.target.add(o);var p=l.clone().multiplyScalar(h.x*m);f.position.add(p),f.target.add(p);var q=new THREE.Quaternion;q.setFromAxisAngle(l,.05*i.y);var r=e.clone().applyQuaternion(q);f.up.applyQuaternion(q);var s=new THREE.Quaternion;return s.setFromAxisAngle(f.worldup,.05*-i.x),r.applyQuaternion(s),f.up.applyQuaternion(s),r.multiplyScalar(g),f.target.copy(f.position).add(r),k&&k.copy(f.target).sub(f.position).normalize(),!0},this.handleSingleClick=function(a,b){return!1},this.handleDoubleClick=function(a,b){return!1},this.handleSingleTap=function(a){return!1},this.handleDoubleTap=function(a,b){return!1},this.handleKeyDown=function(a,b){return!1},this.handleKeyUp=function(a,b){return!1},this.handleWheelInput=function(a){return!1},this.handleButtonDown=function(a,b){return!1},this.handleButtonUp=function(a,b){return!1},this.handleMouseMove=function(a){return!1},this.handleGesture=function(a,b){return!1},this.handleTouchChange=function(a,b){return!1},this.handleBlur=function(a){return!1},this.handleResize=function(){}}var b=Autodesk.Viewing,c=b.Extensions,d=b.Private,e=b.UI;d.Collaboration;c.RemoteControl=function(c,e){b.Extension.call(this,c,e),this.viewer=c,this.client=d.MessageClient.GetInstance(),this.p2p=new d.P2PClient(this.client),this.controllerTool=new a(c,this.client,this.p2p),c.toolController.registerTool(this.controllerTool),this.name="remotecontrol"},c.RemoteControl.prototype=Object.create(b.Extension.prototype),c.RemoteControl.prototype.constructor=c.RemoteControl,c.RemoteControl.prototype.createUI=function(){var a=this,b=this.viewer;this.controlButton=new e.Button("toolbar-remoteControlTool"),this.controlButton.setToolTip("Pair with controller device"),this.controlButton.onClick=function(){this.getState()===e.Button.State.INACTIVE?(a.activate(),this.setState(e.Button.State.ACTIVE)):(a.deactivate(),this.setState(e.Button.State.INACTIVE))},this.controlButton.setIcon("adsk-icon-game-controller"),b.modelTools.addControl(this.controlButton),this.panel=new Autodesk.Viewing.UI.DockingPanel(b.container,"remote-panel","Remote Control"),this.panel.width=300,this.panel.height=375,this.panel.container.style.width=this.panel.width+"px",this.panel.container.style.height=this.panel.height+"px",this.panel.container.style.top=(window.innerHeight-this.panel.height)/2+"px",this.panel.container.style.left=(window.innerWidth-this.panel.width)/2+"px",this.panel.body=document.createElement("div"),this.panel.body.classList.add("body"),this.panel.container.appendChild(this.panel.body);var c=Autodesk.Viewing.i18n.translate("Go to this link"),d=Autodesk.Viewing.i18n.translate("Scan the QR code with your device"),f=Autodesk.Viewing.i18n.translate("or");this.panel.body.innerHTML=['<p data-i18n="'+c+'">'+c+"</p>",'<p><a class="url" target="_blank" href="#">Link</a></p>','<p data-i18n="'+f+'">'+f+"</p>",'<p data-i18n="'+d+'">'+d+"</p>",'<img class="qr-img" src="">'].join("\n"),this.panel.link=this.panel.container.querySelector(".url"),this.panel.code=this.panel.container.querySelector(".code"),this.panel.qrImg=this.panel.container.querySelector(".qr-img")},c.RemoteControl.prototype.load=function(){function a(d){b.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a),c.createUI()}var b=this.viewer,c=this;return b.modelTools&&b.modelTools.getNumberOfControls()>0?c.createUI():b.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a),!0},c.RemoteControl.prototype.unload=function(){var a=this.viewer;if(this.p2p.hangup(),this.client.disconnect(),a.toolController.deactivateTool(this.controllerTool.getName()),this.panel&&(this.panel.setVisible(!1),this.panel=null),this.controlButton)try{a.modelTools.removeControl(this.controlButton),this.controlButton=null}catch(a){d.logger.error("RemoteControlReceiver - Failed to remove controlButton"),this.controlButton=null}return!0},c.RemoteControl.prototype.addCrosshair=function(){this.crosshair=d.stringToDOM('<div id="remote-crosshair"><div class="crosshair-v"></div><div class="crosshair-h"></div></div>'),this.viewer.canvasWrap.appendChild(this.crosshair)},c.RemoteControl.prototype.removeCrosshair=function(){this.crosshair&&this.crosshair.remove()},c.RemoteControl.prototype.connect=function(a){if(this.client.isConnected())return void console.log("RemoteControl already connected");var b=this;d.loadDependency("lmv_io","socket.io-1.3.5.js",function(){b.connectAux(a)})},c.RemoteControl.prototype.connectAux=function(a){var b=this,c=this.viewer;b.client.addEventListener("connectSucceeded",function(c){function e(){i&&i.setVisible(!1),b.p2p.removeEventListener("dataChannelAdded",e),b.addCrosshair()}d.logger.log("connect succeeded");var f=c.data.id+"rc";b.client.join(f);var g=(LMV_RESOURCE_ROOT.length?LMV_RESOURCE_ROOT:window.location.origin+"/")+"rc.html?sessionId="+f+"&env="+d.env,h="http://chart.googleapis.com/chart?cht=qr&chs=200x200&choe=UTF-8&chld=H|0&chl="+escape(g),i=b.panel;i&&(i.link.href=g,i.link.innerHTML=(LMV_RESOURCE_ROOT.length?LMV_RESOURCE_ROOT:window.location.origin+"/")+"rc.html",i.qrImg.src=h,i.setVisible(!0)),b.p2p.addEventListener("dataChannelAdded",e),a&&a instanceof Function&&a(g)}),c.navigation.toPerspective(),b.client.connect(),c.toolController.activateTool(b.controllerTool.getName())},c.RemoteControl.prototype.disconnect=function(){this.p2p.hangup(),this.client.disconnect(),this.viewer.toolController.deactivateTool(this.controllerTool.getName()),this.removeCrosshair(),this.panel.setVisible(!1)},c.RemoteControl.prototype.activate=function(){return this.activeStatus||(this.connect(),this.activeStatus=!0),!0},c.RemoteControl.prototype.deactivate=function(){return this.activeStatus&&(this.disconnect(),this.activeStatus=!1),!0},b.theExtensionManager.registerExtension("Autodesk.Viewing.RemoteControl",c.RemoteControl)}(),function(){AutodeskNamespace("Autodesk.Viewing.Extensions.GamepadModule"),Autodesk.Viewing.Extensions.GamepadModule=function(a){function b(){for(var a in C)if(C.hasOwnProperty(a)&&e.buttons[a].pressed&&.5!=e.buttons[a].value)return w[a]=!0,!0;for(var a in w)if(w.hasOwnProperty(a)&&w[a])return!0;return!(Math.abs(e.axes[A.LEFT_STICK_X])<u&&Math.abs(e.axes[A.LEFT_STICK_Y])<u&&Math.abs(e.axes[A.RIGHT_STICK_X])<u&&Math.abs(e.axes[A.RIGHT_STICK_Y])<u)}function c(){for(var a in z)z.hasOwnProperty(a)&&d(z[a])}function d(a){if(e.buttons[a].value>u)switch(w[a]=!0,a){case z.LEFT_SHOULDER:case z.RIGHT_SHOULDER:C[a]();break;case z.LEFT_TRIGGER:C[a](e.buttons[z.LEFT_TRIGGER].value);break;case z.RIGHT_TRIGGER:C[a](e.buttons[z.RIGHT_TRIGGER].value)}else if(w[a])switch(w[a]=!1,a){case z.SOUTH_BTN:case z.EAST_BTN:case z.WEST_BTN:case z.NORTH_BTN:case z.NORTH_DPAD:case z.SOUTH_DPAD:case z.WEST_DPAD:case z.EAST_DPAD:case z.RIGHT_STICK_BUTTON:case z.LEFT_STICK_BUTTON:C[a]();break;case z.LEFT_TRIGGER:C[a](e.buttons[z.LEFT_TRIGGER].value);break;case z.RIGHT_TRIGGER:C[a](e.buttons[z.RIGHT_TRIGGER].value)}}var e,f,g,h,i,j,k,l,m,n,o=Autodesk.Viewing.Private,p=a.navigation,q=a.container,r=p.getCamera(),s=1,t=0,u=.1,v=6,w={},x=new THREE.Clock(!0),y={seedURN:!1,objectSet:!0,viewport:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}},z={SOUTH_BTN:0,EAST_BTN:1,WEST_BTN:2,NORTH_BTN:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5,LEFT_TRIGGER:6,RIGHT_TRIGGER:7,SOUTH_DPAD:13,EAST_DPAD:15,WEST_DPAD:14,NORTH_DPAD:12,LEFT_STICK_BUTTON:10,RIGHT_STICK_BUTTON:11},A={LEFT_STICK_X:0,LEFT_STICK_Y:1,RIGHT_STICK_X:2,RIGHT_STICK_Y:3},B=function(){},C={};for(var D in z)z.hasOwnProperty(D)&&(C[z[D]]=B);this.activate=function(b){var c=a.model.getBoundingBox().size();s=Math.max(Math.min(Math.min(c.x,c.y),c.z)/10,1e-4),e=navigator.getGamepads()[0],h=new Autodesk.Viewing.Private.ViewerState(a),i=[],j=0,n=b,H(b)},this.deactivate=function(){n=null,h=null},this.update=function(a,d){if(d&&(r=d),a=x.getDelta(),e=navigator.getGamepads()[0],f>-1){(new Date).getTime()-f>g&&F()}if(e&&(l=2*a*s*v,r.isPerspective||p.toPerspective(),e&&b())){r.dirty=!0,k&&(m=r.position.z);var h=r.target.clone().sub(r.position),i=h.length();h.multiplyScalar(1/i);var j=h.clone().cross(r.up).normalize();if(Math.abs(e.axes[A.LEFT_STICK_Y])>u){var n=h.clone().multiplyScalar(-e.axes[A.LEFT_STICK_Y]*l);r.position.add(n),r.target.add(n)}if(Math.abs(e.axes[A.LEFT_STICK_X])>u){var o=j.clone().multiplyScalar(e.axes[A.LEFT_STICK_X]*l);r.position.add(o),r.target.add(o)}var q=new THREE.Quaternion,t=h;if(Math.abs(e.axes[A.RIGHT_STICK_Y])>u){var w=r.clone(),y=h.clone();q.setFromAxisAngle(j,-e.axes[A.RIGHT_STICK_Y]*l/2),y.applyQuaternion(q),w.up.applyQuaternion(q);var z=w.worldup.clone(),B=y.angleTo(z),C=THREE.Math.degToRad(5);B>=C&&B<=Math.PI-C&&(t=h.clone().applyQuaternion(q),r.up.applyQuaternion(q))}var D=new THREE.Quaternion;Math.abs(e.axes[A.RIGHT_STICK_X])>u&&(D.setFromAxisAngle(r.worldup,-e.axes[A.RIGHT_STICK_X]*l/2),t.applyQuaternion(D),r.up.applyQuaternion(D)),c(),k&&(r.position.z=m),t.multiplyScalar(i),r.target.copy(r.position).add(t)}return r};var E=function(a,b,c,d,e){Autodesk.Viewing.Private.HudMessage.displayMessage(q,a,c,d,e),b>0?(f=(new Date).getTime(),g=b):(f=-1,g=0)},F=function(){Autodesk.Viewing.Private.HudMessage.dismiss(),f=-1},G=function(a){F();var b;switch(a){case"up":b=k?"Vertical Lock Mode":"Fly mode"}E({msgTitleKey:"View Orientation Drag Mode Toggled",messageKey:"View Orientation Drag Mode Toggled",messageDefaultValue:b},2e3)},H=function(a){switch(a){case"headtracker":C[z.SOUTH_BTN]=R,C[z.SOUTH_DPAD]=I,C[z.NORTH_DPAD]=W,C[z.WEST_BTN]=U,C[z.LEFT_SHOULDER]=J,C[z.RIGHT_SHOULDER]=K,C[z.LEFT_TRIGGER]=L,C[z.RIGHT_TRIGGER]=N,C[z.RIGHT_STICK_BUTTON]=S,C[z.LEFT_STICK_BUTTON]=T;break;default:C[z.SOUTH_BTN]=R,C[z.EAST_BTN]=O,C[z.WEST_BTN]=U,C[z.NORTH_BTN]=V,C[z.SOUTH_DPAD]=I,C[z.WEST_DPAD]=P,C[z.EAST_DPAD]=Q,C[z.NORTH_DPAD]=W,C[z.LEFT_SHOULDER]=J,C[z.RIGHT_SHOULDER]=K,C[z.LEFT_TRIGGER]=M,C[z.RIGHT_TRIGGER]=N,C[z.RIGHT_STICK_BUTTON]=S,C[z.LEFT_STICK_BUTTON]=T}},I=function(){a.navigation.setRequestHomeView(!0),a.showAll(),a.impl.selector.clearSelection(),a.explode(0)},J=function(){k?m+=-e.buttons[z.LEFT_SHOULDER].pressed*l:r.translateY(-e.buttons[z.LEFT_SHOULDER].pressed*l)},K=function(){k?m+=e.buttons[z.RIGHT_SHOULDER].pressed*l:r.translateY(e.buttons[z.RIGHT_SHOULDER].pressed*l)},L=function(b){if(b>u){if(.5==b)return void a.explode(0);t=b;var c=t;c>1&&(c=1),c<0&&(c=0),a.explode(c)}else a.explode(0)},M=function(a){if(a>u){if(.5==a)return r.fov=75,void(w[z.LEFT_TRIGGER]=!1);r.fov=-45*a+75}else r.fov=75},N=function(a){if(a>u){if(.5==a)return void(w[z.RIGHT_TRIGGER]=!1);v=-5.5*a+6}else v=6},O=function(){var a=h.getState(y);i.push(a),o.logger.log("Savepoint created.")},P=function(){i.length&&(j--,j<0&&(j=i.length-1),h.restoreState(i[j]))},Q=function(){i.length&&(j++,j>=i.length&&(j=0),h.restoreState(i[j]))},R=function(){var b=a.impl.hitTestViewport(new THREE.Vector3(0,0,0));"headtracker"==n&&r.updateMatrixWorld(),b?a.impl.selector.toggleSelection(b.dbId,b.model):a.impl.selector.clearSelection()},S=function(){a.impl.selector.clearSelection()},T=function(){a.showAll(),a.impl.selector.clearSelection(),a.explode(0)},U=function(){var b=a.impl.hitTestViewport(new THREE.Vector3(0,0,0),!1);b&&(b.dbId in a.getHiddenNodes()?a.show(b.dbId):a.hide(b.dbId))},V=function(){a.getPropertyPanel(!0).setVisible(!a.getPropertyPanel(!0).isVisible())},W=function(){k=!k,k&&(m=r.position.z),G("up")}}}(),function(){"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360Sim");var a=function(){function a(){var a=this;a.SimulationStudies={LSS:"SimCaseLSS",MODAL:"SimCaseModalFrequencies",BUCKLING:"SimCaseStructuralBuckling",THERMAL:"SimCaseThermalSteady",THERMALSTRESS:"SimCaseThermalStress",SHAPEGENERATOR:"SimCaseTopOpt",NAMES:{UNKNOWN:"Unknown",LSS:"Static Stress",MODAL:"Modal Frequencies",BUCKLING:"Structural Buckling",THERMAL:"Thermal",THERMALSTRESS:"Thermal Stress",SHAPEGENERATOR:"Shape Optimization"}},a.studyNode,a.loadCases={},a.pointMasssesNode=-1,a.pointMassNodes=[],a.connectorsNode=-1,a.connectorNodes=[],a.activeLoadCaseKey=null,a.modelNodes=[],a.analysisType=a.SimulationStudies.LSS,a.modelStructurePanel=null,a.simExt=null,a.simNodes=[]}a.prototype={constructor:a};var b=a.prototype;return b.studyName=function(){var a=this.SimulationStudies.NAMES.UNKNOWN;return this.analysisType===this.SimulationStudies.LSS?a=this.SimulationStudies.NAMES.LSS:this.analysisType===this.SimulationStudies.MODAL?a=this.SimulationStudies.NAMES.MODAL:this.analysisType===this.SimulationStudies.BUCKLING?a=this.SimulationStudies.NAMES.BUCKLING:this.analysisType===this.SimulationStudies.THERMAL?a=this.SimulationStudies.NAMES.THERMAL:this.analysisType===this.SimulationStudies.THERMALSTRESS?a=this.SimulationStudies.NAMES.THERMALSTRESS:this.analysisType===this.SimulationStudies.SHAPEGENERATOR&&(a=this.SimulationStudies.NAMES.SHAPEGENERATOR),a},b.reset=function(){var a=this;a.studyNode=-1,a.modelNodes=[],a.analysisType=a.SimulationStudies.LSS,a.loadCases={},a.pointMasssesNode=-1,a.pointMassNodes=[],a.connectorsNode=-1,a.connectorNodes=[],a.activeLoadCaseKey=null,a.simNodes=[],a.modelStructurePanel=null},b.addLoadCase=function(a,b,c){var d=this,e=new aves.Fusion360Sim.SimulationLoadCaseDef;return e.loadCase=c,e.loadCaseName=a,d.loadCases["SIM_LOAD_CASE"+b]=e,1===Object.keys(d.loadCases).length&&(d.activeLoadCaseKey="SIM_LOAD_CASE"+b),e},b.shouldDisplayInTree=function(a){var b=this,c=a.dbId;if(b.simNodes.indexOf(c)<0)return!1;if(b.studyNode===c)return!0;if(null===b.activeLoadCaseKey)return!1;if(b.pointMasssesNode===c)return!0;if(-1!==b.pointMassNodes.indexOf(c))return!0;if(-1!==b.connectorNodes.indexOf(c))return!0;if(b.connectorsNode===c)return!0;for(var d=Object.keys(b.loadCases),e=0;e<d.length;e++){var f=b.loadCases[d[e]];if(f.isImportant(c))return f.shouldDisplayInTree(c)}return!1},a}();Autodesk.Viewing.Extensions.Fusion360Sim.SimulationDef=a;var b=function(){function a(){var a=this;a.loadCase=-1,a.loadCaseName="",a.constraintsNode=-1,a.constraintNodes=[],a.loadsNode=-1,a.loadNodes=[],a.resultsNode=-1,a.undeformedResults=-1,a.resultTypes={},a.resultGroups={},a.modalResults={}}a.prototype={constructor:a};var b=a.prototype;return b.associateResult=function(a,b){this.resultTypes[b]=a},b.associateResultGroup=function(a,b){this.resultGroups[b]=a},b.associateModalResult=function(a,b){var c=[];if(c=this.modalResults[a])c.push(b);else{var d=[];d.push(b),c=d}this.modalResults[a]=c},b.isImportant=function(a){var b=this;return b.loadCase===a||(-1!==b.loadNodes.indexOf(a)||(-1!==b.constraintNodes.indexOf(a)||(b.resultsNode===a||(b.constraintsNode===a||b.loadsNode===a))))},b.shouldDisplayInTree=function(a){var b=this;return b.loadCase===a||(-1!==b.loadNodes.indexOf(a)||(-1!==b.constraintNodes.indexOf(a)||b.resultsNode!==a&&(b.constraintsNode===a||b.loadsNode===a)))},b.reset=function(){var a=this;a.constraintsNode=-1,a.constraintNodes=[],a.loadsNode=-1,a.loadNodes=[],a.resultsNode=-1,a.undeformedResults=-1,a.resultTypes={},a.resultGroups={},a.modalResults={}},a}();Autodesk.Viewing.Extensions.Fusion360Sim.SimulationLoadCaseDef=b}(),function(){"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360Sim");var a=Autodesk.Viewing,b=(a.Extension,a.Extensions),c=a.UI,d=a.i18n,e=function(){function e(a,b){if(a&&b){var c=a.style.cssText.trim();";"===c.substring(c.length-1)||(c+=";");var d=[];for(var e in b)d[d.length]=[e,b[e]].join(":");d=d.join(";"),a.style.cssText=d}}function f(){var a,b,e,f,g,h,i,j,k,l,m,n,o=this;c.DockingPanel.prototype.initialize.call(o);var p=o.container;p.classList.add("property-panel","simulation-container","position-"+(o.position||"left")+"-corner"),p.dockRight=!0,f=o.legend=document.createElement("div");var q=document.createDocumentFragment(),r=document.createElement("div");r.classList.add("sim-div-Results"),e=o.resultsGroup=document.createElement("select"),e.classList.add("simulation-resultGroup"),r.appendChild(e),g=o.resultTypes=document.createElement("select"),g.classList.add("simulation-resultTypes"),r.appendChild(g),q.appendChild(r);var s=document.createElement("div");s.classList.add("sim-div-options"),b=o.optUndeformed=document.createElement("input"),b.classList.add("sim-undeformedOption"),b.setAttribute("type","checkbox"),b.setAttribute("name","optUndeformed"),b.setAttribute("id","Undeformed"),b.addEventListener("change",function(a){var b=o.simDef.loadCases[o.simDef.activeLoadCaseKey];null!==b&&-1!==b.undeformedResults&&(o.optUndeformed.checked?o.viewer.show(b.undeformedResults):o.viewer.hide(b.undeformedResults))}),b.checked=!1,s.appendChild(b),b.checked=!1,a=o.labelUndeformed=document.createElement("label"),a.classList.add("sim-undeformedOptionText"),a.htmlFor="Undeformed",a.setAttribute("data-i18n","Show Undeformed Model"),a.textContent=d.translate("Show Undeformed Model"),s.appendChild(a),q.appendChild(s),h=o.divColorScale=document.createElement("div"),h.classList.add("sim-div-colorscale"),h.classList.add("sim-div-colorscale-top1"),i=o.colorScale=document.createElement("div"),i.classList.add("simulation-colorscale"),h.appendChild(i),j=o.colorScaleTopText=document.createElement("div"),j.classList.add("sim-colorScaleTopText"),j.innerHTML="- 3333",h.appendChild(j),k=o.colorScaleBottomText=document.createElement("div"),k.classList.add("sim-colorScaleBottomText"),k.innerHTML="- 3333",h.appendChild(k),q.appendChild(h),l=o.line2=document.createElement("hr"),l.classList.add("sim-line2"),q.appendChild(l);var t=document.createElement("div");t.classList.add("sim-div-Table"),t.addEventListener("click",function(a){t.classList.add("sim-div-Table-Collapse"),p.classList.add("simulation-container-Collapse"),h.classList.add("sim-div-colorscale-Collapse")}),h.addEventListener("click",function(a){t.classList.remove("sim-div-Table-Collapse"),p.classList.remove("simulation-container-Collapse"),h.classList.remove("sim-div-colorscale-Collapse")}),m=o.tbl=document.createElement("table"),n=o.tblBody=document.createElement("tbody"),m.appendChild(n),m.classList.add("sim-table"),t.appendChild(m),q.appendChild(t),f.appendChild(q),p.appendChild(f)}function g(a,b){for(var c=0;c<a.length;++c){var d=a[c];if(d.displayName===b)return d.displayValue}return null}function h(a,b){var c=!1,d='""';b<=1&&(c=!0,d="none"),a.disabled=c,e(a,{"-webkit-appearance":d,"-moz-appearance":d,appearance:d})}function i(a,b){var d=this;b=b||{},d.viewer=a,d.simDef=null,c.DockingPanel.call(d,a.container,"Simulation-Panel","Simulation Results"),d.position=b.position||"right"}i.prototype=Object.create(c.DockingPanel.prototype);var j=i.prototype;return j.constructor=i,j.initialize=function(){var a=this;f.call(a),a.resultsGroup.addEventListener("change",function(b){var c=a.simDef,d=c.loadCases[a.simDef.activeLoadCaseKey];a.viewer.hide(d.resultsNode);var e="fillResultTypes";c.modalAnalysis&&(e="fillModalResultTypes"),a[e](c.activeLoadCaseKey,a.resultsGroup.value),setTimeout(function(){a.setSimObjectsVisibility()},100)}),a.resultTypes.addEventListener("change",function(){var b=a.simDef.loadCases[a.simDef.activeLoadCaseKey];a.viewer.hide(b.resultsNode),a.setSimObjectsVisibility()})},j.setSimulationDef=function(a){function b(a){var b=g(a.properties,"Name");k.setTitle(b)}function c(a,b,c){}function e(a){var b=g(a.properties,"Elements"),c=g(a.properties,"Nodes");k.rowElements.cells[1].innerText=b,k.rowNodes.cells[1].innerText=c}var f,h,i,j,k=this;if(k.simDef=a,f=1*a.studyNode,-1===a.undeformedResults&&(k.optUndeformed.classList.add("sim-hide"),k.labelUndeformed.classList.add("sim-hide"),k.divColorScale.classList.remove("sim-div-colorscale-top1"),k.divColorScale.classList.add("sim-div-colorscale-top2")),k.viewer.getProperties(f,b,c),h=d.translate(a.studyName()),i=k.tblBody,k.rowType)k.rowType.cells[1].innerHTML=h;else{[{name:"rowType",content:[d.translate("Analysis Type"),h]},{name:"rowNodes",content:[d.translate("Nodes"),"1872"]},{name:"rowElements",content:[d.translate("Elements"),"1084"]},{name:"rowMin",content:[d.translate("Min"),"0.000E+02 MPa"]},{name:"rowMax",content:[d.translate("Max"),"5.117E+02 MPa"]}].forEach(function(a){k[a.name]=i.insertRow(-1),a.content.forEach(function(b){k[a.name].insertCell(-1).innerHTML=b})})}j=k.viewer,j.model.getObjectTree(function(b){k.instanceTree=b,k.fillResultsGroup(k.simDef.activeLoadCaseKey);var c=a.analysisType===a.SimulationStudies.MODAL||a.analysisType===a.SimulationStudies.BUCKLING?"fillModalResultTypes":"fillResultTypes";k[c](k.simDef.activeLoadCaseKey,k.resultsGroup.value),setTimeout(function(){a.simExt.showResultsDlg(!0),a.simExt.applySettings(),k.setSimObjectsVisibility()},500)});var l=+k.simDef.resultsNode;j.getProperties(l,e,c)},j.processNodes=function(a,c){function e(a,b){function c(c){var e=c.properties,f=g(c.properties,"A1C6011B-E1A6-4ADF-975D-A0003C592F87");if(f){switch(f){case"SIM_STUDY":j.studyNode=a;var h=g(c.properties,"Study Type");j.analysisType=h;break;case"SIM_POINT_MASSES":j.pointMasssesNode=a;break;case"SIM_POINT_MASS":j.pointMassNodes.push(a);break;case"SIM_CONNECTORS":j.connectorsNode=a;break;case"SIM_CONNECTOR":j.connectorNodes.push(a);break;case"SIM_LOAD_CASE":l=j.addLoadCase(g(c.properties,"Name"),a,a);break;case"SIM_CONSTRAINTS":null==l&&(l=j.addLoadCase(d.translate("Load Case:1"),0,0)),l.constraintsNode=a;break;case"SIM_CONSTRAINT":l.constraintNodes.push(a);break;case"SIM_LOADS":null==l&&(l=j.addLoadCase(d.translate("Load Case:1"),0,0)),l.loadsNode=a;break;case"SIM_LOAD":l.loadNodes.push(a);break;case"SIM_RESULTS_SCALAR_PLOT":null==l&&(l=j.addLoadCase(d.translate("Load Case:1"),0,0)),j.analysisType===j.SimulationStudies.LSS||j.analysisType===j.SimulationStudies.THERMAL||j.analysisType===j.SimulationStudies.THERMALSTRESS||j.analysisType===j.SimulationStudies.SHAPEGENERATOR?l.associateResult(g(e,"Name"),a):l.associateModalResult(g(e,"Name"),a);break;case"SIM_RESULTS_GROUP":null==l&&(l=j.addLoadCase(d.translate("Load Case:1"),0,0)),j.analysisType!==j.SimulationStudies.LSS&&j.analysisType!==j.SimulationStudies.THERMAL&&j.analysisType!==j.SimulationStudies.THERMALSTRESS&&j.analysisType!==j.SimulationStudies.SHAPEGENERATOR||l.associateResultGroup(g(e,"Name"),a);break;case"SIM_RESULTS":null==l&&(l=j.addLoadCase(d.translate("Load Case:1"),0,0)),l.resultsNode=a;break;case"SIM_RESULTS_UNDEFORMED_FEATURE_EDGES_PLOT":null==l&&(l=j.addLoadCase(d.translate("Load Case:1"),0,0)),l.undeformedResults=a}j.simNodes.push(a)}else j.modelNodes.push(a);b()}function e(a,c,d){b()}a&&k&&k.getProperties(a,c,e)}function f(){i.length>0?e(i.shift(),f):c(j)}var h=this,i=[],j=h.simDef,k=h.viewer,l=null;j?j.reset():j=new b.Fusion360Sim.SimulationDef,a.enumNodeChildren(a.getRootId(),function(a){i[i.length]=a},!0),f()},j.initModel=function(b,c){var d=this;d.viewer&&(d.processNodes(b,function(a){a.simExt=c,d.setSimulationDef(a)}),d.addEventListener(d.viewer,a.SELECTION_CHANGED_EVENT,function(a){var b=a.nodeArray;b&&d.handleClick(b[0])}))},j.fillResultsGroup=function(a){var b=this,c=b.simDef,e=c.loadCases[a],f=b.resultsGroup;f.options.length=0;for(var g=Object.keys(c.analysisType===c.SimulationStudies.MODAL||c.analysisType===c.SimulationStudies.BUCKLING?e.modalResults:e.resultGroups),i=0;i<g.length;i++){var j=document.createElement("option");j.value=g[i];var k=c.analysisType===c.SimulationStudies.MODAL||c.analysisType===c.SimulationStudies.BUCKLING?g[i]:e.resultGroups[g[i]];j.setAttribute("data-i18n",k),j.textContent=d.translate(k),f.add(j)}h(f,f.options.length,!1)},j.fillResultTypes=function(a,b){function c(a,b,c){}function e(a){function b(a){if(g(a.properties,e)===f){var b=document.createElement("option");b.value=a.dbId;var c=l.resultTypes[a.dbId];b.setAttribute("data-i18n",c),b.textContent=d.translate(c),j.add(b),h(j,j.options.length,0===k.options.length)}}for(var e="Result group",f=g(a.properties,e),m=Object.keys(l.resultTypes),n=0;n<m.length;n++){var o=+m[n];i.getProperties(o,b,c)}}var f=this,i=f.viewer,j=f.resultTypes,k=f.resultsGroup,l=f.simDef.loadCases[a];j.options.length=0;var m=+b;i.getProperties(m,e,c)},j.fillModalResultTypes=function(a,b){function c(a){if(g(a.properties,"Result type")===k){var b=document.createElement("option");b.value=a.dbId;var c=g(a.properties,"Mode"),d=c;b.setAttribute("data-i18n",d),b.textContent=d,e.resultTypes.add(b),h(f,f.options.length,0===i.options.length)}}function d(a,b,c){}var e=this,f=e.resultTypes,i=e.resultsGroup,j=e.simDef.loadCases[a];f.options.length=0;for(var k=b,l=j.modalResults[k]||[],m=0;m<l.length;m++){var n=+l[m];e.viewer.getProperties(n,c,d)}},j.uninitialize=function(){c.DockingPanel.prototype.uninitialize.call(this),this.viewer=null},j.setTitle=function(a,b){a||(a="Simulations",b=b||{},b.localizeTitle=!0),c.DockingPanel.prototype.setTitle.call(this,a,b)},j.setModelNodesVisible=function(a){var b=this,c=b.viewer;if(b.simDef){var d=b.simDef.modelNodes;if(d&&d.length>0)for(var e=0;e<d.length;e++)c[a?"show":"hide"](d[e])}},j.setNodeVisibility=function(a,b){this.viewer[b?"show":"hide"](a)},j.isSimStudyNode=function(a){return!!this.simDef.studyNode&&this.simDef.studyNode===a},j.handleClick=function(a){var b=this;if(null===b.simDef)return!1;var c=b.simDef.loadCases[b.simDef.activeLoadCaseKey];if(null===c)return!1;for(var d=Object.keys(b.simDef.loadCases),e=0;e<d.length;e++){var f=b.simDef.loadCases[d[e]];if(f.isImportant(a)&&c!==f){-1!==c.loadsNode&&b.viewer.hide(c.loadsNode),-1!==c.constraintsNode&&b.viewer.hide(c.constraintsNode),-1!==c.undeformedResults&&b.viewer.hide(c.undeformedResults),-1!==c.resultsNode&&b.viewer.hide(c.resultsNode),-1!==b.simDef.connectorsNode&&b.viewer.hide(b.simDef.connectorsNode),b.simDef.activeLoadCaseKey=d[e],b.fillResultsGroup(b.simDef.activeLoadCaseKey);var g=b.simDef.analysisType===b.simDef.SimulationStudies.MODAL||b.simDef.analysisType===b.simDef.SimulationStudies.BUCKLING?"fillModalResultTypes":"fillResultTypes";return b[g](b.simDef.activeLoadCaseKey,b.resultsGroup.value),setTimeout(function(){b.simDef.simExt.showResultsDlg(!0),b.setSimObjectsVisibility()},500),!0}}return!1},j.setSimObjectsVisibility=function(a){function b(a){var b=g(a.properties,"Minimal value"),c=g(a.properties,"Maximal value"),e=g(a.properties,"Scale reversed"),f=g(a.properties,"Unit");d.rowMin.cells[1].innerText=b+" "+f,d.rowMax.cells[1].innerText=c+" "+f;var h=g(a.properties,"Lower referential value"),i=g(a.properties,"Upper referential value");"True"===e?(d.colorScale.style.transform="rotate(90deg)",d.colorScale.style.moztransform="rotate(90deg)",d.colorScale.style.webkittransform="rotate(90deg)"):(d.colorScale.style.transform="rotate(-90deg)",d.colorScale.style.moztransform="rotate(-90deg)",d.colorScale.style.webkittransform="rotate(-90deg)"),d.colorScaleTopText.innerHTML="- "+i+" "+f,d.colorScaleBottomText.innerHTML="- "+h+" "+f}function c(a,b,c){}var d=this,e=d.simDef.loadCases[d.simDef.activeLoadCaseKey];if(!d.resultTypes||0===d.resultTypes.options.length||null===e)return d.setModelNodesVisible(!0),void d.simDef.simExt.showResultsDlg(!1);var f=+d.resultTypes.value;d.setModelNodesVisible(!1),-1!==f&&d.viewer.show(f),-1!==e.loadsNode&&d.viewer.show(e.loadsNode),-1!==e.constraintsNode&&d.viewer.show(e.constraintsNode),d.optUndeformed.checked&&-1!==e.undeformedResults&&d.viewer.show(e.undeformedResults),-1!==d.simDef.connectorsNode&&d.viewer.show(d.simDef.connectorsNode),d.viewer.getProperties(f,b,c)},i}();b.Fusion360Sim.GalleryPanel=e}(),function(){"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360Sim"),Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel=function(a,b,c){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.call(this,a.viewer,b,c),this.viewer=a.viewer,this.ext=a},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype=Object.create(Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype),Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.constructor=Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel,Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.setGallery=function(a){this.simGalleryPanel=a},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.initialize=function(){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.initialize.call(this)},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.isSimResultsNode=function(a){return!!(this.simGalleryPanel&&this.simGalleryPanel.simDef&&this.simGalleryPanel.simDef.resultsNode)&&this.simGalleryPanel.simDef.resultsNode==a},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.isSimStudyNode=function(a){return!!(this.simGalleryPanel&&this.simGalleryPanel.simDef&&this.simGalleryPanel.simDef.studyNode)&&this.simGalleryPanel.simDef.studyNode==a},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.isModelNode=function(a){return!!(this.simGalleryPanel&&this.simGalleryPanel.simDef&&this.simGalleryPanel.simDef.modelNodes&&0!=this.simGalleryPanel.simDef.modelNodes.length)&&-1!==this.simGalleryPanel.simDef.modelNodes.indexOf(a)},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.shouldInclude=function(a){var b=this;if(!b.simGalleryPanel||!b.simGalleryPanel.simDef)return!1;if(b.isModelNode(a))return!0;if(b.isSimStudyNode(a))return!0;for(var c=b.simGalleryPanel.simDef,d=Object.keys(c.loadCases),e=0;e<d.length;e++){if(c.loadCases[d[e]].resultsNode===a)return!1}return!0},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.onClick=function(a,b){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onClick.call(this,a,b),this.simGalleryPanel.handleClick(a)},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.expandStudyNode=function(){this.simGalleryPanel.simDef.studyNode&&this.tree.setCollapsed(this.simGalleryPanel.simDef.studyNode,!1)}}(),function(){"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360Sim");var a=Autodesk.Viewing;a.GEOMETRY_LOAD_START="geometryLoadStarted";var b=function(){function b(b,e){var f=this;e=e||{};for(var g in c)e[g]=e[g]||c[g];a.Extension.call(f,b,e),this.name="fusionsim",b.addEventListener(a.GEOMETRY_LOAD_START,function(a){d&&f.unload(),"Autodesk.Fusion360.Simulation"===a.data.extensions?d=!0:(f.unload(),d=!1)}),b.addEventListener(a.GEOMETRY_LOADED_EVENT,function(a){f.load()})}var c={},d=!1;b.prototype=Object.create(a.Extension.prototype);var e=b.prototype;return e.constructor=b,e.load=function(){var b=this,c=b.viewer;return!c.model||(b.galleryPanel=new a.Extensions.Fusion360Sim.GalleryPanel(b.viewer),b.viewer.addPanel(b.galleryPanel),b.simButton=new a.UI.Button("toolbar-simulation"),b.simButton.setVisible(!1),b.simButton.setToolTip("Simulation Results"),b.simButton.onClick=function(c){var d=b.galleryPanel.isVisible();d?b.deactivate(b.galleryPanel):b.activate(b.galleryPanel),b.simButton.setState(d?a.UI.Button.State.INACTIVE:a.UI.Button.State.ACTIVE)},b.simButton.setIcon("toolbar-simulationIcon"),c.settingsTools.addControl(b.simButton,{index:1}),b.hideLines=c.prefs.get("lineRendering"),b.ghosting=c.prefs.get("ghosting"),b.ambientShadow=c.prefs.get("ambientShadows"),b.antialiazing=c.prefs.get("antialiasing"),b.lightPreset=c.prefs.get("lightPreset"),c.model.getObjectTree(function(a){setTimeout(function(){b.galleryPanel.initModel(a,b),b.initModelBrowser()},100)}),!0)},e.unload=function(){var a=this;if(a.viewer.model)return a.showResultsDlg(!1),a.viewer.settingsTools.removeControl(this.simButton),a.viewer.removePanel(this.galleryPanel),a.galleryPanel.uninitialize(),a.viewer.hideLines(!a.hideLines),a.viewer.setGhosting(a.ghosting),
a.viewer.setQualityLevel(a.ambientShadow,a.antialiazing),a.viewer.setLightPreset(a.lightPreset),!0},e.initModelBrowser=function(){var a=this;setTimeout(function(){a.options=a.options||{},a.options.addFooter=!0,a.modelStructurePanel=new Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel(a,"Simulation Model Structure Loading",a.options),a.viewer.setModelStructurePanel(a.modelStructurePanel),a.modelStructurePanel.setGallery(a.galleryPanel)},100)},e.showResultsDlg=function(b){var c=this;c.simButton.setState(b?a.UI.Button.State.ACTIVE:a.UI.Button.State.INACTIVE),c.simButton.setVisible(b),c.galleryPanel.setVisible(b)},e.applySettings=function(){var a=this.viewer;a.hideLines(!1),a.setGhosting(!1),a.setQualityLevel(!1,!0),a.setLightPreset(4)},e.simData=function(){return this.galleryPanel.simDef},e.activate=function(a){return this.activeStatus||(a.setVisible(!0),this.activeStatus=!0),!0},e.deactivate=function(a){return this.activeStatus&&(a.setVisible(!1),this.activeStatus=!1),!0},b}();a.Extensions.Simulation=b,a.theExtensionManager.registerExtension("Autodesk.Fusion360.Simulation",a.Extensions.Simulation)}(),function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.viewer=a,this.options=b,this.name="explode",this.slider=a.explodeSubmenu.querySelector(".explode-slider"),this.explodeButton=a.modelTools.getControl("toolbar-explodeTool")}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.Explode");a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a;var c=a.prototype;c.activate=function(){return this.activeStatus||(this.viewer.explodeSubmenu.style.display="",this.activeStatus=!0),!0},c.deactivate=function(){return this.activeStatus&&(this.slider.parentNode.style.display="none",this.viewer.explode(0),this.viewer.explodeSlider.value=0,this.activeStatus=!1),!0},b.ExplodeExtension=a,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Explode",b.ExplodeExtension)}(),function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.viewer=a,this.options=b,this.name="fullscreen"}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.FullScreen");a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a;var c=a.prototype;c.activate=function(){return this.activeStatus||(this.viewer.nextScreenMode(),this.activeStatus=!0),!0},c.deactivate=function(){return this.activeStatus&&(this.viewer.escapeScreenMode(),this.activeStatus=!1),!0},b.FullScreenExtension=a,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.FullScreen",b.FullScreenExtension)}(),function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.viewer=a,this.options=b,this.name="gohome"}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.GoHome");a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a;var c=a.prototype;c.activate=function(){return this.viewer.navigation.setRequestHomeView(!0),!0},c.deactivate=function(){return!1},b.GoHomeExtension=a,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.GoHome",b.GoHomeExtension)}(),function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.viewer=a,this.options=b,this.name="layermanager"}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.LayerManager"),c=Autodesk.Viewing.Extensions;a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a;var d=a.prototype;d.activate=function(){return this.activeStatus||(this.viewer.layersPanel||this.viewer.setLayersPanel(new c.ViewerLayersPanel(this.viewer)),this.viewer.showLayerManager(!0),this.activeStatus=!0),!0},d.deactivate=function(){return this.activeStatus&&(this.viewer.layersPanel||this.viewer.setLayersPanel(new c.ViewerLayersPanel(this.viewer)),this.viewer.showLayerManager(!1),this.activeStatus=!1),!0},b.LayerManagerExtension=a,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.LayerManager",b.LayerManagerExtension)}(),function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.viewer=a,this.options=b,this.name="modelstructure"}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.ModelStructure");a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a;var c=a.prototype;c.activate=function(){return this.activeStatus||(this.viewer.showModelStructurePanel(!0),this.activeStatus=!0),!0},c.deactivate=function(){return this.activeStatus&&(this.viewer.showModelStructurePanel(!1),this.activeStatus=!1),!0},b.ModelStructureExtension=a,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.ModelStructure",b.ModelStructureExtension)}(),function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.viewer=a,this.options=b,this.propertyPanel=this.viewer.getPropertyPanel(!0),this.name="propertiesmanager"}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.PropertiesManager");a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a;var c=a.prototype;c.activate=function(){return this.activeStatus||(this.propertyPanel.setVisible(!0),this.activeStatus=!0),!0},c.deactivate=function(){return this.activeStatus&&(this.propertyPanel.setVisible(!1),this.activeStatus=!1),!0},b.PropertiesManagerExtension=a,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.PropertiesManager",b.PropertiesManagerExtension)}(),function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.viewer=a,this.options=b,this.name="viewersettings"}var b=AutodeskNamespace("Autodesk.Viewing.Extensions.ViewerSettings"),c=Autodesk.Viewing.Extensions;a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a;var d=a.prototype;d.activate=function(){if(!this.activeStatus){this.viewer.showViewer3dOptions(!0);this.viewer.getSettingsPanel(!0).selectTab(c.ViewerSettingTab.Performance),this.activeStatus=!0}return!0},d.deactivate=function(){return this.activeStatus&&(this.viewer.showViewer3dOptions(!1),this.activeStatus=!1),!0},b.ViewerSettingsExtension=a,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.ViewerSettings",b.ViewerSettingsExtension)}(),function(a,b){"use strict";var c,d=a.document;c=function(){var b,c,e,f,g,h,i,j,k,l,m,n,o,p={},q={},r=!1,s={ENTER:13,ESC:27,SPACE:32},t=[];return q={buttons:{holder:'<nav class="alertify-buttons">{{buttons}}</nav>',submit:'<button type="submit" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',ok:'<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',cancel:'<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</button>'},input:'<div class="alertify-text-wrapper"><input type="text" class="alertify-text" id="alertify-text"></div>',message:'<p class="alertify-message">{{message}}</p>',log:'<article class="alertify-log{{class}}">{{message}}</article>'},o=function(){var a,b,c=!1,e=d.createElement("fakeelement"),f={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"};for(a in f)if(void 0!==e.style[a]){b=f[a],c=!0;break}return{type:b,supported:c}},b=function(a){return d.getElementById(a)},p={labels:{ok:"OK",cancel:"Cancel"},delay:5e3,buttonReverse:!1,buttonFocus:"ok",transition:void 0,addListeners:function(a){var b,h,i,j,k,l=void 0!==e,m=void 0!==c,o=void 0!==n,p="",q=this;b=function(b){return void 0!==b.preventDefault&&b.preventDefault(),i(b),void 0!==n&&(p=n.value),"function"==typeof a&&(void 0!==n?a(!0,p):a(!0)),!1},h=function(b){return void 0!==b.preventDefault&&b.preventDefault(),i(b),"function"==typeof a&&a(!1),!1},i=function(a){q.hide(),q.unbind(d.body,"keyup",j),q.unbind(f,"focus",k),l&&q.unbind(e,"click",b),m&&q.unbind(c,"click",h)},j=function(a){var c=a.keyCode;(c===s.SPACE&&!o||o&&c===s.ENTER)&&b(a),c===s.ESC&&m&&h(a)},k=function(a){o?n.focus():!m||q.buttonReverse?e.focus():c.focus()},this.bind(f,"focus",k),this.bind(g,"focus",k),l&&this.bind(e,"click",b),m&&this.bind(c,"click",h),this.bind(d.body,"keyup",j),this.transition.supported||this.setFocus()},bind:function(a,b,c){"function"==typeof a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},handleErrors:function(){if(void 0!==a.onerror){var b=this;return a.onerror=function(a,c,d){b.error("["+a+" on line "+d+" of "+c+"]",0)},!0}return!1},appendButtons:function(a,b){return this.buttonReverse?b+a:a+b},build:function(a){var b="",c=a.type,d=a.message,e=a.cssClass||"";switch(b+='<div class="alertify-dialog">',b+='<a id="alertify-resetFocusBack" class="alertify-resetFocus" href="#">Reset Focus</a>',"none"===p.buttonFocus&&(b+='<a href="#" id="alertify-noneFocus" class="alertify-hidden"></a>'),"prompt"===c&&(b+='<div id="alertify-form">'),b+='<article class="alertify-inner">',b+=q.message.replace("{{message}}",d),"prompt"===c&&(b+=q.input),b+=q.buttons.holder,b+="</article>","prompt"===c&&(b+="</div>"),b+='<a id="alertify-resetFocus" class="alertify-resetFocus" href="#">Reset Focus</a>',b+="</div>",c){case"confirm":b=b.replace("{{buttons}}",this.appendButtons(q.buttons.cancel,q.buttons.ok)),b=b.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case"prompt":b=b.replace("{{buttons}}",this.appendButtons(q.buttons.cancel,q.buttons.submit)),b=b.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case"alert":b=b.replace("{{buttons}}",q.buttons.ok),b=b.replace("{{ok}}",this.labels.ok)}return k.className="alertify alertify-"+c+" "+e,j.className="alertify-cover",b},close:function(a,b){var c,d,e=b&&!isNaN(b)?+b:this.delay,f=this;this.bind(a,"click",function(){c(a)}),d=function(a){a.stopPropagation(),f.unbind(this,f.transition.type,d),l.removeChild(this),l.hasChildNodes()||(l.className+=" alertify-logs-hidden")},c=function(a){void 0!==a&&a.parentNode===l&&(f.transition.supported?(f.bind(a,f.transition.type,d),a.className+=" alertify-log-hide"):(l.removeChild(a),l.hasChildNodes()||(l.className+=" alertify-logs-hidden")))},0!==b&&setTimeout(function(){c(a)},e)},dialog:function(a,b,c,e,f){i=d.activeElement;var g=function(){l&&null!==l.scrollTop&&j&&null!==j.scrollTop||g()};if("string"!=typeof a)throw new Error("message must be a string");if("string"!=typeof b)throw new Error("type must be a string");if(void 0!==c&&"function"!=typeof c)throw new Error("fn must be a function");return this.init(),g(),t.push({type:b,message:a,callback:c,placeholder:e,cssClass:f}),r||this.setup(),this},extend:function(a){if("string"!=typeof a)throw new Error("extend method must have exactly one paramter");return function(b,c){return this.log(b,a,c),this}},hide:function(){var a,b=this;t.splice(0,1),t.length>0?this.setup(!0):(r=!1,a=function(c){c.stopPropagation(),b.unbind(k,b.transition.type,a)},this.transition.supported?(this.bind(k,this.transition.type,a),k.className="alertify alertify-hide alertify-hidden"):k.className="alertify alertify-hide alertify-hidden alertify-isHidden",j.className="alertify-cover alertify-cover-hidden",i.focus())},init:function(){d.createElement("nav"),d.createElement("article"),d.createElement("section"),null==b("alertify-cover")&&(j=d.createElement("div"),j.setAttribute("id","alertify-cover"),j.className="alertify-cover alertify-cover-hidden",d.body.appendChild(j)),null==b("alertify")&&(r=!1,t=[],k=d.createElement("section"),k.setAttribute("id","alertify"),k.setAttribute("style","z-index : 999999999"),k.className="alertify alertify-hidden",d.body.appendChild(k)),null==b("alertify-logs")&&(l=d.createElement("section"),l.setAttribute("id","alertify-logs"),l.className="alertify-logs alertify-logs-hidden",d.body.appendChild(l)),d.body.setAttribute("tabindex","0"),this.transition=o()},log:function(a,b,c){var d=function(){l&&null!==l.scrollTop||d()};return this.init(),d(),l.className="alertify-logs",this.notify(a,b,c),this},notify:function(a,b,c){var e=d.createElement("article");e.className="alertify-log"+("string"==typeof b&&""!==b?" alertify-log-"+b:""),e.innerHTML=a,l.appendChild(e),setTimeout(function(){e.className=e.className+" alertify-log-show"},50),this.close(e,c)},set:function(a){var b;if("object"!=typeof a&&a instanceof Array)throw new Error("args must be an object");for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},setFocus:function(){n?(n.focus(),n.select()):h.focus()},setup:function(a){var d,i=t[0],j=this;r=!0,d=function(a){a.stopPropagation(),j.setFocus(),j.unbind(k,j.transition.type,d)},this.transition.supported&&!a&&this.bind(k,this.transition.type,d),k.innerHTML=this.build(i),f=b("alertify-resetFocus"),g=b("alertify-resetFocusBack"),e=b("alertify-ok")||void 0,c=b("alertify-cancel")||void 0,h="cancel"===p.buttonFocus?c:"none"===p.buttonFocus?b("alertify-noneFocus"):e,n=b("alertify-text")||void 0,m=b("alertify-form")||void 0,"string"==typeof i.placeholder&&""!==i.placeholder&&(n.value=i.placeholder),a&&this.setFocus(),this.addListeners(i.callback)},unbind:function(a,b,c){"function"==typeof a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)}},{alert:function(a,b,c){return p.dialog(a,"alert",b,"",c),this},confirm:function(a,b,c){return p.dialog(a,"confirm",b,"",c),this},extend:p.extend,init:p.init,log:function(a,b,c){return p.log(a,b,c),this},prompt:function(a,b,c,d){return p.dialog(a,"prompt",b,c,d),this},success:function(a,b){return p.log(a,"success",b),this},error:function(a,b){return p.log(a,"error",b),this},set:function(a){p.set(a)},hide:function(a){p.hide(a)},labels:p.labels,debug:p.handleErrors}},void 0===a.alertify&&(a.alertify=new c)}(this),function(){var a=Autodesk.Viewing,b=a.endpoint=a.endpoint||{},c=(a.Private,null);b.ENDPOINT_API_DERIVATIVE_SERVICE_V2="derivativeV2",b.ENDPOINT_API_MODEL_DERIVATIVE_V2="modelDerivativeV2",b.ENDPOINT_API_FLUENT="fluent";var d={derivativeV2:{baseURL:"/derivativeservice/v2",itemURL:"/derivativeservice/v2/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn"},modelDerivativeV2:{baseURL:"/modelderivative/v2/",itemURL:"/modelderivative/v2/designdata/:urn/manifest/:derivativeurn",manifestURL:"/modelderivative/v2/designdata/:urn/manifest",thumbnailsURL:"/modelderivative/v2/designdata/:urn/thumbnail"},fluent:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnRedirectURL:"/cdnurl"}},e="",f=b.ENDPOINT_API_DERIVATIVE_SERVICE_V2,g=!1;b.HTTP_REQUEST_HEADERS={},b.setEndpointAndApi=function(a,b){e=a,b&&(f=b)},b.getEndpointAndApi=function(){return e+d[f].baseURL},b.getApiEndpoint=function(){return e},b.getApiFlavor=function(){return f},b.getCdnUrl=function(){return c||(e?e+d[f].cdnURL:void 0)},b.setCdnUrl=function(a){c=a},b.getCdnRedirectUrl=function(){var a=d[f].cdnRedirectURL;return a?e+a:null},b.getManifestApi=function(a,b,c){var g=a||e;return c=c||f,g+=d[c].manifestURL,b=b||"",g=g.replace(":urn",b)},b.getItemApi=function(a,b,c){var g=(a||e)+d[c||f].itemURL;b=b||"";var h=b;return h=h.split("/"),h=h[0]||"",h=h.split(":"),h=h[h.length-1]||"",g=g.replace(":urn",h),g=g.replace(":derivativeurn",b)},b.getThumbnailApi=function(a,b,c){return((a||e)+d[c||f].thumbnailsURL).replace(":urn",b||"")},b.makeOssPath=function(a,b,c){return(a||e)+"/oss/v2/buckets/"+b+"/objects/"+encodeURIComponent(decodeURIComponent(c))},b.getUseCredentials=function(){return g},b.pathRequiresCredentials=function(a){var b=-1===a.indexOf("://"),c=0===a.indexOf(this.getEndpointAndApi()),d=0===a.indexOf(e);return b||c||d},b.getDomainParam=function(){return this.getUseCredentials()&&!a.isNodeJS?"domain="+encodeURIComponent(window.location.origin):""},b.setUseCredentials=function(a){g=a}}(),function(){"use strict";var a=Autodesk.Viewing,b=a.endpoint=a.endpoint||{},c=a.Private,d=a.getGlobal();b.PROTEIN_ROOT=null,b.PRISM_ROOT=null,d.LOCALIZATION_REL_PATH="",d.LMV_VIEWER_VERSION="4.1",d.LMV_VIEWER_PATCH="0",d.LMV_BUILD_TYPE="Production",d.LMV_RESOURCE_VERSION=null,d.LMV_RESOURCE_ROOT="","v"===LMV_VIEWER_VERSION.charAt(0)&&(LMV_VIEWER_VERSION=LMV_VIEWER_VERSION.substr(1)),d.stderr=function(){console.warn('"stderr" is deprecated; please use "Autodesk.Viewing.Private.logger" instead')},c.env=null,c.docItemId=null,c.token={accessToken:null,getAccessToken:null,tokenRefreshInterval:null},c.assets=[],c.offline=!1,c.offlineResourcePrefix=null;var e={local:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},dev:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},stg:{RTC:["https://rtc-stg.api.autodesk.com:443","https://lmv.autodesk.com:443"]},prod:{RTC:["https://rtc.api.autodesk.com:443","https://lmv.autodesk.com:443"]}},f={local:"",dev:"https://developer-dev.api.autodesk.com",stg:"https://developer-stg.api.autodesk.com",prod:"https://developer.api.autodesk.com"},g={dev:"https://fluent.autodesk.com",stg:"https://dcs-stg.autodesk.com",prod:"https://dcs.autodesk.com"},h={stg:{CLIENT_ID:"lmv-stag",CLIENT_KEY:"kjemi1rwAgsqIqyvDUtc9etPD6MsAzbV",ENDPOINT:"https://ase-stg.autodesk.com"},prod:{CLIENT_ID:"lmv-prod",CLIENT_KEY:"iaoUM2CRGydfn703yfPq4MAogZi8I5u4",ENDPOINT:"https://ase.autodesk.com"}};c.EnvironmentConfigurations={Local:{ROOT:"",LMV:e.local},Development:{ROOT:f.dev,LMV:e.dev,bubbleManifest:!0},Staging:{ROOT:f.stg,LMV:e.stg,bubbleManifest:!0},Production:{ROOT:f.prod,LMV:e.prod,bubbleManifest:!0},AutodeskDevelopment:{ROOT:f.dev,LMV:e.dev},AutodeskStaging:{ROOT:f.stg,LMV:e.stg},AutodeskProduction:{ROOT:f.prod,LMV:e.prod},FluentDev:{ROOT:g.dev,LMV:e.dev},FluentStaging:{ROOT:g.stg,LMV:e.stg},FluentProduction:{ROOT:g.prod,LMV:e.prod}},c.initializeEnvironmentVariable=function(a){var b;if(a&&a.env&&(b=a.env),b||(b=c.getParameterByName("env")),a&&a.offlineResourcePrefix&&(c.offlineResourcePrefix=a.offlineResourcePrefix),a&&a.offline&&"true"===a.offline&&(c.offline=!0),!b)switch(window.location.hostname){case"developer-dev.api.autodesk.com":b="AutodeskDevelopment";break;case"developer-stg.api.autodesk.com":b="AutodeskStaging";break;case"developer.api.autodesk.com":b="AutodeskProduction";break;case"localhost.autodesk.com":case"":case"127.0.0.1":b="Local";break;default:b="AutodeskProduction"}c.env=b,"undefined"!=typeof window&&c.logger.info("Host name : "+window.location.hostname),c.logger.info("Environment initialized as : "+b)},c.initializeServiceEndPoints=function(b){var d=b.endpoint;if(!d){d=c.EnvironmentConfigurations[c.env].ROOT}var e=b.api||a.endpoint.ENDPOINT_API_DERIVATIVE_SERVICE_V2;if(a.endpoint.setEndpointAndApi(d,e),!a.isNodeJS){var f=["viewer3D.js","viewer3D.min.js"];b&&b.hasOwnProperty("libraryName")&&f.push(b.libraryName);for(var g,h,i=0;i<f.length;i++){var j=c.getScript(f[i]);h=j?j.src:"";var k=h.indexOf(f[i]);if(k>=0){g=h.substr(0,k);break}}LMV_RESOURCE_VERSION="v"+LMV_VIEWER_VERSION;var l=c.getParameterByNameFromPath("v",h);l&&l.length&&l!=LMV_RESOURCE_VERSION?(c.logger.warn("Version string mismatch between requested and actual version: "+l+" vs. "+LMV_RESOURCE_VERSION+". Using "+l),LMV_RESOURCE_VERSION=l):l&&l.length||(LMV_RESOURCE_VERSION=null,c.logger.info("No viewer version specified, will implicitly use "+LMV_VIEWER_VERSION)),LMV_RESOURCE_ROOT=g||LMV_RESOURCE_ROOT}},c.initLoadContext=function(b){b=b||{},b.auth=a.endpoint.getUseCredentials(),b.endpoint=a.endpoint.getApiEndpoint(),b.headers||(b.headers={});var c=a.endpoint;for(var d in c.HTTP_REQUEST_HEADERS)b.headers[d]=c.HTTP_REQUEST_HEADERS[d];var e=a.endpoint.getDomainParam();return e&&(b.queryParams?b.queryParams+="&"+e:b.queryParams=e),b.otg_cdn=c.getCdnUrl(),b},c.refreshCookie=function(b,d,e){d=d||function(){},c.ViewingService.rawGet(a.endpoint.getApiEndpoint(),null,"/auth/settoken",d,e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0,postData:"access-token="+b})},c.refreshRequestHeader=function(b){a.endpoint.HTTP_REQUEST_HEADERS.Authorization="Bearer "+b},c.refreshToken=function(a,b,d){if(c.token.accessToken=a,c.token.useCookie){var e=function(b){c.logger.warn("Failed to set token in cookie. Will use header instead."),c.token.useCookie=!1,c.refreshRequestHeader(a),d&&d(b)};c.refreshCookie(a,b,e)}else c.refreshRequestHeader(a),b&&b()},c.initializeAuth=function(b,d){function e(a,f){g=a,c.refreshToken(g,c.token.tokenRefreshInterval?null:b);var h=f-60;h<=0&&(h=f),c.token.tokenRefreshInterval=1e3*h,setTimeout(function(){d.getAccessToken(e)},c.token.tokenRefreshInterval)}var f=d?d.shouldInitializeAuth:void 0;if(void 0===f){f="false"!==c.getParameterByName("auth").toLowerCase()}if("Local"==c.env||!f)return setTimeout(b,0),a.endpoint.setUseCredentials(void 0!==d.useCredentials&&d.useCredentials),a.endpoint.getUseCredentials();a.endpoint.setUseCredentials(void 0===d.useCredentials||d.useCredentials),c.token.useCookie=d.useCookie,c.token.tokenRefreshInterval&&(clearTimeout(c.token.tokenRefreshInterval),c.token.tokenRefreshInterval=null);var g;return d&&d.getAccessToken?(c.token.getAccessToken=d.getAccessToken,"string"==typeof(g=d.getAccessToken(e))&&g&&c.refreshToken(g,b)):d&&d.accessToken?(g=d.accessToken,c.refreshToken(g,b)):(g=c.getParameterByName("accessToken"),g||(g="9AMaRKBoPCIBy61JmQ8OLLLyRblS",c.logger.warn("Warning : no access token is provided. Use built in token : "+g)),c.refreshToken(g,b)),a.endpoint.getUseCredentials()},c.initializeLogger=function(b){if(c.logger.initialize(b),!(b&&b.hasOwnProperty("useADP")&&0==b.useADP||a.isNodeJS)){var d="https://ase-cdn.autodesk.com/adp/v1.0.3/js/adp-web-analytics-sdk.min.js",e=function(){if("undefined"==typeof Adp)return void c.logger.warn("Autodesk Data Platform SDK not found");var a;switch(LMV_BUILD_TYPE){case"Production":a=h.prod;break;default:a=h.stg}var b={product:{name:"LMV",line_name:"LMV",key:a.CLIENT_ID,id:a.CLIENT_KEY,id_provider:"appkey",build_id:LMV_VIEWER_VERSION+"."+LMV_VIEWER_PATCH,build_tag:LMV_BUILD_TYPE}},d={server:a.ENDPOINT,enable_geo_data:!1,enable_browser_data:!0,enable_session_messages:!0};c.logger.adp=new Adp(b,d)};"function"==typeof require?require([d],function(a){window.Adp=a,e()}):c.loadDependency("Adp",d,e)}};var i=function(){b.getCdnRedirectUrl()&&c.ViewingService.rawGet(b.getCdnRedirectUrl(),null,null,function(a){a&&a.length&&(b.setCdnUrl(a),c.logger.info("CDN_ROOT is: "+a))},function(){},{withCredentials:!1,responseType:"text"})};c.initializeProtein=function(){if((!c.ENABLE_DEBUG||"Local"!=c.env||a.endpoint.getUseCredentials())&&!c.offline){var b=new XMLHttpRequest;b.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=protein",!0),b.responseType="json",b.onload=function(d){var e=b.response.url;e&&e.length&&(e=e.replace("http://","https://"),a.endpoint.PROTEIN_ROOT=e+"/",c.logger.info("Protein root is: "+a.endpoint.PROTEIN_ROOT))},b.send();var d=new XMLHttpRequest;d.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=prism",!0),d.responseType="json",d.onload=function(b){var e=d.response.url;e&&e.length&&(e=e.replace("http://","https://"),a.endpoint.PRISM_ROOT=e+"/",c.logger.info("Prism root is: "+a.endpoint.PRISM_ROOT))},d.send()}},c.getParameterByName=function(a){return"undefined"==typeof window?"":c.getParameterByNameFromPath(a,window.location.href)},c.getParameterByNameFromPath=function(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),e=d.exec(b);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))},c.getDemoDocumentURN=function(){var a;switch(c.env){case"Development":a="urn:dXJuOmFkc2suYTM2MGJldGFkZXY6ZnMuZmlsZTplbnRlcnByaXNlLmxtdnRlc3QuRFM1YTczMFFUYmYwMDIyZDA3NTFhYmE5MjZlZDZkMjJlZDY0P3ZlcnNpb249MQ==";break;case"Staging":a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbicvTU0zNTAwQXNzZW1ibHkuZHdm";break;case"Production":a="FIXME";break;default:a="https://lmv.rocks/viewer/data/gears/output/bubble.json"}return a},c.processMemoryOptions=function(a){if(a){var b;if(a.memory){b=0|parseInt(a.memory.limit);(a.memory.debug&&a.memory.debug.force||!1)&&b<=0&&(a.memory.force=!1,c.logger.warn("config.memory.limit value is invalid: ("+a.memory.limit+")"))}var d=c.getParameterByName("viewermemory");if((b=parseInt(d))>=0){b|=0;var e=b>0&&"f"===d.charAt(d.length-1).toLowerCase();a.memory={limit:b,debug:{force:e}},e?c.logger.info("Forcing memory limit to URL param: ("+b+" MegaBytes)."):c.logger.info("Setting memory limit to URL param: ("+b+" MegaBytes).")}else""!==d&&c.logger.warn("Invalid viewermemory URL param value: ("+d+")")}},c.setLanguage=function(a,b){var c={lng:a,resGetPath:"res/locales/__lng__/__ns__.json",ns:{namespaces:["allstrings"],defaultNs:"allstrings"},fallbackLng:"en",debug:!1};LOCALIZATION_REL_PATH="res/locales/"+a+"/",Autodesk.Viewing.i18n.init(c,function(a){Autodesk.Viewing.i18n.clearDebugLocString(),b&&b()})},c.extendLocalization=function(a){return null!==a&&"object"==typeof a&&(Object.keys(a).forEach(function(b){Autodesk.Viewing.i18n.addResourceBundle(b,"allstrings",a[b],!0,!0)}),!0)},c.initializeLocalization=function(a){var b=a&&a.language||navigator.language,d=c.Lang.getSupported(b);c.setLanguage(d)},c.initializeUserInfo=function(a){a&&a.userInfo&&(c.setUserName(a.userInfo.name),a.comment2Token&&(c.comment2Token=a.comment2Token))},c.getScript=function(a){a=a.toLowerCase();var b=document.getElementsByTagName("SCRIPT");if(b&&b.length>0)for(var c=0;c<b.length;++c)if(b[c].src&&-1!==b[c].src.toLowerCase().indexOf(a))return b[c];return null},c.getResourceUrl=function(a){var b=LMV_RESOURCE_VERSION;return LMV_RESOURCE_ROOT+a+(b?"?v="+b:"")},c.loadDependency=function(a,b,d,e,f){if(void 0===window[a]){var g=document.createElement("SCRIPT");g.src=b.indexOf("://")>0?b:c.getResourceUrl(b);var h=function(){g.onerror=null,g.onload=null},i=function(){h(),e&&e()},j=function(){h(),"function"==typeof define&&define.amd&&"function"==typeof require&&f?require([f],function(b){window[a]=b,d&&d()},i):d&&d()};g.onload=j,g.onerror=i,document.head.appendChild(g)}else d&&d()},c.injectCSS=function(a,b,d){for(var e=a.indexOf("://")>0?a:c.getResourceUrl(a),f=document.getElementsByTagName("link"),g=0,h=f.length;g<h;g++)if(f[g].href===e)return void(b&&b());var i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",e),b&&(i.onload=b),d&&(i.onerror=d),document.head.appendChild(i)},c.getHtmlTemplate=function(a,b){function d(a){b(a,null)}function e(a){var c=a.currentTarget.responseText;b(null,c)}var f=a.indexOf("://")>0?a:c.getResourceUrl(a),g=new XMLHttpRequest;g.onload=e,g.onerror=d,g.ontimeout=d,g.open("GET",f,!0),g.send()},Autodesk.Viewing.createInitializerOptions=function(){return{env:"AutodeskProduction",api:void 0,getAccessToken:void 0,language:void 0,logLevel:c.LogLevels.ERROR,webGLHelpLink:null}},Autodesk.Viewing.createViewerConfig=function(){var b={extensions:[],sharedPropertyDbPath:void 0,canvasConfig:void 0,startOnInitialize:!0,experimental:[]};return Autodesk.Viewing.theExtensionManager.popuplateOptions(b),a.Viewer3D&&a.Viewer3D.populateConfigOptions(b),c.GuiViewer3D&&c.GuiViewer3D.populateConfigOptions(b),b},c.isExperimentalFlagEnabled=function(a,b){return!(!b||!Array.isArray(b.experimental))&&-1!==b.experimental.indexOf(a)},Autodesk.Viewing.Initializer=function(b,d){function e(){c.initializeLegacyNamespaces(!1);var a=2,e=function(){--a<=0&&d()};c.initWorkerScript(e,e),THREE.warn=c.logger.warn.bind(c.logger),c.initializeAuth(e,b),c.initializeLocalization(b),c.initializeUserInfo(b),i()}a.isNodeJS?(c.initializeEnvironmentVariable(b),c.initializeServiceEndPoints(b),c.initializeLogger(b),c.initializeAuth(d,b),i()):(c.WEBGL_HELP_LINK=b?b.webGLHelpLink:null,c.initializeEnvironmentVariable(b),c.initializeServiceEndPoints(b),c.initializeLogger(b),c.disableDocumentTouchSafari(),c.loadDependency("Promise","es6-promise.min.js",function(){c.loadDependency("THREE","three.min.js",function(){c.loadDependency("WGS","wgs.min.js",e)})},null,"es6-promise-polyfill"))}}();